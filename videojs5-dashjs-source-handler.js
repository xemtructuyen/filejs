(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==='object'&&typeof module==='object')
module.exports=factory();else if(typeof define==='function'&&define.amd)
define([],factory);else{var a=factory();for(var i in a)(typeof exports==='object'?exports:root)[i]=a[i];}})(this,function(){return(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports;}
var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports;}
__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.i=function(value){return value;};__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{configurable:false,enumerable:true,get:getter});}};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module['default'];}:function getModuleExports(){return module;};__webpack_require__.d(getter,'a',getter);return getter;};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property);};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=2);})
([(function(module,exports,__webpack_require__){(function(global){var win;if(typeof window!=="undefined"){win=window;}else if(typeof global!=="undefined"){win=global;}else if(typeof self!=="undefined"){win=self;}else{win={};}
module.exports=win;}.call(exports,__webpack_require__(3)))}),(function(module,exports){!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.DashjsP2PBundle=t():e.DashjsP2PBundle=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(76)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r){var i=o(r);!i[e]&&t&&(i[e]={instance:t,override:n})}function t(e,t){for(var n in l){var r=l[n];if(r.context===e&&r.name===t)return r.instance}return null}function n(e,t,n){for(var r in l){var i=l[r];if(i.context===e&&i.name===t)return void(l[r].instance=n)}l.push({name:t,context:e,instance:n})}function r(e){return function(t){return void 0===t&&(t={}),{create:function(){return a(e.__dashjs_factory_name,e.apply({context:t},arguments),t,arguments)}}}}function i(e){return function(n){var r=void 0;return void 0===n&&(n={}),{getInstance:function(){return r||(r=t(n,e.__dashjs_factory_name)),r||(r=a(e.__dashjs_factory_name,e.apply({context:n},arguments),n,arguments),l.push({name:e.__dashjs_factory_name,context:n,instance:r})),r}}}}function a(e,t,n,r){var i=o(n),a=i[e];if(a){var u=a.instance;if(!a.override)return u.apply({context:n,factory:s},r);u=u.apply({context:n,factory:s,parent:t},r);for(var l in u)t.hasOwnProperty(l)&&(t[l]=u[l])}return t}function o(e){var t=void 0;return u.forEach(function(n){n===e&&(t=n)}),t||(t=u.push(e)),t}var s=void 0,u=[],l=[];return s={extend:e,getSingletonInstance:t,setSingletonInstance:n,getSingletonFactory:i,getClassFactory:r}}();t.default=n,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}},s=n(91),u=r(s),l=function(e){function t(){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),t}(u.default),d=new l;t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t,n){var i=arguments.length<=3||void 0===arguments[3]?s:arguments[3];if(!e)throw new Error("event type cannot be null or undefined");if(!t||"function"!=typeof t)throw new Error("listener must be a function: "+t);if(!(r(e,t,n)>=0)){a[e]=a[e]||[];var o={callback:t,scope:n,priority:i},u=a[e].some(function(t,n){if(i>t.priority)return a[e].splice(n,0,o),!0});u||a[e].push(o)}}function t(e,t,n){if(e&&t&&a[e]){var i=r(e,t,n);i<0||a[e].splice(i,1)}}function n(e,t){if(e&&a[e]){if(t=t||{},t.hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");t.type=e,a[e].forEach(function(e){return e.callback.call(e.scope,t)})}}function r(e,t,n){var r=-1;return a[e]?(a[e].some(function(e,i){if(e.callback===t&&(!n||n===e.scope))return r=i,!0}),r):r}function i(){a={}}var a={},o={on:e,off:t,trigger:n,reset:i};return o}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=0,u=5e3;i.__dashjs_factory_name="EventBus";var l=o.default.getSingletonFactory(i);l.EVENT_PRIORITY_LOW=s,l.EVENT_PRIORITY_HIGH=u,t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){d=!0,c=!0,f=(new Date).getTime()}function t(e){c=e}function n(e){d=e}function r(){return d}function i(){var e="",t=null;c&&(t=(new Date).getTime(),e+="["+(t-f)+"]"),e.length>0&&(e+=" "),Array.apply(null,arguments).forEach(function(t){e+=t+" "}),d&&console.log(e),s.trigger(u.default.LOG,{message:e})}var a=this.context,s=(0,o.default)(a).getInstance(),l=void 0,d=void 0,c=void 0,f=void 0;return l={log:i,setLogTimestampVisible:t,setLogToBrowserConsole:n,getLogToBrowserConsole:r},e(),l}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),o=r(a),s=n(2),u=r(s),l=n(1),d=r(l);i.__dashjs_factory_name="Debug",t.default=d.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(){function e(){var e,t;Le=[],Me=!1,we=!0,xe=!0,et=!1,nt=!1,Be={enabled:!0,ttl:c},He={enabled:!0,ttl:f},Ne=d,ke=void 0,Ue=m,Fe=E,je=NaN,Ge=S,Ke=C,Ve=A,We=D,qe=_,Ye=g,ze=h,Qe=p,Xe=v,$e=M,tt={default:L},e={},i(e,u.HTTPRequest.MPD_TYPE,O),i(e,u.HTTPRequest.XLINK_EXPANSION_TYPE,b),i(e,u.HTTPRequest.MEDIA_SEGMENT_TYPE,I),i(e,u.HTTPRequest.INIT_SEGMENT_TYPE,I),i(e,u.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,I),i(e,u.HTTPRequest.INDEX_SEGMENT_TYPE,I),i(e,u.HTTPRequest.OTHER_TYPE,I),Ze=e,t={},i(t,u.HTTPRequest.MPD_TYPE,P),i(t,u.HTTPRequest.XLINK_EXPANSION_TYPE,w),i(t,u.HTTPRequest.MEDIA_SEGMENT_TYPE,R),i(t,u.HTTPRequest.INIT_SEGMENT_TYPE,R),i(t,u.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,R),i(t,u.HTTPRequest.INDEX_SEGMENT_TYPE,R),i(t,u.HTTPRequest.OTHER_TYPE,R),Je=t}function t(e){et=e}function n(){return et}function r(e){qe=e}function a(){return qe}function o(e){Ye=e}function s(){return Ye}function l(e){ze=e}function N(){return ze}function k(e){Qe=e}function x(){return Qe}function U(e){Xe=e}function F(){return Xe}function B(e){je=e}function H(){return isNaN(je)?nt?T:y:je}function j(e){Ge=e}function G(){return Ge}function K(e){Ke=e}function V(){return Ke}function W(e){Ve=e}function q(){return Ve}function Y(e){We=e}function z(){return We}function Q(e){Ue=e}function X(){return Ue}function Z(e,t){Be.enabled=e,void 0===t||isNaN(t)||"number"!=typeof t||(Be.ttl=t)}function J(){return Be}function $(e,t){He.enabled=e,void 0===t||isNaN(t)||"number"!=typeof t||(He.ttl=t)}function ee(){return He}function te(e){Fe=e}function ne(){return Fe}function re(e){Ze[u.HTTPRequest.MEDIA_SEGMENT_TYPE]=e}function ie(e,t){Ze[e]=t}function ae(){return Ze[u.HTTPRequest.MEDIA_SEGMENT_TYPE]}function oe(e){return Ze[e]}function se(e){Je[u.HTTPRequest.MEDIA_SEGMENT_TYPE]=e}function ue(e,t){Je[e]=t}function le(){return Je[u.HTTPRequest.MEDIA_SEGMENT_TYPE]}function de(e){return Je[e]}function ce(e){$e=e}function fe(){return $e}function _e(e){xe=e}function he(){return xe}function pe(e){Ne=e}function ge(e){ke=e}function ve(){return Ne}function me(){return ke}function Ee(e){we=e}function ye(){return we}function Te(e){Me=e}function Se(){return Me}function Ce(e){Le=e}function Ae(){return Le}function De(e,t){e?tt[e]=!!t:Object.keys(tt).forEach(function(e){De(e,t)})}function Ie(e){var t=tt[e];return void 0===t?tt.default:t}function Re(){return nt}function Oe(e){nt=e}function Pe(){}var be=void 0,we=void 0,Me=void 0,Le=void 0,Ne=void 0,ke=void 0,xe=void 0,Ue=void 0,Fe=void 0,Be=void 0,He=void 0,je=void 0,Ge=void 0,Ke=void 0,Ve=void 0,We=void 0,qe=void 0,Ye=void 0,ze=void 0,Qe=void 0,Xe=void 0,Ze=void 0,Je=void 0,$e=void 0,et=void 0,tt=void 0,nt=void 0;return be={setBufferOccupancyABREnabled:t,getBufferOccupancyABREnabled:n,setBandwidthSafetyFactor:r,getBandwidthSafetyFactor:a,setCacheLoadThresholdLatency:o,getCacheLoadThresholdLatency:s,setCacheLoadThresholdVideo:l,getCacheLoadThresholdVideo:N,setCacheLoadThresholdAudio:k,getCacheLoadThresholdAudio:x,setAbandonLoadTimeout:U,getAbandonLoadTimeout:F,setLastBitrateCachingInfo:Z,getLastBitrateCachingInfo:J,setLastMediaSettingsCachingInfo:$,getLastMediaSettingsCachingInfo:ee,setStableBufferTime:B,getStableBufferTime:H,setBufferTimeAtTopQuality:j,getBufferTimeAtTopQuality:G,setBufferTimeAtTopQualityLongForm:K,getBufferTimeAtTopQualityLongForm:V,setLongFormContentDurationThreshold:W,getLongFormContentDurationThreshold:q,setRichBufferThreshold:Y,getRichBufferThreshold:z,setBufferToKeep:Q,getBufferToKeep:X,setBufferPruningInterval:te,getBufferPruningInterval:ne,setFragmentRetryAttempts:re,getFragmentRetryAttempts:ae,setRetryAttemptsForType:ie,getRetryAttemptsForType:oe,setFragmentRetryInterval:se,getFragmentRetryInterval:le,setRetryIntervalForType:ue,getRetryIntervalForType:de,setWallclockTimeUpdateInterval:ce,getWallclockTimeUpdateInterval:fe,setScheduleWhilePaused:_e,getScheduleWhilePaused:he,getUseSuggestedPresentationDelay:Se,setUseSuggestedPresentationDelay:Te,setLiveDelayFragmentCount:pe,getLiveDelayFragmentCount:ve,getLiveDelay:me,setLiveDelay:ge,setUseManifestDateHeaderTimeSource:Ee,getUseManifestDateHeaderTimeSource:ye,setUTCTimingSources:Ce,getUTCTimingSources:Ae,setXHRWithCredentialsForType:De,getXHRWithCredentialsForType:Ie,setFastSwitchEnabled:Oe,getFastSwitchEnabled:Re,reset:Pe},e(),be}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),s=r(o),u=n(6),l={scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"http://time.akamai.com/?iso"},d=4,c=36e4,f=36e4,_=.9,h=50,p=5,g=50,v=1e4,m=30,E=30,y=12,T=20,S=30,C=60,A=600,D=20,I=3,R=1e3,O=3,P=500,b=1,w=500,M=50,L=!1;a.__dashjs_factory_name="MediaPlayerModel";var N=s.default.getSingletonFactory(a);N.DEFAULT_UTC_TIMING_SOURCE=l,t.default=N,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this._stream=null,this._tfinish=null,this._mediaduration=null,this._responseHeaders=null,this._serviceLocation=null},i=function e(){n(this,e),this.s=null,this.d=null,this.b=[]};r.MPD_TYPE="MPD",r.XLINK_EXPANSION_TYPE="XLinkExpansion",r.INIT_SEGMENT_TYPE="InitializationSegment",r.INDEX_SEGMENT_TYPE="IndexSegment",r.MEDIA_SEGMENT_TYPE="MediaSegment",r.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",r.OTHER_TYPE="other",t.HTTPRequest=r,t.HTTPRequestTrace=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n=void 0===e?s:e,r=void 0===t?null:t,i={value:n,reason:r};return i}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=-1;i.__dashjs_factory_name="SwitchRequest";var u=o.default.getClassFactory(i);u.NO_CHANGE=s,t.default=u,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t,r,i){n(this,e),this.code=t||null,this.message=r||null,this.data=i||null};t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){de=0,ce=NaN,fe=null,pe=null,ve=!1,_e={},ge=(0,d.default)(Z).getInstance()}function t(e){he=e,te=le.getElement(),Q(),pe=he.manifestInfo.isDynamic,ce=he.start,$.on(h.default.DATA_UPDATE_COMPLETED,L,this),$.on(h.default.BYTES_APPENDED,Y,this),$.on(h.default.BUFFER_LEVEL_STATE_CHANGED,z,this),$.on(h.default.PERIOD_SWITCH_STARTED,n,this),ve&&(ve=!1,s())}function n(e){!pe&&e.fromStreamInfo&&_e[e.fromStreamInfo.id]&&delete _e[e.fromStreamInfo.id]}function r(){var e=R(!0),t=pe?e-he.start:0;return e+(he.duration-t)-g()}function i(){return g()>0}function a(){return he.id}function s(){if(te){te.autoplay=!0;var e=te.play();e&&"undefined"!=typeof Promise&&e instanceof Promise&&e.catch(function(e){"NotAllowedError"===e.name&&$.trigger(h.default.PLAYBACK_NOT_ALLOWED),J("Caught pending play exception - continuing ("+e+")")})}else ve=!0}function l(){if(te)return te.paused}function c(){te&&(te.pause(),te.autoplay=!1)}function _(){if(te)return te.seeking}function p(e){le&&(J("Requesting seek to time: "+e),le.setCurrentTime(e))}function g(){if(te)return te.currentTime}function v(){if(te)return te.playbackRate}function E(){if(te)return te.played}function y(){if(te)return te.ended}function T(){return pe}function S(e){ce=e}function C(){return ce}function A(e,t){var n=se.getMpd(oe.getValue()),r=void 0,i=10;r=ge.getUseSuggestedPresentationDelay()&&n.hasOwnProperty("suggestedPresentationDelay")?n.suggestedPresentationDelay:ge.getLiveDelay()?ge.getLiveDelay():isNaN(e)?2*he.manifestInfo.minBufferTime:e*ge.getLiveDelayFragmentCount();var a=Math.max(t-i,t/2);return Math.min(r,a)}function D(){le&&te&&($.off(h.default.DATA_UPDATE_COMPLETED,L,this),$.off(h.default.BUFFER_LEVEL_STATE_CHANGED,z,this),$.off(h.default.BYTES_APPENDED,Y,this),b(),X()),le=null,he=null,te=null,pe=null,e()}function I(e){e&&(e.streamController&&(ne=e.streamController),e.timelineConverter&&(re=e.timelineConverter),e.metricsModel&&(ie=e.metricsModel),e.dashMetrics&&(ae=e.dashMetrics),e.manifestModel&&(oe=e.manifestModel),e.dashManifestModel&&(se=e.dashManifestModel),e.adapter&&(ue=e.adapter),e.videoModel&&(le=e.videoModel))}function R(e){var t=void 0,n=(0,u.default)(Z).getInstance().getURIFragmentData(),r=parseInt(n.s,10),i=parseInt(n.t,10),a=NaN;if(e||(a=isNaN(r)?i:r),pe)!isNaN(a)&&a>1262304e3&&(t=a-he.manifestInfo.availableFrom.getTime()/1e3,(t>ce||t<ce-he.manifestInfo.DVRWindowSize)&&(t=null)),t=t||ce;else if(!isNaN(a)&&a<Math.max(he.manifestInfo.duration,he.duration)&&a>=0)t=a;else{var o=_e[he.id];void 0===o&&(o=ne.getActiveStreamCommonEarliestTime()),t=Math.max(o,he.start)}return t}function O(e){var t,n=ie.getReadOnlyMetricsFor("video")||ie.getReadOnlyMetricsFor("audio"),r=ae.getCurrentDVRInfo(n),i=r?r.range:null;if(!i)return NaN;if(e>i.end)t=Math.max(i.end-2*he.manifestInfo.minBufferTime,i.start);else{if(!(e<i.start))return e;t=i.start}return t}function P(){if(null===fe){var e=function(){q()};fe=setInterval(e,ge.getWallclockTimeUpdateInterval())}}function b(){clearInterval(fe),fe=null}function w(){var e=R(!1);e>0&&(p(e),J("Starting playback at offset: "+e))}function M(){if(!l()&&pe&&0!==te.readyState){var e=g(),t=O(e),n=!isNaN(t)&&t!==e;n&&p(t)}}function L(e){if(!e.error){var t=ue.convertDataToTrack(oe.getValue(),e.currentRepresentation),n=t.mediaInfo.streamInfo;he.id===n.id&&(he=n,M())}}function N(){$.trigger(h.default.CAN_PLAY)}function k(){J("Native video element event: play"),M(),P(),$.trigger(h.default.PLAYBACK_STARTED,{startTime:g()})}function x(){J("Native video element event: playing"),$.trigger(h.default.PLAYBACK_PLAYING,{playingTime:g()})}function U(){J("Native video element event: pause"),$.trigger(h.default.PLAYBACK_PAUSED,{ended:y()})}function F(){var e=g();J("Seeking to: "+e),P(),$.trigger(h.default.PLAYBACK_SEEKING,{seekTime:e})}function B(){J("Native video element event: seeked"),$.trigger(h.default.PLAYBACK_SEEKED)}function H(){var e=g();e!==de&&(de=e,$.trigger(h.default.PLAYBACK_TIME_UPDATED,{timeToEnd:r(),time:e}))}function j(){$.trigger(h.default.PLAYBACK_PROGRESS)}function G(){var e=v();J("Native video element event: ratechange: ",e),$.trigger(h.default.PLAYBACK_RATE_CHANGED,{playbackRate:e})}function K(){J("Native video element event: loadedmetadata"),(!pe&&he.isFirst||re.isTimeSyncCompleted())&&w(),$.trigger(h.default.PLAYBACK_METADATA_LOADED),P()}function V(){J("Native video element event: ended"),c(),b(),$.trigger(h.default.PLAYBACK_ENDED)}function W(e){var t=e.target||e.srcElement;$.trigger(h.default.PLAYBACK_ERROR,{error:t.error})}function q(){$.trigger(h.default.WALLCLOCK_TIME_UPDATED,{isDynamic:pe,time:new Date})}function Y(e){var t=e.bufferedRanges;if(t&&t.length){var n=Math.max(t.start(0),he.start),r=void 0===_e[he.id]?n:Math.max(_e[he.id],n);r!==_e[he.id]&&(!pe&&R(!0)<r&&g()<r&&p(r),_e[he.id]=r)}}function z(e){e.streamInfo.id===he.id&&le.setStallState(e.mediaType,e.state===o.default.BUFFER_EMPTY)}function Q(){te.addEventListener("canplay",N),te.addEventListener("play",k),te.addEventListener("playing",x),te.addEventListener("pause",U),te.addEventListener("error",W),te.addEventListener("seeking",F),te.addEventListener("seeked",B),te.addEventListener("timeupdate",H),te.addEventListener("progress",j),te.addEventListener("ratechange",G),te.addEventListener("loadedmetadata",K),te.addEventListener("ended",V)}function X(){te.removeEventListener("canplay",N),te.removeEventListener("play",k),te.removeEventListener("playing",x),te.removeEventListener("pause",U),te.removeEventListener("error",W),te.removeEventListener("seeking",F),te.removeEventListener("seeked",B),te.removeEventListener("timeupdate",H),te.removeEventListener("progress",j),te.removeEventListener("ratechange",G),te.removeEventListener("loadedmetadata",K),te.removeEventListener("ended",V)}var Z=this.context,J=(0,m.default)(Z).getInstance().log,$=(0,f.default)(Z).getInstance(),ee=void 0,te=void 0,ne=void 0,re=void 0,ie=void 0,ae=void 0,oe=void 0,se=void 0,ue=void 0,le=void 0,de=void 0,ce=void 0,fe=void 0,_e=void 0,he=void 0,pe=void 0,ge=void 0,ve=void 0;return ee={initialize:t,setConfig:I,getStreamStartTime:R,getTimeToStreamEnd:r,isPlaybackStarted:i,getStreamId:a,getTime:g,getPlaybackRate:v,getPlayedRanges:E,getEnded:y,getIsDynamic:T,setLiveStartTime:S,getLiveStartTime:C,computeLiveDelay:A,play:s,isPaused:l,pause:c,isSeeking:_,seek:p,reset:D},e(),ee}Object.defineProperty(t,"__esModule",{value:!0});var a=n(17),o=r(a),s=n(43),u=r(s),l=n(5),d=r(l),c=n(3),f=r(c),_=n(2),h=r(_),p=n(1),g=r(p),v=n(4),m=r(v);i.__dashjs_factory_name="PlaybackController",t.default=g.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){W={}}function t(e){e&&e.adapter&&(V=e.adapter)}function n(){G.trigger(O.default.METRICS_CHANGED)}function r(e){G.trigger(O.default.METRIC_CHANGED,{mediaType:e}),n()}function i(e,t,n){G.trigger(O.default.METRIC_UPDATED,{mediaType:e,metric:t,value:n}),r(e)}function a(e,t,n){G.trigger(O.default.METRIC_ADDED,{mediaType:e,metric:t,value:n}),r(e)}function s(e){delete W[e],r(e)}function d(){W={},n()}function f(e){return W.hasOwnProperty(e)?W[e]:null}function h(e){var t;return W.hasOwnProperty(e)?t=W[e]:(t=new o.default,W[e]=t),t}function g(e,t,n,r,i,o){var s=new u.default;return s.tcpid=t,s.dest=n,s.topen=r,s.tclose=i,s.tconnect=o,h(e).TcpList.push(s),a(e,V.metricsList.TCP_CONNECTION,s),s}function m(e,t,n,r){var i=new l.HTTPRequestTrace;return i.s=t,i.d=n,i.b=r,e.trace.push(i),e.interval||(e.interval=0),e.interval+=n,i}function T(e,t,n,r,i,o,s,u,d,c,f,_,p,g){var v=new l.HTTPRequest;return i&&i!==r&&(T(e,null,n,r,null,null,s,u,null,null,null,_,null,null),v.actualurl=i),v.tcpid=t,v.type=n,v.url=r,v.range=s,v.trequest=u,v.tresponse=d,v.responsecode=f,v._tfinish=c,v._stream=e,v._mediaduration=_,v._responseHeaders=p,v._serviceLocation=o,g?g.forEach(function(e){m(v,e.s,e.d,e.b)}):(delete v.interval,delete v.trace),h(e).HttpList.push(v),a(e,V.metricsList.HTTP_REQUEST,v),v}function C(e,t,n,r,i){var o=new c.default;return o.t=t,o.mt=n,o.to=r,i?o.lto=i:delete o.lto,h(e).RepSwitchList.push(o),a(e,V.metricsList.TRACK_SWITCH,o),o}function D(e,t,n){var r=new _.default;return r.t=t,r.level=n,h(e).BufferLevel.push(r),a(e,V.metricsList.BUFFER_LEVEL,r),r}function R(e,t,n){var r=new p.default;return r.target=n,r.state=t,h(e).BufferState.push(r),a(e,V.metricsList.BUFFER_STATE,r),r}function P(e,t,n,r){var i=new v.default;return i.time=t,i.range=r,i.manifestInfo=n,h(e).DVRInfo.push(i),a(e,V.metricsList.DVR_INFO,i),i}function b(e,t){var n=new E.default,r=h(e).DroppedFrames;return n.time=t.creationTime,n.droppedFrames=t.droppedVideoFrames,r.length>0&&r[r.length-1]==n?r[r.length-1]:(r.push(n),a(e,V.metricsList.DROPPED_FRAMES,n),n)}function w(e,t,n,r,i,o,s,u,l){var d=new S.default;return d.mediaType=e,d.t=t,d.type=n,d.startTime=r,d.availabilityStartTime=i,d.duration=o,d.quality=s,d.range=u,d.state=l,h(e).SchedulingInfo.push(d),a(e,V.metricsList.SCHEDULING_INFO,d),d}function L(e,t,n){var r=new I.default;r.loadingRequests=t,r.executedRequests=n,h(e).RequestsQueue=r,a(e,V.metricsList.REQUESTS_QUEUE,r)}function N(e,t,n,r,i,o,s,u,l,d){var c=new y.ManifestUpdate,f=h("stream");return c.mediaType=e,c.type=t,c.requestTime=n,c.fetchTime=r,c.availabilityStartTime=i,c.presentationStartTime=o,c.clientTimeOffset=s,c.currentTime=u,c.buffered=l,c.latency=d,f.ManifestUpdate.push(c),a(e,V.metricsList.MANIFEST_UPDATE,c),c}function k(e,t){if(e){for(var n in t)e[n]=t[n];i(e.mediaType,V.metricsList.MANIFEST_UPDATE,e)}}function x(e,t,n,r,a){if(e){var o=new y.ManifestUpdateStreamInfo;return o.id=t,o.index=n,o.start=r,o.duration=a,e.streamInfo.push(o),i(e.mediaType,V.metricsList.MANIFEST_UPDATE_STREAM_INFO,e),o}return null}function U(e,t,n,r,a,o,s,u){if(e){var l=new y.ManifestUpdateTrackInfo;return l.id=t,l.index=n,l.streamIndex=r,l.mediaType=a,l.startNumber=s,l.fragmentInfoType=u,l.presentationTimeOffset=o,e.trackInfo.push(l),i(e.mediaType,V.metricsList.MANIFEST_UPDATE_TRACK_INFO,e),l}return null}function F(e){var t="stream";return e.trace&&Array.isArray(e.trace)?e.trace.forEach(function(e){e.hasOwnProperty("subreplevel")&&!e.subreplevel&&delete e.subreplevel}):delete e.trace,h(t).PlayList.push(e),a(t,V.metricsList.PLAY_LIST,e),e}function B(e){var t="stream";return h(t).DVBErrors.push(e),a(t,V.metricsList.DVB_ERRORS,e),e}function H(e,t){var n=new M.default;return n._s=t,h(e).BolaState=[n],a(e,"BolaState",n),n}var j=this.context,G=(0,A.default)(j).getInstance(),K=void 0,V=void 0,W=void 0;return K={metricsChanged:n,metricChanged:r,metricUpdated:i,metricAdded:a,clearCurrentMetricsForType:s,clearAllCurrentMetrics:d,getReadOnlyMetricsFor:f,getMetricsFor:h,addTcpConnection:g,addHttpRequest:T,addRepresentationSwitch:C,addBufferLevel:D,addBufferState:R,addDVRInfo:P,addDroppedFrames:b,addSchedulingInfo:w,addRequestsQueue:L,addManifestUpdate:N,updateManifestUpdateInfo:k,addManifestUpdateStreamInfo:x,addManifestUpdateRepresentationInfo:U,addPlayList:F,addDVBErrors:B,updateBolaState:H,setConfig:t},e(),K}Object.defineProperty(t,"__esModule",{value:!0});var a=n(186),o=r(a),s=n(200),u=r(s),l=n(6),d=n(197),c=r(d),f=n(192),_=r(f),h=n(193),p=r(h),g=n(194),v=r(g),m=n(195),E=r(m),y=n(196),T=n(199),S=r(T),C=n(3),A=r(C),D=n(198),I=r(D),R=n(2),O=r(R),P=n(1),b=r(P),w=n(191),M=r(w);i.__dashjs_factory_name="MetricsModel",t.default=b.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){c.trigger(u.default.ERROR,{error:"capability",event:e})}function t(e,t,n){c.trigger(u.default.ERROR,{error:"download",event:{id:e,url:t,request:n}})}function n(e,t,n,r){c.trigger(u.default.ERROR,{error:"manifestError",event:{message:e,id:t,manifest:n,event:r}})}function r(e,t,n){c.trigger(u.default.ERROR,{error:"cc",event:{message:e,id:t,cc:n}})}function i(e){c.trigger(u.default.ERROR,{error:"mediasource",event:e})}function a(e){c.trigger(u.default.ERROR,{error:"key_session",event:e})}function s(e){c.trigger(u.default.ERROR,{error:"key_message",event:e})}var l=void 0,d=this.context,c=(0,o.default)(d).getInstance();return l={capabilityError:e,downloadError:t,manifestError:n,timedTextError:r,mediaSourceError:i,mediaKeySessionError:a,mediaKeyMessageError:s}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),o=r(a),s=n(2),u=r(s),l=n(1),d=r(l),c="mediasource",f="mediakeys",_="manifest",h="SIDX",p="content",g="initialization",v="xlink",m="codec",E="parse",y="nostreams",T="parse";i.__dashjs_factory_name="ErrorHandler";var S=d.default.getSingletonFactory(i);S.CAPABILITY_ERROR_MEDIASOURCE=c,S.CAPABILITY_ERROR_MEDIAKEYS=f,S.DOWNLOAD_ERROR_ID_MANIFEST=_,S.DOWNLOAD_ERROR_ID_SIDX=h,S.DOWNLOAD_ERROR_ID_CONTENT=p,S.DOWNLOAD_ERROR_ID_INITIALIZATION=g,S.DOWNLOAD_ERROR_ID_XLINK=v,S.MANIFEST_ERROR_ID_CODEC=m,S.MANIFEST_ERROR_ID_PARSE=E,S.MANIFEST_ERROR_ID_NOSTREAMS=y,S.TIMED_TEXT_ERROR_ID_PARSE=T,t.default=S,e.exports=t.default},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function a(){function e(e,t){var n,r=O.getValue(),i=r.Period_asArray[t];return n=C(i,e),null===n?null:n.bandwidth}function t(e,t){var n,r=O.getValue(),i=r.Period_asArray[t];return n=S(i,e)}function n(e,t){var n,r=O.getValue(),i=r.Period_asArray[t];return n=D(i,e)}function r(e){return f(e,h.TRACK_SWITCH)}function i(e){return f(e,h.BUFFER_LEVEL)}function a(e){var t=i(e);return t?(0,p.round10)(t.level/1e3,-3):0}function s(e){return e.RequestsQueue}function l(e){if(null===e)return null;var t,n,r=e.HttpList,i=null;if(null===r||r.length<=0)return null;for(t=r.length,n=t-1;n>=0;){if(r[n].responsecode){i=r[n];break}n--}return i}function c(e){return null===e?[]:e.HttpList?e.HttpList:[]}function f(e,t){if(null===e)return null;var n=e[t];if(null===n)return null;var r=n.length;return r<=0?null:n[r-1]}function _(e){return f(e,h.DROPPED_FRAMES)}function g(e){return f(e,h.SCHEDULING_INFO)}function v(e){return f(e,h.MANIFEST_UPDATE)}function m(e){return f(e,h.DVR_INFO)}function E(e,t){var n,r,i,a={};if(null===e)return null;for(n=c(e),i=n.length-1;i>=0;i--)if(r=n[i],r.type===o.HTTPRequest.MPD_TYPE){a=T(r._responseHeaders);break}return void 0===a[t]?null:a[t]}function y(e,t){if(null===e)return null;var n,r=l(e);return null===r||null===r._responseHeaders?null:(n=T(r._responseHeaders),void 0===n[t]?null:n[t])}function T(e){var t={};if(!e)return t;for(var n=e.trim().split("\r\n"),r=0,i=n.length;r<i;r++){var a=n[r],o=a.indexOf(": ");o>0&&(t[a.substring(0,o)]=a.substring(o+2))}return t}function S(e,t){var n=C(e,t,!0);return null!==n?n:-1}function C(e,t,n){var r,i,a,o,s,u;for(i=e.AdaptationSet_asArray,s=0;s<i.length;s+=1)for(r=i[s],o=r.Representation_asArray,u=0;u<o.length;u+=1)if(a=o[u],t===a.id)return n?u:a;return null}function A(e,t){return(0,d.default)(R).getInstance().getIsTypeOf(e,t)}function D(e,t){var n,r,i,a;if(!e||!t)return-1;for(r=e.AdaptationSet_asArray,a=0;a<r.length;a+=1)if(n=r[a],i=n.Representation_asArray,A(n,t))return i.length;return-1}var I=void 0,R=this.context,O=(0,u.default)(R).getInstance();return I={getBandwidthForRepresentation:e,getIndexForRepresentation:t,getMaxIndexForBufferType:n,getCurrentRepresentationSwitch:r,getLatestBufferLevelVO:i,getCurrentBufferLevel:a,getCurrentHttpRequest:l,getHttpRequests:c,getCurrentDroppedFrames:_,getCurrentSchedulingInfo:g,getCurrentDVRInfo:m,getCurrentManifestUpdate:v,getLatestFragmentRequestHeaderValueByID:y,getLatestMPDRequestHeaderValueByID:E,getRequestsQueue:s}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),s=n(33),u=i(s),l=n(13),d=i(l),c=n(1),f=i(c),_=n(54),h=r(_),p=n(202);a.__dashjs_factory_name="DashMetrics",t.default=f.default.getSingletonFactory(a),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){var n,r,i,a=!1,o=!1,s=e.ContentComponent_asArray,u="text"!==t?new RegExp(t):new RegExp("(vtt|ttml)");if(e.Representation_asArray.length>0&&e.Representation_asArray[0].hasOwnProperty("codecs")){var l=e.Representation_asArray[0].codecs;if(0===l.search("stpp")||0===l.search("wvtt"))return"fragmentedText"===t}if(s){if(s.length>1)return"muxed"===t;s[0]&&s[0].contentType===t&&(a=!0,o=!0)}if(e.hasOwnProperty("mimeType")&&(a=u.test(e.mimeType),o=!0),!o)for(n=0,r=e.Representation_asArray.length;!o&&n<r;)i=e.Representation_asArray[n],i.hasOwnProperty("mimeType")&&(a=u.test(i.mimeType),o=!0),n++;return a}function t(t){return e(t,"audio")}function n(t){return e(t,"video")}function r(t){return e(t,"fragmentedText")}function i(t){return e(t,"text")}function a(t){return e(t,"muxed")}function s(e){return"text/vtt"===e||"application/ttml+xml"===e}function l(e){var t="";return e.hasOwnProperty("lang")&&(t=e.lang.replace(/[^A-Za-z0-9-]/g,"")),t}function c(e){return e.hasOwnProperty("Viewpoint")?e.Viewpoint:null}function _(e){return e.hasOwnProperty("Role_asArray")?e.Role_asArray:[]}function p(e){return e.hasOwnProperty("Accessibility_asArray")?e.Accessibility_asArray:[]}function v(e){return e.hasOwnProperty("AudioChannelConfiguration_asArray")?e.AudioChannelConfiguration_asArray:[]}function E(e){return _(e).filter(function(e){return"main"===e.value})[0]}function T(){return function(e,t){return e.bandwidth-t.bandwidth}}function C(e){return void 0!==e.Representation_asArray&&null!==e.Representation_asArray&&e.Representation_asArray.sort(T()),e}function D(e,t,n){var r,i,a=t.Period_asArray[n].AdaptationSet_asArray;for(r=0,i=a.length;r<i;r++)if(a[r].hasOwnProperty("id")&&a[r].id===e)return a[r];return null}function R(e,t,n){var r=t.Period_asArray[n].AdaptationSet_asArray;return r[e]}function P(e,t,n){var r,i,a=t.Period_asArray[n].AdaptationSet_asArray;for(r=0,i=a.length;r<i;r++)if(a[r]===e)return r;return-1}function b(t,n,r){var i,a,o=t.Period_asArray[n].AdaptationSet_asArray,s=[];for(i=0,a=o.length;i<a;i++)e(o[i],r)&&s.push(C(o[i]));return s}function w(e,t,n,r){var i=b(e,t,n);if(!i||0===i.length)return null;if(i.length>1&&r)for(var a=le.getCurrentTrackFor(n,r),o=de.getAllMediaInfoForType(e,r,n),s=0,u=i.length;s<u;s++){if(a&&le.isTracksEqual(a,o[s]))return i[s];if(E(i[s]))return i[s]}return i[0]}function M(e){var t=e.Representation_asArray[0];return t.mimeType+';codecs="'+t.codecs+'"'}function L(e){return e.Representation_asArray[0].mimeType}function N(e){return e&&e.hasOwnProperty("cenc:default_KID")?e["cenc:default_KID"]:null}function k(e){return e&&e.hasOwnProperty("ContentProtection_asArray")&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null}function x(e){var t=!1;return e.hasOwnProperty("type")&&(t="dynamic"===e.type),t}function U(e){var t,n,r=x(e);return t=!isNaN(e.timeShiftBufferDepth),n=r&&t}function F(e,t){var n=!1;return e.profiles&&e.profiles.length>0&&(n=e.profiles.indexOf(t)!==-1),n}function B(e){return F(e,"urn:mpeg:dash:profile:isoff-on-demand:2011")}function H(e){return F(e,"urn:dvb:dash:profile:dvb-dash:2014")}function j(e){var t;return t=e.hasOwnProperty("mediaPresentationDuration")?e.mediaPresentationDuration:Number.MAX_VALUE}function G(e){return e.bandwidth}function K(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=NaN;return e.hasOwnProperty("minimumUpdatePeriod")&&(n=e.minimumUpdatePeriod),isNaN(n)?n:Math.max(n-t,1)}function V(e){return e.Representation_asArray.length}function W(e){if(!e||!e.Representation_asArray||!e.Representation_asArray.length)return null;for(var t=C(e),n=t.Representation_asArray,r=n.length,i=[],a=0;a<r;a++)i.push({bandwidth:n[a].bandwidth,width:n[a].width||0,height:n[a].height||0});return i}function q(e,t){return t.Representation_asArray[e]}function Y(e,t){for(var n,r,i,a,u,l=C(e.Period_asArray[t.period.index].AdaptationSet_asArray[t.index]),d=[],c=0;c<l.Representation_asArray.length;c++)a=l.Representation_asArray[c],n=new o.default,n.index=c,n.adaptation=t,a.hasOwnProperty("id")&&(n.id=a.id),a.hasOwnProperty("bandwidth")&&(n.bandwidth=a.bandwidth),a.hasOwnProperty("maxPlayoutRate")&&(n.maxPlayoutRate=a.maxPlayoutRate),a.hasOwnProperty("SegmentBase")?(i=a.SegmentBase,n.segmentInfoType="SegmentBase"):a.hasOwnProperty("SegmentList")?(i=a.SegmentList,i.hasOwnProperty("SegmentTimeline")?(n.segmentInfoType="SegmentTimeline",u=i.SegmentTimeline.S_asArray[i.SegmentTimeline.S_asArray.length-1],(!u.hasOwnProperty("r")||u.r>=0)&&(n.useCalculatedLiveEdgeTime=!0)):(n.segmentInfoType="SegmentList",n.useCalculatedLiveEdgeTime=!0)):a.hasOwnProperty("SegmentTemplate")?(i=a.SegmentTemplate,i.hasOwnProperty("SegmentTimeline")?(n.segmentInfoType="SegmentTimeline",u=i.SegmentTimeline.S_asArray[i.SegmentTimeline.S_asArray.length-1],(!u.hasOwnProperty("r")||u.r>=0)&&(n.useCalculatedLiveEdgeTime=!0)):n.segmentInfoType="SegmentTemplate",
i.hasOwnProperty("initialization")&&(n.initialization=i.initialization.split("$Bandwidth$").join(a.bandwidth).split("$RepresentationID$").join(a.id))):n.segmentInfoType="BaseURL",i&&(i.hasOwnProperty("Initialization")?(r=i.Initialization,r.hasOwnProperty("sourceURL")?n.initialization=r.sourceURL:r.hasOwnProperty("range")&&(n.range=r.range)):a.hasOwnProperty("mimeType")&&s(a.mimeType)&&(n.range=0),i.hasOwnProperty("timescale")&&(n.timescale=i.timescale),i.hasOwnProperty("duration")&&(n.segmentDuration=i.duration/n.timescale),i.hasOwnProperty("startNumber")&&(n.startNumber=i.startNumber),i.hasOwnProperty("indexRange")&&(n.indexRange=i.indexRange),i.hasOwnProperty("presentationTimeOffset")&&(n.presentationTimeOffset=i.presentationTimeOffset/n.timescale)),n.MSETimeOffset=ue.calcMSETimeOffset(n),n.path=[t.period.index,t.index,c],d.push(n);return d}function z(e,i){for(var o,s,l=e.Period_asArray[i.index],d=[],c=0;c<l.AdaptationSet_asArray.length;c++)s=l.AdaptationSet_asArray[c],o=new u.default,s.hasOwnProperty("id")&&(o.id=s.id),o.index=c,o.period=i,a(s)?o.type="muxed":t(s)?o.type="audio":n(s)?o.type="video":r(s)?o.type="fragmentedText":o.type="text",d.push(o);return d}function Q(e,t){var n,r,i=x(e),a=[],o=null,s=null,u=null,l=null;for(r=0,n=e.Period_asArray.length;r<n;r++)s=e.Period_asArray[r],s.hasOwnProperty("start")?(l=new d.default,l.start=s.start):null!==o&&s.hasOwnProperty("duration")&&null!==u?(l=new d.default,l.start=u.start+u.duration,l.duration=s.duration):0!==r||i||(l=new d.default,l.start=0),null!==u&&isNaN(u.duration)&&(u.duration=l.start-u.start),null!==l&&(l.id=X(s,r)),null!==l&&s.hasOwnProperty("duration")&&(l.duration=s.duration),null!==l&&(l.index=r,l.mpd=t,a.push(l),o=s,u=l),s=null,l=null;return 0===a.length?a:(null!==u&&isNaN(u.duration)&&(u.duration=J(e,u)-u.start),a)}function X(e,t){if(!e)throw new Error("Period cannot be null or undefined");var n=d.default.DEFAULT_ID+"_"+t;return e.hasOwnProperty("id")&&"__proto__"!==e.id&&(n=e.id),n}function Z(e){var t=new f.default;return t.manifest=e,e.hasOwnProperty("availabilityStartTime")?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):t.availabilityStartTime=new Date(e.loadedTime.getTime()),e.hasOwnProperty("availabilityEndTime")&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty("minimumUpdatePeriod")&&(t.minimumUpdatePeriod=e.minimumUpdatePeriod),e.hasOwnProperty("mediaPresentationDuration")&&(t.mediaPresentationDuration=e.mediaPresentationDuration),e.hasOwnProperty("suggestedPresentationDelay")&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty("timeShiftBufferDepth")&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty("maxSegmentDuration")&&(t.maxSegmentDuration=e.maxSegmentDuration),t}function J(e,t){var n=x(e),r=void 0;if(e.mediaPresentationDuration)r=e.mediaPresentationDuration;else if(t.duration)r=t.duration;else{if(!n)throw new Error("Must have @mediaPresentationDuratio on MPD or an explicit @duration on the last period.");r=Number.POSITIVE_INFINITY}return r}function $(e,t){var n=e.Period_asArray,r=n[t.index].EventStream_asArray,i=[];if(r)for(var a=0;a<r.length;a++){var o=new I.default;if(o.period=t,o.timescale=1,!r[a].hasOwnProperty("schemeIdUri"))throw new Error("Invalid EventStream. SchemeIdUri has to be set");o.schemeIdUri=r[a].schemeIdUri,r[a].hasOwnProperty("timescale")&&(o.timescale=r[a].timescale),r[a].hasOwnProperty("value")&&(o.value=r[a].value);for(var s=0;s<r[a].Event_asArray.length;s++){var u=new S.default;u.presentationTime=0,u.eventStream=o,r[a].Event_asArray[s].hasOwnProperty("presentationTime")&&(u.presentationTime=r[a].Event_asArray[s].presentationTime),r[a].Event_asArray[s].hasOwnProperty("duration")&&(u.duration=r[a].Event_asArray[s].duration),r[a].Event_asArray[s].hasOwnProperty("id")&&(u.id=r[a].Event_asArray[s].id),i.push(u)}}return i}function ee(e,t){var n=[];if(!e)return n;for(var r=0;r<e.length;r++){var i=new I.default;if(i.timescale=1,i.representation=t,!e[r].hasOwnProperty("schemeIdUri"))throw new Error("Invalid EventStream. SchemeIdUri has to be set");i.schemeIdUri=e[r].schemeIdUri,e[r].hasOwnProperty("timescale")&&(i.timescale=e[r].timescale),e[r].hasOwnProperty("value")&&(i.value=e[r].value),n.push(i)}return n}function te(e,t){var n=e.Period_asArray[t.period.index].AdaptationSet_asArray[t.index].InbandEventStream_asArray;return ee(n,null)}function ne(e,t){var n=e.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index].Representation_asArray[t.index].InbandEventStream_asArray;return ee(n,t)}function re(e){var t=x(e),n=e.hasOwnProperty("availabilityStartTime"),r=e.UTCTiming_asArray,i=[];return(t||n)&&r&&r.forEach(function(e){var t=new h.default;e.hasOwnProperty("schemeIdUri")&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty("value")&&(t.value=e.value.toString(),i.push(t)))}),i}function ie(e){var t=[],n=e.BaseURL_asArray||[e.baseUri],r=!1;return n.some(function(n){if(n){var i=new A.default,a=n.__text||n;return ce.isRelative(a)&&(r=!0,e.baseUri&&(a=e.baseUri+a)),i.url=a,n.hasOwnProperty("serviceLocation")&&n.serviceLocation.length?i.serviceLocation=n.serviceLocation:i.serviceLocation=a,n.hasOwnProperty("dvb:priority")&&(i.dvb_priority=n["dvb:priority"]),n.hasOwnProperty("dvb:weight")&&(i.dvb_weight=n["dvb:weight"]),t.push(i),r}}),t}function ae(e){return e.hasOwnProperty("Location")&&(e.Location=e.Location_asArray[0]),e.Location}var oe=void 0,se=this.context,ue=(0,g.default)(se).getInstance(),le=(0,m.default)(se).getInstance(),de=(0,y.default)(se).getInstance(),ce=(0,O.default)(se).getInstance();return oe={getIsTypeOf:e,getIsAudio:t,getIsVideo:n,getIsText:i,getIsMuxed:a,getIsTextTrack:s,getIsFragmentedText:r,getIsMain:E,getLanguageForAdaptation:l,getViewpointForAdaptation:c,getRolesForAdaptation:_,getAccessibilityForAdaptation:p,getAudioChannelConfigurationForAdaptation:v,processAdaptation:C,getAdaptationForIndex:R,getIndexForAdaptation:P,getAdaptationForId:D,getAdaptationsForType:b,getAdaptationForType:w,getCodec:M,getMimeType:L,getKID:N,getContentProtectionData:k,getIsDynamic:x,getIsDVR:U,getIsOnDemand:B,getIsDVB:H,getDuration:j,getBandwidth:G,getManifestUpdatePeriod:K,getRepresentationCount:V,getBitrateListForAdaptation:W,getRepresentationFor:q,getRepresentationsForAdaptation:Y,getAdaptationsForPeriod:z,getRegularPeriods:Q,getMpd:Z,getEventsForPeriod:$,getEventStreams:ee,getEventStreamForAdaptationSet:te,getEventStreamForRepresentation:ne,getUTCTimingSources:re,getBaseURLsFromElement:ie,getRepresentationSortFunction:T,getLocation:ae}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(40),o=r(a),s=n(108),u=r(s),l=n(111),d=r(l),c=n(110),f=r(c),_=n(59),h=r(_),p=n(39),g=r(p),v=n(15),m=r(v),E=n(21),y=r(E),T=n(58),S=r(T),C=n(57),A=r(C),D=n(109),I=r(D),R=n(26),O=r(R),P=n(1),b=r(P);i.__dashjs_factory_name="DashManifestModel",t.default=b.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){me={video:!0,audio:!0},Ee={},ye={},Te={},Se={},Ce={},De={},Ae={},Fe={},Re=!1,Ke=!0,Oe=!1,void 0===Pe&&(Pe=!1),xe=(0,u.default)(ce).getInstance(),ke=(0,d.default)(ce).getInstance(),Me=(0,S.default)(ce).getInstance(),Le=(0,A.default)(ce).getInstance(),Ne=(0,I.default)(ce).getInstance(),He=(0,x.default)(ce).getInstance(),je=(0,F.default)(ce).getInstance(),Ge=(new Date).getTime()/1e3}function t(e,t){Fe[e]=(0,M.default)(ce).create(),Ae[e]=t,De[e]=De[e]||{},De[e].state=G,he.on(g.default.LOADING_PROGRESS,de,this),"video"==e&&(he.on(m.default.QUALITY_CHANGE_RENDERED,i,this),Be=(0,N.default)(ce).create(),ue())}function n(){he.off(g.default.LOADING_PROGRESS,de,this),he.off(m.default.QUALITY_CHANGE_RENDERED,i,this),Ue=void 0,Be=void 0,clearTimeout(Ie),Ie=null,e()}function r(e){e&&(e.abrRulesCollection&&(ge=e.abrRulesCollection),e.streamController&&(ve=e.streamController))}function i(e){"video"===e.mediaType&&(Ue=e.newQuality,Be.push(Ue,Ne.getPlaybackQuality()))}function a(e,t){var n;return Ee[t]=Ee[t]||{},Ee[t].hasOwnProperty(e)||(Ee[t][e]=0),n=ae(Ee[t][e],e),n=oe(n,e,Ee[t][e]),n=le(n,e)}function s(e){var t=xe.getSavedBitrateSettings(e);if(!Te.hasOwnProperty(e))if(Se.hasOwnProperty(e)){var n=Me.getValue(),r=Le.getAdaptationForType(n,0,e).Representation;if(Array.isArray(r)){var i=Math.max(Math.round(r.length*Se[e])-1,0);Te[e]=r[i].bandwidth}else Te[e]=0}else isNaN(t)?Te[e]="video"===e?K:V:Te[e]=t;return Te[e]}function l(e,t){Te[e]=t}function c(e){return Se.hasOwnProperty(e)?Se[e]:null}function _(e,t){Se[e]=t}function p(e){return Te.hasOwnProperty("max")&&Te.max.hasOwnProperty(e)?Te.max[e]:NaN}function v(e,t){Te.max=Te.max||{},Te.max[e]=t}function E(e){return Se.hasOwnProperty("max")&&Se.max.hasOwnProperty(e)?Se.max[e]:1}function y(e,t){Se.max=Se.max||{},Se.max[e]=t}function T(e){return me[e]}function C(e,t){me[e]=t}function D(){return Re}function R(e){Re=e}function P(){return Oe}function w(e){Oe=e}function L(){return Ke}function k(e){Ke=e}function U(e){var t=e.getType(),n=e.getStreamInfo(),r=n.id,i=ne(t,n),o=(0,O.default)(ce).create({streamProcessor:e,currentValue:i,playbackIndex:Ue,switchHistory:Fe[t],droppedFramesHistory:Be,hasRichBuffer:Z(t)});if(Be&&Be.push(Ue,Ne.getPlaybackQuality()),T(t)){var s=a(t,r),u=ge.getMaxQuality(o),l=u.value;if(l>s&&(l=s),Fe[t].push({oldValue:i,newValue:l}),l>b.default.NO_CHANGE&&l!=i)(De[t].state===G||l>i)&&q(t,n,i,l,s,u.reason);else if(fe.getLogToBrowserConsole()){var d=je.getCurrentBufferLevel(He.getReadOnlyMetricsFor(t));_e("AbrController ("+t+") stay on "+i+"/"+s+" (buffer: "+d+")")}}}function B(e,t,n,r){var i=t.id,o=ne(e,t),s=null!==n&&!isNaN(n)&&n%1===0;if(!s)throw new Error("argument is not an integer");var u=a(e,i);n!==o&&n>=0&&n<=u&&q(e,t,o,n,u,r)}function q(e,t,n,r,i,a){if(fe.getLogToBrowserConsole()){var o=je.getCurrentBufferLevel(He.getReadOnlyMetricsFor(e));_e("AbrController ("+e+") switch from "+n+" to "+r+"/"+i+" (buffer: "+o+")\n"+JSON.stringify(a))}re(e,t.id,r),he.trigger(g.default.QUALITY_CHANGE_REQUESTED,{mediaType:e,streamInfo:t,oldQuality:n,newQuality:r,reason:a})}function Y(e,t){De[e].state=t}function z(e){return De[e].state}function Q(e,t,n){if(Ke&&n&&Ae[e.type].getCurrentRepresentationInfo()&&Ae[e.type].getCurrentRepresentationInfo().fragmentDuration){n/=1e3;var r=Ae[e.type].getCurrentRepresentationInfo().fragmentDuration;if(n>r)return 0;var i=n/r;t*=1-i}var a=X(e);if(!a||0===a.length)return W;for(var o=a.length-1;o>=0;o--){var s=a[o];if(1e3*t>=s.bitrate)return o}return 0}function X(e){if(!e||!e.bitrateList)return null;for(var t,n=e.bitrateList,r=e.type,i=[],a=0,s=n.length;a<s;a++)t=new o.default,t.mediaType=r,t.qualityIndex=a,t.bitrate=n[a].bandwidth,t.width=n[a].width,t.height=n[a].height,i.push(t);return i}function Z(e){var t=He.getReadOnlyMetricsFor(e),n=je.getCurrentBufferLevel(t),r=t.BufferState.length>0?t.BufferState[t.BufferState.length-1]:null,i=!1;return r&&n>r.target&&(i=n>r.target+ke.getRichBufferThreshold()),i}function J(e,t){Ce[e]=t}function $(e){return Ce[e]}function ee(e){var t=e.type,n=e.streamInfo.id,r=e.representationCount-1;return ie(t,n,r),r}function te(e){var t,n=e.id,r=ne("audio",e),i=ne("video",e);return t=r===a("audio",n)&&i===a("video",n)}function ne(e,t){var n,r=t.id;return ye[r]=ye[r]||{},ye[r].hasOwnProperty(e)||(ye[r][e]=W),n=ye[r][e]}function re(e,t,n){ye[t]=ye[t]||{},ye[t][e]=n}function ie(e,t,n){Ee[t]=Ee[t]||{},Ee[t][e]=n}function ae(e,t){var n=p(t);if(isNaN(n)||!Ae[t])return e;var r=Q(Ae[t].getMediaInfo(),n);return Math.min(e,r)}function oe(e,t,n){var r=E(t);return isNaN(r)||r>=1||r<0?e:Math.min(e,Math.round(n*r))}function se(e){Pe=e}function ue(){var e=Ne.getElement();if(void 0!==e){var t=Oe&&window.hasOwnProperty("devicePixelRatio"),n=t?window.devicePixelRatio:1;be=e.clientWidth*n,we=e.clientHeight*n}}function le(e,t){if("video"!==t||!Re||!Ae[t])return e;Pe||ue();var n=Me.getValue(),r=Le.getAdaptationForType(n,0,t).Representation,i=e;if(be>0&&we>0){for(;i>0&&r[i]&&be<r[i].width&&be-r[i-1].width<r[i].width-be;)i-=1;r.length-2>=i&&r[i].width===r[i+1].width&&(i=Math.min(e,i+1))}return i}function de(e){var t=e.request.mediaType;if(T(t)){var n=Ae[t].getScheduleController();if(!n)return;var r=(0,O.default)(ce).create({streamProcessor:Ae[t],currentRequest:e.request,currentValue:ne(t,ve.getActiveStreamInfo()),hasRichBuffer:Z(t)}),i=ge.shouldAbandonFragment(r);if(i.value>b.default.NO_CHANGE){var a=n.getFragmentModel(),o=a.getRequests({state:f.default.FRAGMENT_MODEL_LOADING,index:e.request.index})[0];o&&(a.abortRequests(),Y(t,j),Fe[t].reset(),Fe[t].push({oldValue:ne(t,ve.getActiveStreamInfo()),newValue:i.value,confidence:1,reason:i.reason}),B(t,ve.getActiveStreamInfo(),i.value,i.reason),he.trigger(g.default.FRAGMENT_LOADING_ABANDONED,{streamProcessor:Ae[t],request:o,mediaType:t}),clearTimeout(Ie),Ie=setTimeout(function(){Y(t,G),Ie=null},ke.getAbandonLoadTimeout()))}}}var ce=this.context,fe=(0,H.default)(ce).getInstance(),_e=fe.log,he=(0,h.default)(ce).getInstance(),pe=void 0,ge=void 0,ve=void 0,me=void 0,Ee=void 0,ye=void 0,Te=void 0,Se=void 0,Ce=void 0,Ae=void 0,De=void 0,Ie=void 0,Re=void 0,Oe=void 0,Pe=void 0,be=void 0,we=void 0,Me=void 0,Le=void 0,Ne=void 0,ke=void 0,xe=void 0,Ue=void 0,Fe=void 0,Be=void 0,He=void 0,je=void 0,Ge=void 0,Ke=void 0;return pe={isPlayingAtTopQuality:te,updateTopQualityIndex:ee,getAverageThroughput:$,getBitrateList:X,getQualityForBitrate:Q,getMaxAllowedBitrateFor:p,setMaxAllowedBitrateFor:v,getMaxAllowedRepresentationRatioFor:E,setMaxAllowedRepresentationRatioFor:y,getInitialBitrateFor:s,setInitialBitrateFor:l,getInitialRepresentationRatioFor:c,setInitialRepresentationRatioFor:_,setAutoSwitchBitrateFor:C,getAutoSwitchBitrateFor:T,getUseDeadTimeLatency:L,setUseDeadTimeLatency:k,setLimitBitrateByPortal:R,getLimitBitrateByPortal:D,getUsePixelRatioInLimitBitrateByPortal:P,setUsePixelRatioInLimitBitrateByPortal:w,getQualityFor:ne,getAbandonmentStateFor:z,setAbandonmentStateFor:Y,setPlaybackQuality:B,getPlaybackQuality:U,setAverageThroughput:J,getTopQualityIndexFor:a,setElementSize:ue,setWindowResizeEventCalled:se,initialize:t,setConfig:r,reset:n},e(),pe}Object.defineProperty(t,"__esModule",{value:!0});var a=n(180),o=r(a),s=n(50),u=r(s),l=n(5),d=r(l),c=n(32),f=r(c),_=n(3),h=r(_),p=n(2),g=r(p),v=n(22),m=r(v),E=n(1),y=r(E),T=n(33),S=r(T),C=n(13),A=r(C),D=n(18),I=r(D),R=n(67),O=r(R),P=n(7),b=r(P),w=n(162),M=r(w),L=n(161),N=r(L),k=n(10),x=r(k),U=n(12),F=r(U),B=n(4),H=r(B),j="abandonload",G="allowload",K=1e3,V=100,W=0;i.__dashjs_factory_name="AbrController";var q=y.default.getSingletonFactory(i);q.ABANDON_LOAD=j,q.QUALITY_DEFAULT=W,t.default=q,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){B={},b(),P()}function t(e,t){var n=d(e),i=r(e,t),a=[];return"fragmentedText"===e?void s(i[0]):(n||(n=U.getSavedMediaSettings(e),l(e,n)),void(i&&0!==i.length&&(n&&i.forEach(function(e){O(n,e)&&a.push(e)}),s(0===a.length?w(i):a.length>1?w(a):a[0]))))}function n(e){var t=e?e.type:null,n=e?e.streamInfo.id:null,r=d(t);return!(!e||!C(t))&&(B[n]=B[n]||M(),!(B[n][t].list.indexOf(e)>=0)&&(B[n][t].list.push(e),r&&O(r,e)&&!i(t,e.streamInfo)&&s(e),!0))}function r(e,t){if(!e||!t)return[];var n=t.id;return B[n]&&B[n][e]?B[n][e].list:[]}function i(e,t){return!e||!t||t&&!B[t.id]?null:B[t.id][e].current}function a(e){var t=e.type,n=e.streamInfo.id;return B[n]&&B[n][t]&&A(B[n][t].current,e)}function s(e){if(e){var t=e.type,n=e.streamInfo,r=n.id,a=i(t,n);if(B[r]&&B[r][t]&&(!a||!A(e,a))){B[r][t].current=e,a&&k.trigger(o.default.CURRENT_TRACK_CHANGED,{oldMediaInfo:a,newMediaInfo:e,switchMode:G[t]});var s=R(e);s&&B[r][t].storeLastSettings&&(s.roles&&(s.role=s.roles[0],delete s.roles),s.accessibility&&(s.accessibility=s.accessibility[0]),s.audioChannelConfiguration&&(s.audioChannelConfiguration=s.audioChannelConfiguration[0]),U.setSavedMediaSettings(t,s))}}}function l(e,t){e&&t&&(H[e]=t)}function d(e){return e?H[e]:null}function c(e,t){var n=V.indexOf(t)!==-1;return n?void(G[e]=t):void N("track switch mode is not supported: "+t)}function _(e){return G[e]}function p(e){var t=W.indexOf(e)!==-1;return t?void(j=e):void N("track selection mode is not supported: "+e)}function S(){return j||T}function C(e){return"audio"===e||"video"===e||"text"===e||"fragmentedText"===e}function A(e,t){var n=e.id===t.id,r=e.viewpoint===t.viewpoint,i=e.lang===t.lang,a=e.roles.toString()===t.roles.toString(),o=e.accessibility.toString()===t.accessibility.toString(),s=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return n&&r&&i&&a&&o&&s}function D(e){e&&e.errHandler&&(K=e.errHandler)}function I(){e(),x.resetEmbedded()}function R(e){var t={lang:e.lang,viewpoint:e.viewpoint,roles:e.roles,accessibility:e.accessibility,audioChannelConfiguration:e.audioChannelConfiguration},n=t.lang||t.viewpoint||t.role&&t.role.length>0||t.accessibility&&t.accessibility.length>0||t.audioChannelConfiguration&&t.audioChannelConfiguration.length>0;return n?t:null}function O(e,t){var n=!e.lang||e.lang===t.lang,r=!e.viewpoint||e.viewpoint===t.viewpoint,i=!e.role||!!t.roles.filter(function(t){return t===e.role})[0],a=!e.accessibility||!!t.accessibility.filter(function(t){return t===e.accessibility})[0],o=!e.audioChannelConfiguration||!!t.audioChannelConfiguration.filter(function(t){return t===e.audioChannelConfiguration})[0];return n&&r&&i&&a&&o}function P(){G={audio:m,video:v}}function b(){H={audio:null,video:null}}function w(e){var t=S(),n=[],r=function(e){var t,n=0,r=[];return e.forEach(function(e){t=Math.max.apply(Math,e.bitrateList.map(function(e){return e.bandwidth})),t>n?(n=t,r=[e]):t===n&&r.push(e)}),r},i=function(e){var t,n=0,r=[];return e.forEach(function(e){t=e.representationCount,t>n?(n=t,r=[e]):t===n&&r.push(e)}),r};switch(t){case E:n=r(e),n.length>1&&(n=i(n));break;case y:n=i(e),n.length>1&&(n=r(e));break;default:N("track selection mode is not supported: "+t)}return n[0]}function M(){return{audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},fragmentedText:{list:[],storeLastSettings:!0,current:null}}}var L=this.context,N=(0,f.default)(L).getInstance().log,k=(0,u.default)(L).getInstance(),x=(0,h.default)(L).getInstance(),U=(0,g.default)(L).getInstance(),F=void 0,B=void 0,H=void 0,j=void 0,G=void 0,K=void 0,V=[m,v],W=[E,y];return F={initialize:e,checkInitialMediaSettingsForType:t,addTrack:n,getTracksFor:r,getCurrentTrackFor:i,isCurrentTrack:a,setTrack:s,setInitialSettings:l,getInitialSettings:d,setSwitchMode:c,getSwitchMode:_,setSelectionModeForInitialTrack:p,getSelectionModeForInitialTrack:S,isMultiTrackSupportedByType:C,isTracksEqual:A,setConfig:D,reset:I}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),o=r(a),s=n(3),u=r(s),l=n(1),d=r(l),c=n(4),f=r(c),_=n(16),h=r(_),p=n(50),g=r(p),v="neverReplace",m="alwaysReplace",E="highestBitrate",y="widestRange",T=E;i.__dashjs_factory_name="MediaController";var S=d.default.getSingletonFactory(i);S.TRACK_SWITCH_MODE_NEVER_REPLACE=v,S.TRACK_SWITCH_MODE_ALWAYS_REPLACE=m,S.TRACK_SELECTION_MODE_HIGHEST_BITRATE=E,S.TRACK_SELECTION_MODE_WIDEST_RANGE=y,S.DEFAULT_INIT_TRACK_SELECTION_MODE=T,t.default=S,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,n){F=!1,B=null,q=null,Y=!1,z=NaN,Q=[],J=null,w||t();var r=n.getStreamProcessor();if(K=r.getMediaInfoArr(),V.setConfig({videoModel:X}),V.initialize(),W=!x.getIsTextTrack(e),N=(0,d.default)(P).getInstance(),G=(0,u.default)(P).getInstance(),G.setConfig({boxParser:N}),W){q=r.getFragmentModel(),this.buffered=(0,f.default)(P).create(),Q=U.getTracksFor("fragmentedText",Z.getActiveStreamInfo());for(var i=U.getCurrentTrackFor("fragmentedText",Z.getActiveStreamInfo()),a=0;a<Q.length;a++)if(Q[a]===i){$=a;break}}}function t(){ee=[],K=[],X=(0,m.default)(P).getInstance(),V=(0,y.default)(P).getInstance(),V.setConfig({videoModel:X}),V.initialize(),N=(0,d.default)(P).getInstance(),G=(0,u.default)(P).getInstance(),G.setConfig({boxParser:N}),W=!1,$=null,te=!1,ne=0,ae=[],ie=[],re=null,w=!0}function n(e,t){function n(e,t){var n=new o.default,r={subtitle:"subtitles",caption:"captions"},i=function(){var e=t.roles.length>0?r[t.roles[0]]:r.caption;return e=e===r.caption||e===r.subtitle?e:r.caption},a=function(){var e=!1;return t.codec&&t.codec.search("stpp")>=0&&(e=!0),t.mimeType&&t.mimeType.search("ttml")>=0&&(e=!0),e};n.captionData=e,n.lang=t.lang,n.label=t.id,n.index=t.index,n.isTTML=a(),n.video=X.getElement(),n.defaultTrack=I(t),n.isFragmented=W,n.isEmbedded=!!t.isEmbedded,n.kind=i();var s=(K?K.length:0)+ee.length;V.addTextTrack(n,s)}var i,a,s,u,l,d,c,f=t.mediaInfo,_=f.type,p=f.mimeType,g=f.codec||p;if(!g)return void b("No text type defined");if("fragmentedText"===_)if(Y)if(d=G.getSamplesInfo(e),a=d.sampleList,!J&&a.length>0&&(J=a[0].cts-t.start*z),g.search("stpp")>=0)for(B=null!==B?B:R(g),s=0;s<a.length;s++){var v=a[s],m=v.cts,E=m-J;this.buffered.add(E/z,(E+v.duration)/z);var y=new DataView(e,v.offset,v.subSizes[0]);c=S.default.Utils.dataViewToString(y,"utf-8");var T=[],C=v.offset+v.subSizes[0];for(u=1;u<v.subSizes.length;u++){var D=new Uint8Array(e,C,v.subSizes[u]),O=String.fromCharCode.apply(null,D);T.push(O),C+=v.subSizes[u]}try{i=B.parse(c,m/z,(m+v.duration)/z,T),V.addCaptions($,J/z,i)}catch(e){b("TTML parser error: "+e.message)}}else{var P=[];for(s=0;s<a.length;s++){var w=a[s];w.cts-=J,this.buffered.add(w.cts/z,(w.cts+w.duration)/z);var M=e.slice(w.offset,w.offset+w.size),L=S.default.parseBuffer(M);for(u=0;u<L.boxes.length;u++){var N=L.boxes[u];if(b("VTT box1: "+N.type),"vtte"!==N.type&&"vttc"===N.type)for(b("VTT vttc boxes.length = "+N.boxes.length),l=0;l<N.boxes.length;l++){var x=N.boxes[l];if(b("VTT box2: "+x.type),"payl"===x.type){var U=x.cue_text;b("VTT cue_text = "+U);var F=w.cts/z,H=(w.cts+w.duration)/z;P.push({start:F,end:H,data:U,styles:{}}),b("VTT "+F+"-"+H+" : "+U)}}}}P.length>0&&V.addCaptions($,0,P)}else{for(Y=!0,s=0;s<K.length;s++)n(null,K[s]);z=G.getMediaTimescaleFromMoov(e)}else if("text"===_){var y=new DataView(e,0,e.byteLength);c=S.default.Utils.dataViewToString(y,"utf-8");try{i=R(g).parse(c),n(i,f)}catch(e){k.timedTextError(e,"parse",c)}}else if("video"===_)if("InitializationSegment"===t.segmentType){if(0===ne)for(ne=G.getMediaTimescaleFromMoov(e),s=0;s<ee.length;s++)n(null,ee[s])}else{if(0===ne)return void b("CEA-608: No timescale for embeddedTextTrack yet");var j=function(e,t){function n(e,n,r){var i=null;if(X.getTTMLRenderingDiv())i=h(X.getElement(),e,n,r);else{var a=r.getDisplayText();i=[{start:e,end:n,data:a,styles:{}}]}i&&V.addCaptions(t,0,i)}return n};d=G.getSamplesInfo(e);var q=d.sequenceNumber;if(!ae[0]&&!ae[1]){var Q=void 0,Z=void 0,te=void 0;for(s=0;s<ee.length;s++){if("CC1"===ee[s].id?(Q=0,te=V.getTrackIdxForId("CC1")):"CC3"===ee[s].id&&(Q=1,te=V.getTrackIdxForId("CC3")),te===-1)return void b("CEA-608: data before track is ready.");Z=j(this,te),ae[s]=new A.default.Cea608Parser(s,{newCue:Z},null)}}if(ne&&ie.indexOf(q)==-1){if(null!==re&&q!==re+1)for(s=0;s<ae.length;s++)ae[s]&&ae[s].reset();for(var oe=r(e),se=0;se<ae.length;se++){var ue=oe.fields[se],le=ae[se];if(le){for(s=0;s<ue.length;s++)le.addData(ue[s][0]/ne,ue[s][1]);oe.endTime&&le.cueSplitAtTime(oe.endTime/ne)}}re=q,ie.push(q)}}}function r(e){var t=function(e,t,n){var r=e.length;if(r>0){if(t>=e[r-1][0])e.push([t,n]);else for(var i=r-1;i>=0;i--)if(t<e[i][0]){e.splice(i,0,[t,n]);break}}else e.push([t,n])},n=N.parse(e),r=n.getBox("moof"),i=n.getBox("tfdt"),a=n.getBox("tfhd"),o=n.getBoxes("trun"),s=null;if(0===o.length)return null;s=o[0],o.length>1&&b("Warning: Too many truns");for(var u=r.offset+s.data_offset,l=s.sample_count,d=u,c=i.baseMediaDecodeTime,f=new DataView(e),_={startTime:null,endTime:null,fields:[[],[]]},h=0,p=0;p<l;p++){var g=s.samples[p];void 0===g.sample_duration&&(g.sample_duration=a.default_sample_duration),void 0===g.sample_size&&(g.sample_size=a.default_sample_size),void 0===g.sample_composition_time_offset&&(g.sample_composition_time_offset=0);for(var v=c+h+g.sample_composition_time_offset,m=A.default.findCea608Nalus(f,d,g.sample_size),E=0;E<m.length;E++)for(var y=A.default.extractCea608DataFromRange(f,m[E]),T=0;T<2;T++)y[T].length>0&&t(_.fields[T],v,y[T]);h+=g.sample_duration,d+=g.sample_size}var S=c+h;return _.startTime=c,_.endTime=S,_}function i(e){for(var t="",n=0;n<e.length;++n){var r=e[n];t+=r.uchar}var i=t.length,a=t.replace(/^\s+/,"").length;return i-a}function a(e){return"left: "+3.125*e.x+"%; top: "+6.66*e.y1+"%; width: "+(100-3.125*e.x)+"%; height: "+6.66*Math.max(e.y2-1-e.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function s(e){return"red"==e?"rgb(255, 0, 0)":"green"==e?"rgb(0, 255, 0)":"blue"==e?"rgb(0, 0, 255)":"cyan"==e?"rgb(0, 255, 255)":"magenta"==e?"rgb(255, 0, 255)":"yellow"==e?"rgb(255, 255, 0)":"white"==e?"rgb(255, 255, 255)":"black"==e?"rgb(0, 0, 0)":e}function l(e,t){var n=e.videoHeight/15;return t?"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(t.foreground?s(t.foreground):"rgb(255, 255, 255)")+"; font-style: "+(t.italics?"italic":"normal")+"; text-decoration: "+(t.underline?"underline":"none")+"; white-space: pre; background-color: "+(t.background?s(t.background):"transparent")+";":"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function c(e){var t=e.replace(/^\s+/g,"");return t}function _(e){var t=e.replace(/\s+$/g,"");return t}function h(e,t,n,r){var o=null,s=null,u=!1,d=-1,f={start:t,end:n,spans:[]},h="style_cea608_white_black",p={},g={},v=[],m=void 0,E=void 0;for(m=0;m<15;++m){var y=r.rows[m],T="",S=null;if(!1===y.isEmpty()){var C=i(y.chars);null===o&&(o={x:C,y1:m,y2:m+1,p:[]}),C!==d&&u&&(o.p.push(f),f={start:t,end:n,spans:[]},o.y2=m,o.name="region_"+o.x+"_"+o.y1+"_"+o.y2,!1===p.hasOwnProperty(o.name)?(v.push(o),p[o.name]=o):(s=p[o.name],s.p.contat(o.p)),o={x:C,y1:m,y2:m+1,p:[]});for(var A=0;A<y.chars.length;++A){var D=y.chars[A],I=D.penState;if(null===S||!I.equals(S)){T.trim().length>0&&(f.spans.push({name:h,line:T,row:m}),T="");var R="style_cea608_"+I.foreground+"_"+I.background;I.underline&&(R+="_underline"),I.italics&&(R+="_italics"),g.hasOwnProperty(R)||(g[R]=JSON.parse(JSON.stringify(I))),S=I,h=R}T+=D.uchar}T.trim().length>0&&f.spans.push({name:h,line:T,row:m}),u=!0,d=C}else u=!1,d=-1,o&&(o.p.push(f),f={start:t,end:n,spans:[]},o.y2=m,o.name="region_"+o.x+"_"+o.y1+"_"+o.y2,!1===p.hasOwnProperty(o.name)?(v.push(o),p[o.name]=o):(s=p[o.name],s.p.contat(o.p)),o=null)}o&&(o.p.push(f),o.y2=m+1,o.name="region_"+o.x+"_"+o.y1+"_"+o.y2,!1===p.hasOwnProperty(o.name)?(v.push(o),p[o.name]=o):(s=p[o.name],s.p.contat(o.p)),o=null);var O=[];for(m=0;m<v.length;++m){var P=v[m],b="sub_cea608_"+M++,w=document.createElement("div");w.id=b;var L=a(P);w.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+L;var N=document.createElement("div");N.className="paragraph bodyStyle",N.style.cssText=l(e);var k=document.createElement("div");k.className="cueUniWrapper",k.style.cssText="unicode-bidi: normal; direction: ltr;";for(var x=0;x<P.p.length;++x){var U=P.p[x],F=0;for(E=0;E<U.spans.length;++E){var B=U.spans[E];if(B.line.length>0){if(0!==E&&F!=B.row){var H=document.createElement("br");H.className="lineBreak",k.appendChild(H)}var j=!1;F===B.row&&(j=!0),F=B.row;var G=g[B.name],K=document.createElement("span");K.className="spanPadding "+B.name+" customSpanColor",K.style.cssText=l(e,G),0!==E&&j?E===U.spans.length-1?K.textContent=_(B.line):K.textContent=B.line:0===E&&U.spans.length>1&&B.row===U.spans[1].row?K.textContent=c(B.line):K.textContent=B.line.trim(),k.appendChild(K)}}}N.appendChild(k),w.appendChild(N);var V={bodyStyle:["%",90]};for(E in g)g.hasOwnProperty(E)&&(V[E]=["%",90]);O.push({type:"html",start:t,end:n,cueHTMLElement:w,cueID:b,cellResolution:[32,15],isFromCEA608:!0,regions:v,regionID:P.name,videoHeight:e.videoHeight,videoWidth:e.videoWidth,fontSize:V,lineHeight:{},linePadding:{}})}return O}function p(){V.deleteAllTextTracks(),F=!1,B=null,G=null,K=null,V=null,W=!1,q=null,Y=!1,z=NaN,Q=[],X=null,Z=null,w=!1,ee=null}function v(e){w||t(),"CC1"===e.id||"CC3"===e.id?ee.push(e):b("Warning: Embedded track "+e.id+" not supported!")}function E(){w=!1,ee=[],ae=[null,null],ie=[],re=null}function T(){return F}function C(e){e&&(e.errHandler&&(k=e.errHandler),e.dashManifestModel&&(x=e.dashManifestModel),e.mediaController&&(U=e.mediaController),e.videoModel&&(X=e.videoModel),e.streamController&&(Z=e.streamController),e.textTracks&&(V=e.textTracks),e.VTTParser&&(H=e.VTTParser),e.TTMLParser&&(j=e.TTMLParser))}function D(){for(var e=X.getElement(),t=e.textTracks,n=t.length,r=n-ee.length,i=V.getCurrentTrackIdx(),a=0;a<n;a++){var o=t[a];if(F="showing"!==o.mode,"showing"===o.mode){if(i!==a&&(V.setCurrentTrackIdx(a),V.addCaptions(a,0,null),W&&a<r)){var s=U.getCurrentTrackFor("fragmentedText",Z.getActiveStreamInfo()),u=Q[a];u!==s&&(q.abortRequests(),V.deleteTrackCues(s),U.setTrack(u),$=a)}break}}F&&V.setCurrentTrackIdx(-1)}function I(e){var t=!1;return ee.length>1&&e.isEmbedded?t=e.id&&"CC1"===e.id:1===ee.length?e.id&&"CC"===e.id.substring(0,2)&&(t=!0):0===ee.length&&(t=e.index===K[0].index),t}function R(e){var t;return e.search("vtt")>=0?t=H:(e.search("ttml")>=0||e.search("stpp")>=0)&&(t=j,t.setConfig({videoModel:X})),t}function O(){return V.getCurrentTrackIdx()}var P=this.context,b=(0,g.default)(P).getInstance().log,w=!1,M=0,L=void 0,N=void 0,k=void 0,x=void 0,U=void 0,F=void 0,B=void 0,H=void 0,j=void 0,G=void 0,K=void 0,V=void 0,W=void 0,q=void 0,Y=void 0,z=void 0,Q=void 0,X=void 0,Z=void 0,J=void 0,$=void 0,ee=void 0,te=void 0,ne=void 0,re=void 0,ie=void 0,ae=void 0;return L={initialize:e,append:n,abort:p,getCurrentTrackIdx:O,getAllTracksAreDisabled:T,setTextTrack:D,setConfig:C,addEmbeddedTrack:v,resetEmbedded:E}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(188),o=r(a),s=n(104),u=r(s),l=n(49),d=r(l),c=n(71),f=r(c),_=n(1),h=r(_),p=n(4),g=r(p),v=n(18),m=r(v),E=n(42),y=r(E),T=n(75),S=r(T),C=n(52),A=r(C);i.__dashjs_factory_name="TextSourceBuffer",t.default=h.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){he=f.default.QUALITY_DEFAULT,pe=!1,ge=0,ve=Number.POSITIVE_INFINITY,Ee=0,ye=Number.POSITIVE_INFINITY,Se=null,Ce=b,De=0,Ie=!1,Re=!1,Oe=!1,Pe=!1}function n(e,t,n){Te=e,J(t),we=n,Ne=(0,u.default)(ne).getInstance(),be=(0,h.default)(ne).getInstance(),Me=(0,f.default)(ne).getInstance(),ke=(0,O.default)(ne).getInstance(),Le=we.getScheduleController(),he=Me.getQualityFor(Te,we.getStreamInfo()),ie.on(y.default.DATA_UPDATE_COMPLETED,H,this),ie.on(y.default.INIT_FRAGMENT_LOADED,a,this),ie.on(y.default.MEDIA_FRAGMENT_LOADED,l,this),ie.on(y.default.QUALITY_CHANGE_REQUESTED,p,this),ie.on(y.default.STREAM_COMPLETED,j,this),ie.on(y.default.PLAYBACK_PROGRESS,E,this),ie.on(y.default.PLAYBACK_TIME_UPDATED,E,this),ie.on(y.default.PLAYBACK_RATE_CHANGED,V,this),ie.on(y.default.PLAYBACK_SEEKING,v,this),ie.on(y.default.WALLCLOCK_TIME_UPDATED,K,this),ie.on(y.default.CURRENT_TRACK_CHANGED,G,this,m.default.EVENT_PRIORITY_HIGH),ie.on(y.default.SOURCEBUFFER_APPEND_COMPLETED,_,this),ie.on(y.default.SOURCEBUFFER_REMOVE_COMPLETED,F,this)}function r(e){if(!e||!me||!we)return null;var t=null;try{t=se.createSourceBuffer(me,e),t&&t.hasOwnProperty("initialize")&&t.initialize(Te,this)}catch(e){ue.mediaSourceError("Error creating "+Te+" source buffer.")}return Q(t),B(we.getRepresentationInfoForQuality(he).MSETimeOffset),t}function i(){return we.getStreamInfo().id===le.getActiveStreamInfo().id}function a(e){e.fragmentModel===we.getFragmentModel()&&(re("Init fragment finished loading saving to",Te+"'s init cache"),
ke.save(e.chunk),c(e.chunk))}function s(e,t){var n=ke.extract(e,Te,t);n?c(n):ie.trigger(y.default.INIT_REQUESTED,{sender:_e})}function l(e){if(e.fragmentModel===we.getFragmentModel()){var t=e.chunk,n=t.bytes,r=t.quality,i=we.getRepresentationInfoForQuality(r),a=oe.getValue(),s=ce.getEventsFor(a,i.mediaInfo,we),u=ce.getEventsFor(a,i,we);if(s&&s.length>0||u&&u.length>0){var l=we.getFragmentModel().getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,quality:r,index:t.index})[0],d=M(n,l,s,u);we.getEventController().addInbandEvents(d)}t.bytes=L(n),c(t)}}function c(e){Re=!0,Ae=e,se.append(Se,e),"video"===e.mediaInfo.type&&e.mediaInfo.embeddedCaptions&&fe.append(e.bytes,e)}function _(e){if(Se===e.buffer){if(e.error||!N())return e.error.code===d.default.QUOTA_EXCEEDED_ERROR_CODE&&(ve=.8*se.getTotalBufferedTime(Se)),void(e.error.code!==d.default.QUOTA_EXCEEDED_ERROR_CODE&&N()||(ie.trigger(y.default.QUOTA_EXCEEDED,{sender:_e,criticalBufferLevel:ve}),U(x())));isNaN(Ae.index)||(Ee=Math.max(Ae.index,Ee),A());var t=se.getAllRanges(Se);if(t&&t.length>0)for(var n=0,r=t.length;n<r;n++)re("Buffered Range for type:",Te,":",t.start(n)," - ",t.end(n));E(),Re=!1,ie.trigger(y.default.BYTES_APPENDED,{sender:_e,quality:Ae.quality,startTime:Ae.start,index:Ae.index,bufferedRanges:t})}}function p(e){he!==e.newQuality&&Te===e.mediaType&&we.getStreamInfo().id===e.streamInfo.id&&(B(we.getRepresentationInfoForQuality(e.newQuality).MSETimeOffset),he=e.newQuality)}function v(){ye=Number.POSITIVE_INFINITY,pe=!1,E()}function E(){T(),C()}function T(){ge=se.getBufferLength(Se,be.getTime()),ie.trigger(y.default.BUFFER_LEVEL_UPDATED,{sender:_e,bufferLevel:ge}),D()}function C(){i()&&(ae.addBufferState(Te,Ce,Le.getBufferTarget()),ae.addBufferLevel(Te,new Date,1e3*ge))}function A(){var e=Ee>=ye-1;e&&!pe&&(pe=!0,ie.trigger(y.default.BUFFERING_COMPLETED,{sender:_e,streamInfo:we.getStreamInfo()}))}function D(){R(ge<w&&!pe?b:P)}function R(e){Ce===e||"fragmentedText"===Te&&fe.getAllTracksAreDisabled()||(Ce=e,C(),ie.trigger(y.default.BUFFER_LEVEL_STATE_CHANGED,{sender:_e,state:e,mediaType:Te,streamInfo:we.getStreamInfo()}),ie.trigger(e===P?y.default.BUFFER_LOADED:y.default.BUFFER_EMPTY,{mediaType:Te}),re(e===P?"Got enough buffer to start.":"Waiting for more buffer before starting playback."))}function M(e,t,n,r){var i=Math.max(isNaN(t.startTime)?0:t.startTime,0),a=[],o=[];Pe=!1;for(var s=n.concat(r),u=0,l=s.length;u<l;u++)a[s[u].schemeIdUri]=s[u];for(var d=(0,S.default)(ne).getInstance().parse(e),c=d.getBoxes("emsg"),u=0,l=c.length;u<l;u++){var f=ce.getEvent(c[u],a,i);f&&o.push(f)}return o}function L(e){if(!Pe)return e;for(var t=e.length,n=Math.pow(256,2),r=Math.pow(256,3),i=new Uint8Array(e.length),a=0,o=0;a<t;){var s=String.fromCharCode(e[a+4],e[a+5],e[a+6],e[a+7]),u=e[a]*r+e[a+1]*n+256*e[a+2]+1*e[a+3];if("emsg"!=s)for(var l=a;l<a+u;l++)i[o]=e[l],o++;a+=u}return i.subarray(0,o)}function N(){var e=se.getTotalBufferedTime(Se);return e<ve}function k(){if(Se&&"fragmentedText"!==Te){var e=Se.buffered.length?Se.buffered.start(0):0,t=be.getTime()-e-Ne.getBufferToKeep();t>0&&(re("pruning buffer: "+t+" seconds."),Oe=!0,se.remove(Se,0,Math.round(e+t),me))}}function x(){if(!Se)return null;var e=be.getTime(),t=we.getFragmentModel().getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,time:e})[0],n=se.getBufferRange(Se,e),r=t&&!isNaN(t.startTime)?t.startTime:Math.floor(e);return null===n&&Se.buffered.length>0&&(r=Se.buffered.end(Se.buffered.length-1)),{start:Se.buffered.start(0),end:r}}function U(e){e&&Se&&se.remove(Se,e.start,e.end,me)}function F(e){Se===e.buffer&&(Oe&&(Oe=!1),T(),ie.trigger(y.default.BUFFER_CLEARED,{sender:_e,from:e.from,to:e.to,hasEnoughSpaceToAppend:N()}))}function B(e){Se&&Se.timestampOffset!==e&&!isNaN(e)&&(Se.timestampOffset=e)}function H(e){e.sender.getStreamProcessor()!==we||e.error||B(e.currentRepresentation.MSETimeOffset)}function j(e){e.fragmentModel===we.getFragmentModel()&&(ye=e.request.index,A())}function G(e){Se&&e.newMediaInfo.type===Te&&e.newMediaInfo.streamInfo.id===we.getStreamInfo().id&&de.getSwitchMode(Te)===g.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&U(x())}function K(){De++;var e=De*(Ne.getWallclockTimeUpdateInterval()/1e3);e>=Ne.getBufferPruningInterval()&&!Re&&(De=0,k())}function V(){D()}function W(){return Te}function q(){return we}function Y(e){we=e}function z(){return Se}function Q(e){Se=e}function X(){return ge}function Z(){return ve}function J(e){me=e}function $(){return me}function ee(){return pe}function te(e){ie.off(y.default.DATA_UPDATE_COMPLETED,H,this),ie.off(y.default.QUALITY_CHANGE_REQUESTED,p,this),ie.off(y.default.INIT_FRAGMENT_LOADED,a,this),ie.off(y.default.MEDIA_FRAGMENT_LOADED,l,this),ie.off(y.default.STREAM_COMPLETED,j,this),ie.off(y.default.CURRENT_TRACK_CHANGED,G,this),ie.off(y.default.PLAYBACK_PROGRESS,E,this),ie.off(y.default.PLAYBACK_TIME_UPDATED,E,this),ie.off(y.default.PLAYBACK_RATE_CHANGED,V,this),ie.off(y.default.PLAYBACK_SEEKING,v,this),ie.off(y.default.WALLCLOCK_TIME_UPDATED,K,this),ie.off(y.default.SOURCEBUFFER_APPEND_COMPLETED,_,this),ie.off(y.default.SOURCEBUFFER_REMOVE_COMPLETED,F,this),ve=Number.POSITIVE_INFINITY,Ce=b,he=f.default.QUALITY_DEFAULT,ye=Number.POSITIVE_INFINITY,Ee=0,Ae=null,Ie=!1,pe=!1,Re=!1,Oe=!1,be=null,we=null,Me=null,Le=null,e||(se.abort(me,Se),se.removeSourceBuffer(me,Se)),Se=null}var ne=this.context,re=(0,I.default)(ne).getInstance().log,ie=(0,m.default)(ne).getInstance(),ae=e.metricsModel,oe=e.manifestModel,se=e.sourceBufferController,ue=e.errHandler,le=e.streamController,de=e.mediaController,ce=e.adapter,fe=e.textSourceBuffer,_e=void 0,he=void 0,pe=void 0,ge=void 0,ve=void 0,me=void 0,Ee=void 0,ye=void 0,Te=void 0,Se=void 0,Ce=void 0,Ae=void 0,De=void 0,Ie=void 0,Re=void 0,Oe=void 0,Pe=void 0,be=void 0,we=void 0,Me=void 0,Le=void 0,Ne=void 0,ke=void 0;return _e={initialize:n,createBuffer:r,getType:W,getStreamProcessor:q,setStreamProcessor:Y,getBuffer:z,setBuffer:Q,getBufferLevel:X,getCriticalBufferLevel:Z,setMediaSource:J,getMediaSource:$,getIsBufferingCompleted:ee,switchInitData:s,reset:te},t(),_e}Object.defineProperty(t,"__esModule",{value:!0});var a=n(32),o=r(a),s=n(5),u=r(s),l=n(30),d=r(l),c=n(14),f=r(c),_=n(9),h=r(_),p=n(15),g=r(p),v=n(3),m=r(v),E=n(2),y=r(E),T=n(49),S=r(T),C=n(1),A=r(C),D=n(4),I=r(D),R=n(72),O=r(R),P="bufferLoaded",b="bufferStalled",w=.5;i.__dashjs_factory_name="BufferController";var M=A.default.getClassFactory(i);M.BUFFER_LOADED=P,M.BUFFER_EMPTY=b,t.default=M,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){S=[]}function t(){E.playbackRate=C||1,E.removeEventListener("canplay",t)}function n(e){E&&(E.readyState<=2&&e>0?E.addEventListener("canplay",t):E.playbackRate=e)}function r(e){if(E.currentTime!=e)try{E.currentTime=e}catch(t){0===E.readyState&&t.code===t.INVALID_STATE_ERR&&setTimeout(function(){E.currentTime=e},400)}}function i(){return E}function a(e){E=e,E.preload="auto"}function o(e){e?E.src=e:(E.removeAttribute("src"),E.load())}function s(){return E.src}function u(){return T}function l(e){T=e}function d(){return y}function c(e){y=e,y.style.position="absolute",y.style.display="flex",y.style.overflow="hidden",y.style.pointerEvents="none",y.style.top=0,y.style.left=0}function f(e,t){g(e,t)}function _(){return S.length>0}function h(e){var t=void 0;null===e||E.seeking||S.indexOf(e)!==-1||(S.push(e),1===S.length&&(t=document.createEvent("Event"),t.initEvent("waiting",!0,!1),C=E.playbackRate,n(0),E.dispatchEvent(t)))}function p(e){var t=S.indexOf(e),r=void 0;null!==e&&(t!==-1&&S.splice(t,1),_()===!1&&0===E.playbackRate&&(n(C||1),E.paused||(r=document.createEvent("Event"),r.initEvent("playing",!0,!1),E.dispatchEvent(r))))}function g(e,t){t?h(e):p(e)}function v(){var e="webkitDroppedFrameCount"in E&&"webkitDecodedFrameCount"in E,t="getVideoPlaybackQuality"in E,n=null;return t?n=E.getVideoPlaybackQuality():e&&(n={droppedVideoFrames:E.webkitDroppedFrameCount,totalVideoFrames:E.webkitDroppedFrameCount+E.webkitDecodedFrameCount,creationTime:new Date}),n}var m=void 0,E=void 0,y=void 0,T=void 0,S=void 0,C=void 0;return m={initialize:e,setCurrentTime:r,setStallState:f,getElement:i,setElement:a,setSource:o,getSource:s,getVideoContainer:u,setVideoContainer:l,getTTMLRenderingDiv:d,setTTMLRenderingDiv:c,getPlaybackQuality:v}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="VideoModel",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.action=e.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer"};r.ACTION_DOWNLOAD="download",r.ACTION_COMPLETE="complete",t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){n(this,e),this.periodId=t.periodId,this.adaptationSetId=t.adaptationSetId,this.representationId=t.representationId,this.type=t.type,this.bitrate=t.bitrate}return r(e,[{key:"viewToString",value:function(){return e.makeIDString(this.periodId,this.adaptationSetId,this.representationId)}},{key:"isEqual",value:function(e){return!!e&&this.periodId===e.periodId&&this.adaptationSetId===e.adaptationSetId&&this.representationId===e.representationId}}],[{key:"makeIDString",value:function(e,t,n){return"P"+e+"A"+t+"R"+n}}]),e}();t.default=i,e.exports=t.default},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function a(){function e(e){e&&e.dashManifestModel&&(N=e.dashManifestModel)}function t(){k=[],x={}}function n(e,t){return t.getRepresentationForQuality(e.quality)}function r(e){return x?x[e.streamInfo.id][e.index]:null}function i(e){for(var t=k.length,n=0;n<t;n++){var r=k[n];if(e.id===r.id)return r}return null}function a(e,t){var n=new s.default,r=t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index],i=N.getRepresentationFor(t.index,r);return n.id=t.id,n.quality=t.index,n.bandwidth=N.getBandwidth(i),n.DVRWindow=t.segmentAvailabilityRange,n.fragmentDuration=t.segmentDuration||(t.segments&&t.segments.length>0?t.segments[0].duration:NaN),n.MSETimeOffset=t.MSETimeOffset,n.useCalculatedLiveEdgeTime=t.useCalculatedLiveEdgeTime,n.mediaInfo=o(e,t.adaptation),n}function o(e,t){var n,r=new l.default,i=t.period.mpd.manifest.Period_asArray[t.period.index].AdaptationSet_asArray[t.index];return r.id=t.id,r.index=t.index,r.type=t.type,r.streamInfo=d(e,t.period),r.representationCount=N.getRepresentationCount(i),r.lang=N.getLanguageForAdaptation(i),n=N.getViewpointForAdaptation(i),r.viewpoint=n?n.value:void 0,r.accessibility=N.getAccessibilityForAdaptation(i).map(function(e){var t=e.value,n=t;return e.schemeIdUri&&e.schemeIdUri.search("cea-608")>=0&&"undefined"!=typeof E.default&&(n=t?"cea-608:"+t:"cea-608",r.embeddedCaptions=!0),n}),r.audioChannelConfiguration=N.getAudioChannelConfigurationForAdaptation(i).map(function(e){return e.value}),r.roles=N.getRolesForAdaptation(i).map(function(e){return e.value}),r.codec=N.getCodec(i),r.mimeType=N.getMimeType(i),r.contentProtection=N.getContentProtectionData(i),r.bitrateList=N.getBitrateListForAdaptation(i),r.contentProtection&&r.contentProtection.forEach(function(e){e.KID=N.getKID(e)}),r.isText=N.getIsTextTrack(r.mimeType),r}function u(e,t,n){e.id=t,e.index=100+parseInt(t.substring(2,3)),e.type="embeddedText",e.codec="cea-608-in-SEI",e.isText=!0,e.isEmbedded=!0,e.lang=t+" "+n,e.roles=["caption"]}function d(e,t){var n=new c.default,r=1;return n.id=t.id,n.index=t.index,n.start=t.start,n.duration=t.duration,n.manifestInfo=f(e,t.mpd),n.isLast=1===e.Period_asArray.length||Math.abs(n.start+n.duration-n.manifestInfo.duration)<r,n.isFirst=1===e.Period_asArray.length||N.getRegularPeriods(e,N.getMpd(e))[0].id===t.id,n}function f(e,t){var n=new _.default;return n.DVRWindowSize=t.timeShiftBufferDepth,n.loadedTime=t.manifest.loadedTime,n.availableFrom=t.availabilityStartTime,n.minBufferTime=t.manifest.minBufferTime,n.maxFragmentDuration=t.maxSegmentDuration,n.duration=N.getDuration(e),n.isDynamic=N.getIsDynamic(e),n}function h(e,t,n){var r=N.getAdaptationForType(e,t.index,n,t);if(!r)return null;var a=i(t),s=a.id,u=N.getIndexForAdaptation(r,e,t.index);return x[s]=x[s]||N.getAdaptationsForPeriod(e,a),o(e,x[s][u])}function g(e,t,n){var r,a,s,l,d,c,f=i(t),_=f.id,h=N.getAdaptationsForType(e,t.index,"embeddedText"!==n?n:"video"),p=[];if(!h)return p;for(x[_]=x[_]||N.getAdaptationsForPeriod(e,f),l=0,c=h.length;l<c;l++){if(r=h[l],s=N.getIndexForAdaptation(r,e,t.index),a=o(e,x[_][s]),"embeddedText"===n){var g=a.accessibility.length;for(d=0;d<g;d++)if(a){var v=a.accessibility[d];if(0===v.indexOf("cea-608:")){var m=v.substring(8),E=m.split(";");if("CC"===E[0].substring(0,2))for(d=0;d<E.length;d++)a||(a=o.call(this,e,x[_][s])),u(a,E[d].substring(0,3),E[d].substring(4)),p.push(a),a=null;else for(d=0;d<E.length;d++)a||(a=o.call(this,e,x[_][s])),u(a,"CC"+(d+1),E[d]),p.push(a),a=null}else 0===v.indexOf("cea-608")&&(u(a,"CC1","eng"),p.push(a),a=null)}}a&&"embeddedText"!==n&&p.push(a)}return p}function v(e){if(!e)return null;var t=[],n=N.getMpd(e);k=N.getRegularPeriods(e,n),x={};for(var r=0,i=k.length;r<i;r++)t.push(d(e,k[r]));return t}function m(e){var t=N.getMpd(e);return f(e,t)}function y(e,t){var n=e.getRepresentationController().getRepresentationForQuality(t);return e.getIndexHandler().getInitRequest(n)}function S(e,t){var r=n(t,e.getRepresentationController());return e.getIndexHandler().getNextSegmentRequest(r)}function C(e,t,r,i){var a=n(t,e.getRepresentationController());return e.getIndexHandler().getSegmentRequestForTime(a,r,i)}function A(e,t,r){var i=n(t,e.getRepresentationController());return e.getIndexHandler().generateSegmentRequestForTime(i,r)}function D(e){return e.getIndexHandler().getCurrentTime()}function I(e,t){return e.getIndexHandler().setCurrentTime(t)}function R(e,t){var n,a,o=i(t.getStreamInfo()),s=t.getMediaInfo(),u=r(s),l=t.getType();n=s.id,a=n?N.getAdaptationForId(n,e,o.index):N.getAdaptationForIndex(s.index,e,o.index),t.getRepresentationController().updateData(a,u,l)}function O(e,t,n){var r=t.getRepresentationForQuality(n);return r?a(e,r):null}function P(e,t){var n=t.getCurrentRepresentation();return n?a(e,n):null}function b(e,t,n){var r=new p.default,i=e.scheme_id_uri,a=e.value,o=e.timescale,s=e.presentation_time_delta,u=e.event_duration,l=e.id,d=e.message_data,c=n*o+s;return t[i]?(r.eventStream=t[i],r.eventStream.value=a,r.eventStream.timescale=o,r.duration=u,r.id=l,r.presentationTime=c,r.messageData=d,r.presentationTimeDelta=s,r):null}function w(e,t,a){var o=[];return t instanceof c.default?o=N.getEventsForPeriod(e,i(t)):t instanceof l.default?o=N.getEventStreamForAdaptationSet(e,r(t)):t instanceof s.default&&(o=N.getEventStreamForRepresentation(e,n(t,a.getRepresentationController()))),o}function M(){k=[],x={}}var L=void 0,N=void 0,k=void 0,x=void 0;return L={initialize:t,convertDataToTrack:a,convertDataToMedia:o,convertDataToStream:d,getDataForTrack:n,getDataForMedia:r,getDataForStream:i,getStreamsInfo:v,getManifestInfo:m,getMediaInfoForType:h,getAllMediaInfoForType:g,getCurrentRepresentationInfo:P,getRepresentationInfoForQuality:O,updateData:R,getInitRequest:y,getNextFragmentRequest:S,getFragmentRequestForTime:C,generateFragmentRequestForTime:A,getIndexHandlerTime:D,setIndexHandlerTime:I,getEventsFor:w,getEvent:b,setConfig:e,reset:M,metricsList:T}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(189),s=i(o),u=n(185),l=i(u),d=n(187),c=i(d),f=n(184),_=i(f),h=n(58),p=i(h),g=n(1),v=i(g),m=n(52),E=i(m),y=n(54),T=r(y);a.__dashjs_factory_name="DashAdapter",t.default=v.default.getSingletonFactory(a),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}},s=n(27),u=r(s),l=function(e){function t(){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.AST_IN_FUTURE="astInFuture",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_LOADED="bufferLoaded",this.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",this.ERROR="error",this.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",this.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",this.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",this.LOG="log",this.MANIFEST_LOADED="manifestLoaded",this.METRICS_CHANGED="metricsChanged",this.METRIC_CHANGED="metricChanged",this.METRIC_ADDED="metricAdded",this.METRIC_UPDATED="metricUpdated",this.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",this.PERIOD_SWITCH_STARTED="periodSwitchStarted",this.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",this.QUALITY_CHANGE_RENDERED="qualityChangeRendered",this.STREAM_INITIALIZED="streamInitialized",this.TEXT_TRACKS_ADDED="allTextTracksAdded",this.TEXT_TRACK_ADDED="textTrackAdded",this.CAN_PLAY="canPlay",this.PLAYBACK_ENDED="playbackEnded",this.PLAYBACK_ERROR="playbackError",this.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",this.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",this.PLAYBACK_PAUSED="playbackPaused",this.PLAYBACK_PLAYING="playbackPlaying",this.PLAYBACK_PROGRESS="playbackProgress",this.PLAYBACK_RATE_CHANGED="playbackRateChanged",this.PLAYBACK_SEEKED="playbackSeeked",this.PLAYBACK_SEEKING="playbackSeeking",this.PLAYBACK_STARTED="playbackStarted",this.PLAYBACK_TIME_UPDATED="playbackTimeUpdated"}return a(t,e),t}(u.default),d=new l;t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){function t(){var e;p=[],g=[],v=[],e={},i(e,o.HTTPRequest.MPD_TYPE,f.default.DOWNLOAD_ERROR_ID_MANIFEST),i(e,o.HTTPRequest.XLINK_EXPANSION_TYPE,f.default.DOWNLOAD_ERROR_ID_XLINK),i(e,o.HTTPRequest.INIT_SEGMENT_TYPE,f.default.DOWNLOAD_ERROR_ID_INITIALIZATION),i(e,o.HTTPRequest.MEDIA_SEGMENT_TYPE,f.default.DOWNLOAD_ERROR_ID_CONTENT),i(e,o.HTTPRequest.INDEX_SEGMENT_TYPE,f.default.DOWNLOAD_ERROR_ID_CONTENT),i(e,o.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,f.default.DOWNLOAD_ERROR_ID_CONTENT),i(e,o.HTTPRequest.OTHER_TYPE,f.default.DOWNLOAD_ERROR_ID_CONTENT),m=e}function n(e,t){var r=e.request,i=new XMLHttpRequest,a=[],o=!0,s=!0,d=new Date,f=d,h=0,E=function(e){s=!1,r.requestStartDate=d,r.requestEndDate=new Date,r.firstByteDate=r.firstByteDate||d,r.checkExistenceOnly||c.addHttpRequest(r.mediaType,null,r.type,r.url,i.responseURL||null,r.serviceLocation||null,r.range||null,r.requestStartDate,r.firstByteDate,r.requestEndDate,i.status,r.duration,i.getAllResponseHeaders(),e?a:null)},y=function(){p.indexOf(i)!==-1&&(p.splice(p.indexOf(i),1),s&&(E(!1),t>0?(t--,v.push(setTimeout(function(){n(e,t)},u.getRetryIntervalForType(r.type)))):(l.downloadError(m[r.type],r.url,r),e.error&&e.error(r,"error",i.statusText),e.complete&&e.complete(r,i.statusText))))},T=function(t){var n=new Date;o&&(o=!1,(!t.lengthComputable||t.lengthComputable&&t.total!==t.loaded)&&(r.firstByteDate=n)),t.lengthComputable&&(r.bytesLoaded=t.loaded,r.bytesTotal=t.total),a.push({s:f,d:n.getTime()-f.getTime(),b:[t.loaded?t.loaded-h:0]}),f=n,h=t.loaded,e.progress&&e.progress()},S=function(){i.status>=200&&i.status<=299&&(E(!0),e.success&&e.success(i.response,i.statusText,i),e.complete&&e.complete(r,i.statusText))};try{var C=_.modifyRequestURL(r.url),A=r.checkExistenceOnly?"HEAD":"GET";i.open(A,C,!0),r.responseType&&(i.responseType=r.responseType),r.range&&i.setRequestHeader("Range","bytes="+r.range),r.requestStartDate||(r.requestStartDate=d),i=_.modifyRequestHeader(i),i.withCredentials=u.getXHRWithCredentialsForType(r.type),i.onload=S,i.onloadend=y,i.onerror=y,i.onprogress=T;var D=(new Date).getTime();isNaN(r.delayLoadingTime)||D>=r.delayLoadingTime?(p.push(i),i.send()):!function(){var e={xhr:i};g.push(e),e.delayTimeout=setTimeout(function(){if(g.indexOf(e)!==-1){g.splice(g.indexOf(e),1);try{p.push(e.xhr),e.xhr.send()}catch(t){e.xhr.onerror()}}},r.delayLoadingTime-D)}()}catch(e){i.onerror()}}function r(e){e.request&&n(e,u.getRetryAttemptsForType(e.request.type))}function a(){v.forEach(function(e){return clearTimeout(e)}),v=[],g.forEach(function(e){return clearTimeout(e.delayTimeout)}),g=[],p.forEach(function(e){e.onloadend=e.onerror=e.onprogress=void 0,e.abort()}),p=[]}var s=this.context,u=(0,d.default)(s).getInstance(),l=e.errHandler,c=e.metricsModel,_=e.requestModifier,h=void 0,p=void 0,g=void 0,v=void 0,m=void 0;return h={load:r,abort:a},t(),h}Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),s=n(1),u=r(s),l=n(5),d=r(l),c=n(11),f=r(c);a.__dashjs_factory_name="XHRLoader";var _=u.default.getClassFactory(a);t.default=_,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){fe=null,de=[],Se=(0,y.default)(W).getInstance(),he=!0,pe=!1,ge=!1,Ce=!1,Ae=!0,De=null,ve=!1,me=!1}function t(e,t){he=e,_e=t,le.initialize(),se=(0,R.default)(W).getInstance(),X=(0,d.default)(W).getInstance(),X.setConfig({log:q,manifestModel:J,dashManifestModel:$}),X.initialize(Z),ye=(0,m.default)(W).getInstance(),Te=(0,o.default)(W).getInstance(),Te.setConfig({streamController:z,timelineConverter:le,metricsModel:te,dashMetrics:ne,manifestModel:J,dashManifestModel:$,adapter:ee,videoModel:ye}),Y.on(h.default.TIME_SYNCHRONIZATION_COMPLETED,P,this),Y.on(h.default.PLAYBACK_SEEKING,r,this),Y.on(h.default.PLAYBACK_TIME_UPDATED,n,this),Y.on(h.default.PLAYBACK_ENDED,p,this),Y.on(h.default.PLAYBACK_ERROR,k,this),Y.on(h.default.PLAYBACK_STARTED,i,this),Y.on(h.default.PLAYBACK_PAUSED,a,this),Y.on(h.default.MANIFEST_UPDATED,b,this),Y.on(h.default.STREAM_BUFFERING_COMPLETED,s,this)}function n(e){if(w()){var t=ye.getPlaybackQuality();t&&te.addDroppedFrames("video",t)}Te.isSeeking()||e.timeToEnd<=V&&p()}function r(e){var t=l(e.seekTime);t&&t!==ce?(L(C.PlayListTrace.END_OF_PERIOD_STOP_REASON),E(ce,t,e.seekTime)):L(C.PlayListTrace.USER_REQUEST_STOP_REASON),N(C.PlayList.SEEK_START_REASON)}function i(){Ae?(Ae=!1,N(C.PlayList.INITIAL_PLAYOUT_START_REASON)):Ce&&(Ce=!1,N(C.PlayList.RESUME_FROM_PAUSE_START_REASON))}function a(e){e.ended||(Ce=!0,L(C.PlayListTrace.USER_REQUEST_STOP_REASON))}function s(){var e=U().isLast;Ee&&e&&ie.signalEndOfStream(Ee)}function l(e){var t=0,n=null,r=de.length;r>0&&(t+=de[0].getStartTime());for(var i=0;i<r;i++)if(n=de[i],t+=n.getDuration(),e<t)return n;return null}function c(e,t){for(var n=null,r=0,i=0,a=null,o=de.length,s=0;s<o;s++){if(n=de[s],i=n.getStartTime(),a=n.getDuration(),Number.isFinite(i)&&(r=i),n.getId()===t)return e-r;Number.isFinite(a)&&(r+=a)}return null}function _(){var e=[];return ce.getProcessors().forEach(function(t){e.push(t.getIndexHandler().getEarliestTime())}),Math.min.apply(Math,e)}function p(){var e=v();e&&E(ce,e,NaN),L(e?C.PlayListTrace.END_OF_PERIOD_STOP_REASON:C.PlayListTrace.END_OF_CONTENT_STOP_REASON)}function v(){if(ce){var e=function(){var e=ce.getStreamInfo().start,t=ce.getStreamInfo().duration;return{v:de.filter(function(n){return n.getStreamInfo().start===e+t})[0]}}();if("object"==typeof e)return e.v}}function E(e,t,n){!pe&&t&&e!==t&&(pe=!0,Y.trigger(h.default.PERIOD_SWITCH_STARTED,{fromStreamInfo:e?e.getStreamInfo():null,toStreamInfo:t.getStreamInfo()}),e&&e.deactivate(),ce=t,Te.initialize(ce.getStreamInfo()),Ie=M(),T(n))}function T(e){function t(){q("MediaSource is open!"),window.URL.revokeObjectURL(n),Ee.removeEventListener("sourceopen",t),Ee.removeEventListener("webkitsourceopen",t),A(),S(e)}var n=void 0;Ee?ie.detachMediaSource(ye):Ee=ie.createMediaSource(),Ee.addEventListener("sourceopen",t,!1),Ee.addEventListener("webkitsourceopen",t,!1),n=ie.attachMediaSource(Ee,ye),q("MediaSource attached to element.  Waiting on open...")}function S(e){ce.activate(Ee),Ae||(isNaN(e)?!function(){var e=Te.getStreamStartTime(!0);ce.getProcessors().forEach(function(t){ee.setIndexHandlerTime(t,e)}),Te.seek(e)}():Te.seek(e)),ce.startEventController(),!he&&Ae||Te.play(),pe=!1,Y.trigger(h.default.PERIOD_SWITCH_COMPLETED,{toStreamInfo:ce.getStreamInfo()})}function A(){var e=ce.getStreamInfo().manifestInfo.duration,t=ie.setDuration(Ee,e);q("Duration successfully set to: "+t)}function I(e){for(var t=0,n=de.length;t<n;t++)if(de[t].getId()===e.id)return de[t];return null}function O(e){try{var t=ee.getStreamsInfo(e);if(0===t.length)throw new Error("There are no streams");var n=ne.getCurrentManifestUpdate(te.getMetricsFor("stream"));te.updateManifestUpdateInfo(n,{currentTime:Te.getTime(),buffered:ye.getElement().buffered,presentationStartTime:t[0].start,clientTimeOffset:le.getClientTimeOffset()});for(var r=0,i=t.length;r<i;r++){var a=t[r],o=I(a);o?o.updateData(a):(o=(0,u.default)(W).create({manifestModel:J,manifestUpdater:X,adapter:ee,timelineConverter:le,capabilities:Q,errHandler:ue,baseURLController:oe}),de.push(o),o.initialize(a,fe)),te.addManifestUpdateStreamInfo(n,a.id,a.index,a.start,a.duration)}ce||E(null,de[0],NaN),Y.trigger(h.default.STREAMS_COMPOSED)}catch(t){ue.manifestError(t.message,"nostreamscomposed",e),me=!0,K()}}function P(){var e=J.getValue();fe&&(Y.trigger(h.default.PROTECTION_CREATED,{controller:fe,manifest:e}),fe.setMediaElement(ye.getElement()),_e&&fe.setProtectionData(_e)),O(e)}function b(e){if(e.error)me=!0,K();else{var t,n,r=e.manifest,i=ee.getStreamsInfo(r)[0],a=ee.getMediaInfoForType(r,i,"video")||ee.getMediaInfoForType(r,i,"audio");a&&(t=ee.getDataForMedia(a),n=$.getRepresentationsForAdaptation(r,t)[0].useCalculatedLiveEdgeTime,n&&(q("SegmentTimeline detected using calculated Live Edge Time"),Se.setUseManifestDateHeaderTimeSource(!1)));var o=$.getUTCTimingSources(e.manifest),s=!$.getIsDynamic(r)||n?o:o.concat(Se.getUTCTimingSources()),u=(0,g.default)(W).getInstance().isManifestHTTPS();s.forEach(function(e){e.value.replace(/.*?:\/\//g,"")===y.default.DEFAULT_UTC_TIMING_SOURCE.value.replace(/.*?:\/\//g,"")&&(e.value=e.value.replace(u?new RegExp(/^(http:)?\/\//i):new RegExp(/^(https:)?\/\//i),u?"https://":"http://"),q("Matching default timing source protocol to manifest protocol: ",e.value))}),oe.initialize(r),ae.setConfig({metricsModel:te,dashMetrics:ne}),ae.initialize(s,Se.getUseManifestDateHeaderTimeSource())}}function w(){return void 0===Ie&&(Ie=M()),Ie}function M(){var e=!1;return ce.getProcessors().forEach(function(t){"video"===t.getMediaInfo().type&&(e=!0)}),e}function L(e,t){t=t||new Date,De&&(ce&&ce.getProcessors().forEach(function(n){var r=n.getScheduleController();r&&r.finalisePlayList(t,e)}),te.addPlayList(De),De=null)}function N(e){De=new C.PlayList,De.start=new Date,De.mstart=1e3*Te.getTime(),De.starttype=e,ce&&ce.getProcessors().forEach(function(e){var t=e.getScheduleController();t&&t.setPlayList(De)})}function k(e){if(e.error){var t="";switch(e.error.code){case 1:t="MEDIA_ERR_ABORTED";break;case 2:t="MEDIA_ERR_NETWORK";break;case 3:t="MEDIA_ERR_DECODE";break;case 4:t="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:t="MEDIA_ERR_ENCRYPTED";break;default:t="UNKNOWN"}ve=!0,e.error.message&&(t+=" ("+e.error.message+")"),e.error.msExtendedCode&&(t+=" (0x"+(e.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),q("Video Element Error: "+t),e.error&&q(e.error),ue.mediaSourceError(t),K()}}function x(){return he}function U(){return ce?ce.getStreamInfo():null}function F(e){return ce.getId()===e.id}function B(e){return de.filter(function(t){return t.getId()===e})[0]}function H(e){Z.load(e)}function j(e){X.setManifest(e)}function G(e){e&&(e.capabilities&&(Q=e.capabilities),e.manifestLoader&&(Z=e.manifestLoader),e.manifestModel&&(J=e.manifestModel),e.dashManifestModel&&($=e.dashManifestModel),e.protectionController&&(fe=e.protectionController),e.adapter&&(ee=e.adapter),e.metricsModel&&(te=e.metricsModel),e.dashMetrics&&(ne=e.dashMetrics),e.liveEdgeFinder&&(re=e.liveEdgeFinder),e.mediaSourceController&&(ie=e.mediaSourceController),e.timeSyncController&&(ae=e.timeSyncController),e.baseURLController&&(oe=e.baseURLController),e.errHandler&&(ue=e.errHandler),e.timelineConverter&&(le=e.timelineConverter))}function K(){ae.reset(),L(ve||me?C.PlayListTrace.FAILURE_STOP_REASON:C.PlayListTrace.USER_REQUEST_STOP_REASON);for(var e=0,t=de.length;e<t;e++){var o=de[e];o.reset(ve)}de=[],Y.off(h.default.PLAYBACK_TIME_UPDATED,n,this),Y.off(h.default.PLAYBACK_SEEKING,r,this),Y.off(h.default.PLAYBACK_ERROR,k,this),Y.off(h.default.PLAYBACK_STARTED,i,this),Y.off(h.default.PLAYBACK_PAUSED,a,this),Y.off(h.default.PLAYBACK_ENDED,p,this),Y.off(h.default.MANIFEST_UPDATED,b,this),Y.off(h.default.STREAM_BUFFERING_COMPLETED,s,this),oe.reset(),X.reset(),te.clearAllCurrentMetrics(),J.setValue(null),Z.reset(),le.reset(),re.reset(),ee.reset(),se.reset(),pe=!1,ge=!1,ce=null,ve=!1,me=!1,Ie=void 0,Ae=!0,Ce=!1,Ee&&(ie.detachMediaSource(ye),Ee=null),ye=null,fe&&(fe.setMediaElement(null),fe=null,_e=null,J.getValue()&&Y.trigger(h.default.PROTECTION_DESTROYED,{data:J.getValue().url})),Y.trigger(h.default.STREAM_TEARDOWN_COMPLETE)}var V=.1,W=this.context,q=(0,D.default)(W).getInstance().log,Y=(0,f.default)(W).getInstance(),z=void 0,Q=void 0,X=void 0,Z=void 0,J=void 0,$=void 0,ee=void 0,te=void 0,ne=void 0,re=void 0,ie=void 0,ae=void 0,oe=void 0,se=void 0,ue=void 0,le=void 0,de=void 0,ce=void 0,fe=void 0,_e=void 0,he=void 0,pe=void 0,ge=void 0,ve=void 0,me=void 0,Ee=void 0,ye=void 0,Te=void 0,Se=void 0,Ce=void 0,Ae=void 0,De=void 0,Ie=void 0;return z={initialize:t,getAutoPlay:x,getActiveStreamInfo:U,isStreamActive:F,isVideoTrackPresent:w,getStreamById:B,getTimeRelativeToStreamId:c,load:H,loadWithManifest:j,getActiveStreamCommonEarliestTime:_,setConfig:G,reset:K},e(),z}Object.defineProperty(t,"__esModule",{value:!0});var a=n(9),o=r(a),s=n(116),u=r(s),l=n(114),d=r(l),c=n(3),f=r(c),_=n(2),h=r(_),p=n(43),g=r(p),v=n(18),m=r(v),E=n(5),y=r(E),T=n(1),S=r(T),C=n(74),A=n(4),D=r(A),I=n(72),R=r(I);i.__dashjs_factory_name="StreamController",t.default=S.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);
}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(37),s=r(o),u=function(){function e(){i(this,e)}return a(e,null,[{key:"findCencContentProtection",value:function(e){for(var t=null,n=0;n<e.length;++n){var r=e[n];"urn:mpeg:dash:mp4protection:2011"===r.schemeIdUri.toLowerCase()&&"cenc"===r.value.toLowerCase()&&(t=r)}return t}},{key:"getPSSHData",value:function(e){var t=8,n=new DataView(e),r=n.getUint8(t);return t+=20,r>0&&(t+=4+16*n.getUint32(t)),t+=4,e.slice(t)}},{key:"getPSSHForKeySystem",value:function(t,n){var r=e.parsePSSHList(n);return r.hasOwnProperty(t.uuid.toLowerCase())?r[t.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(e){return"pssh"in e?s.default.decodeArray(e.pssh.__text).buffer:null}},{key:"parsePSSHList",value:function(e){if(null===e)return[];for(var t=new DataView(e),n=!1,r={},i=0;!n;){var a,o,s,u,l,d=i;if(i>=t.buffer.byteLength)break;if(a=t.getUint32(i),o=i+a,i+=4,1886614376===t.getUint32(i))if(i+=4,s=t.getUint8(i),0===s||1===s){i++,i+=3,u="";var c,f;for(c=0;c<4;c++)f=t.getUint8(i+c).toString(16),u+=1===f.length?"0"+f:f;for(i+=4,u+="-",c=0;c<2;c++)f=t.getUint8(i+c).toString(16),u+=1===f.length?"0"+f:f;for(i+=2,u+="-",c=0;c<2;c++)f=t.getUint8(i+c).toString(16),u+=1===f.length?"0"+f:f;for(i+=2,u+="-",c=0;c<2;c++)f=t.getUint8(i+c).toString(16),u+=1===f.length?"0"+f:f;for(i+=2,u+="-",c=0;c<6;c++)f=t.getUint8(i+c).toString(16),u+=1===f.length?"0"+f:f;i+=6,u=u.toLowerCase(),l=t.getUint32(i),i+=4,r[u]=t.buffer.slice(d,o),i=o}else i=o;else i=o}return r}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){try{new window.URL("x","http://y");s=c}catch(e){}finally{s=s||f}}function t(e){var t=e.indexOf("/"),n=e.lastIndexOf("/");return t!==-1?n===t+1?e:(e.indexOf("?")!==-1&&(e=e.substring(0,e.indexOf("?"))),e.substring(0,n+1)):""}function n(e){var t=e.match(d);return t?t[1]:""}function r(e){return!u.test(e)}function i(e){return r(e)&&"/"===e.charAt(0)}function a(e){return l.test(e)}function o(e,t){return s(e,t)}var s=void 0,u=/^[a-z][a-z0-9+\-.]*:/i,l=/^https?:\/\//i,d=/^([a-z][a-z0-9+\-.]*:\/\/[^\/]+)\/?/i,c=function(e,t){try{return new window.URL(e,t).toString()}catch(t){return e}},f=function(e,a){var o=t;if(!a)return e;if(!r(e))return e;i(e)&&(o=n);var s=o(a),u="/"!==s.charAt(s.length-1)&&"/"!==e.charAt(0)?"/":"";return[s,e].join(u)};e();var _={parseBaseUrl:t,parseOrigin:n,isRelative:r,isPathAbsolute:i,isHTTPURL:a,resolve:o};return _}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="URLUtils",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){n(this,e)}return r(e,[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&e[i].indexOf("public_")===-1||(this[i]=e[i])}}}]),e}();t.default=i,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,r){n(this,e),this._test=t,this._converter=r}return r(e,[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}]),e}();t.default=i,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){for(;e.length<t;)e="0"+e;return e}function a(e,t){return e.representation.startNumber+t}function o(e,t,n){var r,a,o,s,u,l,d="%0",c=t.length,f=d.length;if(!e)return e;for(;;){if(r=e.indexOf("$"+t),r<0)return e;if(a=e.indexOf("$",r+c),a<0)return e;if(o=e.indexOf(d,r+c),o>r&&o<a)switch(s=e.charAt(a-1),u=parseInt(e.substring(o+f,a-1),10),s){case"d":case"i":case"u":l=i(n.toString(),u);break;case"x":l=i(n.toString(16),u);break;case"X":l=i(n.toString(16),u).toUpperCase();break;case"o":l=i(n.toString(8),u);break;default:return e}else l=n;e=e.substring(0,r)+l+e.substring(a+1)}}function s(e,t,n,r){var i,o,s,u;return o=n.segmentDuration,isNaN(o)&&(o=n.adaptation.period.duration),s=n.adaptation.period.start+r*o,u=s+o,i=new f.default,i.representation=n,i.duration=o,i.presentationStartTime=s,i.mediaStartTime=e.calcMediaTimeFromPresentationTime(i.presentationStartTime,n),i.availabilityStartTime=e.calcAvailabilityStartTimeFromPresentationTime(i.presentationStartTime,n.adaptation.period.mpd,t),i.availabilityEndTime=e.calcAvailabilityEndTimeFromPresentationTime(u,n.adaptation.period.mpd,t),i.wallStartTime=e.calcWallTimeForSegment(i,t),i.replacementNumber=a(i,r),i.availabilityIdx=r,i}function u(e,t,n,r,i,s,u,l,d){var c,_,h,p=r/s,g=Math.min(i/s,n.adaptation.period.mpd.maxSegmentDuration);return c=e.calcPresentationTimeFromMediaTime(p,n),_=c+g,h=new f.default,h.representation=n,h.duration=g,h.mediaStartTime=p,h.presentationStartTime=c,h.availabilityStartTime=n.adaptation.period.mpd.manifest.loadedTime,h.availabilityEndTime=e.calcAvailabilityEndTimeFromPresentationTime(_,n.adaptation.period.mpd,t),h.wallStartTime=e.calcWallTimeForSegment(h,t),h.replacementTime=r,h.replacementNumber=a(h,d),u=o(u,"Number",h.replacementNumber),u=o(u,"Time",h.replacementTime),h.media=u,h.mediaRange=l,h.availabilityIdx=d,h}function l(e,t){if(!t||!t.segments)return null;var n,r,i=t.segments.length;if(e<i&&(n=t.segments[e],n&&n.availabilityIdx===e))return n;for(r=0;r<i;r++)if(n=t.segments[r],n&&n.availabilityIdx===e)return n;return null}function d(e,t,n,r,i,a){var o,s,u,d=n.segmentDuration,c=n.adaptation.period.mpd.manifest.minBufferTime,f=n.segmentAvailabilityRange,_={start:e.calcPeriodRelativeTimeFromMpdRelativeTime(n,f.start),end:e.calcPeriodRelativeTimeFromMpdRelativeTime(n,f.end)},h=n.segments,p=2*d,g=a||Math.max(2*c,10*d),v=NaN,m=null;return _.start=Math.max(_.start,0),t&&!e.isTimeSyncCompleted()?(o=Math.floor(_.start/d),s=Math.floor(_.end/d),u={start:o,end:s}):(h&&h.length>0?(m=l(i,n),v=m?e.calcPeriodRelativeTimeFromMpdRelativeTime(n,m.presentationStartTime):i>0?i*d:e.calcPeriodRelativeTimeFromMpdRelativeTime(n,r)):v=i>0?i*d:t?_.end:_.start,o=Math.floor(Math.max(v-p,_.start)/d),s=Math.floor(Math.min(o+g/d,_.end/d)),u={start:o,end:s})}Object.defineProperty(t,"__esModule",{value:!0}),t.replaceTokenForTemplate=o,t.getIndexBasedSegment=s,t.getTimeBasedSegment=u,t.getSegmentByIndex=l,t.decideSegmentListRangeForTemplate=d;var c=n(41),f=r(c)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){var n=t.codec,r=null;try{if(n.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))throw new A.default("not really supported");r=e.addSourceBuffer(n)}catch(e){if(!t.isText&&n.indexOf('codecs="stpp')===-1&&n.indexOf('codecs="wvtt')===-1)throw e;r=(0,o.default)(E).getInstance(),r.setConfig({errHandler:(0,f.default)(E).getInstance(),adapter:(0,d.default)(E).getInstance(),dashManifestModel:D,mediaController:(0,u.default)(E).getInstance(),videoModel:(0,S.default)(E).getInstance(),streamController:(0,h.default)(E).getInstance(),textTracks:(0,g.default)(E).getInstance(),VTTParser:(0,m.default)(E).getInstance(),TTMLParser:(0,y.default)(E).getInstance()})}return r}function t(e,t){try{e.removeSourceBuffer(t)}catch(e){}}function n(e,t,n){var r,i,a=null,o=0,s=0,u=null,l=null,d=0,c=n||.15;try{a=e.buffered}catch(e){return null}if(null!==a&&void 0!==a){for(i=0,r=a.length;i<r;i++)if(o=a.start(i),s=a.end(i),null===u)d=Math.abs(o-t),t>=o&&t<s?(u=o,l=s):d<=c&&(u=o,l=s);else{if(d=o-l,!(d<=c))break;l=s}if(null!==u)return{start:u,end:l}}return null}function r(e){var t=null;try{return t=e.buffered}catch(e){return null}}function i(e){var t,n,i=r(e),a=0;if(!i)return a;for(n=0,t=i.length;n<t;n++)a+=i.end(n)-i.start(n);return a}function a(e,t,r){var i,a;return i=n(e,t,r),a=null===i?0:i.end-t}function s(e,t){if(!t)return null;var n,i,a,o,s,u,l,d,c,f=r(t);if(!f)return null;for(var _=0,h=f.length;_<h;_++){if(d=e.length>_,s=d?{start:e.start(_),end:e.end(_)}:null,n=f.start(_),i=f.end(_),!s)return c={start:n,end:i};if(a=s.start===n,o=s.end===i,!a||!o){if(a)c={start:s.end,end:i};else{if(!o)return c={start:n,end:i};c={start:n,end:s.start}}return u=e.length>_+1?{start:e.start(_+1),end:e.end(_+1)}:null,l=_+1<h?{start:f.start(_+1),end:f.end(_+1)}:null,!u||l&&l.start===u.start&&l.end===u.end||(c.end=u.start),c}}return null}function l(e,t){var n=t.bytes,r="append"in e?"append":"appendBuffer"in e?"appendBuffer":null,i="Object"===Object.prototype.toString.call(e).slice(8,-1);if(r)try{v(e,function(){i?e[r](n,t):e[r](n),v(e,function(){T.trigger(O.default.SOURCEBUFFER_APPEND_COMPLETED,{buffer:e,bytes:n})})})}catch(t){T.trigger(O.default.SOURCEBUFFER_APPEND_COMPLETED,{buffer:e,bytes:n,error:new A.default(t.code,t.message,null)})}}function c(e,t,n,r){try{v(e,function(){t>=0&&n>t&&"ended"!==r.readyState&&e.remove(t,n),v(e,function(){T.trigger(O.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:e,from:t,to:n})})})}catch(r){T.trigger(O.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:e,from:t,to:n,error:new A.default(r.code,r.message,null)})}}function _(e,t){try{"open"===e.readyState?t.abort():t.setTextTrack&&"ended"===e.readyState&&t.abort()}catch(e){}}function p(e){e&&e.dashManifestModel&&(D=e.dashManifestModel)}function v(e,t){var n,r=50,i=function(){e.updating||(clearInterval(n),t())},a=function n(){e.updating||(e.removeEventListener("updateend",n,!1),t())};if(!e.updating)return void t();if("function"==typeof e.addEventListener)try{e.addEventListener("updateend",a,!1)}catch(e){n=setInterval(i,r)}else n=setInterval(i,r)}var E=this.context,T=(0,I.default)(E).getInstance(),C=void 0,D=void 0;return C={append:l,remove:c,abort:_,createSourceBuffer:e,removeSourceBuffer:t,getBufferRange:n,getAllRanges:r,getTotalBufferedTime:i,getBufferLength:a,getRangeDifference:s,setConfig:p}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(16),o=r(a),s=n(15),u=r(s),l=n(21),d=r(l),c=n(11),f=r(c),_=n(24),h=r(_),p=n(42),g=r(p),v=n(179),m=r(v),E=n(178),y=r(E),T=n(18),S=r(T),C=n(8),A=r(C),D=n(3),I=r(D),R=n(2),O=r(R),P=n(1),b=r(P),w=22;i.__dashjs_factory_name="SourceBufferController";var M=b.default.getSingletonFactory(i);M.QUOTA_EXCEEDED_ERROR_CODE=w,t.default=M,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}},s=n(27),u=r(s),l=function(e){function t(){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",this.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer"}return a(t,e),t}(u.default),d=new l;t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){P=null,M=null,b=[],w=[],I.on(u.default.LOADING_COMPLETED,S,O)}function n(e){M=e}function r(e){P=e}function i(){return P}function a(e){var t=function(e,t){return e.action===f.default.ACTION_COMPLETE&&e.action===t.action},n=function(e,t){return!isNaN(e.index)&&e.startTime===t.startTime&&e.adaptationIndex===t.adaptationIndex},r=function(e,t){return isNaN(e.index)&&isNaN(t.index)&&e.quality===t.quality},i=function(i){var a=!1;return i.some(function(i){if(n(e,i)||r(e,i)||t(e,i))return a=!0}),a};return i(b)}function s(e){var t=e.state instanceof Array?e.state:[e.state],n=[];return t.forEach(function(t){var r=y(t);n=n.concat(E(r,e))}),n}function l(e){b=b.filter(function(t){return isNaN(t.startTime)||t.startTime>=e})}function d(){M.abort(),w=[]}function c(e){switch(e.action){case f.default.ACTION_COMPLETE:b.push(e),T(e,g),I.trigger(u.default.STREAM_COMPLETED,{request:e,fragmentModel:this});break;case f.default.ACTION_DOWNLOAD:T(e,p),w.push(e),_(e);break;default:D("Unknown request action.")}}function _(e){I.trigger(u.default.FRAGMENT_LOADING_STARTED,{sender:O,request:e}),M.load(e)}function v(e,t,n){for(var r=e.length-1,i=r;i>=0;i--){var a=e[i],o=a.startTime,s=o+a.duration;if(n=void 0!==n?n:a.duration/2,!isNaN(o)&&!isNaN(s)&&t+n>=o&&t-n<s||isNaN(o)&&isNaN(t))return a}return null}function E(e,t){return t.hasOwnProperty("time")?[v(e,t.time,t.threshold)]:e.filter(function(e){for(var n in t)if("state"!==n&&t.hasOwnProperty(n)&&e[n]!=t[n])return!1;return!0})}function y(e){var t=void 0;switch(e){case p:t=w;break;case g:t=b;break;default:t=[]}return t}function T(e,t){R.addSchedulingInfo(e.mediaType,new Date,e.type,e.startTime,e.availabilityStartTime,e.duration,e.quality,e.range,t),R.addRequestsQueue(e.mediaType,w,b)}function S(e){e.sender===M&&(w.splice(w.indexOf(e.request),1),e.response&&!e.error&&b.push(e.request),T(e.request,e.error?m:g),I.trigger(u.default.FRAGMENT_LOADING_COMPLETED,{request:e.request,response:e.response,error:e.error,sender:this}))}function C(){I.off(u.default.LOADING_COMPLETED,S,this),M&&(M.reset(),M=null),b=[],w=[]}var A=this.context,D=(0,h.default)(A).getInstance().log,I=(0,o.default)(A).getInstance(),R=e.metricsModel,O=void 0,P=void 0,b=void 0,w=void 0,M=void 0;return O={setLoader:n,setScheduleController:r,getScheduleController:i,getRequests:s,isFragmentLoaded:a,removeExecutedRequestsBeforeTime:l,abortRequests:d,executeRequest:c,reset:C},t(),O}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),o=r(a),s=n(2),u=r(s),l=n(1),d=r(l),c=n(19),f=r(c),_=n(4),h=r(_),p="loading",g="executed",v="canceled",m="failed";i.__dashjs_factory_name="FragmentModel";var E=d.default.getClassFactory(i);E.FRAGMENT_MODEL_LOADING=p,E.FRAGMENT_MODEL_EXECUTED=g,E.FRAGMENT_MODEL_CANCELED=v,E.FRAGMENT_MODEL_FAILED=m,t.default=E,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){return a}function t(e){a=e,e&&r.trigger(u.default.MANIFEST_LOADED,{data:e})}var n=this.context,r=(0,o.default)(n).getInstance(),i=void 0,a=void 0;return i={getValue:e,setValue:t}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),o=r(a),s=n(2),u=r(s),l=n(1),d=r(l);i.__dashjs_factory_name="ManifestModel",t.default=d.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){e&&e.log&&(E=e.log)}function t(){T=[];var e;e=(0,f.default)(p).getInstance(),T.push(e),e=(0,d.default)(p).getInstance(),T.push(e),e=(0,u.default)(p).getInstance(),T.push(e),S=e}function n(){return T}function r(e){for(var t=0;t<T.length;t++)if(T[t].systemString===e)return T[t];return null}function i(e){return e===S}function a(e,t){if(e.byteLength===t.byteLength){for(var n=new Uint8Array(e),r=new Uint8Array(t),i=0;i<n.length;i++)if(n[i]!==r[i])return!1;return!0}return!1}function s(e){var t,n,r,i,a=[];if(e)for(r=0;r<T.length;++r)for(n=T[r],i=0;i<e.length;++i)if(t=e[i],t.schemeIdUri.toLowerCase()===n.schemeIdURI){var o=n.getInitData(t);o&&a.push({ks:T[r],initData:o})}return a}function l(e,t){var n,r=[],i=o.default.parsePSSHList(e);for(n=0;n<T.length;++n){var a=T[n].systemString,s=!t||a in t;T[n].uuid in i&&s&&r.push({ks:T[n],initData:i[T[n].uuid]})}return r}function c(e,t,n){if("license-release"===n||"individualization-request"===n)return null;var r=null;return t&&t.hasOwnProperty("drmtoday")?r=(0,h.default)(p).getInstance():"com.widevine.alpha"===e.systemString?r=(0,m.default)(p).getInstance():"com.microsoft.playready"===e.systemString?r=(0,g.default)(p).getInstance():"org.w3.clearkey"===e.systemString&&(r=(0,y.default)(p).getInstance()),r}function _(e,t){try{return S.getClearKeysFromProtectionData(e,t)}catch(e){return E("Failed to retrieve clearkeys from ProtectionData"),null}}var p=this.context,v=void 0,E=void 0,T=void 0,S=void 0;return v={initialize:t,isClearKey:i,initDataEquals:a,getKeySystems:n,getKeySystemBySystemString:r,getSupportedKeySystemsFromContentProtection:s,getSupportedKeySystems:l,getLicenseServer:c,processClearKeyLicenseRequest:_,setConfig:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(25),o=r(a),s=n(150),u=r(s),l=n(152),d=r(l),c=n(151),f=r(c),_=n(157),h=r(_),p=n(158),g=r(p),v=n(159),m=r(v),E=n(156),y=r(E),T=n(1),S=r(T);i.__dashjs_factory_name="ProtectionKeyController",t.default=S.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){return e}function t(e){return e}var n=void 0;return n={modifyRequestURL:e,modifyRequestHeader:t}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="RequestModifier",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(20),u=r(s),l=function(){function e(t){i(this,e),this.timeStamp=t.timeStamp,this.trackView=new u.default(t.trackView)}return o(e,null,[{key:"fromArrayBuffer",value:function(t){var n=new Uint8Array(t),r=n.slice(0,12).buffer,i=new Uint32Array(r),o=a(i,3),s=o[0],u=o[1],l=o[2],d=n.slice(12).buffer,c=new Float64Array(d),f=c[0],_={periodId:s,adaptationSetId:u,representationId:l};return new e({timeStamp:f,trackView:_})}}]),o(e,[{key:"isEqual",value:function(e){if(!e)return!1;var t=e.timeStamp,n=e.trackView;return this.timeStamp===t&&this.trackView.isEqual(n)}},{key:"isInTrack",value:function(e){return this.trackView.isEqual(e)}},{key:"viewToString",value:function(){return this.trackView.viewToString()+"S"+this.timeStamp}},{key:"toArrayBuffer",value:function(){var e=new Uint32Array([this.trackView.periodId,this.trackView.adaptationSetId,this.trackView.representationId]),t=new Float64Array([this.timeStamp]),n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e.buffer),0),n.set(new Uint8Array(t.buffer),12),n.buffer}},{key:"getId",value:function(){return this.timeStamp}}]),e}();t.default=l,e.exports=t.default},function(e,t,n){"use strict";var r={};r.encode=function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|63&r)):r<65536?(t.push(224|r>>12),t.push(128|63&r>>6),t.push(128|63&r)):(t.push(240|r>>18),t.push(128|63&r>>12),t.push(128|63&r>>6),t.push(128|63&r))}return t},r.decode=function(e){for(var t=[],n=0;n<e.length;){var r=e[n++];r<128||(r<224?(r=(31&r)<<6,r|=63&e[n++]):r<240?(r=(15&r)<<12,r|=(63&e[n++])<<6,r|=63&e[n++]):(r=(7&r)<<18,r|=(63&e[n++])<<12,r|=(63&e[n++])<<6,r|=63&e[n++])),t.push(String.fromCharCode(r))}return t.join("")};var i={};!function(e){var t=function(t){for(var n=0,r=[],i=0|t.length/3;0<i--;){var a=(t[n]<<16)+(t[n+1]<<8)+t[n+2];n+=3,r.push(e.charAt(63&a>>18)),r.push(e.charAt(63&a>>12)),r.push(e.charAt(63&a>>6)),r.push(e.charAt(63&a))}if(2==t.length-n){var a=(t[n]<<16)+(t[n+1]<<8);r.push(e.charAt(63&a>>18)),r.push(e.charAt(63&a>>12)),r.push(e.charAt(63&a>>6)),r.push("=")}else if(1==t.length-n){var a=t[n]<<16;r.push(e.charAt(63&a>>18)),r.push(e.charAt(63&a>>12)),r.push("==")}return r.join("")},n=function(){for(var t=[],n=0;n<e.length;++n)t[e.charCodeAt(n)]=n;return t["=".charCodeAt(0)]=0,t}(),o=function(e){for(var t=0,r=[],i=0|e.length/4;0<i--;){var a=(n[e.charCodeAt(t)]<<18)+(n[e.charCodeAt(t+1)]<<12)+(n[e.charCodeAt(t+2)]<<6)+n[e.charCodeAt(t+3)];r.push(255&a>>16),r.push(255&a>>8),r.push(255&a),t+=4}return r&&("="==e.charAt(t-2)?(r.pop(),r.pop()):"="==e.charAt(t-1)&&r.pop()),r},u={};u.encode=function(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t},u.decode=function(e){for(var t=0;t<s.length;++t)a[t]=String.fromCharCode(a[t]);return a.join("")},i.decodeArray=function(e){var t=o(e);return new Uint8Array(t)},i.encodeASCII=function(e){var n=u.encode(e);return t(n)},i.decodeASCII=function(e){var t=o(e);return u.decode(t)},i.encode=function(e){var n=r.encode(e);return t(n)},i.decode=function(e){var t=o(e);return r.decode(t)}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),t.decode=i.decode,t.decodeArray=i.decodeArray},function(e,t){"use strict";function n(e){function t(){void 0===e.escapeMode&&(e.escapeMode=!0),void 0===e.attributePrefix&&(e.attributePrefix="_"),e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0),e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0),void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0),e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],void 0===e.useDoubleQuotes&&(e.useDoubleQuotes=!1),e.xmlElementsFilter=e.xmlElementsFilter||[],e.jsonPropertiesFilter=e.jsonPropertiesFilter||[],void 0===e.keepCData&&(e.keepCData=!1),void 0===e.ignoreRoot&&(e.ignoreRoot=!1)}function n(){}function r(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function i(e){return e.prefix}function a(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function o(e,t,n,r){for(var i=0;i<e.length;i++){var a=e[i];if("string"==typeof a){if(a==r)break}else if(a instanceof RegExp){if(a.test(r))break}else if("function"==typeof a&&a(t,n,r))break}return i!=e.length}function s(t,n,r){switch(e.arrayAccessForm){case"property":t[n]instanceof Array?t[n+"_asArray"]=t[n]:t[n+"_asArray"]=[t[n]]}!(t[n]instanceof Array)&&e.arrayAccessFormPaths.length>0&&o(e.arrayAccessFormPaths,t,n,r)&&(t[n]=[t[n]])}function u(e){var t=e.split(/[-T:+Z]/g),n=new Date(t[0],t[1]-1,t[2]),r=t[5].split(".");if(n.setHours(t[3],t[4],r[0]),r.length>1&&n.setMilliseconds(r[1]),t[6]&&t[7]){var i=60*t[6]+Number(t[7]),a=/\d\d-\d\d:\d\d$/.test(e)?"-":"+";i=0+("-"==a?-1*i:i),n.setMinutes(n.getMinutes()-i-n.getTimezoneOffset())}else e.indexOf("Z",e.length-1)!==-1&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n}function l(t,n,r){if(e.datetimeAccessFormPaths.length>0){var i=r.split(".#")[0];return o(e.datetimeAccessFormPaths,t,n,i)?u(t):t}return t}function d(t,n,r,i){return!(n==D.ELEMENT_NODE&&e.xmlElementsFilter.length>0)||o(e.xmlElementsFilter,t,r,i)}function c(t,n){if(t.nodeType==D.DOCUMENT_NODE){for(var a=new Object,o=t.childNodes,u=0;u<o.length;u++){var f=o.item(u);if(f.nodeType==D.ELEMENT_NODE)if(e.ignoreRoot)a=c(f);else{a={};var _=r(f);a[_]=c(f)}}return a}if(t.nodeType==D.ELEMENT_NODE){var a=new Object;a.__cnt=0;for(var h=[],o=t.childNodes,u=0;u<o.length;u++){var f=o.item(u),_=r(f);if(f.nodeType!=D.COMMENT_NODE){var p=n+"."+_;if(d(a,f.nodeType,_,p))if(a.__cnt++,null==a[_]){var g=c(f,p);if("#text"!=_||/[^\s]/.test(g)){var v={};v[_]=g,h.push(v)}a[_]=g,s(a,_,p)}else{null!=a[_]&&(a[_]instanceof Array||(a[_]=[a[_]],s(a,_,p)));var g=c(f,p);if("#text"!=_||/[^\s]/.test(g)){var v={};v[_]=g,h.push(v)}a[_][a[_].length]=g}}}a.__children=h;for(var m=r(t),E=0;E<t.attributes.length;E++){var y=t.attributes.item(E);a.__cnt++;for(var T=y.value,S=0,C=e.matchers.length;S<C;S++){var A=e.matchers[S];A.test(y,m)&&(T=A.converter(y.value))}a[e.attributePrefix+y.name]=T}var I=i(t);return null!=I&&""!=I&&(a.__cnt++,a.__prefix=I),null!=a["#text"]&&(a.__text=a["#text"],a.__text instanceof Array&&(a.__text=a.__text.join("\n")),e.stripWhitespaces&&(a.__text=a.__text.trim()),delete a["#text"],"property"==e.arrayAccessForm&&delete a["#text_asArray"],a.__text=l(a.__text,_,n+"."+_)),null!=a["#cdata-section"]&&(a.__cdata=a["#cdata-section"],delete a["#cdata-section"],"property"==e.arrayAccessForm&&delete a["#cdata-section_asArray"]),0==a.__cnt&&"text"==e.emptyNodeForm?a="":1==a.__cnt&&null!=a.__text?a=a.__text:1!=a.__cnt||null==a.__cdata||e.keepCData?a.__cnt>1&&null!=a.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==a.__text||""==a.__text.trim())&&delete a.__text:a=a.__cdata,delete a.__cnt,!e.enableToStringFunc||null==a.__text&&null==a.__cdata||(a.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),a}if(t.nodeType==D.TEXT_NODE||t.nodeType==D.CDATA_SECTION_NODE)return t.nodeValue}function f(t,n,r,i){var o="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+n;if(null!=r)for(var s=0;s<r.length;s++){var u=r[s],l=t[u];e.escapeMode&&(l=a(l)),o+=" "+u.substr(e.attributePrefix.length)+"=",o+=e.useDoubleQuotes?'"'+l+'"':"'"+l+"'"}return o+=i?"/>":">"}function _(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function h(e,t){return e.indexOf(t,e.length-t.length)!==-1}function p(t,n){return!!("property"==e.arrayAccessForm&&h(n.toString(),"_asArray")||0==n.toString().indexOf(e.attributePrefix)||0==n.toString().indexOf("__")||t[n]instanceof Function)}function g(e){var t=0;if(e instanceof Object)for(var n in e)p(e,n)||t++;return t}function v(t,n,r){return 0==e.jsonPropertiesFilter.length||""==r||o(e.jsonPropertiesFilter,t,n,r)}function m(t){var n=[];if(t instanceof Object)for(var r in t)r.toString().indexOf("__")==-1&&0==r.toString().indexOf(e.attributePrefix)&&n.push(r);return n}function E(t){var n="";return null!=t.__cdata&&(n+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(n+=e.escapeMode?a(t.__text):t.__text),n}function y(t){var n="";return t instanceof Object?n+=E(t):null!=t&&(n+=e.escapeMode?a(t):t),n}function T(e,t){return""===e?t:e+"."+t}function S(e,t,n,r){var i="";if(0==e.length)i+=f(e,t,n,!0);else for(var a=0;a<e.length;a++)i+=f(e[a],t,m(e[a]),!1),i+=C(e[a],T(r,t)),i+=_(e[a],t);return i}function C(e,t){var n="",r=g(e);if(r>0)for(var i in e)if(!p(e,i)&&(""==t||v(e,i,T(t,i)))){var a=e[i],o=m(a);if(null==a||void 0==a)n+=f(a,i,o,!0);else if(a instanceof Object)if(a instanceof Array)n+=S(a,i,o,t);else if(a instanceof Date)n+=f(a,i,o,!1),n+=a.toISOString(),n+=_(a,i);else{var s=g(a);s>0||null!=a.__text||null!=a.__cdata?(n+=f(a,i,o,!1),n+=C(a,T(t,i)),n+=_(a,i)):n+=f(a,i,o,!0)}else n+=f(a,i,o,!1),n+=y(a),n+=_(a,i)}return n+=y(e)}var A="1.2.0";e=e||{},t(),n();var D={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(e){var t=window.ActiveXObject||"ActiveXObject"in window;if(void 0===e)return null;var n;if(window.DOMParser){var r=new window.DOMParser,i=null;if(!t)try{i=r.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI}catch(e){i=null}try{n=r.parseFromString(e,"text/xml"),null!=i&&n.getElementsByTagNameNS(i,"parsererror").length>0&&(n=null)}catch(e){n=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(e);return n},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?u(e):e},this.xml2json=function(e){return c(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return C(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return A}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){D=0,I=!1,R=NaN,C.on(u.default.TIME_SYNCHRONIZATION_COMPLETED,E,this)}function t(){return I}function n(e){I=e}function r(){return D}function i(e){D=e}function a(){return R}function s(e){R=e}function l(e,t,n,r){var i=NaN;return i=r?n&&t.timeShiftBufferDepth!=Number.POSITIVE_INFINITY?new Date(t.availabilityStartTime.getTime()+1e3*(e+t.timeShiftBufferDepth)):t.availabilityEndTime:n?new Date(t.availabilityStartTime.getTime()+1e3*(e-D)):t.availabilityStartTime}function d(e,t,n){return l.call(this,e,t,n)}function c(e,t,n){return l.call(this,e,t,n,!0)}function f(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime()+1e3*D)/1e3}function _(e,t){var n=t.adaptation.period.start,r=t.presentationTimeOffset;return e+(n-r)}function h(e,t){var n=t.adaptation.period.start,r=t.presentationTimeOffset;return e-n+r}function p(e,t){var n,r,i;return t&&(n=e.representation.adaptation.period.mpd.suggestedPresentationDelay,r=e.presentationStartTime+n,i=new Date(e.availabilityStartTime.getTime()+1e3*r)),i}function g(e,t){var n=e.adaptation.period,r={start:n.start,end:n.start+n.duration};if(!t)return r;if(!I&&e.segmentAvailabilityRange)return e.segmentAvailabilityRange;var i=e.segmentDuration||(e.segments&&e.segments.length?e.segments[e.segments.length-1].duration:0),a=f(new Date,n),o=n.start+n.duration;return r.start=Math.max(a-n.mpd.timeShiftBufferDepth,n.start),r.end=a>=o&&a-i<o?o-i:a-i,r}function v(e,t){var n=e.adaptation.period.start;return t-n}function m(e,t){var n=e.adaptation.period.start;return t+n}function E(e){I||void 0!==e.offset&&(i(e.offset/1e3),I=!0)}function y(e){var t=e.presentationTimeOffset,n=e.adaptation.period.start;return n-t}function T(){C.off(u.default.TIME_SYNCHRONIZATION_COMPLETED,E,this),D=0,I=!1,R=NaN}var S=this.context,C=(0,o.default)(S).getInstance(),A=void 0,D=void 0,I=void 0,R=void 0;return A={initialize:e,isTimeSyncCompleted:t,setTimeSyncCompleted:n,getClientTimeOffset:r,setClientTimeOffset:i,getExpectedLiveEdge:a,setExpectedLiveEdge:s,calcAvailabilityStartTimeFromPresentationTime:d,calcAvailabilityEndTimeFromPresentationTime:c,calcPresentationTimeFromWallTime:f,calcPresentationTimeFromMediaTime:_,calcPeriodRelativeTimeFromMpdRelativeTime:v,calcMpdRelativeTimeFromPeriodRelativeTime:m,calcMediaTimeFromPresentationTime:h,calcSegmentAvailabilityRange:g,calcWallTimeForSegment:p,calcMSETimeOffset:y,reset:T}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),o=r(a),s=n(2),u=r(s),l=n(1),d=r(l);i.__dashjs_factory_name="TimelineConverter",t.default=d.default.getSingletonFactory(i),e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{
value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){n(this,e),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0,this.bandwidth=NaN,this.maxPlayoutRate=NaN}return r(e,null,[{key:"hasInitialization",value:function(e){return null!==e.initialization||("BaseURL"!==e.segmentInfoType||"SegmentBase"!==e.segmentInfoType)&&null!==e.range}},{key:"hasSegments",value:function(e){return"BaseURL"!==e.segmentInfoType&&"SegmentBase"!==e.segmentInfoType&&!e.indexRange}}]),e}();t.default=i,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.availabilityIdx=NaN,this.wallStartTime=NaN,this.representation=null};t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){P=window.VTTCue||window.TextTrackCue,M=[],L=[],N=-1,k=0,x=0,U=0,F=0,B=null,H=null,K=!1,V=2147483647,j=!!navigator.userAgent.match(/Chrome/)&&!navigator.userAgent.match(/Edge/),void 0!==document.fullscreenElement?G="fullscreenElement":void 0!==document.webkitIsFullScreen?G="webkitIsFullScreen":document.msFullscreenElement?G="msFullscreenElement":document.mozFullScreen&&(G="mozFullScreen")}function t(e){var t=M[e].kind,n=void 0!==M[e].label?M[e].label:M[e].lang,r=M[e].lang,i=j?document.createElement("track"):w.addTextTrack(t,n,r);return j&&(i.kind=t,i.label=n,i.srclang=r),i}function n(e){K=e,B&&!document[G]&&(B.style.zIndex=e?V:null)}function r(e,n){if(M.length===n)return void R("Trying to add too many tracks.");if(M.push(e),void 0===w&&(w=e.video),M.length===n){M.sort(function(e,t){return e.index-t.index}),B=b.getTTMLRenderingDiv();for(var r=-1,i=0;i<M.length;i++){var a=t.call(this,i);L.push(a),M[i].defaultTrack&&(a.default=!0,r=i),j&&w.appendChild(a);var o=w.textTracks[i];o.nonAddedCues=[],B&&(M[i].isTTML||M[i].isEmbedded)?o.renderingType="html":o.renderingType="default",this.addCaptions(i,0,M[i].captionData),I.trigger(u.default.TEXT_TRACK_ADDED)}if(g.call(this,r),r>=0){for(var s=0;s<w.textTracks.length;s++)w.textTracks[s].mode=s===r?"showing":"hidden";this.addCaptions(r,0,null)}I.trigger(u.default.TEXT_TRACKS_ADDED,{index:N,tracks:M})}}function i(e,t,n,r,i,a){var o=e/t,s=n/r,u=0,l=0;o>s?(l=t,u=l/r*n):(u=e,l=u/n*r);var d=0,c=0,f=0,_=0,h=u/l;return h>i?(_=l,f=l/(1/i),d=(e-f)/2,c=0):(f=u,_=u/i,d=0,c=(t-_)/2),a?{x:d+.1*f,y:c+.1*_,w:.8*f,h:.8*_}:{x:d,y:c,w:f,h:_}}function a(){var e=this.getCurrentTextTrack();if(e&&"html"===e.renderingType){var t=w.clientWidth/w.clientHeight,n=!1;e.isFromCEA608&&(t=3.5/3,n=!0);var r=i.call(this,w.clientWidth,w.clientHeight,w.videoWidth,w.videoHeight,t,n),a=r.w,o=r.h;if(a!=U||o!=F){k=r.x,x=r.y,U=a,F=o,B.style.left=k+"px",B.style.top=x+"px",B.style.width=U+"px",B.style.height=F+"px";for(var s=0;e.activeCues&&s<e.activeCues.length;++s){var u=e.activeCues[s];u.scaleCue(u)}G&&document[G]||K?B.style.zIndex=V:B.style.zIndex=null}}}function s(e,t){var n=Math.round(.01*e*t).toString()+"px";return n}function l(e){var t=U,n=F;if(t*n!==0&&e.layout){var r=e.layout,i=s(r.left,t),a=s(r.top,n),o=s(r.width,t),u=s(r.height,n);B.style.left=i,B.style.top=a,B.style.width=o,B.style.height=u;var l=B.firstChild;l&&l.style&&(l.style.left="0px",l.style.top="0px",l.style.width=o,l.style.height=u)}}function d(e){var t,n,r,i,a,o=U,s=F,u=[o/e.cellResolution[0],s/e.cellResolution[1]];if(e.linePadding)for(t in e.linePadding)if(e.linePadding.hasOwnProperty(t)){var l=e.linePadding[t];n=(l*u[0]).toString();for(var d=document.getElementsByClassName("spanPadding"),c=0;c<d.length;c++)d[c].style.cssText=d[c].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n),d[c].style.cssText=d[c].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n)}if(e.fontSize)for(t in e.fontSize)if(e.fontSize.hasOwnProperty(t)){"%"===e.fontSize[t][0]?r=e.fontSize[t][1]/100:"c"===e.fontSize[t][0]&&(r=e.fontSize[t][1]),n=(r*u[1]).toString(),a="defaultFontSize"!==t?document.getElementsByClassName(t):document.getElementsByClassName("paragraph");for(var f=0;f<a.length;f++)a[f].style.cssText=a[f].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n)}if(e.lineHeight)for(t in e.lineHeight)if(e.lineHeight.hasOwnProperty(t)){"%"===e.lineHeight[t][0]?i=e.lineHeight[t][1]/100:"c"===e.fontSize[t][0]&&(i=e.lineHeight[t][1]),n=(i*u[1]).toString(),a=document.getElementsByClassName(t);for(var _=0;_<a.length;_++)a[_].style.cssText=a[_].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n)}}function c(e,t,n){var r=e>=0?w.textTracks[e]:null,i=this;if(r){if("showing"!==r.mode)return void(n&&n.length>0&&(r.nonAddedCues=r.nonAddedCues.concat(n)));if(n||(n=r.nonAddedCues,r.nonAddedCues=[]),n&&0!==n.length)for(var o in n){var s,u=n[o];r.cellResolution=u.cellResolution,r.isFromCEA608=u.isFromCEA608,H||"html"!==u.type&&"image"!==u.type||(H=setInterval(a.bind(this),500)),"image"===u.type?(s=new P(u.start-t,u.end-t,""),s.image=u.data,s.id=u.id,s.size=0,s.type="image",s.layout=u.layout,s.scaleCue=l.bind(i),s.onenter=function(){if(B&&"showing"===r.mode){var e=new Image;e.id="ttmlImage_"+this.id,e.src=this.image,e.style.cssText="z-index: 2147483648; pointer-events: none; display: block; visibility: visible !important; position: relative !important;",B.appendChild(e),l.call(i,this)}},s.onexit=function(){if(B)for(var e=B.childNodes,t=0;t<e.length;t++)e[t].id==="ttmlImage_"+this.id&&B.removeChild(e[t])}):"html"===u.type?(s=new P(u.start-t,u.end-t,""),s.cueHTMLElement=u.cueHTMLElement,s.regions=u.regions,s.regionID=u.regionID,s.cueID=u.cueID,s.videoWidth=u.videoWidth,s.videoHeight=u.videoHeight,s.cellResolution=u.cellResolution,s.fontSize=u.fontSize,s.lineHeight=u.lineHeight,s.linePadding=u.linePadding,s.scaleCue=d.bind(i),B.style.left=k+"px",B.style.top=x+"px",B.style.width=U+"px",B.style.height=F+"px",s.onenter=function(){"showing"===r.mode&&(R("Cue "+this.startTime+"-"+this.endTime+" : "+this.cueHTMLElement.id+" : "+this.cueHTMLElement.innerText),B.appendChild(this.cueHTMLElement),d.call(i,this))},s.onexit=function(){for(var e=B.childNodes,t=0;t<e.length;++t)e[t].id===this.cueID&&B.removeChild(e[t])}):(s=new P(u.start-t,u.end-t,u.data),u.styles&&(void 0!==u.styles.align&&s.hasOwnProperty("align")&&(s.align=u.styles.align),void 0!==u.styles.line&&s.hasOwnProperty("line")&&(s.line=u.styles.line),void 0!==u.styles.position&&s.hasOwnProperty("position")&&(s.position=u.styles.position),void 0!==u.styles.size&&s.hasOwnProperty("size")&&(s.size=u.styles.size))),r.addCue(s)}}}function _(){return N>=0?w.textTracks[N]:null}function h(){return N}function p(e){for(var t=-1,n=0;n<w.textTracks.length;n++)if(w.textTracks[n].label===e){t=n;break}return t}function g(e){if(N=e,C.call(this),e>=0){var t=w.textTracks[e];"html"===t.renderingType?T.call(this):S.call(this)}else S.call(this)}function v(e){return w.textTracks[e]}function m(e){if(e.cues){for(var t=e.cues,n=t.length-1,r=n;r>=0;r--)e.removeCue(t[r]);e.mode="disabled"}}function E(){for(var e=L.length,t=0;t<e;t++)if(j)w.removeChild(L[t]);else{var n=v.call(this,t);n.nonAddedCues=[],m.call(this,n)}L=[],M=[],H&&(clearInterval(H),H=null),C.call(this)}function y(e){w.removeChild(L[e]),L.splice(e,1)}function T(){if(j){var e=document.getElementById("native-cue-style");if(!e){e=document.createElement("style"),e.id="native-cue-style",document.head.appendChild(e);var t=e.sheet;w.id?t.insertRule("#"+w.id+"::cue {background: transparent}",0):0!==w.classList.length?t.insertRule("."+w.className+"::cue {background: transparent}",0):t.insertRule("video::cue {background: transparent}",0)}}}function S(){if(j){var e=document.getElementById("native-cue-style");e&&document.head.removeChild(e)}}function C(){if(B)for(;B.firstChild;)B.removeChild(B.firstChild)}function A(e){e&&e.videoModel&&(b=e.videoModel)}var D=this.context,I=(0,o.default)(D).getInstance(),R=(0,f.default)(D).getInstance().log,O=void 0,P=void 0,b=void 0,w=void 0,M=void 0,L=void 0,N=void 0,k=void 0,x=void 0,U=void 0,F=void 0,B=void 0,H=void 0,j=void 0,G=void 0,K=void 0,V=void 0;return O={initialize:e,displayCConTop:n,addTextTrack:r,addCaptions:c,getTextTrack:v,getCurrentTextTrack:_,getCurrentTrackIdx:h,setCurrentTrackIdx:g,getTrackIdxForId:p,deleteTrackCues:m,deleteAllTextTracks:E,deleteTextTrack:y,setConfig:A}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),o=r(a),s=n(2),u=r(s),l=n(1),d=r(l),c=n(4),f=r(c);i.__dashjs_factory_name="TextTracks",t.default=d.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){s=new o.default,u=[],l=!1}function t(){return s}function n(){return u}function r(){return l}function i(e){function t(e,t,n,r){var i=r[0].split(/[=]/);return r.push({key:i[0],value:i[1]}),r.shift(),r}function n(e,t,n){return t>0&&(c&&0===u.length?u=n[t].split(/[&]/):f&&(i=n[t].split(/[&]/))),n}if(!e)return null;var r,i=[],a=new RegExp(/[?]/),o=new RegExp(/[#]/),d=new RegExp(/^(https:)?\/\//i),c=a.test(e),f=o.test(e);return l=d.test(e),r=e.split(/[?#]/).map(n),u.length>0&&(u=u.reduce(t,null)),i.length>0&&(i=i.reduce(t,null),i.forEach(function(e){s[e.key]=e.value})),e}var a=void 0,s=void 0,u=void 0,l=void 0;return a={initialize:e,parseURI:i,getURIFragmentData:t,getURIQueryData:n,isManifestHTTPS:r}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(190),o=r(a),s=n(1),u=r(s);i.__dashjs_factory_name="URIQueryAndFragmentModel",t.default=u.default.getSingletonFactory(i),e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t,r){n(this,e),this.sessionToken=t,this.error=r};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t,r,i,a){n(this,e),this.sessionToken=t,this.message=r,this.defaultURL=i,this.messageType=a?a:"license-request"};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t,r){n(this,e),this.keySystem=t,this.ksConfiguration=r};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t,r,i,a,o){n(this,e),this.initDataTypes=["cenc"],t&&t.length&&(this.audioCapabilities=t),r&&r.length&&(this.videoCapabilities=r),this.distinctiveIdentifier=i,this.persistentState=a,this.sessionTypes=o};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t,r){n(this,e),this.initData=t,this.initDataType=r};t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){if(!e)return null;void 0===e.fileStart&&(e.fileStart=0);var t=d.default.parseBuffer(e),r=(0,o.default)(n).create();return r.setData(t),r}var t=void 0,n=this.context;return t={parse:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(176),o=r(a),s=n(1),u=r(s),l=n(75),d=r(l);i.__dashjs_factory_name="BoxParser",t.default=u.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){if(void 0!==E)return E;E=!1;var t,n="1",r="1";try{"undefined"!=typeof window&&(t=window[e])}catch(e){return v("Warning: DOMStorage access denied: "+e.message),E}if(!t||e!==h&&e!==p)return E;try{t.setItem(n,r),t.removeItem(n),E=!0}catch(e){v("Warning: DOMStorage is supported, but cannot be used: "+e.message)}return E}function t(){e(h)&&c.forEach(function(e){var t=localStorage.getItem(e.oldKey);if(t){localStorage.removeItem(e.oldKey);try{localStorage.setItem(e.newKey,t)}catch(e){v(e.message)}}})}function n(){y=(0,u.default)(g).getInstance(),t()}function r(){var e=6e5;return Math.round((new Date).getTime()/e)*e}function i(t,n){return e(t)&&y["get"+n+"CachingInfo"]().enabled}function a(e){if(!i(h,"LastMediaSettings"))return null;var t=_.replace(/\?/,e),n=JSON.parse(localStorage.getItem(t))||{},r=(new Date).getTime()-parseInt(n.timestamp,10)>=y.getLastMediaSettingsCachingInfo().ttl||!1,a=n.settings;return r&&(localStorage.removeItem(t),a=null),a}function o(e){var t=NaN;if(i(h,"LastBitrate")){var n=f.replace(/\?/,e),r=JSON.parse(localStorage.getItem(n))||{},a=(new Date).getTime()-parseInt(r.timestamp,10)>=y.getLastBitrateCachingInfo().ttl||!1,o=parseInt(r.bitrate,10);isNaN(o)||a?a&&localStorage.removeItem(n):(t=o,v("Last saved bitrate for "+e+" was "+o))}return t}function s(e,t){if(i(h,"LastMediaSettings")){var n=_.replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({settings:t,timestamp:r()}))}catch(e){v(e.message)}}}function l(e,t){if(i(h,"LastBitrate")&&t){var n=f.replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({bitrate:t/1e3,timestamp:r()}))}catch(e){v(e.message)}}}var g=this.context,v=(0,d.default)(g).getInstance().log,m=void 0,E=void 0,y=void 0;return m={getSavedBitrateSettings:o,setSavedBitrateSettings:l,getSavedMediaSettings:a,setSavedMediaSettings:s,isSupported:e},n(),m}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(5),u=r(s),l=n(4),d=r(l),c=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],f="dashjs_?_bitrate",_="dashjs_?_settings",h="localStorage",p="sessionStorage";i.__dashjs_factory_name="DOMStorage";var g=o.default.getSingletonFactory(i);t.default=g,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){i=e,a=t}function t(){var e=a.getCurrentRepresentationInfo(),t=e.DVRWindow.end;return e.useCalculatedLiveEdgeTime&&(t=i.getExpectedLiveEdge(),i.setClientTimeOffset(t-e.DVRWindow.end)),t}function n(){i=null,a=null}var r=void 0,i=void 0,a=void 0;return r={initialize:e,getLiveEdge:t,reset:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="LiveEdgeFinder";var s=o.default.getSingletonFactory(i);t.default=s,e.exports=t.default},function(e,t,n){"use strict";!function(e){var t={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},n=function(e){var n=e;return t.hasOwnProperty(e)&&(n=t[e]),String.fromCharCode(n)},r=15,i=32,a={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},o={17:2,18:4,21:6,22:8,23:10,19:13,20:15},s={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},u={25:2,26:4,29:6,30:8,31:10,27:13,28:15},l=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],d={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var n=this.verboseFilter[e];this.verboseLevel>=n&&console.log(this.time+" ["+e+"] "+t)}},c=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t},f=function(e,t,n,r,i){this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=r||"black",this.flash=i||!1};f.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}},isDefault:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},equals:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},copy:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var _=function(e,t,n,r,i,a){this.uchar=e||" ",this.penState=new f(t,n,r,i,a)};_.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(e,t){this.uchar=e,this.penState.copy(t)},setPenState:function(e){this.penState.copy(e)},equals:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},copy:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},isEmpty:function(){return" "===this.uchar&&this.penState.isDefault()}};var h=function(){this.chars=[];for(var e=0;e<i;e++)this.chars.push(new _);this.pos=0,this.currPenState=new f};h.prototype={equals:function(e){for(var t=!0,n=0;n<i;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<i;t++)this.chars[t].copy(e.chars[t])},isEmpty:function(){for(var e=!0,t=0;t<i;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},setCursor:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(d.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>i&&(d.log("ERROR","Too large cursor position "+this.pos),this.pos=i)},moveCursor:function(e){var t=this.pos+e;if(e>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(e){e>=144&&this.backSpace();var t=n(e);return this.pos>=i?void d.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),void this.moveCursor(1))},clearFromPos:function(e){var t;for(t=e;t<i;t++)this.chars[t].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var e=[],t=!0,n=0;n<i;n++){var r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")},setPenStyles:function(e){this.currPenState.setStyles(e);var t=this.chars[this.pos];t.setPenState(this.currPenState)}};var p=function(){this.rows=[];for(var e=0;e<r;e++)this.rows.push(new h);this.currRow=r-1,this.nrRollUpRows=null,this.reset()};p.prototype={reset:function(){for(var e=0;e<r;e++)this.rows[e].clear();this.currRow=r-1},equals:function(e){for(var t=!0,n=0;n<r;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<r;t++)this.rows[t].copy(e.rows[t])},isEmpty:function(){for(var e=!0,t=0;t<r;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},backSpace:function(){var e=this.rows[this.currRow];e.backSpace()},clearToEndOfRow:function(){var e=this.rows[this.currRow];e.clearToEndOfRow()},insertChar:function(e){var t=this.rows[this.currRow];t.insertChar(e)},setPen:function(e){var t=this.rows[this.currRow];t.setPenStyles(e)},moveCursor:function(e){var t=this.rows[this.currRow];t.moveCursor(e)},setCursor:function(e){d.log("INFO","setCursor: "+e);var t=this.rows[this.currRow];t.setCursor(e)},setPAC:function(e){d.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.currRow=t;var n=this.rows[this.currRow];if(null!==e.indent){var r=e.indent,i=Math.max(r-1,0);n.setCursor(e.indent),e.color=n.chars[i].penState.foreground}var a={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(a)},setBkgData:function(e){d.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},setRollUpRows:function(e){this.nrRollUpRows=e},rollUp:function(){if(null===this.nrRollUpRows)return void d.log("DEBUG","roll_up but nrRollUpRows not set yet");d.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),d.log("INFO","Rolling up")},getDisplayText:function(e){e=e||!1;for(var t=[],n="",i=-1,a=0;a<r;a++){var o=this.rows[a].getTextString();o&&(i=a+1,e?t.push("Row "+i+': "'+o+'"'):t.push(o.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n},getTextAndFormat:function(){return this.rows}};var g=function(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new p,this.nonDisplayedMemory=new p,this.lastOutputScreen=new p,this.currRollUpRow=this.displayedMemory.rows[r-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};g.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[r-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(e){this.outputFilter=e},setPAC:function(e){this.writeScreen.setPAC(e)},setBkgData:function(e){this.writeScreen.setBkgData(e)},setMode:function(e){e!==this.mode&&(this.mode=e,d.log("INFO","MODE="+e),"MODE_POP-ON"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},insertChars:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";d.log("INFO",n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(d.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){d.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){d.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){d.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(e){d.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},cc_FON:function(){d.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){d.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){d.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){d.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){d.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){d.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){d.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(d.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,d.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(e){d.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},cc_MIDROW:function(e){var t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{var n=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[n]}d.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},outputDataUpdate:function(){var e=d.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}};var v=function(e,t,n){this.field=e||1,this.outputs=[t,n],this.channels=[new g(1,t),new g(2,n)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};v.prototype={getHandler:function(e){return this.channels[e].getHandler()},setHandler:function(e,t){this.channels[e].setHandler(t)},addData:function(e,t){var n,r,i,a=!1;this.lastTime=e,d.setTime(e);for(var o=0;o<t.length;o+=2)if(r=127&t[o],i=127&t[o+1],0!==r||0!==i){if(d.log("DATA","["+c([t[o],t[o+1]])+"] -> ("+c([r,i])+")"),n=this.parseCmd(r,i),n||(n=this.parseMidrow(r,i)),n||(n=this.parsePAC(r,i)),n||(n=this.parseBackgroundAttributes(r,i)),!n&&(a=this.parseChars(r,i)))if(this.currChNr&&this.currChNr>=0){var s=this.channels[this.currChNr-1];s.insertChars(a)}else d.log("WARNING","No channel found yet. TEXT-MODE?");n?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,d.log("WARNING","Couldn't parse cleaned data "+c([r,i])+" orig: "+c([t[o],t[o+1]])))}else this.dataCounters.padding+=2},parseCmd:function(e,t){var n=null,r=(20===e||28===e)&&32<=t&&t<=47,i=(23===e||31===e)&&33<=t&&t<=35;if(!r&&!i)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,d.log("DEBUG","Repeated command ("+c([e,t])+") is dropped"),!0;n=20===e||23===e?1:2;var a=this.channels[n-1];return 20===e||28===e?32===t?a.cc_RCL():33===t?a.cc_BS():34===t?a.cc_AOF():35===t?a.cc_AON():36===t?a.cc_DER():37===t?a.cc_RU(2):38===t?a.cc_RU(3):39===t?a.cc_RU(4):40===t?a.cc_FON():41===t?a.cc_RDC():42===t?a.cc_TR():43===t?a.cc_RTD():44===t?a.cc_EDM():45===t?a.cc_CR():46===t?a.cc_ENM():47===t&&a.cc_EOC():a.cc_TO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},parseMidrow:function(e,t){var n=null;if((17===e||25===e)&&32<=t&&t<=47){if(n=17===e?1:2,n!==this.currChNr)return d.log("ERROR","Mismatch channel in midrow parsing"),!1;var r=this.channels[n-1];return r.cc_MIDROW(t),d.log("DEBUG","MIDROW ("+c([e,t])+")"),!0}return!1},parsePAC:function(e,t){var n=null,r=null,i=(17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127,l=(16===e||24===e)&&64<=t&&t<=95;if(!i&&!l)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;n=e<=23?1:2,r=64<=t&&t<=95?1===n?a[e]:s[e]:1===n?o[e]:u[e];var d=this.interpretPAC(r,t),c=this.channels[n-1];return c.setPAC(d),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},interpretPAC:function(e,t){var n=t,r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,r.underline=1===(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r},parseChars:function(e,t){var r=null,i=null,a=null;if(e>=25?(r=2,a=e-8):(r=1,a=e),17<=a&&a<=19){var o=t;o=17===a?t+80:18===a?t+112:t+144,d.log("INFO","Special char '"+n(o)+"' in channel "+r),i=[o]}else 32<=e&&e<=127&&(i=0===t?[e]:[e,t]);if(i){var s=c(i);d.log("DEBUG","Char codes =  "+s.join(",")),this.lastCmdA=null,this.lastCmdB=null}return i},parseBackgroundAttributes:function(e,t){var n,r,i,a,o=(16===e||24===e)&&32<=t&&t<=47,s=(23===e||31===e)&&45<=t&&t<=47;return!(!o&&!s)&&(n={},16===e||24===e?(r=Math.floor((t-32)/2),n.background=l[r],t%2===1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0)),i=e<24?1:2,a=this.channels[i-1],a.setBkgData(n),this.lastCmdA=null,this.lastCmdB=null,!0)},reset:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}};var m=function(e,t,n){for(var r=0,i=t,a=0,o=[],s=function(e,t,n,r){if(4!==e||t<8)return null;var i=n.getUint8(r),a=n.getUint16(r+1),o=n.getUint32(r+3),s=n.getUint8(r+7);return 181==i&&49==a&&1195456820==o&&3==s};i<t+n;){if(r=e.getUint32(i),a=31&e.getUint8(i+4),6===a)for(var u=i+5,l=-1;u<i+4+r-1;){l=0;for(var d=255;255===d;)d=e.getUint8(u),l+=d,u++;var c=0;for(d=255;255===d;)d=e.getUint8(u),c+=d,u++;s(l,c,e,u)&&o.push([u,c]),u+=c}i+=r+4}return o},E=function(e,t){var n=t[0],r=[[],[]];n+=8;var i=31&e.getUint8(n);n+=2;for(var a=0;a<i;a++){var o=e.getUint8(n),s=4&o,u=3&o;n++;var l=e.getUint8(n);n++;var d=e.getUint8(n);n++,s&&(127&l)+(127&d)!==0&&(0===u?(r[0].push(l),r[0].push(d)):1===u&&(r[1].push(l),r[1].push(d)))}return r};e.logger=d,e.PenState=f,e.CaptionScreen=p,e.Cea608Parser=v,e.findCea608Nalus=m,e.extractCea608DataFromRange=E}(t)},function(e,t){"use strict";function n(){return r}Object.defineProperty(t,"__esModule",{value:!0}),t.getVersionString=n;var r="2.4.1"},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="TcpList";t.TCP_CONNECTION=n;var r="HttpList";t.HTTP_REQUEST=r;var i="RepSwitchList";t.TRACK_SWITCH=i;var a="BufferLevel";t.BUFFER_LEVEL=a;var o="BufferState";t.BUFFER_STATE=o;var s="DVRInfo";t.DVR_INFO=s;var u="DroppedFrames";t.DROPPED_FRAMES=u;var l="SchedulingInfo";t.SCHEDULING_INFO=l;var d="RequestsQueue";t.REQUESTS_QUEUE=d;var c="ManifestUpdate";t.MANIFEST_UPDATE=c;var f="ManifestUpdatePeriodInfo";t.MANIFEST_UPDATE_STREAM_INFO=f;var _="ManifestUpdateRepresentationInfo";t.MANIFEST_UPDATE_TRACK_INFO=_;var h="PlayList";t.PLAY_LIST=h;var p="DVBErrors";t.DVB_ERRORS=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(97),s=r(o),u=function(){function e(t,n,r,a,o){var u=this;i(this,e),this._name=t||"",
this._properties=[],this._children=r||[],this._isRoot=a||!1,this._isArray=o||!0,Array.isArray(n)&&n.forEach(function(e){u._properties.push(new s.default(e))})}return a(e,[{key:"name",get:function(){return this._name}},{key:"isRoot",get:function(){return this._isRoot}},{key:"isArray",get:function(){return this._isArray}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){function n(){s=(0,u.default)(a).create(e,t),l=(0,d.default)(a).create(e,t),c=(0,f.default)(a).create(e,t)}function r(e,t,n,r,a){var o,u=e.segmentInfoType;return"SegmentBase"!==u&&"BaseURL"!==u&&i(e,n)?("SegmentTimeline"===u?o=s.getSegments(e,t,n,a):"SegmentTemplate"===u?o=l.getSegments(e,t,n,a):"SegmentList"===u&&(o=c.getSegments(e,t,n,a)),r&&r(e,o)):o=e.segments,o}function i(e,t){var n,r,i=e.segments,a=!1;return i&&0!==i.length?(r=i[0].availabilityIdx,n=i[i.length-1].availabilityIdx,a=t<r||t>n):a=!0,a}var a=this.context,o=void 0,s=void 0,l=void 0,c=void 0;return o={getSegments:r},n(),o}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(107),u=r(s),l=n(106),d=r(l),c=n(105),f=r(c);i.__dashjs_factory_name="SegmentsGetter";var _=o.default.getClassFactory(i);t.default=_,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=1,i=1,a=function e(t,a,o,s){n(this,e),this.url=t||"",this.serviceLocation=a||t||"",this.dvb_priority=o||r,this.dvb_weight=s||i};a.DEFAULT_DVB_PRIORITY=r,a.DEFAULT_DVB_WEIGHT=i,t.default=a,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.schemeIdUri="",this.value=""};t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){hn=!1,pn=!1,gn=!0,En=null,_n=null,Tn=null,ne.default.extend(ie.default),Cn=(0,N.default)(sn).getInstance()}function t(e,t,n){return Dn=(0,y.default)(sn).getInstance(),An=(0,m.default)(sn).getInstance(),Dn.supportsMediaSource()?void(hn||(hn=!0,vn=(0,F.default)(sn).getInstance(),On=(0,u.default)(sn).getInstance(),mn=(0,f.default)(sn).getInstance(),mn.initialize(),bn=(0,_e.default)(sn).getInstance(),Pn=(0,pe.default)(sn).getInstance(),Sn=(0,x.default)(sn).getInstance(),Sn.setConfig({adapter:Qt()}),st(),me(void 0===n||n),e&&Ut(e),t&&jt(t),dn("[dash.js "+W()+"] MediaPlayer has been initialized"))):void An.capabilityError("mediasource")}function n(){return!!wn&&!!fn}function r(){if(!pn)throw nn;(!gn||a()&&pn)&&On.play()}function i(){if(!pn)throw nn;On.pause()}function a(){if(!pn)throw nn;return On.isPaused()}function s(){if(!pn)throw nn;return On.isSeeking()}function l(){if(!pn)throw nn;return On.getIsDynamic()}function c(e){if(!wn)throw rn;xt().muted=e}function _(){if(!wn)throw rn;return xt().muted}function p(e){if(!wn)throw rn;xt().volume=e}function v(){if(!wn)throw rn;return xt().volume}function E(e){var t=["video","audio","fragmentedText"];if(e){if(t.indexOf(e)!==-1){var n=Se().getCurrentBufferLevel(Ce(e));return n?n:NaN}return dn("Warning  - getBufferLength requested for invalid type"),NaN}return t.map(function(e){return Be(e).length>0?Se().getCurrentBufferLevel(Ce(e)):Number.MAX_VALUE}).reduce(function(e,t){return Math.min(e,t)})}function T(){var e=Jt();return e?e.manifestInfo.DVRWindowSize:0}function C(e){var t=Jt();if(!t)return 0;var n=t.range.start+e;return n>t.range.end&&(n=t.range.end),n}function D(e){if(!pn)throw nn;var t=On.getIsDynamic()?C(e):e;On.seek(t)}function R(e){if(!pn)throw nn;var t=xt().currentTime;if(void 0!==e)t=In.getTimeRelativeToStreamId(t,e);else if(On.getIsDynamic()){var n=Jt();t=null===n?0:P()-(n.range.end-n.time)}return t}function P(){if(!pn)throw nn;var e=xt().duration;if(On.getIsDynamic()){var t,n=Jt();if(!n)return 0;t=n.range.end-n.range.start,e=t<n.manifestInfo.DVRWindowSize?t:n.manifestInfo.DVRWindowSize}return e}function w(){if(!pn)throw nn;return R()<0?NaN:$t(R())}function L(){if(!pn)throw nn;return $t(P())}function k(e,t,n){var r=!(arguments.length<=3||void 0===arguments[3])&&arguments[3],i=new Date(1e3*e),a=i.toLocaleDateString(t),o=i.toLocaleTimeString(t,{hour12:n});return r?o+" "+a:o}function U(e){e=Math.max(e,0);var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return(0===t?"":t<10?"0"+t.toString()+":":t.toString()+":")+(n<10?"0"+n.toString():n.toString())+":"+(r<10?"0"+r.toString():r.toString())}function B(e,t,n){oe.default.extend(e,t,n,sn)}function j(e,t,n){un.on(e,t,n)}function K(e,t,n){un.off(e,t,n)}function W(){return(0,se.getVersionString)()}function Y(){return ln}function Q(){if(!wn)throw rn;return wn}function Z(e){Cn.setLiveDelayFragmentCount(e)}function $(e){Cn.setLiveDelay(e)}function te(){return Cn.getLiveDelay()}function re(e){Cn.setUseSuggestedPresentationDelay(e)}function ae(e,t){Cn.setLastBitrateCachingInfo(e,t)}function ue(e,t){Cn.setLastMediaSettingsCachingInfo(e,t)}function de(e,t){vn.setMaxAllowedBitrateFor(e,t)}function fe(e){return vn.getMaxAllowedBitrateFor(e)}function he(e,t){vn.setMaxAllowedRepresentationRatioFor(e,t)}function ge(e){return vn.getMaxAllowedRepresentationRatioFor(e)}function me(e){gn=e}function Ee(){return gn}function ye(e){Cn.setScheduleWhilePaused(e)}function Te(){return Cn.getScheduleWhilePaused()}function Se(){return Pn}function Ce(e){return Sn.getReadOnlyMetricsFor(e)}function Ae(e){if(!pn)throw nn;return vn.getQualityFor(e,In.getActiveStreamInfo())}function De(e,t){if(!pn)throw nn;vn.setPlaybackQuality(e,In.getActiveStreamInfo(),t)}function Ie(){vn.setElementSize(),vn.setWindowResizeEventCalled(!0)}function Re(){return vn.getLimitBitrateByPortal()}function Oe(e){vn.setLimitBitrateByPortal(e)}function Pe(){return vn.getUsePixelRatioInLimitBitrateByPortal()}function be(e){vn.setUsePixelRatioInLimitBitrateByPortal(e)}function we(e){if(!pn)throw nn;void 0===Mn&&(Mn=(0,O.default)(sn).getInstance());for(var t=xt().textTracks,n=t.length,r=0;r<n;r++){var i=t[r],a=e===r?"showing":"hidden";i.mode!==a&&(i.mode=a)}Mn.setTextTrack()}function Me(){var e=NaN;return Mn&&(e=Mn.getCurrentTrackIdx()),e}function Le(e){if(!pn)throw nn;var t=en();return t?t.getBitrateListFor(e):[]}function Ne(e,t){vn.setInitialBitrateFor(e,t)}function ke(e){if(!pn)throw nn;return vn.getInitialBitrateFor(e)}function xe(e,t){vn.setInitialRepresentationRatioFor(e,t)}function Ue(e){return vn.getInitialRepresentationRatioFor(e)}function Fe(e){if(!pn)throw nn;return Tn.getStreamsInfo(e)}function Be(e){if(!pn)throw nn;var t=In.getActiveStreamInfo();return t?mn.getTracksFor(e,t):[]}function He(e,t,n){if(!pn)throw nn;return n=n||Tn.getStreamsInfo(t)[0],n?Tn.getAllMediaInfoForType(t,n,e):[]}function je(e){if(!pn)throw nn;var t=In.getActiveStreamInfo();return t?mn.getCurrentTrackFor(e,t):null}function Ge(e,t){mn.setInitialSettings(e,t)}function Ke(e){return mn.getInitialSettings(e)}function Ve(e){if(!pn)throw nn;mn.setTrack(e)}function We(e){return mn.getSwitchMode(e)}function qe(e,t){mn.setSwitchMode(e,t)}function Ye(e){mn.setSelectionModeForInitialTrack(e)}function ze(){return mn.getSelectionModeForInitialTrack()}function Qe(){return vn.getAutoSwitchBitrateFor("video")||vn.getAutoSwitchBitrateFor("audio")}function Xe(e){return vn.getAverageThroughput(e)}function Ze(e){vn.setAutoSwitchBitrateFor("video",e),vn.setAutoSwitchBitrateFor("audio",e)}function Je(e){return vn.getAutoSwitchBitrateFor(e)}function $e(e,t){vn.setAutoSwitchBitrateFor(e,t)}function et(e){Cn.setFastSwitchEnabled(e)}function tt(){return Cn.getFastSwitchEnabled()}function nt(e){Cn.setBufferOccupancyABREnabled(e)}function rt(e,t){var n=Yt(),r=this,i=function e(i){i.error?t(null,i.error):t(i.manifest),un.off(ne.default.INTERNAL_MANIFEST_LOADED,e,r),n.reset()};un.on(ne.default.INTERNAL_MANIFEST_LOADED,i,r);var a=(0,b.default)(sn).getInstance();a.initialize(),n.load(a.parseURI(e))}function it(e,t){at(e,t);var n=new o.default;n.schemeIdUri=e,n.value=t,Cn.getUTCTimingSources().push(n)}function at(e,t){var n=Cn.getUTCTimingSources();n.forEach(function(r,i){r.schemeIdUri===e&&r.value===t&&n.splice(i,1)})}function ot(){Cn.setUTCTimingSources([])}function st(){it(N.default.DEFAULT_UTC_TIMING_SOURCE.scheme,N.default.DEFAULT_UTC_TIMING_SOURCE.value)}function ut(e){Cn.setUseManifestDateHeaderTimeSource(e)}function lt(e){Cn.setBufferToKeep(e)}function dt(e){Cn.setBufferPruningInterval(e)}function ct(e){Cn.setStableBufferTime(e)}function ft(e){Cn.setBufferTimeAtTopQuality(e)}function _t(e){Cn.setBufferTimeAtTopQualityLongForm(e)}function ht(e){Cn.setLongFormContentDurationThreshold(e)}function pt(e){Cn.setRichBufferThreshold(e)}function gt(e){Cn.setBandwidthSafetyFactor(e)}function vt(){return Cn.getBandwidthSafetyFactor()}function mt(e){Cn.setCacheLoadThresholdLatency(e)}function Et(){return Cn.getCacheLoadThresholdLatency()}function yt(e){Cn.setCacheLoadThresholdVideo(e)}function Tt(){return Cn.getCacheLoadThresholdVideo()}function St(e){Cn.setCacheLoadThresholdAudio(e)}function Ct(){return Cn.getCacheLoadThresholdAudio()}function At(e){Cn.setAbandonLoadTimeout(e)}function Dt(e){Cn.setFragmentRetryAttempts(e)}function It(e){Cn.setFragmentRetryInterval(e)}function Rt(e){Ot(void 0,e)}function Ot(e,t){Cn.setXHRWithCredentialsForType(e,t)}function Pt(e){return Cn.getXHRWithCredentialsForType(e)}function bt(){return Xt()}function wt(e){En=e}function Mt(e){_n=e}function Lt(e){var t=(0,S.default)(sn).getInstance();t.setConfig({videoModel:wn}),t.initialize(),t.displayCConTop(e)}function Nt(){return wn?wn.getVideoContainer():null}function kt(e){if(!wn)throw rn;wn.setVideoContainer(e)}function xt(){if(!wn)throw rn;return wn.getElement()}function Ut(e){if(!hn)throw on;wn=null,e&&(wn=(0,V.default)(sn).getInstance(),wn.initialize(),wn.setElement(e),Xt(),Zt()),Wt()}function Ft(){return wn?wn.getTTMLRenderingDiv():null}function Bt(e){if(!wn)throw rn;wn.setTTMLRenderingDiv(e)}function Ht(){if(!fn)throw an;return fn}function jt(e){if(!hn)throw on;if("string"==typeof e){var t=(0,b.default)(sn).getInstance();t.initialize(),fn=t.parseURI(e)}else fn=e;Wt()}function Gt(){return vn.getUseDeadTimeLatency()}function Kt(e){vn.setUseDeadTimeLatency(e)}function Vt(){jt(null),Ut(null),_n=null,En=null}function Wt(){pn?(pn=!1,Tn.reset(),In.reset(),On.reset(),vn.reset(),Rn.reset(),mn.reset(),In=null,yn=null,n()&&tn()):n()&&tn()}function qt(){var e=(0,G.default)(sn).getInstance();e.initialize();var t=(0,A.default)(sn).getInstance();t.setConfig({dashManifestModel:bn}),mn.initialize(),mn.setConfig({errHandler:An}),Rn=(0,q.default)(sn).getInstance(),Rn.initialize(),Rn.setConfig({abrRulesCollection:e}),In=(0,d.default)(sn).getInstance(),In.setConfig({capabilities:Dn,manifestLoader:Yt(),manifestModel:(0,M.default)(sn).getInstance(),dashManifestModel:bn,protectionController:En,adapter:Tn,metricsModel:Sn,dashMetrics:Pn,liveEdgeFinder:(0,g.default)(sn).getInstance(),mediaSourceController:(0,z.default)(sn).getInstance(),timeSyncController:(0,H.default)(sn).getInstance(),baseURLController:(0,X.default)(sn).getInstance(),errHandler:An,timelineConverter:(0,ve.default)(sn).getInstance()}),In.initialize(gn,_n),vn.setConfig({abrRulesCollection:e,rulesController:Rn,streamController:In})}function Yt(){return(0,h.default)(sn).create({errHandler:An,parser:zt(),metricsModel:Sn,requestModifier:(0,I.default)(sn).getInstance()})}function zt(){return(0,ce.default)(sn).create()}function Qt(){return Tn=(0,le.default)(sn).getInstance(),Tn.initialize(),Tn.setConfig({dashManifestModel:bn}),Tn}function Xt(){if(En)return En;var e=dashjs.Protection;if("function"==typeof e){var t=e(sn).create();return ne.default.extend(e.events),ie.default.extend(e.events,{publicOnly:!0}),En=t.createProtectionSystem({log:dn,videoModel:wn,capabilities:Dn,eventBus:un,adapter:Tn})}return null}function Zt(){if(yn)return yn;var e=dashjs.MetricsReporting;if("function"==typeof e){var t=e(sn).create();return yn=t.createMetricsReporting({log:dn,eventBus:un,mediaElement:xt(),dashManifestModel:bn,metricsModel:Sn})}return null}function Jt(){var e=Sn.getReadOnlyMetricsFor("video")||Sn.getReadOnlyMetricsFor("audio");return Pn.getCurrentDVRInfo(e)}function $t(e){var t,n,r=Jt();return r?(t=r.manifestInfo.availableFrom.getTime()/1e3,n=e+(t+r.range.start)):0}function en(){if(!pn)throw nn;var e=In.getActiveStreamInfo();return e?In.getStreamById(e.id):null}function tn(){pn||(pn=!0,dn("Playback Initialized"),qt(),"string"==typeof fn?In.load(fn):In.loadWithManifest(fn))}var nn="You must first call play() to init playback before calling this method",rn="You must first call attachView() to set the video element before calling this method",an="You must first call attachSource() with a valid source before calling this method",on="MediaPlayer not initialized!",sn=this.context,un=(0,ee.default)(sn).getInstance(),ln=(0,J.default)(sn).getInstance(),dn=ln.log,cn=void 0,fn=void 0,_n=void 0,hn=void 0,pn=void 0,gn=void 0,vn=void 0,mn=void 0,En=void 0,yn=void 0,Tn=void 0,Sn=void 0,Cn=void 0,An=void 0,Dn=void 0,In=void 0,Rn=void 0,On=void 0,Pn=void 0,bn=void 0,wn=void 0,Mn=void 0;return cn={initialize:t,on:j,off:K,extend:B,attachView:Ut,attachSource:jt,isReady:n,play:r,isPaused:a,pause:i,isSeeking:s,isDynamic:l,seek:D,setMute:c,isMuted:_,setVolume:p,getVolume:v,time:R,duration:P,timeAsUTC:w,durationAsUTC:L,getActiveStream:en,getDVRWindowSize:T,getDVRSeekOffset:C,convertToTimeCode:U,formatUTC:k,getVersion:W,getDebug:Y,getBufferLength:E,getVideoModel:Q,getVideoContainer:Nt,getTTMLRenderingDiv:Ft,getVideoElement:xt,getSource:Ht,setLiveDelayFragmentCount:Z,setLiveDelay:$,getLiveDelay:te,useSuggestedPresentationDelay:re,enableLastBitrateCaching:ae,enableLastMediaSettingsCaching:ue,setMaxAllowedBitrateFor:de,getMaxAllowedBitrateFor:fe,setMaxAllowedRepresentationRatioFor:he,getMaxAllowedRepresentationRatioFor:ge,setAutoPlay:me,getAutoPlay:Ee,setScheduleWhilePaused:ye,getScheduleWhilePaused:Te,getDashMetrics:Se,getMetricsFor:Ce,getQualityFor:Ae,setQualityFor:De,updatePortalSize:Ie,getLimitBitrateByPortal:Re,setLimitBitrateByPortal:Oe,getUsePixelRatioInLimitBitrateByPortal:Pe,setUsePixelRatioInLimitBitrateByPortal:be,setTextTrack:we,getBitrateInfoListFor:Le,setInitialBitrateFor:Ne,getInitialBitrateFor:ke,setInitialRepresentationRatioFor:xe,getInitialRepresentationRatioFor:Ue,getStreamsFromManifest:Fe,getTracksFor:Be,getTracksForTypeFromManifest:He,getCurrentTrackFor:je,setInitialMediaSettingsFor:Ge,getInitialMediaSettingsFor:Ke,setCurrentTrack:Ve,getTrackSwitchModeFor:We,setTrackSwitchModeFor:qe,setSelectionModeForInitialTrack:Ye,getSelectionModeForInitialTrack:ze,getAutoSwitchQuality:Qe,setAutoSwitchQuality:Ze,setFastSwitchEnabled:et,getFastSwitchEnabled:tt,getAutoSwitchQualityFor:Je,setAutoSwitchQualityFor:$e,getAverageThroughput:Xe,enableBufferOccupancyABR:nt,setBandwidthSafetyFactor:gt,getBandwidthSafetyFactor:vt,setCacheLoadThresholdLatency:mt,getCacheLoadThresholdLatency:Et,setCacheLoadThresholdVideo:yt,getCacheLoadThresholdVideo:Tt,setCacheLoadThresholdAudio:St,getCacheLoadThresholdAudio:Ct,setAbandonLoadTimeout:At,retrieveManifest:rt,addUTCTimingSource:it,removeUTCTimingSource:at,clearDefaultUTCTimingSources:ot,restoreDefaultUTCTimingSources:st,setBufferToKeep:lt,setBufferPruningInterval:dt,setStableBufferTime:ct,setBufferTimeAtTopQuality:ft,setFragmentLoaderRetryAttempts:Dt,setFragmentLoaderRetryInterval:It,setXHRWithCredentials:Rt,setXHRWithCredentialsForType:Ot,getXHRWithCredentialsForType:Pt,setBufferTimeAtTopQualityLongForm:_t,setLongFormContentDurationThreshold:ht,setRichBufferThreshold:pt,getProtectionController:bt,attachProtectionController:wt,setProtectionData:Mt,enableManifestDateHeaderTimeSource:ut,displayCaptionsOnTop:Lt,attachVideoContainer:kt,attachTTMLRenderingDiv:Bt,getCurrentTextTrackIndex:Me,getUseDeadTimeLatencyForAbr:Gt,setUseDeadTimeLatencyForAbr:Kt,reset:Vt},e(),cn}Object.defineProperty(t,"__esModule",{value:!0});var a=n(59),o=r(a),s=n(9),u=r(s),l=n(24),d=r(l),c=n(15),f=r(c),_=n(113),h=r(_),p=n(51),g=r(p),v=n(11),m=r(v),E=n(174),y=r(E),T=n(42),S=r(T),C=n(30),A=r(C),D=n(35),I=r(D),R=n(16),O=r(R),P=n(43),b=r(P),w=n(33),M=r(w),L=n(5),N=r(L),k=n(10),x=r(k),U=n(14),F=r(U),B=n(126),H=r(B),j=n(69),G=r(j),K=n(18),V=r(K),W=n(68),q=r(W),Y=n(123),z=r(Y),Q=n(119),X=r(Q),Z=n(4),J=r(Z),$=n(3),ee=r($),te=n(2),ne=r(te),re=n(22),ie=r(re),ae=n(1),oe=r(ae),se=n(53),ue=n(21),le=r(ue),de=n(96),ce=r(de),fe=n(13),_e=r(fe),he=n(12),pe=r(he),ge=n(39),ve=r(ge);i.__dashjs_factory_name="MediaPlayer";var me=oe.default.getClassFactory(i);me.events=ie.default,t.default=me,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(t,n){var r,i=t.match(o);if(i){try{r=l[i[1]](s).create({eventBus:e.eventBus}),r.initialize(i[1],n,i[3],i[5])}catch(e){r=null,a("MetricsHandlerFactory: Could not create handler for type "+i[1]+" with args "+i[3]+", "+i[5]+" ("+e.message+")")}return r}}function n(e,t){l[e]=t}function r(e){delete l[e]}var i=void 0,a=e.log,o=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,s=this.context,l={BufferLevel:u.default,DVBErrors:d.default,HttpList:f.default,PlayList:h.default,RepSwitchList:h.default,TcpList:h.default};return i={create:t,register:n,unregister:r}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(134),u=r(s),l=n(135),d=r(l),c=n(137),f=r(c),_=n(136),h=r(_);i.__dashjs_factory_name="MetricsHandlerFactory",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t){var n;try{n=i[e.schemeIdUri](a).create(),n.initialize(e,t)}catch(t){n=null,o("ReportingFactory: could not create Reporting with schemeIdUri "+e.schemeIdUri+" ("+t.message+")")}return n}function n(e,t){i[e]=t}function r(e){delete i[e]}var i={"urn:dvb:dash:reporting:2014":u.default},a=this.context,o=e.log,s=void 0;return s={create:t,register:n,unregister:r}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(138),u=r(s);i.__dashjs_factory_name="ReportingFactory",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){return{reconstructFullMetricName:function(e,t,n){var r=e;return t&&(r+="("+t,n&&n.length&&(r+=","+n),r+=")"),r},validateN:function(e){if(!e)throw new Error("missing n");if(isNaN(e))throw new Error("n is NaN");if(e<0)throw new Error("n must be positive");return e}}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="HandlerHelpers",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){var n=null,r=(0,u.default)(i).getInstance();r.setConfig({log:e.log}),r.initialize();var a=t(e);return!n&&a&&(n=(0,o.default)(i).create({protectionModel:a,protectionKeyController:r,adapter:e.adapter,eventBus:e.eventBus,log:e.log}),e.capabilities.setEncryptedMediaSupported(!0)),n}function t(e){var t=e.log,r=e.eventBus,a=e.videoModel.getElement();return void 0!==a.onencrypted&&void 0!==a.mediaKeys&&void 0!==navigator.requestMediaKeySystemAccess&&"function"==typeof navigator.requestMediaKeySystemAccess?(t("EME detected on this user agent! (ProtectionModel_21Jan2015)"),(0,f.default)(i).create({log:t,eventBus:r})):n(a,y)?(t("EME detected on this user agent! (ProtectionModel_3Feb2014)"),(0,h.default)(i).create({log:t,eventBus:r,api:n(a,y)})):n(a,E)?(t("EME detected on this user agent! (ProtectionModel_01b)"),(0,g.default)(i).create({log:t,eventBus:r,api:n(a,E)})):(t("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null)}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];if("function"==typeof e[r[Object.keys(r)[0]]])return r}return null}var r=void 0,i=this.context;return r={createProtectionSystem:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(149),o=r(a),s=n(34),u=r(s),l=n(148),d=r(l),c=n(154),f=r(c),_=n(155),h=r(_),p=n(153),g=r(p),v=n(1),m=r(v),E=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],y=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];i.__dashjs_factory_name="Protection";var T=m.default.getClassFactory(i);T.events=d.default,t.default=T,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,r){if(n(this,e),r&&"persistent"!==r&&"temporary"!==r)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=t,this.type=r}return r(e,[{key:"toJWK",value:function(){var e,t=this.keyPairs.length,n={keys:[]};for(e=0;e<t;e++){var r={kty:"oct",alg:"A128KW",kid:this.keyPairs[e].keyID,k:this.keyPairs[e].key};n.keys.push(r)}this.type&&(n.type=this.type);var i=JSON.stringify(n),a=i.length,o=new ArrayBuffer(a),s=new Uint8Array(o);for(e=0;e<a;e++)s[e]=i.charCodeAt(e);return o}}]),e}();t.default=i,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t,r){n(this,e),this.keyID=t,this.key=r};t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){return _.mediaInfo.streamInfo}function n(){return _.mediaInfo}function r(){return _}function i(){return p}function a(){return _.mediaInfo.streamInfo.manifestInfo}function o(){return h}function s(){return g}function u(){return v}function l(){return m}function d(){return E}function c(){return y}var f=void 0,_=e.streamProcessor.getCurrentRepresentationInfo(),h=e.streamProcessor,p=e.currentValue,g=e.playbackIndex,v=e.switchHistory,m=e.droppedFramesHistory,E=e.currentRequest,y=e.hasRichBuffer;return f={getCurrentValue:i,getManifestInfo:a,getMediaInfo:n,getPlaybackIndex:s,getDroppedFramesHistory:l,getCurrentRequest:d,getSwitchHistory:u,getStreamInfo:t,getStreamProcessor:o,getTrackInfo:r,hasRichBuffer:c}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="RulesContext",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){l={}}function t(e){e&&e.abrRulesCollection&&(l[_]=e.abrRulesCollection)}function n(e,t,n,r,a,o){var s,l,d={},c={},f=e.length,_=f,h=i(t,r),p=function(e){var t,i,a;if(e.value!==u.default.NO_CHANGE){var s=o(d[e.priority],e.value);s!==d[e.priority]&&(d[e.priority]=s,c[e.priority]=e.reason)}--f||(d[u.default.WEAK]!==u.default.NO_CHANGE&&(a=u.default.WEAK,t=d[u.default.WEAK],i=c[u.default.WEAK]),d[u.default.DEFAULT]!==u.default.NO_CHANGE&&(a=u.default.DEFAULT,t=d[u.default.DEFAULT],i=c[u.default.DEFAULT]),d[u.default.STRONG]!==u.default.NO_CHANGE&&(a=u.default.STRONG,t=d[u.default.STRONG],i=c[u.default.STRONG]),a!=u.default.STRONG&&a!=u.default.WEAK&&(a=u.default.DEFAULT),n(void 0!==t?{value:t,confidence:a,reason:i}:{value:r,confidence:a,reason:{name:"NO_CHANGE"}}))};for(d[u.default.STRONG]=u.default.NO_CHANGE,d[u.default.WEAK]=u.default.NO_CHANGE,d[u.default.DEFAULT]=u.default.NO_CHANGE,l=0;l<_;l++)s=e[l],s.execute(h,p)}function r(){var e,t,n=l[_],r=(n.getRules(d.default.QUALITY_SWITCH_RULES)||[]).concat(n.getRules(d.default.ABANDON_FRAGMENT_RULES)||[]),i=r.length;for(t=0;t<i;t++)e=r[t],"function"==typeof e.reset&&e.reset();l={}}function i(e,t){return(0,o.default)(a).create({streamProcessor:e,currentValue:t})}var a=this.context,s=void 0,l=void 0;return s={initialize:e,setConfig:t,applyRules:n,reset:r}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(67),o=r(a),s=n(7),u=r(s),l=n(69),d=r(l),c=n(1),f=r(c),_=0;i.__dashjs_factory_name="RulesController";var h=f.default.getSingletonFactory(i);h.ABR_RULE=_,t.default=h,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){c=[],_=[];var e=(0,S.default)(s).getInstance(),t=(0,A.default)(s).getInstance(),n=(0,y.default)(s).getInstance();n.getBufferOccupancyABREnabled()?(c.push((0,g.default)(s).create({metricsModel:e,dashMetrics:(0,A.default)(s).getInstance()})),_.push((0,m.default)(s).create({metricsModel:e,dashMetrics:(0,A.default)(s).getInstance()}))):(c.push((0,o.default)(s).create({metricsModel:e,dashMetrics:t})),c.push((0,u.default)(s).create({metricsModel:e})),c.push((0,h.default)(s).create()),c.push((0,f.default)(s).create()),_.push((0,d.default)(s).create()))}function t(e){switch(e){case P:return c;case b:return _;default:return null}}function n(e){return e.filter(function(e){return e.value>O.default.NO_CHANGE})}function r(e){if(0!==e.length)return e.reduce(function(e,t){return e.value<t.value?e:t})}function i(e){var t=c.map(function(t){return t.getMaxIndex(e)}),i=n(t),a=r(i);return a||(0,O.default)(s).create()}function a(e){var t=_.map(function(t){return t.shouldAbandon(e)}),i=n(t),a=r(i);return a||(0,O.default)(s).create()}var s=this.context,l=void 0,c=void 0,_=void 0;return l={initialize:e,getRules:t,getMaxQuality:i,shouldAbandonFragment:a}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(168),o=r(a),s=n(166),u=r(s),l=n(163),d=r(l),c=n(165),f=r(c),_=n(167),h=r(_),p=n(70),g=r(p),v=n(164),m=r(v),E=n(5),y=r(E),T=n(10),S=r(T),C=n(12),A=r(C),D=n(1),I=r(D),R=n(7),O=r(R),P="qualitySwitchRules",b="abandonFragmentRules";i.__dashjs_factory_name="ABRRulesCollection";var w=I.default.getSingletonFactory(i);w.QUALITY_SWITCH_RULES=P,w.ABANDON_FRAGMENT_RULES=b,t.default=w,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){H={},j={},G={},K=[],V=(0,d.default)(N).getInstance(),W=(0,f.default)(N).getInstance(),q=(0,p.default)(N).getInstance(),F.on(E.default.BUFFER_EMPTY,g,B),F.on(E.default.PLAYBACK_SEEKING,m,B),F.on(E.default.PERIOD_SWITCH_STARTED,y,B),F.on(E.default.MEDIA_FRAGMENT_LOADED,P,B)}function n(e){return e.map(function(e){return Math.log(e)})}function r(e,t,r,i){var a=NaN;if(i?(a=0,i.forEach(function(e,t){e>i[a]&&(a=t)})):(i=n(r),a=i.length-1),0===a)return null;var o=1-i[0]+(i[a]-i[0])/(t/e-1),s=e/(i[0]+o-1);return{utilities:i,gp:o,Vp:s}}function a(e){var t={},n=e.getMediaInfo(),i=e.getStreamProcessor(),a=e.getStreamInfo(),o=e.getTrackInfo(),s=i.isDynamic(),u=a.manifestInfo.duration,l=o.fragmentDuration,d=n.bitrateList.map(function(e){return e.bandwidth}),c=r(I,R,d,null);if(null===c)return t.state=S,t;if(t.state=C,t.bitrates=d,t.utilities=c.utilities,t.Vp=c.Vp,t.gp=c.gp,t.isDynamic=s,t.movieDuration=u,t.fragmentDuration=l,t.bandwidthSafetyFactor=V.getBandwidthSafetyFactor(),t.rebufferSafetyFactor=O,t.bufferTarget=V.getStableBufferTime(),t.lastQuality=0,t.placeholderBuffer=0,t.throughputCount=s?M:L,D){for(var f="",_=0;_<d.length;++_){var h=c.utilities[_],p=d[_],g=0;if(_>0){var v=c.utilities[_-1],m=d[_-1];g=c.Vp*((v*p-h*m)/(p-m)+c.gp)}var E=c.Vp*(h+c.gp);f+="\n"+_+":"+(1e-6*d[_]).toFixed(3)+"Mbps "+g.toFixed(3)+"/"+E.toFixed(3)}k("BolaDebug "+n.type+" bitrates"+f)}return t}function s(e,t){for(var n=e.bitrates.length,r=NaN,i=NaN,a=0;a<n;++a){var o=(e.Vp*(e.utilities[a]+e.gp)-t)/e.bitrates[a];(isNaN(i)||o>=i)&&(i=o,r=a)}return r}function u(e,t){for(var n=x.getHttpRequests(e),r=[],i=n.length-1;i>=0&&r.length<t;--i){var a=n[i];a.type===_.HTTPRequest.MEDIA_SEGMENT_TYPE&&a._tfinish&&a.tresponse&&a.trace&&r.push(a)}return r}function l(e,t,n){var r=u(e,t);if(0===r.length)return 0;for(var i=0,a="",o=0;o<r.length;++o){var s=.001*(r[o]._tfinish.getTime()-r[o].trequest.getTime()),l=8*r[o].trace.reduce(function(e,t){return e+t.b[0]},0);D&&(a+=" "+(1e-6*l).toFixed(3)+"/"+s.toFixed(3)+"="+(1e-6*l/s).toFixed(3)+"Mbps"),i+=s/l}return D&&k("BolaDebug "+n+" BolaRule recent throughput = "+(r.length/(1e6*i)).toFixed(3)+"Mbps:"+a),r.length/i}function c(e,t){var n=0;return e.bitrates.some(function(e,r){return e>t||(n=r,!1)}),n}function h(e,t){var n=Date.now(),r=H[t],i=G[t],a=NaN;if(H[t]=n,G[t]=!1,!i){var o=u(e,1);o.length>0&&(a=o[0]._tfinish.getTime(),a>n&&(a=n))}var s=0;return s=i||r>a?n-r:n-a,isNaN(s)||s<=0?0:.001*s}function g(){D&&k("BolaDebug BUFFER_EMPTY"),K.forEach(function(e){var t=U.getReadOnlyMetricsFor(e);if(0!==t.BolaState.length){var n=t.BolaState[0]._s;n.state===A&&(n.placeholderBuffer=0,U.updateBolaState(e,n))}})}function m(e){D&&k("BolaDebug PLAYBACK_SEEKING "+e.seekTime.toFixed(3)),K.forEach(function(e){var t=U.getReadOnlyMetricsFor(e);if(0!==t.BolaState.length){var n=t.BolaState[0]._s;n.state!==S&&(n.state=C),U.updateBolaState(e,n)}}),j={},G={}}function y(){}function P(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=e.chunk.mediaInfo.type,n=e.chunk.start;void 0===t||isNaN(n)||(n<=j[t]?G[t]=!0:(G[t]=!1,j[t]=n))}}function b(e){var t=e.getStreamProcessor();t.getScheduleController().setTimeToLoadDelay(0);var n=(0,o.default)(N).create(o.default.NO_CHANGE,{name:i.__dashjs_factory_name}),r=e.getMediaInfo(),u=r.type,d=U.getReadOnlyMetricsFor(u);if(0===d.BolaState.length){D&&k("BolaDebug "+u+"\nBolaDebug "+u+" BolaRule for state=- fragmentStart="+q.getIndexHandlerTime(e.getStreamProcessor()).toFixed(3));var f=a(e);U.updateBolaState(u,f);var _=0;if(f.state!==S){K.push(u);var p=l(d,f.throughputCount,u);if(0===p)return D&&k("BolaDebug "+u+" BolaRule quality unchanged for INITIALIZE"),n;_=c(f,p*f.bandwidthSafetyFactor),f.lastQuality=_,n.value=_,n.reason.state=f.state,n.reason.throughput=p}return D&&k("BolaDebug "+u+" BolaRule quality "+_+" for INITIALIZE"),n}var g=d.BolaState[0]._s;if(g.state===S)return D&&k("BolaDebug "+u+" BolaRule quality 0 for ONE_BITRATE"),n;var v=g.bitrates,m=g.utilities;D&&k("BolaDebug "+u+"\nBolaDebug "+u+" EXECUTE BolaRule for state="+g.state+" fragmentStart="+q.getIndexHandlerTime(e.getStreamProcessor()).toFixed(3));var E=x.getCurrentBufferLevel(d)?x.getCurrentBufferLevel(d):0,y=l(d,g.throughputCount,u);E<=.1&&(g.placeholderBuffer=0);var T=h(d,u);T>0&&(g.placeholderBuffer+=T),g.placeholderBuffer<0&&(g.placeholderBuffer=0);var I=E+g.placeholderBuffer,R=s(g,I);if(D&&k("BolaDebug "+u+" BolaRule bufferLevel="+E.toFixed(3)+"(+"+g.placeholderBuffer.toFixed(3)+"="+I.toFixed(3)+") recentThroughput="+(1e-6*y).toFixed(3)+" tentativeQuality="+R),g.state===C){var _=c(g,y*g.bandwidthSafetyFactor);if(E>g.fragmentDuration/O){g.state=A;for(var P=0,b=0;b<_;++b){var w=g.Vp*(g.gp+(v[_]*m[b]-v[b]*m[_])/(v[_]-v[b]));w>P&&(P=w)}P>E&&(g.placeholderBuffer=P-E)}
return D&&k("BolaDebug "+u+" BolaRule quality "+_+" for STARTUP"),g.lastQuality=_,U.updateBolaState(u,g),n.value=_,n.reason.state=C,n.reason.throughput=y,n}if(R>g.lastQuality){var _=c(g,y);R>_&&(_<g.lastQuality&&(_=g.lastQuality),R=_)}if(y>0)for(var M=O*y*E/g.fragmentDuration;R>0&&v[R]>M;)--R;var L=0,F=g.Vp*(m[R]+g.gp);return L=I-F,L>0&&(L>g.placeholderBuffer?(L-=g.placeholderBuffer,g.placeholderBuffer=0):(g.placeholderBuffer-=L,L=0)),L>0?R===v.length-1?L=0:t.getScheduleController().setTimeToLoadDelay(1e3*L):L=0,g.lastQuality=R,U.updateBolaState(u,g),n.value=R,n.reason.state=g.state,n.reason.throughput=y,n.reason.bufferLevel=E,D&&k("BolaDebug "+u+" BolaRule quality "+R+" delay="+L.toFixed(3)+" for STEADY"),n}function w(){F.off(E.default.BUFFER_EMPTY,g,B),F.off(E.default.PLAYBACK_SEEKING,m,B),F.off(E.default.PERIOD_SWITCH_STARTED,y,B),F.off(E.default.MEDIA_FRAGMENT_LOADED,P,B),t()}var M=2,L=3,N=this.context,k=(0,T.default)(N).getInstance().log,x=e.dashMetrics,U=e.metricsModel,F=(0,v.default)(N).getInstance(),B=void 0,H=void 0,j=void 0,G=void 0,K=void 0,V=void 0,W=void 0,q=void 0;return B={getMaxIndex:b,reset:w},t(),B}Object.defineProperty(t,"__esModule",{value:!0});var a=n(7),o=r(a),s=n(1),u=r(s),l=n(5),d=r(l),c=n(9),f=r(c),_=n(6),h=n(21),p=r(h),g=n(3),v=r(g),m=n(2),E=r(m),y=n(4),T=r(y),S=0,C=1,A=2,D=!1,I=10,R=30,O=.5;i.__dashjs_factory_name="BolaRule";var P=u.default.getClassFactory(i);P.BOLA_STATE_ONE_BITRATE=S,P.BOLA_STATE_STARTUP=C,P.BOLA_STATE_STEADY=A,P.BOLA_DEBUG=D,t.default=P,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){var n=0;for(n=0;n<this.customTimeRangeArray.length&&e>this.customTimeRangeArray[n].start;n++);for(this.customTimeRangeArray.splice(n,0,{start:e,end:t}),n=0;n<this.customTimeRangeArray.length-1;n++)this.mergeRanges(n,n+1)&&n--;this.length=this.customTimeRangeArray.length}function t(){this.customTimeRangeArray=[],this.length=0}function n(e,t){for(var n=0;n<this.customTimeRangeArray.length;n++)if(e<=this.customTimeRangeArray[n].start&&t>=this.customTimeRangeArray[n].end)this.customTimeRangeArray.splice(n,1),n--;else{if(e>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end){this.customTimeRangeArray.splice(n+1,0,{start:t,end:this.customTimeRangeArray[n].end}),this.customTimeRangeArray[n].end=e;break}e>this.customTimeRangeArray[n].start&&e<this.customTimeRangeArray[n].end?this.customTimeRangeArray[n].end=e:t>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end&&(this.customTimeRangeArray[n].start=t)}this.length=this.customTimeRangeArray.length}function r(e,t){var n=this.customTimeRangeArray[e],r=this.customTimeRangeArray[t];return n.start<=r.start&&r.start<=n.end&&n.end<=r.end?(n.end=r.end,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&r.end<=n.end?(n.start=r.start,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&n.end<=r.end?(this.customTimeRangeArray.splice(e,1),!0):n.start<=r.start&&r.start<=n.end&&r.end<=n.end&&(this.customTimeRangeArray.splice(t,1),!0)}function i(e){return this.customTimeRangeArray[e].start}function a(e){return this.customTimeRangeArray[e].end}var o=[],s=0;return{customTimeRangeArray:o,length:s,add:e,clear:t,remove:n,mergeRanges:r,start:i,end:a}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="CustomTimeRanges",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){var t=e.streamId,n=e.mediaInfo.type,i=e.quality;r[t]=r[t]||{},r[t][n]=r[t][n]||{},r[t][n][i]=e}function t(e,t,n){return r[e][t][n]}function n(){r={}}var r={},i={save:e,extract:t,reset:n};return i}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="InitCache",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}},s=n(19),u=r(s),l=function(e){function t(e,n){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.url=e||null,this.type=n||null,this.mediaType="stream",this.responseType="text"}return a(t,e),t}(u.default);t.default=l,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};r.INITIAL_PLAYOUT_START_REASON="initial_playout",r.SEEK_START_REASON="seek",r.RESUME_FROM_PAUSE_START_REASON="resume",r.METRICS_COLLECTION_START_REASON="metrics_collection_start";var i=function e(){n(this,e),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};i.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",i.REBUFFERING_REASON="rebuffering",i.USER_REQUEST_STOP_REASON="user_request",i.END_OF_PERIOD_STOP_REASON="end_of_period",i.END_OF_CONTENT_STOP_REASON="end_of_content",i.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",i.FAILURE_STOP_REASON="failure",t.PlayList=r,t.PlayListTrace=i},function(e,t,n){var r={};r.parseBuffer=function(e){return new i(e).parse()},r.addBoxParser=function(e,t){"string"==typeof e&&"function"==typeof t&&(a.prototype._boxParsers[e]=t)},r.Utils={},r.Utils.dataViewToString=function(e,t){var n=t||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(n).decode(e);var r=[],i=0;if("utf-8"===n)for(;i<e.byteLength;){var a=e.getUint8(i++);a<128||(a<224?(a=(31&a)<<6,a|=63&e.getUint8(i++)):a<240?(a=(15&a)<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++)):(a=(7&a)<<18,a|=(63&e.getUint8(i++))<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++))),r.push(String.fromCharCode(a))}else for(;i<e.byteLength;)r.push(String.fromCharCode(e.getUint8(i++)));return r.join("")},t.parseBuffer=r.parseBuffer,t.addBoxParser=r.addBoxParser,t.Utils=r.Utils,r.Cursor=function(e){this.offset="undefined"==typeof e?0:e};var i=function(e){this._raw=new DataView(e),this._cursor=new r.Cursor,this.boxes=[]};i.prototype.fetch=function(e){var t=this.fetchAll(e,!0);return t.length?t[0]:null},i.prototype.fetchAll=function(e,t){var n=[];return i._sweep.call(this,e,n,t),n},i.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var e=a.parse(this);if("undefined"==typeof e.type)break;this.boxes.push(e)}return this},i._sweep=function(e,t,n){this.type&&this.type==e&&t.push(this);for(var r in this.boxes){if(t.length&&n)return;i._sweep.call(this.boxes[r],e,t,n)}};var a=function(){this._cursor=new r.Cursor};a.parse=function(e){var t=new a;return t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,t._parseBox(),e._cursor.offset=t._raw.byteOffset+t._raw.byteLength,t},a.prototype._readInt=function(e){var t=null;switch(e){case 8:t=this._raw.getInt8(this._cursor.offset-this._raw.byteOffset);break;case 16:t=this._raw.getInt16(this._cursor.offset-this._raw.byteOffset);break;case 32:t=this._raw.getInt32(this._cursor.offset-this._raw.byteOffset);break;case 64:var n=this._raw.getInt32(this._cursor.offset-this._raw.byteOffset),r=this._raw.getInt32(this._cursor.offset-this._raw.byteOffset+4);t=n*Math.pow(2,32)+r}return this._cursor.offset+=e>>3,t},a.prototype._readUint=function(e){var t=null;switch(e){case 8:t=this._raw.getUint8(this._cursor.offset-this._raw.byteOffset);break;case 16:t=this._raw.getUint16(this._cursor.offset-this._raw.byteOffset);break;case 24:var n=this._raw.getUint16(this._cursor.offset-this._raw.byteOffset),r=this._raw.getUint8(this._cursor.offset-this._raw.byteOffset+2);t=(n<<8)+r;break;case 32:t=this._raw.getUint32(this._cursor.offset-this._raw.byteOffset);break;case 64:var n=this._raw.getUint32(this._cursor.offset-this._raw.byteOffset),r=this._raw.getUint32(this._cursor.offset-this._raw.byteOffset+4);t=n*Math.pow(2,32)+r}return this._cursor.offset+=e>>3,t},a.prototype._readString=function(e){for(var t="",n=0;n<e;n++){var r=this._readUint(8);t+=String.fromCharCode(r)}return t},a.prototype._readTerminatedString=function(){for(var e="";this._cursor.offset-this._offset<this._raw.byteLength;){var t=this._readUint(8);if(0==t)break;e+=String.fromCharCode(t)}return e},a.prototype._readTemplate=function(e){var t=this._readUint(e/2),n=this._readUint(e/2);return t+n/Math.pow(2,e/2)},a.prototype._parseBox=function(){if(this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)return void(this._root._incomplete=!0);switch(this.size=this._readUint(32),this.type=this._readString(4),1==this.size&&(this.largesize=this._readUint(64)),"uuid"==this.type&&(this.usertype=this._readString(16)),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}!this._incomplete&&this._boxParsers[this.type]&&this._boxParsers[this.type].call(this)},a.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},a.prototype._boxParsers={},a.prototype._boxParsers.avc1=function(){this.version=this._readUint(16),this.revision_level=this._readUint(16),this.vendor=this._readUint(32),this.temporal_quality=this._readUint(32),this.spatial_quality=this._readUint(32),this.width=this._readUint(16),this.height=this._readUint(16),this.horizontal_resolution=this._readUint(32),this.vertical_resolution=this._readUint(32),this.data_size=this._readUint(32),this.frame_count=this._readUint(16),this.compressor_name=this._readUint(32),this.depth=this._readUint(16),this.color_table_id=this._readUint(16)},["moov","trak","tref","mdia","minf","stbl","edts","dinf","mvex","moof","traf","mfra","udta","meco","strk","vttc"].forEach(function(e){a.prototype._boxParsers[e]=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(a.parse(this))}}),a.prototype._boxParsers.elst=function(){this._parseFullBox(),this.entry_count=this._readUint(32),this.entries=[];for(var e=1;e<=this.entry_count;e++){var t={};1==this.version?(t.segment_duration=this._readUint(64),t.media_time=this._readInt(64)):(t.segment_duration=this._readUint(32),t.media_time=this._readInt(32)),t.media_rate_integer=this._readInt(16),t.media_rate_fraction=this._readInt(16),this.entries.push(t)}},a.prototype._boxParsers.emsg=function(){this._parseFullBox(),this.scheme_id_uri=this._readTerminatedString(),this.value=this._readTerminatedString(),this.timescale=this._readUint(32),this.presentation_time_delta=this._readUint(32),this.event_duration=this._readUint(32),this.id=this._readUint(32),this.message_data=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset))},a.prototype._boxParsers.free=a.prototype._boxParsers.skip=function(){this.data=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset))},a.prototype._boxParsers.ftyp=a.prototype._boxParsers.styp=function(){for(this.major_brand=this._readString(4),this.minor_versions=this._readUint(32),this.compatible_brands=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.compatible_brands.push(this._readString(4))},a.prototype._boxParsers.hdlr=function(){this._parseFullBox(),this.pre_defined=this._readUint(32),this.handler_type=this._readString(4),this.reserved=[this._readUint(32),this._readUint(32),this._readUint(32)],this.name=this._readTerminatedString()},a.prototype._boxParsers.mdat=function(){this.data=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset))},a.prototype._boxParsers.mdhd=function(){this._parseFullBox(),1==this.version?(this.creation_time=this._readUint(64),this.modification_time=this._readUint(64),this.timescale=this._readUint(32),this.duration=this._readUint(64)):(this.creation_time=this._readUint(32),this.modification_time=this._readUint(32),this.timescale=this._readUint(32),this.duration=this._readUint(32));var e=this._readUint(16);this.pad=e>>15,this.language=String.fromCharCode((e>>10&31)+96,(e>>5&31)+96,(31&e)+96),this.pre_defined=this._readUint(16)},a.prototype._boxParsers.mehd=function(){this._parseFullBox(),1==this.version?this.fragment_duration=this._readUint(64):this.fragment_duration=this._readUint(32)},a.prototype._boxParsers.mfhd=function(){this._parseFullBox(),this.sequence_number=this._readUint(32)},a.prototype._boxParsers.mfro=function(){this._parseFullBox(),this.mfra_size=this._readUint(32)},a.prototype._boxParsers.mp4a=function(){this.reserved1=[this._readUint(32),this._readUint(32)],this.channelcount=this._readUint(16),this.samplesize=this._readUint(16),this.pre_defined=this._readUint(16),this.reserved2=this._readUint(16),this.sample_rate=this._readUint(32)},a.prototype._boxParsers.mvhd=function(){this._parseFullBox(),1==this.version?(this.creation_time=this._readUint(64),this.modification_time=this._readUint(64),this.timescale=this._readUint(32),this.duration=this._readUint(64)):(this.creation_time=this._readUint(32),this.modification_time=this._readUint(32),this.timescale=this._readUint(32),this.duration=this._readUint(32)),this.rate=this._readTemplate(32),this.volume=this._readTemplate(16),this.reserved1=this._readUint(16),this.reserved2=[this._readUint(32),this._readUint(32)],this.matrix=[];for(var e=0;e<9;e++)this.matrix.push(this._readTemplate(32));this.pre_defined=[];for(var e=0;e<6;e++)this.pre_defined.push(this._readUint(32));this.next_track_ID=this._readUint(32)},a.prototype._boxParsers.payl=function(){var e=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset));this.cue_text=r.Utils.dataViewToString(e)},a.prototype._boxParsers.sidx=function(){this._parseFullBox(),this.reference_ID=this._readUint(32),this.timescale=this._readUint(32),0==this.version?(this.earliest_presentation_time=this._readUint(32),this.first_offset=this._readUint(32)):(this.earliest_presentation_time=this._readUint(64),this.first_offset=this._readUint(64)),this.reserved=this._readUint(16),this.reference_count=this._readUint(16),this.references=[];for(var e=0;e<this.reference_count;e++){var t={},n=this._readUint(32);t.reference_type=n>>31&1,t.referenced_size=2147483647&n,t.subsegment_duration=this._readUint(32);var r=this._readUint(32);t.starts_with_SAP=r>>31&1,t.SAP_type=r>>28&7,t.SAP_delta_time=268435455&r,this.references.push(t)}},a.prototype._boxParsers.ssix=function(){this._parseFullBox(),this.subsegment_count=this._readUint(32),this.subsegments=[];for(var e=0;e<this.subsegment_count;e++){var t={};t.ranges_count=this._readUint(32),t.ranges=[];for(var n=0;n<t.ranges_count;n++){var r={};r.level=this._readUint(8),r.range_size=this._readUint(24),t.ranges.push(r)}this.subsegments.push(t)}},a.prototype._boxParsers.stsd=function(){this._parseFullBox(),this.entry_count=this._readUint(32),this.entries=[];for(var e=0;e<this.entry_count;e++)this.entries.push(a.parse(this))},a.prototype._boxParsers.subs=function(){this._parseFullBox(),this.entry_count=this._readUint(32),this.samples_with_subsamples=[];for(var e=0,t=0;t<this.entry_count;t++){var n=this._readUint(32);e+=n;var r=this._readUint(16);if(r>0){for(var i={nr:e,subsamples:[]},a=0;a<r;a++){var o={};1&this.version?o.size=this._readUint(32):o.size=this._readUint(16),o.priority=this._readUint(8),o.discardable=this._readUint(8),o.codec_specific_parameters=this._readUint(32),i.subsamples.push(o)}this.samples_with_subsamples.push(i)}}},a.prototype._boxParsers.tfdt=function(){this._parseFullBox(),1==this.version?this.baseMediaDecodeTime=this._readUint(64):this.baseMediaDecodeTime=this._readUint(32)},a.prototype._boxParsers.tfhd=function(){this._parseFullBox(),this.track_ID=this._readUint(32),1&this.flags&&(this.base_data_offset=this._readUint(64)),2&this.flags&&(this.sample_description_offset=this._readUint(32)),8&this.flags&&(this.default_sample_duration=this._readUint(32)),16&this.flags&&(this.default_sample_size=this._readUint(32)),32&this.flags&&(this.default_sample_flags=this._readUint(32))},a.prototype._boxParsers.tfra=function(){this._parseFullBox(),this.track_ID=this._readUint(32),this._packed=this._readUint(32),this.reserved=this._packed>>>6,this.length_size_of_traf_num=(this._packed&&0xffff00000000)>>>4,this.length_size_of_trun_num=(this._packed&&4294901760)>>>2,this.length_size_of_sample_num=this._packed&&255,this.number_of_entry=this._readUint(32),this.entries=[];for(var e=0;e<this.number_of_entry;e++){var t={};1==this.version?(t.time=this._readUint(64),t.moof_offset=this._readUint(64)):(t.time=this._readUint(32),t.moof_offset=this._readUint(32)),t.traf_number=this._readUint(8*(this.length_size_of_traf_num+1)),t.trun_number=this._readUint(8*(this.length_size_of_trun_num+1)),t.sample_number=this._readUint(8*(this.length_size_of_sample_num+1)),this.entries.push(t)}},a.prototype._boxParsers.tkhd=function(){this._parseFullBox(),1==this.version?(this.creation_time=this._readUint(64),this.modification_time=this._readUint(64),this.track_ID=this._readUint(32),this.reserved1=this._readUint(32),this.duration=this._readUint(64)):(this.creation_time=this._readUint(32),this.modification_time=this._readUint(32),this.track_ID=this._readUint(32),this.reserved1=this._readUint(32),this.duration=this._readUint(32)),this.reserved2=[this._readUint(32),this._readUint(32)],this.layer=this._readUint(16),this.alternate_group=this._readUint(16),this.volume=this._readTemplate(16),this.reserved3=this._readUint(16),this.matrix=[];for(var e=0;e<9;e++)this.matrix.push(this._readTemplate(32));this.width=this._readUint(32),this.height=this._readUint(32)},a.prototype._boxParsers.trex=function(){this._parseFullBox(),this.track_ID=this._readUint(32),this.default_sample_description_index=this._readUint(32),this.default_sample_duration=this._readUint(32),this.default_sample_size=this._readUint(32),this.default_sample_flags=this._readUint(32)},a.prototype._boxParsers.trun=function(){this._parseFullBox(),this.sample_count=this._readUint(32),1&this.flags&&(this.data_offset=this._readInt(32)),4&this.flags&&(this.first_sample_flags=this._readUint(32)),this.samples=[];for(var e=0;e<this.sample_count;e++){var t={};256&this.flags&&(t.sample_duration=this._readUint(32)),512&this.flags&&(t.sample_size=this._readUint(32)),1024&this.flags&&(t.sample_flags=this._readUint(32)),2048&this.flags&&(0==this.version?t.sample_composition_time_offset=this._readUint(32):t.sample_composition_time_offset=this._readInt(32)),this.samples.push(t)}},a.prototype._boxParsers.vlab=function(){var e=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset));this.source_label=r.Utils.dataViewToString(e)},a.prototype._boxParsers.vttC=function(){var e=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset));this.config=r.Utils.dataViewToString(e)},a.prototype._boxParsers.vtte=function(){}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n=30,r=(0,o.MediaPlayer)(e).create();return new u.default(r,t,n),r}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{create:function(t){return new i(e,t)}}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(90),s=n(78),u=r(s);t.default={MediaPlayer:a},e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t){function r(e){var t=this.factory,n=this.context;i=function(){return e},a=function(){return n},o=function(){return t.getSingletonInstance(n,"DashManifestModel")},s=function(){return e.timelineConverter}}n(this,e);var i=void 0,a=void 0,o=void 0,s=void 0;this.getDashManifestModel=function(){return o?o():void 0},this.getTimelineConverter=function(){return s?s():void 0},this.getConfig=function(){return i()},this.getContext=function(){return a()},t.extend("Stream",r,!0)};t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(79),s=r(o),u=n(84),l=r(u),d=function(){function e(t,n,r){i(this,e);var a=new s.default(t,n,r);this.peerAgent=l.default.get(a)}return a(e,[{key:"version",get:function(){return e.version}}],[{key:"version",get:function(){return s.default.version}}]),e}();t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(82),s=r(o),u=n(83),l=r(u),d=n(85),c=r(d),f=n(36),_=r(f),h=n(81),p=r(h),g=n(87),v=r(g),m=n(203),E=r(m),y=n(77),T=r(y),S="v1",C="streamTeardownComplete",A=E.default,D=function(){function e(t,n,r){if(i(this,e),this._p2pConfig=n,this._player=t,this._liveDelay=r,this._player.getLiveDelay){var a=this._player.getLiveDelay();isNaN(a)?this._player.setLiveDelay(this._liveDelay):this._liveDelay=a}else this._player.setLiveDelay(this._liveDelay);if(this._dashjsInternals=new T.default(t),this._player.extend("FragmentLoader",new p.default(this).SRFragmentLoader,!0),this._player.extend("ThroughputRule",new v.default(this).SRThroughputRule,!0),"undefined"==typeof dashjs)throw new Error("dashjs context undefined.");this._player.on(dashjs.MediaPlayer.events.MANIFEST_LOADED,this._onManifestLoaded,this),this.player.on(C,this.dispose,this)}return a(e,null,[{key:"StreamrootPeerAgentModule",set:function(e){A=e},get:function(){return A}},{key:"version",get:function(){return"1.11.28"}}]),a(e,[{key:"initialize",value:function(t){this.updateManifest(t);var n=new s.default(this,this._dashjsInternals);this._playerInterface=new c.default(this._player,n,this._liveDelay),this._peerAgentModule=new e.StreamrootPeerAgentModule(this._playerInterface,this._manifest.url,new l.default(n),this._p2pConfig,_.default,e.StreamrootPeerAgentModule.StreamTypes.DASH,S);try{var r=this._player.getVideoElement();this._peerAgentModule.setMediaElement(r)}catch(e){console.warn("Tried to access media element before it was set")}}},{key:"dispose",value:function(){this._peerAgentModule&&this._peerAgentModule.dispose(),this._playerInterface&&this._playerInterface.dispose(),this._manifest=null}},{key:"updateManifest",value:function(e){this._manifest=e}},{key:"_onManifestLoaded",value:function(e){var t=e.data;return this._manifest?void(t.url!==this._manifest.url?(this.dispose(),this.initialize(t)):this.updateManifest(t)):void this.initialize(t)}},{key:"peerAgentModule",get:function(){return this._peerAgentModule}},{key:"manifest",get:function(){return this._manifest}},{key:"player",get:function(){return this._player}}]),e}();t.default=D,e.exports=t.default},function(e,t){"use strict";var n="onTrackChange",r="onEmergencyFragLoadAborted",i=[n,r],a=function(e){return i.indexOf(e)>-1};e.exports={TRACK_CHANGE_EVENT:n,EMERGENCY_FRAG_LOAD_ABORT:r,isSupported:a}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){function t(e,t){var n=o([],e);return n.forEach(function(e){e.s=new Date(e.s.getTime()-t)}),n}function n(e,n,r){var i=Date.now(),a=e.p2pDownloaded?e.p2pDuration+e.cdnDuration:0;if(n.firstByteDate=n.firstByteDate||n.requestStartDate,n.requestEndDate=new Date(i),0!==a){n.requestStartDate=new Date(i-a);var o=e.latency||Math.min(y,(n.requestEndDate-n.requestStartDate)/2);n.firstByteDate=new Date(n.requestStartDate.getTime()+o),t(r,a)}}var r=1,a=2,s="request is null",l=["audio","video"];this.SRFragmentLoader=function(t){function c(){var t;L=e.peerAgentModule,k=[],t={},i(t,_.HTTPRequest.MPD_TYPE,f.default.DOWNLOAD_ERROR_ID_MANIFEST),i(t,_.HTTPRequest.XLINK_EXPANSION_TYPE,f.default.DOWNLOAD_ERROR_ID_XLINK),i(t,_.HTTPRequest.INIT_SEGMENT_TYPE,f.default.DOWNLOAD_ERROR_ID_INITIALIZATION),i(t,_.HTTPRequest.MEDIA_SEGMENT_TYPE,f.default.DOWNLOAD_ERROR_ID_CONTENT),i(t,_.HTTPRequest.INDEX_SEGMENT_TYPE,f.default.DOWNLOAD_ERROR_ID_CONTENT),i(t,_.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,f.default.DOWNLOAD_ERROR_ID_CONTENT),i(t,_.HTTPRequest.OTHER_TYPE,f.default.DOWNLOAD_ERROR_ID_CONTENT),x=t}function h(e){if("InitializationSegment"!==e.type&&l.indexOf(e.mediaInfo.type)>=0){var t=new v.default({periodId:e.mediaInfo.streamInfo.index,adaptationSetId:e.mediaInfo.index,representationId:e.quality,type:e.mediaInfo.type,bitrate:e.mediaInfo.bitrateList[e.quality].bandwidth});return new p.default({trackView:t,timeStamp:e.startTime})}return null}function g(e){var t=b.modifyRequestHeader(new E.default),n=o({},t.headers);return e.range&&(n.Range="bytes="+e.range),n}function m(e,t){var n=void 0;return n="function"==typeof O.getXHRWithCredentialsForType?O.getXHRWithCredentialsForType(e.type):O.getXHRWithCredentials(),{url:b.modifyRequestURL(e.url),headers:t,withCredentials:!!n}}function y(e){if(U=O.getRetryAttemptsForType(e.type),F=!1,!e)return void I.trigger(u.default.LOADING_COMPLETED,{request:void 0,error:new Error(a,s)});e.requestStartDate=new Date;var t=g(e),i=h(e),o=m(e,t),l=[],d=e.requestStartDate,c=0,f=function(t,n,r){w.addHttpRequest(e.mediaType,null,e.type,e.url,null,e.serviceLocation||null,e.range||null,e.requestStartDate,e.firstByteDate,e.requestEndDate,n,e.duration,"Content-Length: "+r,t?l:null)},_=function(t,r){if(!F){var i=r.cdnDownloaded+r.p2pDownloaded;n(r,e,l),f(!0,200,i),I.trigger(u.default.LOADING_COMPLETED,{request:e,response:t,sender:D})}},p=function(t){if(!F){var n=new Date;e.firstByteDate=e.firstByteDate||n;var r=t.cdnDownloaded+t.p2pDownloaded;t.lengthComputable&&(e.bytesLoaded=r,e.bytesTotal=t.total),l.push({s:d,d:n.getTime()-d.getTime(),b:[r?r-c:0]}),d=n,c=r,I.trigger(u.default.LOADING_PROGRESS,{request:e})}},v=function(t){F||(f(!1,t.status),U>0?(R("Failed loading fragment: "+e.mediaType+":"+e.type+":"+e.startTime+", retry in "+O.getRetryIntervalForType(e.type)+"ms attempts: "+U),U--,k.push(setTimeout(function(){y(e,U)},O.getRetryIntervalForType(e.type)))):(R("Failed loading fragment: "+e.mediaType+":"+e.type+":"+e.startTime+" no retry attempts left"),P.downloadError(x[e.type],e.url,e),I.trigger(u.default.LOADING_COMPLETED,{request:void 0,error:new Error(r,"failed loading fragment")})))};N=L.getSegment(o,{onSuccess:_,onProgress:p,onError:v},i)}function T(){F=!0,U=0,k.forEach(function(e){return clearTimeout(e)}),k=[],N&&N.abort(),N=null}function S(){T()}var C=this.context,A=this.factory,D=this.parent,I=A.getSingletonInstance(C,"EventBus"),R=A.getSingletonInstance(C,"Debug").log,O=(0,d.default)(C).getInstance(),P=t.errHandler,b=t.requestModifier,w=t.metricsModel,M=void 0,L=void 0,N=void 0,k=void 0,x=void 0,U=void 0,F=void 0;return M={load:y,abort:T,reset:S},c(),M}}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=n(2),u=r(s),l=n(5),d=r(l),c=n(11),f=r(c),_=n(6),h=n(36),p=r(h),g=n(20),v=r(g),m=n(88),E=r(m),y=50;t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(20),s=r(o),u=n(56),l=r(u),d=n(86),c=r(d),f=function(){function e(t,n){i(this,e),this._wrapper=t,this._dashjsInternals=n,this._segmentsCache=new c.default(this._player)}return a(e,[{key:"_getSegmentsGetter",value:function(){if(!this._segmentsGetter){var e=this._dashjsInternals.getContext(),t=this._dashjsInternals.getConfig();this._segmentsGetter=(0,l.default)(e).create(t,this.isLive())}return this._segmentsGetter}},{key:"getSegmentList",value:function(e,t,n){if(this._segmentsCache.hasSegments(e))return this._segmentsCache.getSegments(e);var r=this._dashjsInternals.getDashManifestModel(),i=this._dashjsInternals.getTimelineConverter();if(!r||!i)throw new Error("Tried to get representation before we could have access to dash.js manifest internals");var a=r.getMpd(this._manifest),o=r.getRegularPeriods(this._manifest,a)[e.periodId],s=r.getAdaptationsForPeriod(this._manifest,o)[e.adaptationSetId],u=r.getRepresentationsForAdaptation(this._manifest,s)[e.representationId],l=this.isLive(),d=0;u.segmentAvailabilityRange=i.calcSegmentAvailabilityRange(u,l);var c=this._getSegmentsGetter().getSegments(u,t,d,void 0,n);return c}},{key:"isLive",value:function(){var e=this._dashjsInternals.getDashManifestModel();if(!e)throw new Error("Tried to get representation before we could have access to dash.js manifest internals");return e.getIsDynamic(this._manifest)}},{key:"getCurrentTracks",value:function(){for(var e={},t=["audio","video"],n=0;n<t.length;n++){var r=t[n],i=this._player.getTracksFor(r);if(i&&i.length>0){var a=this._player.getCurrentTrackFor(r),o=this._player.getQualityFor(r);e[r]=new s.default({periodId:a.streamInfo.index,adaptationSetId:a.index,representationId:o,type:r,bitrate:a.bitrateList[o].bandwidth})}}return e}},{key:"getAllTracks",value:function(){var e={},t=this._player.getStreamsFromManifest(this._manifest);if(t){var n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0)for(var u=a.value,l=["audio","video"],d=0;d<l.length;d++){var c=l[d];e[c]=[];var f=this._player.getTracksForTypeFromManifest(c,this._manifest,u);if(f){var _=!0,h=!1,p=void 0;try{for(var g,v=f[Symbol.iterator]();!(_=(g=v.next()).done);_=!0)for(var m=g.value,E=0;E<m.representationCount;E++)e[c].push(new s.default({periodId:u.index,adaptationSetId:m.index,representationId:E,type:c,bitrate:m.bitrateList[E].bandwidth}))}catch(e){h=!0,p=e}finally{try{!_&&v.return&&v.return()}finally{if(h)throw p}}}}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{
if(r)throw i}}}return e}},{key:"_player",get:function(){return this._wrapper.player}},{key:"_manifest",get:function(){return this._wrapper.manifest}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(36),u=r(s),l=function(){function e(t){a(this,e),this._manifestHelper=t}return o(e,[{key:"isLive",value:function(){return this._manifestHelper.isLive()}},{key:"getSegmentTime",value:function(e){return e.timeStamp}},{key:"getSegmentList",value:function(e,t,n){var r=[],i=void 0,a=this._manifestHelper.getSegmentList(e,t,n);if(void 0!==a){var o=!0,s=!1,l=void 0;try{for(var d,c=a[Symbol.iterator]();!(o=(d=c.next()).done);o=!0){var f=d.value,_=f.mediaStartTime||f.startTime;f.timescale&&(_/=f.timescale),t<=_&&_<=t+n&&(i=new u.default({trackView:e,timeStamp:_}),r.push(i))}}catch(e){s=!0,l=e}finally{try{!o&&c.return&&c.return()}finally{if(s)throw l}}}return r}},{key:"getNextSegmentView",value:function(e){var t=this.getSegmentTime(e)+.2,n=this.getSegmentList(e.trackView,t,30);return n.length?n[0]:null}},{key:"getTrackList",value:function(){for(var e=this._manifestHelper.getAllTracks(),t=[],n=["audio","video"],r=0;r<n.length;r++){var a=n[r];e[a]&&t.push.apply(t,i(e[a]))}return t}}]),e}();t.default=l,e.exports=t.default},function(e,t){"use strict";function n(e){var t={get stats(){return e.peerAgentModule.stats},get version(){return e.peerAgentModule.version},get isP2PEnabled(){return e.peerAgentModule.isP2PEnabled},get p2pDownloadOn(){return e.peerAgentModule.p2pDownloadOn},set p2pDownloadOn(t){e.peerAgentModule.p2pDownloadOn=t},get p2pUploadOn(){return e.peerAgentModule.p2pUploadOn},set p2pUploadOn(t){e.peerAgentModule.p2pUploadOn=t}};return t}Object.defineProperty(t,"__esModule",{value:!0}),t.default={get:n},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(201),l=r(u),d=n(20),c=r(d),f=n(80),_=r(f),h=dashjs.MediaPlayer.events.QUALITY_CHANGE_START||dashjs.MediaPlayer.events.QUALITY_CHANGE_REQUESTED,p=dashjs.MediaPlayer.events.STREAM_INITIALIZED,g=dashjs.MediaPlayer.events.FRAGMENT_LOADING_ABANDONED||"fragmentLoadingAbandoned",v=function(e){function t(e,n,r){i(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(o._player=e,o._manifestHelper=n,o._liveDelay=r,o._bufferLevelMax=Math.max(0,o._liveDelay),void 0===h)throw new Error("Can't find neither QUALITY_CHANGE_START nor QUALITY_CHANGE_REQUESTED dash.js event.");if(void 0===p)throw new Error("Can't find STREAM_INITIALIZED dash.js event.");if(void 0===g)throw new Error("Can't find FRAGMENT_LOADING_ABANDONED dash.js event.");return o._player.on(p,o._onStreamInitialized,o),o._player.on(g,o._onFragLoadingAbandoned,o),o}return o(t,e),s(t,[{key:"dispose",value:function(){this._player.off(g,this._onFragLoadingAbandoned,this),this._player.off(h,this._onQualityChanged,this),this._player.off(p,this._onStreamInitialized,this),this.removeAllListeners()}},{key:"isLive",value:function(){return this._manifestHelper.isLive()}},{key:"getBufferLevelMax",value:function(){return this._bufferLevelMax}},{key:"setBufferMarginLive",value:function(e){var t=e;t>this._bufferLevelMax&&(t=this._bufferLevelMax,console.info("setBufferMarginLive(): buffer level from tracker was capped to=",t)),this._dashjsBufferTime=t,this._player.setStableBufferTime(this._dashjsBufferTime),this._player.setBufferTimeAtTopQuality(this._dashjsBufferTime),this._player.setBufferTimeAtTopQualityLongForm(this._dashjsBufferTime)}},{key:"addEventListener",value:function(e,t){_.default.isSupported(e)?this.on(e,t):console.warn("Trying to add an unsupported event listener. eventName=",e)}},{key:"removeEventListener",value:function(e,t){_.default.isSupported(e)?this.removeListener(e,t):console.warn("Trying to remove an unsupported event listener. eventName=",e)}},{key:"_onStreamInitialized",value:function(){setTimeout(this._player.off,0,p,this._onStreamInitialized,this),this._player.on(h,this._onQualityChanged,this),this.emit(_.default.TRACK_CHANGE_EVENT,this._manifestHelper.getCurrentTracks())}},{key:"_onQualityChanged",value:function(e){var t=e.mediaType,n=e.streamInfo,r=e.newQuality,i={},a=this._player.getCurrentTrackFor(t);i[t]=new c.default({periodId:n.index,adaptationSetId:a.index,representationId:Number(r),mediaType:t,bitrate:a.bitrateList[r].bandwidth}),this.emit(_.default.TRACK_CHANGE_EVENT,i)}},{key:"_onFragLoadingAbandoned",value:function(){this.emit(_.default.EMERGENCY_FRAG_LOAD_ABORT)}}]),t}(l.default);t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(20),s=r(o),u=function(){function e(t){i(this,e),this._player=t,this._player.on("segmentsLoaded",this._onSegmentsLoaded,this),this._cache={}}return a(e,[{key:"_onSegmentsLoaded",value:function(e){var t=e.segments,n=s.default.makeIDString(e.representation.adaptation.period.index,e.representation.adaptation.index,e.representation.index);this._cache[n]=t}},{key:"hasSegments",value:function(e){return void 0!==this._cache[e.viewToString()]}},{key:"getSegments",value:function(e){return this._cache[e.viewToString()]}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=dashjs.FactoryMaker,n=void 0;n=t?t.getClassFactoryByName("SwitchRequest"):o.default,this.SRThroughputRule=function(){function t(t){var a=r(t),o=t.getCurrentValue(),s=t.getMediaInfo().type;return"video"!==s&&"audio"!==s?a:(a.value<o&&e.peerAgentModule.nextSegmentPrebuffered&&e.peerAgentModule.nextSegmentPrebuffered[s]&&(a.value=o,a=n(i).create()),a)}var r=this.parent.getMaxIndex,i=this.context,a={getMaxIndex:t};return a}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(7),o=r(a);t.default=i,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){n(this,e),this._headers={}}return r(e,[{key:"setRequestHeader",value:function(e,t){this._headers[e]=t}},{key:"headers",get:function(){return this._headers}}]),e}();t.default=i,e.exports=t.default},function(e,t){"use strict";function n(e){var t,n,r;for(t=[],r=0,n=e.length;r<n;r+=1)e[r].isRoot?t.push("root"):t.push(e[r].name);var i=function(e,t){var n;if(null!==e&&null!==t)for(n in e)e.hasOwnProperty(n)&&(t.hasOwnProperty(n)||(t[n]=e[n]))},a=function(e,t,n){var r,a,o,s,u;if(null!==e&&0!==e.length)for(r=0,a=e.length;r<a;r+=1)o=e[r],t.hasOwnProperty(o.name)&&(n.hasOwnProperty(o.name)?o.merge&&(s=t[o.name],u=n[o.name],"object"==typeof s&&"object"==typeof u?i(s,u):null!=o.mergeFunction?n[o.name]=o.mergeFunction(s,u):n[o.name]=s+u):n[o.name]=t[o.name])},o=function e(t,n){var r,i,o,s,u,l,d,c=t;if(null!==c.children&&0!==c.children.length)for(r=0,i=c.children.length;r<i;r+=1)if(l=c.children[r],n.hasOwnProperty(l.name))if(l.isArray)for(u=n[l.name+"_asArray"],o=0,s=u.length;o<s;o+=1)d=u[o],a(c.properties,n,d),e(l,d);else d=n[l.name],a(c.properties,n,d),e(l,d)},s=function n(r){var i,a,s,u,l,d,c;if(null===r)return r;if("object"!=typeof r)return r;for(i=0,a=t.length;i<a;i+=1)"root"===t[i]&&(l=e[i],d=r,o(l,d));for(u in r)if(r.hasOwnProperty(u)&&"__children"!=u){if(s=t.indexOf(u),s!==-1)if(l=e[s],l.isArray)for(c=r[u+"_asArray"],i=0,a=c.length;i<a;i+=1)d=c[i],o(l,d);else d=r[u],o(l,d);n(r[u])}return r};return{run:s}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n,e.exports=t.default},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(60),a=r(i),o=n(64),s=r(o),u=n(128),l=r(u),d=n(115),c=r(d),f=n(53),_="undefined"!=typeof window&&window||e,h=_.dashjs;h||(h=_.dashjs={}),h.MediaPlayer=a.default,h.Protection=s.default,h.MetricsReporting=l.default,h.MediaPlayerFactory=c.default,h.Version=(0,f.getVersionString)(),t.default=h,t.MediaPlayer=a.default,t.Protection=s.default,t.MetricsReporting=l.default,t.MediaPlayerFactory=c.default}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}},s=n(27),u=r(s),l=function(e){function t(){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.BUFFERING_COMPLETED="bufferingCompleted",this.BUFFER_CLEARED="bufferCleared",this.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",this.BYTES_APPENDED="bytesAppended",this.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",this.CURRENT_TRACK_CHANGED="currentTrackChanged",this.DATA_UPDATE_COMPLETED="dataUpdateCompleted",this.DATA_UPDATE_STARTED="dataUpdateStarted",this.INITIALIZATION_LOADED="initializationLoaded",this.INIT_FRAGMENT_LOADED="initFragmentLoaded",this.INIT_REQUESTED="initRequested",this.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",this.LIVE_EDGE_SEARCH_COMPLETED="liveEdgeSearchCompleted",this.LOADING_COMPLETED="loadingCompleted",this.LOADING_PROGRESS="loadingProgress",this.MANIFEST_UPDATED="manifestUpdated",this.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",this.QUOTA_EXCEEDED="quotaExceeded",this.REPRESENTATION_UPDATED="representationUpdated",this.SEGMENTS_LOADED="segmentsLoaded",this.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",this.SOURCEBUFFER_APPEND_COMPLETED="sourceBufferAppendCompleted",this.SOURCEBUFFER_REMOVE_COMPLETED="sourceBufferRemoveCompleted",this.STREAMS_COMPOSED="streamsComposed",this.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",this.STREAM_COMPLETED="streamCompleted",this.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",this.TIMED_TEXT_REQUESTED="timedTextRequested",this.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",this.URL_RESOLUTION_FAILED="urlResolutionFailed",this.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",this.XLINK_ELEMENT_LOADED="xlinkElementLoaded",this.XLINK_READY="xlinkReady"}return a(t,e),t}(u.default);t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){Y=-1,Z=0,J=NaN,B.on(c.default.INITIALIZATION_LOADED,k,q),B.on(c.default.SEGMENTS_LOADED,x,q)}function n(t){$=t,X=$.getType(),Q=$.isDynamic(),ee=(0,A.default)(U).create(e,Q)}function r(){return $}function i(e){Z=e}function a(){return Z}function s(){return Y}function d(){return J}function f(){ee=null,Z=0,J=NaN,z=NaN,Y=-1,Q=null,X=null,$=null,B.off(c.default.INITIALIZATION_LOADED,k,q),B.off(c.default.SEGMENTS_LOADED,x,q)}function h(e){return e?e.split("$$").join("$"):e}function p(e,t){if(null===t||null===e||e.indexOf("$RepresentationID$")===-1)return e;var n=t.toString();return e.split("$RepresentationID$").join(n)}function g(e,t,n){var r,i,a=W.resolve(n.path);return a&&t!==a.url&&H.isRelative(t)?(r=a.url,i=a.serviceLocation,t&&(r=H.resolve(t,r))):r=t,!H.isRelative(r)&&(e.url=r,e.serviceLocation=i,!0)}function m(e,t){var n=new o.default,r=e.adaptation.period,i=r.start;if(n.mediaType=t,n.type=l.HTTPRequest.INIT_SEGMENT_TYPE,n.range=e.range,n.availabilityStartTime=G.calcAvailabilityStartTimeFromPresentationTime(i,r.mpd,Q),n.availabilityEndTime=G.calcAvailabilityEndTimeFromPresentationTime(i+r.duration,r.mpd,Q),n.quality=e.index,n.mediaInfo=$.getMediaInfo(),g(n,e.initialization,e))return n}function y(e){if(!e)return null;var t=m(e,X);return t}function C(e){var t=!1;if(Q||Y!==e.availableSegmentsNumber){var n=(0,S.getSegmentByIndex)(Y,e);if(n){var r=n.presentationStartTime-e.adaptation.period.start,i=e.adaptation.period.duration;F(e.segmentInfoType+": "+r+" / "+i),t=("SegmentTimeline"!==e.segmentInfoType||!Q)&&r>=i}}else t=!0;return t}function I(e){return ee.getSegments(e,z,Y,R)}function R(e,t){if(e.segments=t,t&&t.length>0&&(J=isNaN(J)?t[0].presentationStartTime:Math.min(t[0].presentationStartTime,J)),Q&&isNaN(G.getExpectedLiveEdge())){var n=t[t.length-1],r=n.presentationStartTime,i=V.getMetricsFor("stream");G.setExpectedLiveEdge(r),V.updateManifestUpdateInfo(K.getCurrentManifestUpdate(i),{presentationStartTime:r})}}function O(e){if(!e)throw new u.default("no representation");return e.segments=null,I(e),e}function P(e,t){var n,r=T.default.hasInitialization(e),i=T.default.hasSegments(e);return e.segmentDuration||e.segments||O(e),e.segmentAvailabilityRange=null,e.segmentAvailabilityRange=G.calcSegmentAvailabilityRange(e,Q),e.segmentAvailabilityRange.end<e.segmentAvailabilityRange.start&&!e.useCalculatedLiveEdgeTime?(n=new u.default(D,"no segments are available yet",{availabilityDelay:e.segmentAvailabilityRange.start-e.segmentAvailabilityRange.end}),void B.trigger(c.default.REPRESENTATION_UPDATED,{sender:this,representation:e,error:n})):(t||(Y=-1),e.segmentDuration&&O(e),r||j.loadInitialization(e),i||j.loadSegments(e,X,e.indexRange),void(r&&i&&B.trigger(c.default.REPRESENTATION_UPDATED,{sender:this,representation:e})))}function b(e,t,n){var r,i,a,o,s,u=t.segments,l=u?u.length:null,d=-1;if(u&&l>0)for(s=0;s<l;s++)if(i=u[s],a=i.presentationStartTime,o=i.duration,r=void 0===n||null===n?o/2:n,e+r>=a&&e-r<a+o){d=i.availabilityIdx;break}return d}function w(e){if(null===e||void 0===e)return null;var t=new o.default,n=e.representation,r=n.adaptation.period.mpd.manifest.Period_asArray[n.adaptation.period.index].AdaptationSet_asArray[n.adaptation.index].Representation_asArray[n.index].bandwidth,i=e.media;return i=(0,S.replaceTokenForTemplate)(i,"Number",e.replacementNumber),i=(0,S.replaceTokenForTemplate)(i,"Time",e.replacementTime),i=(0,S.replaceTokenForTemplate)(i,"Bandwidth",r),i=p(i,n.id),i=h(i),t.mediaType=X,t.type=l.HTTPRequest.MEDIA_SEGMENT_TYPE,t.range=e.mediaRange,t.startTime=e.presentationStartTime,t.duration=e.duration,t.timescale=n.timescale,t.availabilityStartTime=e.availabilityStartTime,t.availabilityEndTime=e.availabilityEndTime,t.wallStartTime=e.wallStartTime,t.quality=n.index,t.index=e.availabilityIdx,t.mediaInfo=$.getMediaInfo(),t.adaptationIndex=n.adaptation.index,g(t,i,n)?t:void 0}function M(e,t,n){var r,i,a,s=Y,u=!!n&&n.keepIdx,l=n?n.timeThreshold:null,d=!(!n||!n.ignoreIsFinished);return e?(z!==t&&(z=t,F("Getting the request for "+X+" time : "+t)),I(e),Y=b(t,e,l),Y<0&&(I(e),Y=b(t,e,l)),Y>0&&F("Index for "+X+" time "+t+" is "+Y),a=!d&&C(e),a?(r=new o.default,r.action=o.default.ACTION_COMPLETE,r.index=Y,r.mediaType=X,r.mediaInfo=$.getMediaInfo(),F("Signal complete.",r)):(i=(0,S.getSegmentByIndex)(Y,e),r=w(i)),u&&s>=0&&(Y="SegmentTimeline"===e.segmentInfoType&&Q?Y:s),r):null}function L(e,t){var n=(e.segmentAvailabilityRange.end-e.segmentAvailabilityRange.start)/2;return e.segments=null,e.segmentAvailabilityRange={start:t-n,end:t+n},M(e,t,{keepIdx:!1,ignoreIsFinished:!0})}function N(e){var t,n,r;return e&&Y!==-1?(z=null,Y++,F("Getting the next request at index: "+Y),r=C(e),r?(t=new o.default,t.action=o.default.ACTION_COMPLETE,t.index=Y,t.mediaType=X,t.mediaInfo=$.getMediaInfo(),F("Signal complete.")):(I(e),n=(0,S.getSegmentByIndex)(Y,e),t=w(n),!n&&Q&&Y--),t):null}function k(e){var t=e.representation;t.segments&&B.trigger(c.default.REPRESENTATION_UPDATED,{sender:this,representation:t})}function x(e){if(!e.error&&X===e.mediaType){var t,n,r,i,a=e.segments,o=e.representation,s=[],u=0;for(t=0,n=a.length;t<n;t++)r=a[t],i=(0,S.getTimeBasedSegment)(G,Q,o,r.startTime,r.duration,r.timescale,r.media,r.mediaRange,u),s.push(i),i=null,u++;o.segmentAvailabilityRange={start:s[0].presentationStartTime,end:s[n-1].presentationStartTime},o.availableSegmentsNumber=n,R(o,s),T.default.hasInitialization(o)&&B.trigger(c.default.REPRESENTATION_UPDATED,{sender:this,representation:o})}}var U=this.context,F=(0,v.default)(U).getInstance().log,B=(0,_.default)(U).getInstance(),H=(0,E.default)(U).getInstance(),j=e.segmentBaseLoader,G=e.timelineConverter,K=e.dashMetrics,V=e.metricsModel,W=e.baseURLController,q=void 0,Y=void 0,z=void 0,Q=void 0,X=void 0,Z=void 0,J=void 0,$=void 0,ee=void 0;return q={initialize:n,getStreamProcessor:r,getInitRequest:y,getSegmentRequestForTime:M,getNextSegmentRequest:N,generateSegmentRequestForTime:L,updateRepresentation:P,setCurrentTime:i,getCurrentTime:a,getCurrentIndex:s,getEarliestTime:d,reset:f},t(),q}Object.defineProperty(t,"__esModule",{value:!0});var a=n(19),o=r(a),s=n(8),u=r(s),l=n(6),d=n(2),c=r(d),f=n(3),_=r(f),h=n(1),p=r(h),g=n(4),v=r(g),m=n(26),E=r(m),y=n(40),T=r(y),S=n(29),C=n(56),A=r(C),D=1;i.__dashjs_factory_name="DashHandler";var I=p.default.getClassFactory(i);I.SEGMENTS_UNAVAILABLE_ERROR_CODE=D,t.default=I,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){y=(0,f.default)(_).getInstance(),T=(0,m.default)(_).getInstance(),A=(0,o.default)(_).getInstance(),O=(0,R.default)(_).create({errHandler:y,metricsModel:I,requestModifier:A})}function t(e){e.baseURLController&&(P=e.baseURLController),e.metricsModel&&(I=e.metricsModel)}function n(e,t){var r=null,i=null,a=P.resolve(e.path),o=t||{init:!0,url:a?a.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500};p("Start searching for initialization.");var u=l(o),d=function(t){o.bytesLoaded=o.range.end,i=T.parse(t),r=s(i),r?(e.range=r,v.trigger(h.default.INITIALIZATION_LOADED,{representation:e})):(o.range.end=o.bytesLoaded+o.bytesToLoad,n(e,o))},c=function(){v.trigger(h.default.INITIALIZATION_LOADED,{representation:e})};O.load({request:u,success:d,error:c}),p("Perform init search: "+o.url)}function r(e,t,n,i,o){if(n&&(void 0===n.start||void 0===n.end)){var s=n?n.toString().split("-"):null;n=s?{start:parseFloat(s[0]),end:parseFloat(s[1])}:null}o=o?o:c;var u=null,d=null,f=!!n,_=P.resolve(e.path),h={init:!1,url:_?_.url:void 0,range:f?n:{start:0,end:1500},searching:!f,bytesLoaded:i?i.bytesLoaded:0,bytesToLoad:1500},g=l(h),v=function(n){var i=h.bytesToLoad,s=n.byteLength;if(h.bytesLoaded=h.range.end-h.range.start,u=T.parse(n),d=u.getBox("sidx"),d&&d.isComplete){var l,c,f=d.references;if(null!==f&&void 0!==f&&f.length>0&&(l=1===f[0].reference_type),l){p("Initiate multiple SIDX load."),h.range.end=h.range.start+d.size;var _,g,v,m,E,y=[],S=0,C=(d.offset||h.range.start)+d.size,A=function(n){n?(y=y.concat(n),S++,S>=g&&o(y,e,t)):o(null,e,t)};for(_=0,g=f.length;_<g;_++)v=C,m=C+f[_].referenced_size-1,C+=f[_].referenced_size,E={start:v,end:m},r(e,null,E,h,A)}else p("Parsing segments from SIDX."),c=a(d,h),o(c,e,t)}else{if(d)h.range.start=d.offset||h.range.start,h.range.end=h.range.start+(d.size||i);else{if(s<h.bytesLoaded)return void o(null,e,t);var D=u.getLastBox();D&&D.size?(h.range.start=D.offset+D.size,h.range.end=h.range.start+i):h.range.end+=i}r(e,t,h.range,h,o)}},m=function(){o(null,e,t)};O.load({request:g,success:v,error:m}),p("Perform SIDX load: "+h.url)}function i(){O.abort(),O=null,y=null,T=null,A=null}function a(e,t){for(var n,r,i,a,o=e.references,s=o.length,l=e.timescale,d=e.earliest_presentation_time,c=t.range.start+e.offset+e.first_offset+e.size,f=[],_=0;_<s;_++)i=o[_].subsegment_duration,a=o[_].referenced_size,n=new u.default,n.duration=i,n.startTime=d,n.timescale=l,r=c+a-1,n.mediaRange=c+"-"+r,f.push(n),d+=i,c+=a;return f}function s(e){var t,n,r=e.getBox("ftyp"),i=e.getBox("moov"),a=null;return p("Searching for initialization."),i&&i.isComplete&&(t=r?r.offset:i.offset,n=i.offset+i.size-1,a=t+"-"+n,p("Found the initialization.  Range: "+a)),a}function l(e){if(e.url){var t=new D.default;return t.type=e.init?C.HTTPRequest.INIT_SEGMENT_TYPE:C.HTTPRequest.MEDIA_SEGMENT_TYPE,t.url=e.url,t.range=e.range.start+"-"+e.range.end,t}}function c(e,t,n){e?v.trigger(h.default.SEGMENTS_LOADED,{segments:e,representation:t,mediaType:n}):v.trigger(h.default.SEGMENTS_LOADED,{segments:null,representation:t,mediaType:n,error:new d.default(null,"error loading segments",null)})}var _=this.context,p=(0,S.default)(_).getInstance().log,v=(0,g.default)(_).getInstance(),E=void 0,y=void 0,T=void 0,A=void 0,I=void 0,O=void 0,P=void 0;return E={setConfig:t,initialize:e,loadInitialization:n,loadSegments:r,reset:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(35),o=r(a),s=n(41),u=r(s),l=n(8),d=r(l),c=n(11),f=r(c),_=n(2),h=r(_),p=n(3),g=r(p),v=n(49),m=r(v),E=n(1),y=r(E),T=n(4),S=r(T),C=n(6),A=n(19),D=r(A),I=n(23),R=r(I);i.__dashjs_factory_name="SegmentBaseLoader",t.default=y.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){A={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"},CueBlockNumber:{tag:21368}}}}},Void:{tag:236,required:!0}}}function t(){I=(0,g.default)(p).getInstance(),R=(0,m.default)(p).getInstance(),P=(0,D.default)(p).create({errHandler:I,metricsModel:O,requestModifier:R})}function n(e){if(!e.baseURLController||!e.metricsModel)throw new Error("Missing config parameter(s)");b=e.baseURLController,O=e.metricsModel}function r(e){var t=[],n=void 0,r=void 0,i=void 0,a=(0,d.default)(p).create({data:e}),o=void 0;for(a.consumeTag(A.Segment.Cues),r=a.getMatroskaCodedNum();a.moreData()&&a.consumeTagAndSize(A.Segment.Cues.CuePoint,!0);){for(n={},n.CueTime=a.parseTag(A.Segment.Cues.CuePoint.CueTime),n.CueTracks=[];a.moreData()&&a.consumeTagAndSize(A.Segment.Cues.CuePoint.CueTrackPositions,!0);){if(i={},i.Track=a.parseTag(A.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),0===i.Track)throw new Error("Cue track cannot be 0");i.ClusterPosition=a.parseTag(A.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),a.getPos()+4>r||!a.consumeTag(A.Segment.Cues.CuePoint.CueTrackPositions.CueBlockNumber,!0)?n.CueTracks.push(i):(o=a.getMatroskaCodedNum(),i.BlockNumber=a.getMatroskaUint(o),n.CueTracks.push(i))}if(0===n.CueTracks.length)throw new Error("Mandatory cuetrack not found");t.push(n)}if(0===t.length)throw new Error("mandatory cuepoint not found");return t}function i(e,t,n,i){var a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,d=void 0,c=void 0,f=void 0;for(o=r(e),s=[],l=0,d=o.length;l<d;l+=1)u=new y.default,a=0,a=l<o.length-1?o[l+1].CueTime-o[l].CueTime:i-o[l].CueTime,u.duration=a,u.startTime=o[l].CueTime,u.timescale=1e3,c=o[l].CueTracks[0].ClusterPosition+t,f=l<o.length-1?o[l+1].CueTracks[0].ClusterPosition+t-1:n-1,u.mediaRange=c+"-"+f,s.push(u);return v("Parsed cues: "+s.length+" cues."),s}function a(e,t,n,r){var a=(0,d.default)(p).create({data:e}),o=void 0,s=void 0,u=n.split("-"),l=null,c={url:t,range:{start:parseFloat(u[0]),end:parseFloat(u[1])},request:l},_=void 0,h=void 0;for(v("Parse EBML header: "+c.url),a.skipOverElement(A.EBML),a.consumeTag(A.Segment),_=a.getMatroskaCodedNum(),_+=a.getPos(),h=a.getPos();a.moreData()&&!a.consumeTagAndSize(A.Segment.Info,!0);)if(!(a.skipOverElement(A.Segment.SeekHead,!0)||a.skipOverElement(A.Segment.Tracks,!0)||a.skipOverElement(A.Segment.Cues,!0)||a.skipOverElement(A.Void,!0)))throw new Error("no valid top level element found");for(;void 0===o;){var g=a.getMatroskaCodedNum(!0),m=a.getMatroskaCodedNum();switch(g){case A.Segment.Info.Duration.tag:o=a[A.Segment.Info.Duration.parse](m);break;default:a.setPos(a.getPos()+m)}}l=f(c);var E=function(e){s=i(e,h,_,o),r(s)},y=function(){v("Download Error: Cues "+c.url),r(null)};P.load({request:l,success:E,error:y}),v("Perform cues load: "+c.url+" bytes="+c.range.start+"-"+c.range.end)}function s(e,t){var n=null,r=b.resolve(e.path),i=r?r.url:void 0,a=e.range.split("-"),s=t||{range:{start:parseFloat(a[0]),end:parseFloat(a[1])},request:n,url:i,init:!0};v("Start loading initialization."),n=f(s);var u=function(){E.trigger(o.default.INITIALIZATION_LOADED,{representation:e})},l=function(){E.trigger(o.default.INITIALIZATION_LOADED,{representation:e})};P.load({request:n,success:u,error:l}),v("Perform init load: "+s.url)}function l(e,t,n,r){var i=null,o=b.resolve(e.path),s=o?o.url:void 0,u=8192,l={bytesLoaded:0,bytesToLoad:u,range:{start:0,end:u},request:i,url:s,init:!1};r=r?r:c,i=f(l),v("Parsing ebml header");var d=function(i){a(i,s,n,function(n){r(n,e,t)})},_=function(){r(null,e,t)};P.load({request:i,success:d,error:_})}function c(e,t,n){e?E.trigger(o.default.SEGMENTS_LOADED,{segments:e,representation:t,mediaType:n}):E.trigger(o.default.SEGMENTS_LOADED,{segments:null,representation:t,mediaType:n,error:new Error(null,"error loading segments",null)})}function f(e){var t=new C.default;return t.type=e.init?T.HTTPRequest.INIT_SEGMENT_TYPE:T.HTTPRequest.MEDIA_SEGMENT_TYPE,t.url=e.url,t.range=e.range.start+"-"+e.range.end,t}function _(){I=null,R=null,v=null}var p=this.context,v=(0,h.default)(p).getInstance().log,E=(0,u.default)(p).getInstance(),S=void 0,A=void 0,I=void 0,R=void 0,O=void 0,P=void 0,b=void 0;return S={setConfig:n,initialize:t,loadInitialization:s,loadSegments:l,reset:_},e(),S}Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),o=r(a),s=n(3),u=r(s),l=n(175),d=r(l),c=n(1),f=r(c),_=n(4),h=r(_),p=n(11),g=r(p),v=n(35),m=r(v),E=n(41),y=r(E),T=n(6),S=n(19),C=r(S),A=n(23),D=r(A);i.__dashjs_factory_name="WebmSegmentBaseLoader",t.default=f.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){G=null,K=-1,V=!0,W=[],z=(0,f.default)(B).getInstance(),X=(0,g.default)(B).getInstance(),Z=(0,h.default)(B).getInstance(),J=(0,m.default)(B).getInstance(),$=(0,y.default)(B).getInstance(),ee=(0,A.default)(B).getInstance(),te=(0,d.default)(B).getInstance(),ne=(0,o.default)(B).getInstance(),re=(0,u.default)(B).getInstance(),ie=(0,S.default)(B).getInstance(),H.on(b.default.QUALITY_CHANGE_REQUESTED,U,j),H.on(b.default.REPRESENTATION_UPDATED,L,j),H.on(b.default.WALLCLOCK_TIME_UPDATED,N,j),H.on(b.default.BUFFER_LEVEL_UPDATED,k,j)}function t(e){e.abrController&&(z=e.abrController)}function n(e){Y=e,Q=Y.getIndexHandler()}function r(){return Y}function i(){return G}function a(){return K}function s(){return V}function l(){return q}function c(){H.off(b.default.QUALITY_CHANGE_REQUESTED,U,j),H.off(b.default.REPRESENTATION_UPDATED,L,j),H.off(b.default.WALLCLOCK_TIME_UPDATED,N,j),H.off(b.default.BUFFER_LEVEL_UPDATED,k,j),G=null,K=-1,V=!0,W=[],z=null,X=null,Z=null,J=null,$=null,ee=null,te=null,ne=null,re=null,ie=null}function _(e,t,n){var r,i,a=null,o=Y.getStreamInfo(),s=z.getTopQualityIndexFor(n,o.id);if(V=!0,H.trigger(b.default.DATA_UPDATE_STARTED,{sender:this}),W=D(t),null===G&&"fragmentedText"!==n?(i=z.getAverageThroughput(n),a=i||z.getInitialBitrateFor(n,o),r=z.getQualityForBitrate(Y.getMediaInfo(),a)):r=z.getQualityFor(n,o),r>s&&(r=s),q=E(r),G=e,"video"!==n&&"audio"!==n&&"fragmentedText"!==n)return V=!1,void H.trigger(b.default.DATA_UPDATE_COMPLETED,{sender:this,data:G,currentRepresentation:q});for(var u=0;u<W.length;u++)Q.updateRepresentation(W[u],!0)}function p(){var e=new Date,t=l(),n=1e3*Z.getTime();$.addRepresentationSwitch(t.adaptation.type,e,n,t.id)}function v(){var e=te.calcSegmentAvailabilityRange(q,Y.isDynamic());$.addDVRInfo(Y.getType(),Z.getTime(),Y.getStreamInfo().manifestInfo,e)}function E(e){return W[e]}function T(e){return W.indexOf(e)}function C(){for(var e=0,t=W.length;e<t;e++){var n=W[e].segmentInfoType;if(null===W[e].segmentAvailabilityRange||!x.default.hasInitialization(W[e])||("SegmentBase"===n||"BaseURL"===n)&&!W[e].segments)return!1}return!0}function D(e){var t,n=J.getValue();return K=ne.getIndexForAdaptation(G,n,e.period.index),t=ne.getRepresentationsForAdaptation(n,e)}function R(e){for(var t,n=0,r=W.length;n<r;n++)t=W[n],t.segmentAvailabilityRange=te.calcSegmentAvailabilityRange(t,e)}function P(){W.forEach(function(e){e.segmentAvailabilityRange=null})}function w(e){var t=e,n=function(){if(!s()){V=!0,H.trigger(b.default.DATA_UPDATE_STARTED,{sender:j}),P();for(var e=0;e<W.length;e++)Q.updateRepresentation(W[e],!0)}};V=!1,H.trigger(M.default.AST_IN_FUTURE,{delay:t}),setTimeout(n,t)}function L(e){if(e.sender.getStreamProcessor()===Y&&s()){var t,n,r,i=e.representation,a=$.getMetricsFor("stream"),o=$.getMetricsFor(l().adaptation.type),u=re.getCurrentManifestUpdate(a),d=!1,c=0;if("dynamic"===i.adaptation.period.mpd.manifest.type){var f=i.segmentAvailabilityRange.end-i.segmentAvailabilityRange.start,_=Z.computeLiveDelay(q.segmentDuration,Y.getStreamInfo().manifestInfo.DVRWindowSize);c=1e3*(_-f)}if(c>0)return v(),w(c),n=new I.default(F,"Segments update failed",null),void H.trigger(b.default.DATA_UPDATE_COMPLETED,{sender:this,data:G,currentRepresentation:q,error:n});if(u){for(var h=0;h<u.trackInfo.length;h++)if(t=u.trackInfo[h],t.index===i.index&&t.mediaType===Y.getType()){d=!0;break}d||$.addManifestUpdateRepresentationInfo(u,i.id,i.index,i.adaptation.period.index,Y.getType(),i.presentationTimeOffset,i.startNumber,i.segmentInfoType)}C()&&(V=!1,z.setPlaybackQuality(Y.getType(),Y.getStreamInfo(),T(q)),$.updateManifestUpdateInfo(u,{latency:q.segmentAvailabilityRange.end-Z.getTime()}),r=re.getCurrentRepresentationSwitch(o),r||p(),H.trigger(b.default.DATA_UPDATE_COMPLETED,{
sender:this,data:G,currentRepresentation:q}))}}function N(e){e.isDynamic&&R(e.isDynamic)}function k(e){e.sender.getStreamProcessor()===Y&&v()}function U(e){e.mediaType===Y.getType()&&Y.getStreamInfo().id===e.streamInfo.id&&e.oldQuality!==e.newQuality&&(q=E(e.newQuality),ee.setSavedBitrateSettings(e.mediaType,q.bandwidth),p())}var F=1,B=this.context,H=(0,O.default)(B).getInstance(),j=void 0,G=void 0,K=void 0,V=void 0,W=void 0,q=void 0,Y=void 0,z=void 0,Q=void 0,X=void 0,Z=void 0,J=void 0,$=void 0,ee=void 0,te=void 0,ne=void 0,re=void 0,ie=void 0;return j={initialize:n,setConfig:t,getData:i,getDataIndex:a,isUpdating:s,updateData:_,getStreamProcessor:r,getCurrentRepresentation:l,getRepresentationForQuality:E,reset:c},e(),j}Object.defineProperty(t,"__esModule",{value:!0});var a=n(13),o=r(a),s=n(12),u=r(s),l=n(39),d=r(l),c=n(14),f=r(c),_=n(9),h=r(_),p=n(24),g=r(p),v=n(33),m=r(v),E=n(10),y=r(E),T=n(5),S=r(T),C=n(50),A=r(C),D=n(8),I=r(D),R=n(3),O=r(R),P=n(2),b=r(P),w=n(22),M=r(w),L=n(1),N=r(L),k=n(40),x=r(k);i.__dashjs_factory_name="RepresentationController",t.default=N.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){s=[new m.default,new y.default,new S.default,new g.default],u=new h.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:s}),l=new f.default([new A.default,new I.default])}function t(e,t){var n;try{var a=window.performance.now();if(n=u.xml_str2json(e),!n)throw new Error("parser error");var o=window.performance.now();l.run(n);var d=window.performance.now();t.setMatchers(s),t.setIron(l),r("Parsing complete: ( xml2json: "+(o-a).toPrecision(3)+"ms, objectiron: "+(d-o).toPrecision(3)+"ms, total: "+((d-a)/1e3).toPrecision(3)+"s)")}catch(t){return i.manifestError("parsing the manifest failed","parse",e,t),null}return n}var n=this.context,r=(0,d.default)(n).getInstance().log,i=(0,o.default)(n).getInstance(),a=void 0,s=void 0,u=void 0,l=void 0;return a={parse:t},e(),a}Object.defineProperty(t,"__esModule",{value:!0});var a=n(11),o=r(a),s=n(1),u=r(s),l=n(4),d=r(l),c=n(89),f=r(c),_=n(38),h=r(_),p=n(103),g=r(p),v=n(101),m=r(v),E=n(100),y=r(E),T=n(102),S=r(T),C=n(98),A=r(C),D=n(99),I=r(D);i.__dashjs_factory_name="DashParser",t.default=u.default.getClassFactory(i),e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,r){n(this,e);var i=function(e){return e&&e.length&&e.charAt(0)===e.charAt(0).toUpperCase()};this._name=t,this._merge=void 0!==r?r:i(t)}return r(e,[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}]),e}();t.default=i,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}},s=n(55),u=r(s),l=function(e){function t(){i(this,t);var e=["profiles","width","height","sar","frameRate","audioSamplingRate","mimeType","segmentProfiles","codecs","maximumSAPPeriod","startWithSAP","maxPlayoutRate","codingDependency","scanType","FramePacking","AudioChannelConfiguration","ContentProtection","EssentialProperty","SupplementalProperty","InbandEventStream"];o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,"AdaptationSet",e,[new u.default("Representation",e,[new u.default("SubRepresentation",e)])])}return a(t,e),t}(u.default);t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}},s=n(55),u=r(s),l=function(e){function t(){i(this,t);var e=["SegmentBase","SegmentTemplate","SegmentList"];o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,"Period",e,[new u.default("AdaptationSet",e,[new u.default("Representation",e)])])}return a(t,e),t}(u.default);t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}},s=n(28),u=r(s),l=60,d=60,c=1e3,f=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,_=function(e){function t(){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,function(e){return f.test(e.value)},function(e){var t=f.exec(e),n=void 0;if(n=Date.UTC(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10),parseInt(t[4],10),parseInt(t[5],10),t[6]&&parseInt(t[6],10)||0,t[7]&&parseFloat(t[7])*c||0),t[9]&&t[10]){var r=parseInt(t[9],10)*d+parseInt(t[10],10);n+=("+"===t[8]?-1:1)*r*l*c}return new Date(n)})}return a(t,e),t}(u.default);t.default=_,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}},s=n(28),u=r(s),l=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,d=31536e3,c=2592e3,f=86400,_=3600,h=60,p=function(e){function t(){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,function(e){for(var t=["minBufferTime","mediaPresentationDuration","minimumUpdatePeriod","timeShiftBufferDepth","maxSegmentDuration","maxSubsegmentDuration","suggestedPresentationDelay","start","starttime","duration"],n=t.length,r=0;r<n;r++)if(e.nodeName===t[r])return l.test(e.value);return!1},function(e){var t=l.exec(e),n=parseFloat(t[2]||0)*d+parseFloat(t[4]||0)*c+parseFloat(t[6]||0)*f+parseFloat(t[8]||0)*_+parseFloat(t[10]||0)*h+parseFloat(t[12]||0);return void 0!==t[1]&&(n=-n),n})}return a(t,e),t}(u.default);t.default=p,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}},s=n(28),u=r(s),l=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,d=function(e){function t(){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,function(e){return l.test(e.value)},function(e){return parseFloat(e)})}return a(t,e),t}(u.default);t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}},s=n(28),u=r(s),l=function(e){function t(){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,function(e,t){var n={MPD:["id","profiles"],Period:["id"],BaseURL:["serviceLocation","byteRange"],SegmentBase:["indexRange"],Initialization:["range"],RepresentationIndex:["range"],SegmentList:["indexRange"],BitstreamSwitching:["range"],SegmentURL:["mediaRange","indexRange"],SegmentTemplate:["indexRange","media","index","initialization","bitstreamSwitching"],AssetIdentifier:["value","id"],EventStream:["value"],AdaptationSet:["profiles","mimeType","segmentProfiles","codecs","contentType"],FramePacking:["value","id"],AudioChannelConfiguration:["value","id"],ContentProtection:["value","id"],EssentialProperty:["value","id"],SupplementalProperty:["value","id"],InbandEventStream:["value","id"],Accessibility:["value","id"],Role:["value","id"],Rating:["value","id"],Viewpoint:["value","id"],ContentComponent:["contentType"],Representation:["id","dependencyId","mediaStreamStructureId"],Subset:["id"],Metrics:["metrics"],Reporting:["value","id"]};if(n.hasOwnProperty(t)){var r=n[t];return void 0!==r&&r.indexOf(e.name)>=0}return!1},function(e){return String(e)})}return a(t,e),t}(u.default);t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){e&&e.boxParser&&(i=e.boxParser)}function t(e){var t,n,r,a,o,s,u,l,d,c,f,_,h,p=i.parse(e),g=p.getBox("tfhd"),v=p.getBox("tfdt"),m=p.getBox("trun"),E=p.getBox("moof"),y=p.getBox("mfhd"),T=p.getBox("subs");for(f=y.sequence_number,r=m.sample_count,o=v.baseMediaDecodeTime,c=(g.base_data_offset||0)+(m.data_offset||0),s=[],h=0,l=0;l<r;l++){u=m.samples[l],t=void 0!==u.sample_duration?u.sample_duration:g.default_sample_duration,a=void 0!==u.sample_size?u.sample_size:g.default_sample_size,n=void 0!==u.sample_composition_time_offset?u.sample_composition_time_offset:0;var S={dts:o,cts:o+n,duration:t,offset:E.offset+c,size:a,subSizes:[a]};if(T&&h<T.samples_with_subsamples.length&&T.samples_with_subsamples[h].nr==l+1){for(S.subSizes=[],d=0;d<T.samples_with_subsamples[h].subsamples.length;d++){var C=T.samples_with_subsamples[h].subsamples[d].size;S.subSizes.push(C)}h++}s.push(S),c+=a,o+=t}return _=o-v.baseMediaDecodeTime,{sampleList:s,sequenceNumber:f,totalDuration:_}}function n(e){var t=i.parse(e),n=t.getBox("mdhd");return n?n.timescale:NaN}var r=void 0,i=void 0;return r={getSamplesInfo:t,getMediaTimescaleFromMoov:n,setConfig:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="FragmentedTextBoxParser",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){function n(e,n,i,a){var o,u,l,d,c,f,_,h=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,p=h.SegmentURL_asArray.length,g=[];for(_=e.startNumber,d=(0,s.decideSegmentListRangeForTemplate)(r,t,e,n,i,a),c=Math.max(d.start,0),f=Math.min(d.end,h.SegmentURL_asArray.length-1),o=c;o<=f;o++)l=h.SegmentURL_asArray[o],u=(0,s.getIndexBasedSegment)(r,t,e,o),u.replacementTime=(_+o-1)*e.segmentDuration,u.media=l.media?l.media:"",u.mediaRange=l.mediaRange,u.index=l.index,u.indexRange=l.indexRange,g.push(u),u=null;return e.availableSegmentsNumber=p,g}var r=e.timelineConverter,i=void 0;return i={getSegments:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(29);i.__dashjs_factory_name="ListSegmentsGetter";var u=o.default.getClassFactory(i);t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){function n(e,n,i,a){var o,u,l,d,c,f=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate,_=e.segmentDuration,h=e.segmentAvailabilityRange,p=[],g=null,v=null;for(c=e.startNumber,o=isNaN(_)&&!t?{start:c,end:c}:(0,s.decideSegmentListRangeForTemplate)(r,t,e,n,i,a),l=o.start,d=o.end,u=l;u<=d;u++)v=(0,s.getIndexBasedSegment)(r,t,e,u),v.replacementTime=(c+u-1)*e.segmentDuration,g=f.media,g=(0,s.replaceTokenForTemplate)(g,"Number",v.replacementNumber),g=(0,s.replaceTokenForTemplate)(g,"Time",v.replacementTime),v.media=g,p.push(v),v=null;return isNaN(_)?e.availableSegmentsNumber=1:e.availableSegmentsNumber=Math.ceil((h.end-h.start)/_),p}var r=e.timelineConverter,i=void 0;return i={getSegments:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(29);i.__dashjs_factory_name="TemplateSegmentsGetter";var u=o.default.getClassFactory(i);t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){function n(e,n,i,a){void 0===n&&(n=null);var o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,u=o.SegmentTimeline,l=o.SegmentURL_asArray,d=e.availableSegmentsNumber>0,c=void 0;c=a?a:i>-1||null!==n?10:1/0;var f,_,h,p,g,v,m,E,y,T,S,C=0,A=0,D=-1,I=[],R=null,O=function(n,i){var a=o.media,u=n.mediaRange;return l&&(a=l[i].media||"",u=l[i].mediaRange),(0,s.getTimeBasedSegment)(r,t,e,C,n.d,S,a,u,D)};for(S=e.timescale,f=u.S_asArray,T=i,null!==n&&(R=r.calcMediaTimeFromPresentationTime(n,e)),h=0,p=f.length;h<p;h++){if(_=f[h],v=0,_.hasOwnProperty("r")&&(v=_.r),_.hasOwnProperty("t")&&(C=_.t,A=C/S),v<0){if(E=f[h+1],E&&E.hasOwnProperty("t"))m=E.t/S;else{var P=e.segmentAvailabilityRange?e.segmentAvailabilityRange.end:r.calcSegmentAvailabilityRange(e,t).end;m=r.calcMediaTimeFromPresentationTime(P,e),e.segmentDuration=_.d/S}v=Math.ceil((m-A)/(_.d/S))-1}if(y){if(d)break;D+=v+1}else for(g=0;g<=v;g++)if(D++,I.length>c){if(y=!0,d)break}else null!==R?A>=R-_.d/S*1.5&&I.push(O(_,D)):D>=T&&I.push(O(_,D)),C+=_.d,A=C/S}return d||(e.availableSegmentsNumber=D+1),I}var r=e.timelineConverter,i=void 0;return i={getSegments:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(29);i.__dashjs_factory_name="TimelineSegmentsGetter";var u=o.default.getClassFactory(i);t.default=u,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.period=null,this.index=-1,this.type=null};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri=""};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null};r.DEFAULT_ID="defaultId",t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){_=(0,o.default)(s).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier})}function n(e){var t=function(t){l.trigger(h.default.CHECK_FOR_EXISTENCE_COMPLETED,{request:e,exists:t})};if(e){var n=new u.default(e.url);_.load({request:n,success:function(){t(!0)},error:function(){t(!1)}})}else t(!1)}function r(e){var t=function(t,n){l.trigger(h.default.LOADING_COMPLETED,{request:e,response:t||null,error:n||null,sender:c})};e?_.load({request:e,progress:function(){l.trigger(h.default.LOADING_PROGRESS,{request:e})},success:function(e){t(e)},error:function(e,n,r){t(void 0,new d.default(v,r,n))}}):t(void 0,new d.default(m,E))}function i(){_&&_.abort()}function a(){_&&(_.abort(),_=null)}var s=this.context,l=(0,f.default)(s).getInstance(),c=void 0,_=void 0;return c={checkForExistence:n,load:r,abort:i,reset:a},t(),c}Object.defineProperty(t,"__esModule",{value:!0});var a=n(23),o=r(a),s=n(182),u=r(s),l=n(8),d=r(l),c=n(3),f=r(c),_=n(2),h=r(_),p=n(1),g=r(p),v=1,m=2,E="request is null";i.__dashjs_factory_name="FragmentLoader";var y=g.default.getClassFactory(i);y.FRAGMENT_LOADER_ERROR_LOADING_FAILURE=v,y.FRAGMENT_LOADER_ERROR_NULL_REQUEST=m,t.default=y,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){s.on(E.default.XLINK_READY,n,_),g=(0,u.default)(a).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier}),m=(0,o.default)(a).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier})}function n(e){s.trigger(E.default.INTERNAL_MANIFEST_LOADED,{manifest:e.manifest})}function r(e){var t=new f.default(e,p.HTTPRequest.MPD_TYPE);g.load({request:t,success:function(t,n,r){var i,a;r.responseURL&&r.responseURL!==e?(a=l.parseBaseUrl(r.responseURL),i=r.responseURL):(l.isRelative(e)&&(e=l.resolve(e,window.location.href)),a=l.parseBaseUrl(e));var o=c.parse(t,m);o?(o.url=i||e,o.originalUrl||(o.originalUrl=o.url),o.baseUri=a,o.loadedTime=new Date,m.resolveManifestOnLoad(o)):s.trigger(E.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new h.default(S,A)})},error:function(t,n,r){s.trigger(E.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new h.default(C,"Failed loading manifest: "+e+", "+r)})}})}function i(){s.off(E.default.XLINK_READY,n,_),m&&(m.reset(),m=null),g&&(g.abort(),g=null)}var a=this.context,s=(0,v.default)(a).getInstance(),l=(0,d.default)(a).getInstance(),c=e.parser,_=void 0,g=void 0,m=void 0;return _={load:r,reset:i},t(),_}Object.defineProperty(t,"__esModule",{value:!0});var a=n(127),o=r(a),s=n(23),u=r(s),l=n(26),d=r(l),c=n(73),f=r(c),_=n(8),h=r(_),p=n(6),g=n(3),v=r(g),m=n(2),E=r(m),y=n(1),T=r(y),S=1,C=2,A="parsing failed";i.__dashjs_factory_name="ManifestLoader";var D=T.default.getClassFactory(i);D.MANIFEST_LOADER_ERROR_PARSING_FAILURE=S,D.MANIFEST_LOADER_ERROR_LOADING_FAILURE=C,t.default=D,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){e&&(e.manifestModel&&(R=e.manifestModel),e.dashManifestModel&&(O=e.dashManifestModel))}function t(e){I=e,S=NaN,C=null,D=!1,A=!0,P=(0,f.default)(m).getInstance(),y.on(u.default.STREAMS_COMPOSED,v,this),y.on(u.default.PLAYBACK_STARTED,p,this),y.on(u.default.PLAYBACK_PAUSED,g,this),y.on(u.default.INTERNAL_MANIFEST_LOADED,_,this)}function n(e){d(e)}function r(){return I}function i(){y.off(u.default.PLAYBACK_STARTED,p,this),y.off(u.default.PLAYBACK_PAUSED,g,this),y.off(u.default.STREAMS_COMPOSED,v,this),y.off(u.default.INTERNAL_MANIFEST_LOADED,_,this),a(),A=!0,D=!1,S=NaN,P=null}function a(){null!==C&&(clearInterval(C),C=null)}function s(){a(),isNaN(S)||(E("Refresh manifest in "+S+" seconds."),C=setTimeout(c,1e3*S))}function l(){D=!0;var e=R.getValue(),t=e.url,n=O.getLocation(e);n&&(t=n),I.load(t)}function d(e){R.setValue(e);var t=new Date,n=(t.getTime()-e.loadedTime.getTime())/1e3;S=O.getManifestUpdatePeriod(e,n),y.trigger(u.default.MANIFEST_UPDATED,{manifest:e}),E("Manifest has been refreshed at "+t+"["+t.getTime()/1e3+"] "),A||s()}function c(){A&&!P.getScheduleWhilePaused()||D||l()}function _(e){e.error||d(e.manifest)}function p(){A=!1,s()}function g(){A=!0,a()}function v(){D=!1}var m=this.context,E=(0,h.default)(m).getInstance().log,y=(0,o.default)(m).getInstance(),T=void 0,S=void 0,C=void 0,A=void 0,D=void 0,I=void 0,R=void 0,O=void 0,P=void 0;return T={initialize:t,setManifest:n,getManifestLoader:r,refreshManifest:l,setConfig:e,reset:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),o=r(a),s=n(2),u=r(s),l=n(1),d=r(l),c=n(5),f=r(c),_=n(4),h=r(_);i.__dashjs_factory_name="ManifestUpdater",t.default=d.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t,n){if(!e||"VIDEO"!==e.nodeName)return null;if(e._dashjs_player)return e._dashjs_player;var i,a=e.id||e.name||"video element";if(t=t||[].slice.call(e.querySelectorAll("source")).filter(function(e){return e.type==r})[0],!t&&e.src)t=document.createElement("source"),t.src=e.src;else if(!t&&!e.src)return null;return n=n||{},i=(0,u.default)(n).create(),i.initialize(e,t.src,e.autoplay),i.getDebug().log("Converted "+a+" to dash.js player and added content: "+t.src),e._dashjs_player=i,i}function t(t,i){var a=[];t=t||"[data-dashjs-player]",i=i||document;for(var o=i.querySelectorAll(t),s=0;s<o.length;s++){var u=e(o[s],null);a.push(u)}for(var l=i.querySelectorAll('source[type="'+r+'"]'),s=0;s<l.length;s++){var d=n(l[s]),u=e(d,null);a.push(u)}return a}function n(e){for(var t=!0;t;){var n=e;if(t=!1,"video"===n.nodeName.toLowerCase())return n;e=n.parentNode,t=!0}}var r="application/dash+xml";return{create:e,createAll:t}}function a(){window.removeEventListener("load",a),l.createAll()}function o(){window.dashjs&&(window.clearInterval(d),l.createAll())}Object.defineProperty(t,"__esModule",{value:!0});var s=n(60),u=r(s),l=i(),d=void 0,c="undefined"!=typeof window&&window&&window.dashjs&&window.dashjs.skipAutoCreate;!c&&"undefined"!=typeof window&&window&&window.addEventListener&&("complete"===window.document.readyState?window.dashjs?l.createAll():d=window.setInterval(o,500):window.addEventListener("load",a)),t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){le=[],de=!1,ce=!1,fe=null,_e={},he=!1,pe=!1,ve=(0,o.default)(J).getInstance(),me=(0,S.default)(J).getInstance(),Se=(0,g.default)(J).getInstance(),Ee=(0,d.default)(J).getInstance(),ye=(0,h.default)(J).create(),Ce=(0,H.default)(J).getInstance(),ee.on(N.default.BUFFERING_COMPLETED,q,ue),ee.on(N.default.DATA_UPDATE_COMPLETED,Y,ue)}function n(e,t){fe=e,ge=t,ge&&(ee.on(N.default.KEY_ERROR,P,ue),ee.on(N.default.SERVER_CERTIFICATE_UPDATED,P,ue),ee.on(N.default.LICENSE_REQUEST_COMPLETE,P,ue),ee.on(N.default.KEY_SYSTEM_SELECTED,P,ue),ee.on(N.default.KEY_SESSION_CREATED,P,ue))}function r(e){de||(ee.on(N.default.CURRENT_TRACK_CHANGED,k,ue),G(e),de=!0)}function i(){for(var e=le.length,t=0;t<e;t++)le[t].reset();le=[],de=!1,ce=!1,C(),ee.off(N.default.CURRENT_TRACK_CHANGED,k,ue)}function a(){me&&(me.pause(),me=null),ye&&(ye.reset(),ye=null),i(),Ee=null,Se=null,ne=null,te=null,re=null,ie=null,$=null,ae=null,he=!1,pe=!1,_e={},ee.off(N.default.DATA_UPDATE_COMPLETED,Y,ue),ee.off(N.default.BUFFERING_COMPLETED,q,ue),ee.off(N.default.KEY_ERROR,P,ue),ee.off(N.default.SERVER_CERTIFICATE_UPDATED,P,ue),ee.off(N.default.LICENSE_REQUEST_COMPLETE,P,ue),ee.off(N.default.KEY_SYSTEM_SELECTED,P,ue),ee.off(N.default.KEY_SESSION_CREATED,P,ue)}function s(){return fe.duration}function l(){return fe.start}function c(){return fe.index}function _(){return fe.id}function p(){return fe}function v(e){return null!==V(e)}function E(e){var t=V(e);return Se.getBitrateList(t)}function T(){Te&&Te.start()}function C(){Te&&Te.clear()}function D(){return de}function R(){return pe}function P(e){e.error&&(ae.mediaKeySessionError(e.error),$(e.error),a())}function w(e){return"text"===e.type?e.mimeType:e.type}function L(e,t,n){var r,i,a=e.type;if("muxed"===a&&e)return i="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",$(i),ae.manifestError(i,"multiplexedrep",te.getValue()),!1;if("text"===a||"fragmentedText"===a||"embeddedText"===a)return!0;if(r=e.codec,$(a+" codec: "+r),e.contentProtection&&!ie.supportsEncryptedMedia())ae.capabilityError("encryptedmedia");else if(!ie.supportsCodec((0,m.default)(J).getInstance().getElement(),r))return i=a+"Codec ("+r+") is not supported.",ae.manifestError(i,"codec",n),$(i),!1;return!0}function k(e){if(e.newMediaInfo.streamInfo.id===fe.id){var t=z(e.oldMediaInfo);if(t){var n=me.getTime(),r=t.getBuffer(),i=e.newMediaInfo,a=te.getValue(),o=le.indexOf(t),s=t.getMediaSource();"fragmentedText"!==i.type?(t.reset(!0),B(i,a,s,{buffer:r,replaceIdx:o,currentTime:n}),me.seek(me.getTime())):t.updateMediaInfo(a,i)}}}function U(e){var t=e.split("/")[1];return"webm"===t.toLowerCase()}function F(e){var t=U(e.mimeType)?(0,O.default)(J).getInstance():(0,I.default)(J).getInstance();t.setConfig({baseURLController:se,metricsModel:(0,y.default)(J).getInstance()}),t.initialize();var n=(0,A.default)(J).create({segmentBaseLoader:t,timelineConverter:oe,dashMetrics:(0,b.default)(J).getInstance(),metricsModel:(0,y.default)(J).getInstance(),baseURLController:se});return n}function B(e,t,n,r){var i=(0,u.default)(J).create({indexHandler:F(e),timelineConverter:oe,adapter:re,manifestModel:te}),a=re.getAllMediaInfoForType(t,fe,e.type);if(i.initialize(w(e),ye,n,ue,Te),Se.updateTopQualityIndex(e),r?(i.setBuffer(r.buffer),i.getIndexHandler().setCurrentTime(r.currentTime),le[r.replaceIdx]=i):le.push(i),"text"===e.type||"fragmentedText"===e.type){for(var o,s=0;s<a.length;s++)a[s].index===e.index&&(o=s),i.updateMediaInfo(t,a[s]);"fragmentedText"===e.type&&i.updateMediaInfo(t,a[o])}else i.updateMediaInfo(t,e);return i}function j(e,t){var n,r=te.getValue(),i=re.getAllMediaInfoForType(r,fe,e),a=null;if(!i||0===i.length)return void $("No "+e+" data.");for(var o=0,s=i.length;o<s;o++)if(a=i[o],"embeddedText"===e)Ce.addEmbeddedTrack(a);else{if(!L(a,t,r))continue;Ee.isMultiTrackSupportedByType(a.type)&&Ee.addTrack(a,fe)}"embeddedText"!==e&&0!==Ee.getTracksFor(e,fe).length&&(Ee.checkInitialMediaSettingsForType(e,fe),n=Ee.getCurrentTrackFor(e,fe),B(n,r,t))}function G(e){var t,n=te.getValue();if(Te=(0,f.default)(J).getInstance(),Te.initialize(),Te.setConfig({manifestModel:te,manifestUpdater:ne}),t=re.getEventsFor(n,fe),Te.addInlineEvents(t),he=!0,j("video",e),j("audio",e),j("text",e),j("fragmentedText",e),j("embeddedText",e),j("muxed",e),W(),ce=!0,he=!1,0===le.length){var r="No streams to play.";ae.manifestError(r,"nostreams",n),$(r)}else ve.initialize(oe,le[0]),K()}function K(){var e=le.length,t=!!_e.audio||!!_e.video,n=t?new Error(Z,"Data update failed",null):null,r=0;for(r;r<e;r++)if(le[r].isUpdating()||he)return;pe=!0,ce&&(ge&&ge.initialize(te.getValue(),V("audio"),V("video")),ee.trigger(N.default.STREAM_INITIALIZED,{streamInfo:fe,error:n}))}function V(e){for(var t=le.length,n=null,r=0;r<t;r++)if(n=le[r],n.getType()===e)return n.getMediaInfo();return null}function W(){for(var e=0,t=le.length;e<t;e++)le[e].createBuffer()}function q(e){if(e.streamInfo===fe){var t=Q(),n=t.length,r=0;for(r;r<n;r++)if(!t[r].isBufferingCompleted())return;ee.trigger(N.default.STREAM_BUFFERING_COMPLETED,{streamInfo:fe})}}function Y(e){var t=e.sender.getStreamProcessor();t.getStreamInfo()===fe&&(_e[t.getType()]=e.error,K())}function z(e){if(!e)return!1;var t=Q();return t.filter(function(t){return t.getType()===e.type})[0]}function Q(){var e,t,n=le.length,r=[],i=0;for(i;i<n;i++)t=le[i],e=t.getType(),"audio"!==e&&"video"!==e&&"fragmentedText"!==e||r.push(t);return r}function X(e){$("Manifest updated... updating data system wide.");var t=te.getValue();if(de=!1,he=!0,pe=!1,fe=e,Te){var n=re.getEventsFor(t,fe);Te.addInlineEvents(n)}for(var r=0,i=le.length;r<i;r++){var a=le[r],o=re.getMediaInfoForType(t,fe,a.getType());Se.updateTopQualityIndex(o),a.updateMediaInfo(t,o)}he=!1,K()}var Z=1,J=this.context,$=(0,x.default)(J).getInstance().log,ee=(0,M.default)(J).getInstance(),te=e.manifestModel,ne=e.manifestUpdater,re=e.adapter,ie=e.capabilities,ae=e.errHandler,oe=e.timelineConverter,se=e.baseURLController,ue=void 0,le=void 0,de=void 0,ce=void 0,fe=void 0,_e=void 0,he=void 0,pe=void 0,ge=void 0,ve=void 0,me=void 0,Ee=void 0,ye=void 0,Te=void 0,Se=void 0,Ce=void 0;return ue={initialize:n,activate:r,deactivate:i,getDuration:s,getStartTime:l,getStreamIndex:c,getId:_,getStreamInfo:p,hasMedia:v,getBitrateListFor:E,startEventController:T,isActivated:D,isInitialized:R,updateData:X,reset:a,getProcessors:Q},t(),ue}Object.defineProperty(t,"__esModule",{value:!0});var a=n(51),o=r(a),s=n(117),u=r(s),l=n(15),d=r(l),c=n(121),f=r(c),_=n(122),h=r(_),p=n(14),g=r(p),v=n(18),m=r(v),E=n(10),y=r(E),T=n(9),S=r(T),C=n(92),A=r(C),D=n(93),I=r(D),R=n(94),O=r(R),P=n(12),b=r(P),w=n(3),M=r(w),L=n(2),N=r(L),k=n(4),x=r(k),U=n(1),F=r(U),B=n(16),H=r(B);
i.__dashjs_factory_name="Stream",t.default=F.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){ne=[]}function n(e,t,n,r,i){te=e,re=r,ie=i,le=t,$=re.getStreamInfo().manifestInfo.isDynamic,z.initialize(this),ae=(0,o.default)(Y).getInstance(),ae.initialize(te,this),oe=q(e),se=(0,g.default)(Y).create({metricsModel:(0,S.default)(Y).getInstance(),manifestModel:Z,adapter:X,dashMetrics:(0,N.default)(Y).getInstance(),dashManifestModel:(0,M.default)(Y).getInstance(),timelineConverter:Q,rulesController:(0,m.default)(Y).getInstance(),mediaPlayerModel:(0,y.default)(Y).getInstance()}),oe.initialize(te,n,this),se.initialize(te,this),de=(0,A.default)(Y).create({metricsModel:(0,S.default)(Y).getInstance(),errHandler:(0,F.default)(Y).getInstance(),requestModifier:(0,I.default)(Y).getInstance()}),ce=se.getFragmentModel(),ce.setLoader(de),ue=(0,x.default)(Y).create(),ue.initialize(this)}function r(e){z.reset(),oe&&(oe.reset(e),oe=null),se&&(se.reset(),se=null),ue&&(ue.reset(),ue=null),le=null,de=null,ie=null,re=null,$=null,ee=null,ne=[],te=null}function i(){return ue.isUpdating()}function a(){return te}function s(){return ae}function l(){return ue}function c(){return de}function _(){return z}function p(){return le}function v(){return oe.getBuffer()}function E(e){oe.setBuffer(e)}function T(){return oe}function C(){return ce}function D(){return re?re.getStreamInfo():null}function R(e,t){t===ee||t&&ee&&t.type!==ee.type||(ee=t),ne.indexOf(t)===-1&&ne.push(t),X.updateData(e,this)}function P(){return ne}function w(){return ee}function L(){return oe.getMediaSource()}function k(){return se}function U(){return ie}function B(){se.start()}function H(){se.stop()}function j(){return X.getCurrentRepresentationInfo(Z.getValue(),ue)}function G(e){return X.getRepresentationInfoForQuality(Z.getValue(),ue,e)}function K(){return oe.getIsBufferingCompleted()}function V(){return oe.getBuffer()||oe.createBuffer(ee)}function W(){return $}function q(e){var t=null;return t="video"===e||"audio"===e||"fragmentedText"===e?(0,u.default)(Y).create({metricsModel:(0,S.default)(Y).getInstance(),manifestModel:Z,sourceBufferController:(0,O.default)(Y).getInstance(),errHandler:(0,F.default)(Y).getInstance(),streamController:(0,d.default)(Y).getInstance(),mediaController:(0,f.default)(Y).getInstance(),adapter:X,textSourceBuffer:(0,b.default)(Y).getInstance()}):(0,h.default)(Y).create({errHandler:(0,F.default)(Y).getInstance(),sourceBufferController:(0,O.default)(Y).getInstance()})}var Y=this.context,z=e.indexHandler,Q=e.timelineConverter,X=e.adapter,Z=e.manifestModel,J=void 0,$=void 0,ee=void 0,te=void 0,ne=void 0,re=void 0,ie=void 0,ae=void 0,oe=void 0,se=void 0,ue=void 0,le=void 0,de=void 0,ce=void 0;return J={initialize:n,isUpdating:i,getType:a,getBufferController:T,getABRController:s,getFragmentLoader:c,getFragmentModel:C,getScheduleController:k,getEventController:U,getFragmentController:p,getRepresentationController:l,getIndexHandler:_,getCurrentRepresentationInfo:j,getRepresentationInfoForQuality:G,isBufferingCompleted:K,createBuffer:V,getStreamInfo:D,updateMediaInfo:R,getMediaInfoArr:P,getMediaInfo:w,getMediaSource:L,getBuffer:v,setBuffer:E,start:B,stop:H,isDynamic:W,reset:r},t(),J}Object.defineProperty(t,"__esModule",{value:!0});var a=n(14),o=r(a),s=n(17),u=r(s),l=n(24),d=r(l),c=n(15),f=r(c),_=n(125),h=r(_),p=n(124),g=r(p),v=n(68),m=r(v),E=n(5),y=r(E),T=n(10),S=r(T),C=n(112),A=r(C),D=n(35),I=r(D),R=n(30),O=r(R),P=n(16),b=r(P),w=n(13),M=r(w),L=n(12),N=r(L),k=n(95),x=r(k),U=n(11),F=r(U),B=n(1),H=r(B);i.__dashjs_factory_name="StreamProcessor",t.default=H.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t,n){var i=function(r,i){t.resolved=!0,t.resolvedContent=r?r:null,a.trigger(p.default.XLINK_ELEMENT_LOADED,{element:t,resolveObject:n,error:r||i?null:new o.default(m,"Failed loading Xlink element: "+e)})};if(e===r)i(null,!0);else{var u=new c.default(e,l.HTTPRequest.XLINK_TYPE);s.load({request:u,success:function(e){i(e)},error:function(){i(null)}})}}function n(){s&&(s.abort(),s=null)}var r="urn:mpeg:dash:resolve-to-zero:2013",i=this.context,a=(0,_.default)(i).getInstance(),s=(0,u.default)(i).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier}),d=void 0;return d={load:t,reset:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),o=r(a),s=n(23),u=r(s),l=n(6),d=n(73),c=r(d),f=n(3),_=r(f),h=n(2),p=r(h),g=n(1),v=r(g),m=1;i.__dashjs_factory_name="XlinkLoader";var E=v.default.getClassFactory(i);E.XLINK_LOADER_ERROR_LOADING_FAILURE=m,t.default=E,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){p.invalidateSelectedIndexes(e.entry)}function t(){p=(0,o.default)(c).create(),v=(0,u.default)(c).create(),_.on(m.default.SERVICE_LOCATION_BLACKLIST_CHANGED,e,l)}function n(e){e.baseURLTreeModel&&(p=e.baseURLTreeModel),e.baseURLSelector&&(v=e.baseURLSelector)}function r(e){p.update(e),v.chooseSelectorFromManifest(e)}function i(e){var t=p.getForPath(e),n=t.reduce(function(e,t){var n=v.select(t);return n?(h.isRelative(n.url)?e.url=h.resolve(n.url,e.url):(e.url=n.url,e.serviceLocation=n.serviceLocation),e):new f.default},new f.default);if(!h.isRelative(n.url))return n}function a(){p.reset(),v.reset()}function s(e){r(e)}var l=void 0,c=this.context,_=(0,g.default)(c).getInstance(),h=(0,d.default)(c).getInstance(),p=void 0,v=void 0;return l={reset:a,initialize:s,resolve:i,setConfig:n},t(),l}Object.defineProperty(t,"__esModule",{value:!0});var a=n(147),o=r(a),s=n(173),u=r(s),l=n(26),d=r(l),c=n(57),f=r(c),_=n(1),h=r(_),p=n(3),g=r(p),v=n(2),m=r(v);i.__dashjs_factory_name="BaseURLController",t.default=h.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){return!!(o.length&&e&&e.length)&&o.indexOf(e)!==-1}function n(e){o.indexOf(e)===-1&&(o.push(e),s.trigger(l,{entry:e}))}function r(e){e.error&&n(e.request.serviceLocation)}function i(){d&&s.on(d,r,this)}function a(){o=[]}var o=[],s=(0,u.default)(this.context).getInstance(),l=e.updateEventName,d=e.loadFailedEventName;return i(),{add:n,contains:t,reset:a}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(3),u=r(s);i.__dashjs_factory_name="BlackListController",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){P=!1,y={},T={},S={},C=null,A=100,D=A/1e3,O=(0,o.default)(g).getInstance()}function t(){null!==C&&P&&(clearInterval(C),C=null,P=!1)}function n(){v("Start Event Controller"),P||isNaN(A)||(P=!0,C=setInterval(s,A))}function r(e){if(y={},e)for(var t=0;t<e.length;t++){var n=e[t];y[n.id]=n,v("Add inline event with id "+n.id)}v("Added "+e.length+" inline events")}function i(e){for(var t=0;t<e.length;t++){var n=e[t];n.id in T?v("Repeated event with id "+n.id):(T[n.id]=n,v("Add inband event with id "+n.id))}}function a(){if(S)for(var e=O.getTime(),t=Object.keys(S),n=0;n<t.length;n++){var r=t[n],i=S[r];null!==i&&(i.duration+i.presentationTime)/i.eventStream.timescale<e&&(v("Remove Event "+r+" at time "+e),i=null,delete S[r])}}function s(){l(T),l(y),a()}function u(){var e=I.getValue(),t=e.url;e.hasOwnProperty("Location")&&(t=e.Location),v("Refresh manifest @ "+t),R.getManifestLoader().load(t)}function l(e){var t,n=O.getTime();if(e)for(var r=Object.keys(e),i=0;i<r.length;i++){var a=r[i],o=e[a];void 0!==o&&(t=o.presentationTime/o.eventStream.timescale,(0===t||t<=n&&t+D>n)&&(v("Start Event "+a+" at "+n),o.duration>0&&(S[a]=o),o.eventStream.schemeIdUri==h&&o.eventStream.value==p?u():m.trigger(o.eventStream.schemeIdUri,{event:o}),delete e[a]))}}function c(e){e&&(e.manifestModel&&(I=e.manifestModel),e.manifestUpdater&&(R=e.manifestUpdater))}function _(){t(),y=null,T=null,S=null,O=null}var h="urn:mpeg:dash:event:2012",p=1,g=this.context,v=(0,d.default)(g).getInstance().log,m=(0,f.default)(g).getInstance(),E=void 0,y=void 0,T=void 0,S=void 0,C=void 0,A=void 0,D=void 0,I=void 0,R=void 0,O=void 0,P=void 0;return E={initialize:e,addInlineEvents:r,addInbandEvents:i,clear:t,start:n,setConfig:c,reset:_}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(9),o=r(a),s=n(1),u=r(s),l=n(4),d=r(l),c=n(3),f=r(c);i.__dashjs_factory_name="EventController",t.default=u.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){g={},f.on(p.default.FRAGMENT_LOADING_COMPLETED,o,h)}function t(e){var t=g[e];return t||(t=(0,l.default)(u).create({metricsModel:(0,c.default)(u).getInstance()}),g[e]=t),t}function n(e){return e&&e.type&&e.type===a.HTTPRequest.INIT_SEGMENT_TYPE}function r(){f.off(p.default.FRAGMENT_LOADING_COMPLETED,o,this);for(var e in g)g[e].reset();g={}}function i(e,t,n){var r=new s.default;return r.streamId=n,r.mediaInfo=t.mediaInfo,r.segmentType=t.type,r.start=t.startTime,r.duration=t.duration,r.end=r.start+r.duration,r.bytes=e,r.index=t.index,r.quality=t.quality,r}function o(e){if(g[e.request.mediaType]===e.sender){var t=e.sender.getScheduleController(),r=e.request,a=e.response,o=n(r),s=t.getStreamProcessor().getStreamInfo();if(!a||!s)return void d("No "+r.mediaType+" bytes to push or stream is inactive.");var u=i(a,r,s.id);f.trigger(o?p.default.INIT_FRAGMENT_LOADED:p.default.MEDIA_FRAGMENT_LOADED,{chunk:u,fragmentModel:e.sender})}}var u=this.context,d=(0,E.default)(u).getInstance().log,f=(0,_.default)(u).getInstance(),h=void 0,g=void 0;return h={getModel:t,isInitializationRequest:n,reset:r},e(),h}Object.defineProperty(t,"__esModule",{value:!0});var a=n(6),o=n(181),s=r(o),u=n(32),l=r(u),d=n(10),c=r(d),f=n(3),_=r(f),h=n(2),p=r(h),g=n(1),v=r(g),m=n(4),E=r(m);i.__dashjs_factory_name="FragmentController",t.default=v.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){var e="WebKitMediaSource"in window,t="MediaSource"in window;return t?new MediaSource:e?new WebKitMediaSource:null}function t(e,t){var n=window.URL.createObjectURL(e);return t.setSource(n),n}function n(e){e.setSource(null)}function r(e,t){return e.duration!=t&&(e.duration=t),e.duration}function i(e){var t=e.sourceBuffers,n=t.length,r=0;if("open"===e.readyState){for(r;r<n;r++){if(t[r].updating)return;if(0===t[r].buffered.length)return}e.endOfStream()}}var a=void 0;return a={createMediaSource:e,attachMediaSource:t,detachMediaSource:n,setDuration:r,signalEndOfStream:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="MediaSourceController",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){Se=!0,Ke=NaN,je=NaN,Ge={},Ve=[],Ce=!1,Ae=null,De=null,Ie=!0,Re=!1,Oe=0,be=NaN}function n(e,t){me=e,Ne=t,we=(0,s.default)(se).getInstance(),Me=(0,_.default)(se).getInstance(),Le=(0,l.default)(se).getInstance(),ke=(0,B.default)(se).getInstance(),xe=Ne.getFragmentController(),Ue=Ne.getBufferController(),Ee=xe.getModel(me),Ee.setScheduleController(this),ye=Ne.isDynamic(),He=ge.getScheduleWhilePaused(),Fe=(0,p.default)(se).create({dashMetrics:(0,D.default)(se).getInstance(),metricsModel:(0,T.default)(se).getInstance(),textSourceBuffer:(0,E.default)(se).getInstance()}),Be=(0,v.default)(se).create({adapter:(0,R.default)(se).getInstance(),sourceBufferController:(0,P.default)(se).getInstance(),textSourceBuffer:(0,E.default)(se).getInstance()}),he.getIsTextTrack(me)&&le.on(k.default.TIMED_TEXT_REQUESTED,W,this),le.on(k.default.QUALITY_CHANGE_REQUESTED,y,this),le.on(k.default.DATA_UPDATE_STARTED,F,this),le.on(k.default.DATA_UPDATE_COMPLETED,A,this),le.on(k.default.FRAGMENT_LOADING_COMPLETED,M,this),le.on(k.default.STREAM_COMPLETED,b,this),le.on(k.default.STREAM_INITIALIZED,I,this),le.on(k.default.BUFFER_LEVEL_STATE_CHANGED,G,this),le.on(k.default.BUFFER_CLEARED,H,this),le.on(k.default.BYTES_APPENDED,x,this),le.on(k.default.INIT_REQUESTED,h,this),le.on(k.default.QUOTA_EXCEEDED,K,this),le.on(k.default.BUFFER_LEVEL_STATE_CHANGED,G,this),le.on(k.default.PLAYBACK_SEEKING,Y,this),le.on(k.default.PLAYBACK_STARTED,q,this),le.on(k.default.PLAYBACK_RATE_CHANGED,z,this),le.on(k.default.PLAYBACK_TIME_UPDATED,N,this),le.on(k.default.URL_RESOLUTION_FAILED,V,this),le.on(k.default.FRAGMENT_LOADING_ABANDONED,U,this)}function r(){Te&&!Ue.getIsBufferingCompleted()&&(ae(),Ce=!1,Se?(Se=!1,g(Te.quality)):f(0),ue("Schedule controller starting for "+me))}function i(){Ce||(Ce=!0,clearTimeout(Pe),ue("Schedule controller stopping for "+me))}function o(e,t){Ge[t]=Ge[t]||{};var n=Le.getTopQualityIndexFor(e,t);return Ge[t][e]!=n&&(ue("Top quality"+e+" index has changed from "+Ge[t][e]+" to "+n),Ge[t][e]=n,!0)}function u(){if(!(Ce||Re||!Ue||we.isPaused()&&!He)){d();var e=Ve.length>0;if(e||o(Te.mediaInfo.type,Ne.getStreamInfo().id)||Fe.execute(Ne,me,ke.isVideoTrackPresent())){var t=function(){if(Te.quality!==Ke)Ke=Te.quality,Ue.switchInitData(Ne.getStreamInfo().id,Te.quality);else{var e=Ve.shift();if(xe.isInitializationRequest(e))g(e.quality);else{var t=Be.execute(Ne,e);t?Ee.executeRequest(t):(Re=!1,f(500))}}};Re=!0,e?t():(Le.getPlaybackQuality(Ne),t())}else f(500)}}function d(){var e=1.5*Te.fragmentDuration,t=Ee.getRequests({state:C.default.FRAGMENT_MODEL_EXECUTED,time:we.getTime()+e,threshold:0})[0];t&&Ve.indexOf(t)===-1&&!he.getIsTextTrack(me)&&(!Me.isCurrentTrack(t.mediaInfo)||ge.getFastSwitchEnabled()&&t.quality<Te.quality&&Ue.getBufferLevel()>=e&&Le.getAbandonmentStateFor(me)!==l.default.ABANDON_LOAD?(m(t),ue("Reloading outdated fragment at index: ",t.index)):t.quality>Te.quality&&X(we.getTime()+Ue.getBufferLevel()))}function f(e){clearTimeout(Pe),Pe=setTimeout(u,e)}function h(e){e.sender.getStreamProcessor()===Ne&&g(Te.quality)}function g(e){Ke=e;var t=fe.getInitRequest(Ne,e);t&&(Re=!0,Ee.executeRequest(t))}function m(e){Ve.push(e)}function y(e){if(me===e.mediaType&&Ne.getStreamInfo().id===e.streamInfo.id){if(Te=Ne.getRepresentationInfoForQuality(e.newQuality),null===Te||void 0===Te)throw new Error("Unexpected error! - currentRepresentationInfo is null or undefined");ie(new Date,a.PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON),ae()}}function S(e){var t=Ee.getRequests({state:C.default.FRAGMENT_MODEL_EXECUTED,time:we.getTime(),threshold:0})[0];t&&we.getTime()>=t.startTime&&(t.quality!==je&&e&&le.trigger(k.default.QUALITY_CHANGE_RENDERED,{mediaType:me,oldQuality:je,newQuality:t.quality}),je=t.quality)}function A(e){e.error||e.sender.getStreamProcessor()!==Ne||(Te=fe.convertDataToTrack(ce.getValue(),e.currentRepresentation))}function I(e){e.error||Ne.getStreamInfo().id!==e.streamInfo.id||(Te=Ne.getCurrentRepresentationInfo(),ye&&Se&&(pe.setTimeSyncCompleted(!0),O()),Ce&&r())}function O(){var e=(0,w.default)(se).getInstance().getLiveEdge(),t=Te.mediaInfo.streamInfo.manifestInfo.DVRWindowSize/2,n=e-we.computeLiveDelay(Te.fragmentDuration,t),r=fe.getFragmentRequestForTime(Ne,Te,n,{ignoreIsFinished:!0});be=we.getLiveStartTime(),(isNaN(be)||r.startTime>be)&&(we.setLiveStartTime(r.startTime),be=r.startTime);var i=_e.getCurrentManifestUpdate(de.getMetricsFor("stream"));de.updateManifestUpdateInfo(i,{currentTime:be,presentationStartTime:e,latency:e-be,clientTimeOffset:pe.getClientTimeOffset()})}function b(e){e.fragmentModel===Ee&&(i(),Re=!1,ue("Stream is complete"))}function M(e){e.sender===Ee&&(he.getIsTextTrack(me)&&(Re=!1),e.error&&e.request.serviceLocation&&!Ce&&(m(e.request),Re=!1,f(0)))}function N(){S(!0)}function x(e){e.sender.getStreamProcessor()===Ne&&(Re=!1,f(0))}function U(e){e.streamProcessor===Ne&&(m(e.request),Re=!1,f(0))}function F(e){e.sender.getStreamProcessor()===Ne&&i()}function H(e){e.sender.getStreamProcessor()===Ne&&(Ee.removeExecutedRequestsBeforeTime(e.to),e.hasEnoughSpaceToAppend&&Ce&&r())}function G(e){e.sender.getStreamProcessor()!==Ne||e.state!==c.default.BUFFER_EMPTY||we.isSeeking()||(ue("Buffer is empty! Stalling!"),ie(new Date,a.PlayListTrace.REBUFFERING_REASON))}function K(e){e.sender.getStreamProcessor()===Ne&&i()}function V(){Ee.abortRequests(),i()}function W(e){e.sender.getStreamProcessor()===Ne&&g(e.index)}function q(){!Ce&&He||r()}function Y(e){be=e.seekTime,J(0),Ce&&r();var t=_e.getCurrentManifestUpdate(de.getMetricsFor("stream")),n=Te.DVRWindow?Te.DVRWindow.end-we.getTime():NaN;de.updateManifestUpdateInfo(t,{latency:n})}function z(e){De&&(De.playbackspeed=e.playbackRate.toString())}function Q(){return be}function X(e){be=e}function Z(){return Ee}function J(e){Oe=e}function $(){return Oe}function ee(){return Ne}function te(){return Fe.getBufferTarget(Ne,me,ke.isVideoTrackPresent())}function ne(e){Ae=e}function re(e,t){ie(e,t),Ae=null}function ie(e,t){if(Ae&&Ie===!1){var n=De.start,r=e.getTime()-n.getTime();De.duration=r,De.stopreason=t,Ae.trace.push(De),Ie=!0}}function ae(){Ae&&Ie===!0&&Te&&(Ie=!1,De=new a.PlayListTrace,De.representationid=Te.id,De.start=new Date,De.mstart=1e3*we.getTime(),De.playbackspeed=we.getPlaybackRate().toString())}function oe(){le.off(k.default.DATA_UPDATE_STARTED,F,this),le.off(k.default.DATA_UPDATE_COMPLETED,A,this),le.off(k.default.BUFFER_LEVEL_STATE_CHANGED,G,this),le.off(k.default.QUALITY_CHANGE_REQUESTED,y,this),le.off(k.default.FRAGMENT_LOADING_COMPLETED,M,this),le.off(k.default.STREAM_COMPLETED,b,this),le.off(k.default.STREAM_INITIALIZED,I,this),le.off(k.default.QUOTA_EXCEEDED,K,this),le.off(k.default.BYTES_APPENDED,x,this),le.off(k.default.BUFFER_CLEARED,H,this),le.off(k.default.INIT_REQUESTED,h,this),le.off(k.default.PLAYBACK_RATE_CHANGED,z,this),le.off(k.default.PLAYBACK_SEEKING,Y,this),le.off(k.default.PLAYBACK_STARTED,q,this),le.off(k.default.PLAYBACK_TIME_UPDATED,N,this),le.off(k.default.URL_RESOLUTION_FAILED,V,this),le.off(k.default.FRAGMENT_LOADING_ABANDONED,U,this),he.getIsTextTrack(me)&&le.off(k.default.TIMED_TEXT_REQUESTED,W,this),i(),S(!1),Re=!1,Oe=0,be=NaN,we=null,Ae=null}var se=this.context,ue=(0,j.default)(se).getInstance().log,le=(0,L.default)(se).getInstance(),de=e.metricsModel,ce=e.manifestModel,fe=e.adapter,_e=e.dashMetrics,he=e.dashManifestModel,pe=e.timelineConverter,ge=e.mediaPlayerModel,ve=void 0,me=void 0,Ee=void 0,ye=void 0,Te=void 0,Se=void 0,Ce=void 0,Ae=void 0,De=void 0,Ie=void 0,Re=void 0,Oe=void 0,Pe=void 0,be=void 0,we=void 0,Me=void 0,Le=void 0,Ne=void 0,ke=void 0,xe=void 0,Ue=void 0,Fe=void 0,Be=void 0,He=void 0,je=void 0,Ge=void 0,Ke=void 0,Ve=void 0;return ve={initialize:n,getStreamProcessor:ee,getSeekTarget:Q,setSeekTarget:X,getFragmentModel:Z,setTimeToLoadDelay:J,getTimeToLoadDelay:$,replaceRequest:m,start:r,stop:i,reset:oe,setPlayList:ne,getBufferTarget:te,finalisePlayList:re},t(),ve}Object.defineProperty(t,"__esModule",{value:!0});var a=n(74),o=n(9),s=r(o),u=n(14),l=r(u),d=n(17),c=r(d),f=n(15),_=r(f),h=n(171),p=r(h),g=n(172),v=r(g),m=n(16),E=r(m),y=n(10),T=r(y),S=n(32),C=r(S),A=n(12),D=r(A),I=n(21),R=r(I),O=n(30),P=r(O),b=n(51),w=r(b),M=n(3),L=r(M),N=n(2),k=r(N),x=n(1),U=r(x),F=n(24),B=r(F),H=n(4),j=r(H);i.__dashjs_factory_name="ScheduleController",t.default=U.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){y=!1,T=null,S=null,C=null,A=null,D=null,E=!1,p.on(u.default.DATA_UPDATE_COMPLETED,c,this),p.on(u.default.INIT_FRAGMENT_LOADED,f,this)}function n(e,t,n){C=e,s(t),A=n,D=A.getRepresentationController()}function r(e){try{S=g.createSourceBuffer(T,e),y||(S.hasOwnProperty("initialize")&&S.initialize(C,this),y=!0)}catch(e){v.mediaSourceError("Error creating "+C+" source buffer.")}return S}function i(){return S}function a(e){S=e}function s(e){T=e}function l(){return A}function d(e){p.off(u.default.DATA_UPDATE_COMPLETED,c,this),p.off(u.default.INIT_FRAGMENT_LOADED,f,this),e||(g.abort(T,S),g.removeSourceBuffer(T,S))}function c(e){e.sender.getStreamProcessor()===A&&p.trigger(u.default.TIMED_TEXT_REQUESTED,{index:0,sender:e.sender})}function f(e){e.fragmentModel===A.getFragmentModel()&&e.chunk.bytes&&g.append(S,e.chunk)}function _(){return E}var h=this.context,p=(0,o.default)(h).getInstance(),g=e.sourceBufferController,v=e.errHandler,m=void 0,E=void 0,y=void 0,T=void 0,S=void 0,C=void 0,A=void 0,D=void 0;return m={initialize:n,createBuffer:r,getBuffer:i,setBuffer:a,getStreamProcessor:l,getIsBufferingCompleted:_,setMediaSource:s,reset:d},t(),m}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),o=r(a),s=n(2),u=r(s),l=n(1),d=r(l);i.__dashjs_factory_name="TextController",t.default=d.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){L=t,b=0,w=!1,M=!1,N={"urn:mpeg:dash:utc:http-head:2014":T,"urn:mpeg:dash:utc:http-xsdate:2014":y.bind(null,f),"urn:mpeg:dash:utc:http-iso:2014":y.bind(null,_),"urn:mpeg:dash:utc:direct:2014":E,"urn:mpeg:dash:utc:http-head:2012":T,"urn:mpeg:dash:utc:http-xsdate:2012":y.bind(null,f),"urn:mpeg:dash:utc:http-iso:2012":y.bind(null,_),"urn:mpeg:dash:utc:direct:2012":E,"urn:mpeg:dash:utc:http-ntp:2014":m,"urn:mpeg:dash:utc:ntp:2014":m,"urn:mpeg:dash:utc:sntp:2014":m},i()||(A(e),a(!0))}function t(e){e&&(e.metricsModel&&(k=e.metricsModel),e.dashMetrics&&(x=e.dashMetrics))}function n(){return l()}function r(e){w=e}function i(){return w}function a(e){M=e}function s(e){b=e}function l(){return b}function c(e){var t,n,r=60,i=60,a=1e3,o=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/,s=o.exec(e);return t=Date.UTC(parseInt(s[1],10),parseInt(s[2],10)-1,parseInt(s[3],10),parseInt(s[4],10),parseInt(s[5],10),s[6]&&(parseInt(s[6],10)||0),s[7]&&parseFloat(s[7])*a||0),s[9]&&s[10]&&(n=parseInt(s[9],10)*i+parseInt(s[10],10),t+=("+"===s[8]?-1:1)*n*r*a),new Date(t).getTime()}function f(e){var t=Date.parse(e);return isNaN(t)&&(t=c(e)),t}function _(e){return Date.parse(e)}function v(e){return Date.parse(e)}function m(e,t,n){n()}function E(e,t,n){var r=f(e);return isNaN(r)?void n():void t(r)}function y(e,t,n,r,i){var a,o,s=!1,u=new XMLHttpRequest,l=i?"HEAD":"GET",d=t.match(/\S+/g);t=d.shift(),a=function(){s||(s=!0,d.length?y(e,d.join(" "),n,r,i):r())},o=function(){var t,r;200===u.status&&(t=i?u.getResponseHeader("Date"):u.response,r=e(t),isNaN(r)||(n(r),s=!0))},u.open(l,t),u.timeout=g||0,u.onload=o,u.onloadend=a,u.send()}function T(e,t,n){y(v,e,t,n,!0)}function S(){var e=k.getReadOnlyMetricsFor("stream"),t=x.getLatestMPDRequestHeaderValueByID(e,"Date"),n=null!==t?new Date(t).getTime():Number.NaN;isNaN(n)?C(!0):(s(n-(new Date).getTime()),C(!1,n/1e3,b))}function C(e,t,n){r(!1),O.trigger(d.default.TIME_SYNCHRONIZATION_COMPLETED,{time:t,offset:n,error:e?new o.default(p):null})}function A(e,t){var n=t||0,i=e[n],a=function(e,t){var n=!e||!t;n&&L?S():C(n,e,t)};r(!0),i?N.hasOwnProperty(i.schemeIdUri)?N[i.schemeIdUri](i.value,function(e){var t=(new Date).getTime(),n=e-t;s(n),R("Local time:      "+new Date(t)),R("Server time:     "+new Date(e)),R("Difference (ms): "+n),a(e,n)},function(){A(e,n+1)}):A(e,n+1):(s(0),a())}function D(){a(!1),r(!1)}var I=this.context,R=(0,h.default)(I).getInstance().log,O=(0,u.default)(I).getInstance(),P=void 0,b=void 0,w=void 0,M=void 0,L=void 0,N=void 0,k=void 0,x=void 0;return P={initialize:e,getOffsetToDeviceTimeMs:n,setConfig:t,reset:D}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),o=r(a),s=n(3),u=r(s),l=n(2),d=r(l),c=n(1),f=r(c),_=n(4),h=r(_),p=1,g=5e3;i.__dashjs_factory_name="TimeSyncController";var v=f.default.getSingletonFactory(i);v.TIME_SYNC_FAILED_ERROR_CODE=p,v.HTTP_TIMEOUT_MS=g,t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){I.on(d.default.XLINK_ELEMENT_LOADED,l,O),L=(0,o.default)(D).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier})}function n(e){P=e}function r(e){b=e}function i(e){var t;M=new h.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:P}),w=e,t=f(w.Period_asArray,w,E,v),s(t,E,v)}function a(){I.off(d.default.XLINK_ELEMENT_LOADED,l,O),L&&(L.reset(),L=null)}function s(e,t,n){var r,i,a,o={};for(o.elements=e,o.type=t,o.resolveType=n,0===o.elements.length&&c(o),a=0;a<o.elements.length;a++)r=o.elements[a],i=R.isHTTPURL(r.url)?r.url:r.originalContent.BaseURL+r.url,L.load(i,r,o)}function l(e){var t,n,r,i="<response>",a="</response>",o="";t=e.element,n=e.resolveObject,t.resolvedContent&&(r=t.resolvedContent.indexOf(">")+1,o=t.resolvedContent.substr(0,r)+i+t.resolvedContent.substr(r)+a,t.resolvedContent=M.xml_str2json(o)),C(n)&&c(n)}function c(e){var t,n,r=[];if(_(e),e.resolveType===m&&I.trigger(d.default.XLINK_READY,{manifest:w}),e.resolveType===v)switch(e.type){case E:for(t=0;t<w[E+"_asArray"].length;t++)n=w[E+"_asArray"][t],n.hasOwnProperty(y+"_asArray")&&(r=r.concat(f(n[y+"_asArray"],n,y,v))),n.hasOwnProperty(T+"_asArray")&&(r=r.concat(f(n[T+"_asArray"],n,T,v)));s(r,y,v);break;case y:I.trigger(d.default.XLINK_READY,{manifest:w})}}function f(e,t,n,r){var i,a,o,s=[];for(a=e.length-1;a>=0;a--)i=e[a],i.hasOwnProperty("xlink:href")&&i["xlink:href"]===S&&e.splice(a,1);for(a=0;a<e.length;a++)i=e[a],i.hasOwnProperty("xlink:href")&&i.hasOwnProperty("xlink:actuate")&&i["xlink:actuate"]===r&&(o=p(i["xlink:href"],t,n,a,r,i),s.push(o));return s}function _(e){var t,n,r,i,a,o,s=[];for(i=e.elements.length-1;i>=0;i--){if(t=e.elements[i],n=t.type+"_asArray",!t.resolvedContent||A())delete t.originalContent["xlink:actuate"],delete t.originalContent["xlink:href"],s.push(t.originalContent);else if(t.resolvedContent)for(a=0;a<t.resolvedContent[n].length;a++)r=t.resolvedContent[n][a],s.push(r);for(t.parentElement[n].splice(t.index,1),o=0;o<s.length;o++)t.parentElement[n].splice(t.index+o,0,s[o]);s=[]}e.elements.length>0&&b.run(w)}function p(e,t,n,r,i,a){return{url:e,parentElement:t,type:n,index:r,resolveType:i,originalContent:a,resolvedContent:null,resolved:!1}}function C(e){var t,n;for(t=0;t<e.elements.length;t++)if(n=e.elements[t],n.resolved===!1)return!1;return!0}function A(){return!1}var D=this.context,I=(0,u.default)(D).getInstance(),R=(0,g.default)(D).getInstance(),O=void 0,P=void 0,b=void 0,w=void 0,M=void 0,L=void 0;return O={resolveManifestOnLoad:i,setMatchers:n,setIron:r,reset:a},t(),O}Object.defineProperty(t,"__esModule",{value:!0});var a=n(118),o=r(a),s=n(3),u=r(s),l=n(2),d=r(l),c=n(1),f=r(c),_=n(38),h=r(_),p=n(26),g=r(p),v="onLoad",m="onActuate",E="Period",y="AdaptationSet",T="EventStream",S="urn:mpeg:dash:resolve-to-zero:2013";i.__dashjs_factory_name="XlinkController",t.default=f.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){return a=(0,o.default)(r).getInstance({eventBus:e.eventBus,metricsModel:e.metricsModel}),(0,d.default)(r).create(e)}function t(){return(0,h.default)(r).getInstance()}function n(){return(0,f.default)(r).getInstance()}var r=this.context,i=void 0,a=void 0;return i={createMetricsReporting:e,getReportingFactory:t,getMetricsHandlerFactory:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(139),o=r(a),s=n(31),u=r(s),l=n(129),d=r(l),c=n(61),f=r(c),_=n(62),h=r(_),p=n(1),g=r(p);i.__dashjs_factory_name="MetricsReporting";var v=g.default.getClassFactory(i);v.events=u.default,t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(t){if(!t.error){var n=Object.keys(i),r=(0,u.default)(a).getInstance({dashManifestModel:e.dashManifestModel}).getMetrics(t.manifest);r.forEach(function(t){var r=JSON.stringify(t);if(i.hasOwnProperty(r))n.splice(r,1);else try{var s=(0,o.default)(a).create(e);s.initialize(t),i[r]=s}catch(e){}}),n.forEach(function(e){i[e].reset(),delete i[e]}),s.trigger(f.default.METRICS_INITIALISATION_COMPLETE)}}function n(){Object.keys(i).forEach(function(e){i[e].reset()}),i={}}function r(){s.on(h.default.MANIFEST_UPDATED,t),s.on(h.default.STREAM_TEARDOWN_COMPLETE,n)}var i={},a=this.context,s=e.eventBus;return r(),{}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(130),o=r(a),s=n(140),u=r(s),l=n(1),d=r(l),c=n(31),f=r(c),_=n(2),h=r(_);i.__dashjs_factory_name="MetricsCollectionController",t.default=d.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(t){try{a=(0,u.default)(s).create({mediaElement:e.mediaElement}),a.initialize(t.Range),i=(0,d.default)(s).create({log:e.log}),i.initialize(t.Reporting,a),r=(0,f.default)(s).create({log:e.log,eventBus:e.eventBus}),r.initialize(t.metrics,i)}catch(e){throw n(),e}}function n(){r&&r.reset(),i&&i.reset(),a&&a.reset()}var r=void 0,i=void 0,a=void 0,o=void 0,s=this.context;return o={initialize:t,reset:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(132),u=r(s),l=n(133),d=r(l),c=n(131),f=r(c);i.__dashjs_factory_name="MetricsController",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){i.forEach(function(t){t.handleNewMetric(e.metric,e.value,e.mediaType)})}function n(e,n){e.split(",").forEach(function(e,t,r){var a;if(e.indexOf("(")!==-1&&e.indexOf(")")===-1){var o=r[t+1];o&&o.indexOf("(")===-1&&o.indexOf(")")!==-1&&(e+=","+o,delete r[t+1])}a=l.create(e,n),a&&i.push(a)}),u.on(d.default.METRIC_ADDED,t,a),u.on(d.default.METRIC_UPDATED,t,a)}function r(){u.off(d.default.METRIC_ADDED,t,a),u.off(d.default.METRIC_UPDATED,t,a),i.forEach(function(e){return e.reset()}),i=[]}var i=[],a=void 0,s=this.context,u=e.eventBus,l=(0,o.default)(s).getInstance({log:e.log,eventBus:e.eventBus});return a={initialize:n,reset:r}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(61),o=r(a),s=n(1),u=r(s),l=n(22),d=r(l);i.__dashjs_factory_name="MetricsHandlersController",t.default=u.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){e&&e.length&&(e.forEach(function(e){var t=e.starttime,n=t+e.duration;l.add(t,n)}),a=!!e[0]._useWallClockTime)}function n(){l.clear()}function r(){l=(0,u.default)(o).create()}function i(){var e,t=l.length;if(!t)return!0;e=a?(new Date).getTime()/1e3:d.currentTime;for(var n=0;n<t;n+=1){var r=l.start(n),i=l.end(n);if(r<=e&&e<i)return!0}return!1}var a=!1,o=this.context,s=void 0,l=void 0,d=e.mediaElement;return s={initialize:t,reset:n,isEnabled:i},r(),s}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(71),u=r(s);i.__dashjs_factory_name="RangeController",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t){e.some(function(e){var n=o.create(e,t);if(n)return i.push(n),!0})}function n(){i.forEach(function(e){return e.reset()}),i=[]}function r(e,t){i.forEach(function(n){return n.report(e,t)})}var i=[],a=void 0,o=(0,u.default)(this.context).getInstance({log:e.log});return a={initialize:t,reset:n,report:r}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(62),u=r(s);i.__dashjs_factory_name="ReportingController",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){try{return Object.keys(h).map(function(e){return h[e]}).reduce(function(e,t){return e.level<t.level?e:t})}catch(e){return}}function t(){var t=e();t&&c!==t.t&&(c=t.t,o.report(l,t))}function n(e,n,r){n&&(s=_.validateN(r),o=n,l=_.reconstructFullMetricName(e,r),
d=setInterval(t,s))}function r(){clearInterval(d),d=null,s=0,o=null,c=null}function i(e,t,n){"BufferLevel"===e&&(h[n]=t)}var a=void 0,o=void 0,s=void 0,l=void 0,d=void 0,c=void 0,f=this.context,_=(0,u.default)(f).getInstance(),h=[];return a={initialize:n,reset:r,handleNewMetric:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(63),u=r(s);i.__dashjs_factory_name="BufferLevelHandler",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){s.off(u.default.METRICS_INITIALISATION_COMPLETE,t,this),s.trigger(u.default.BECAME_REPORTING_PLAYER)}function n(e,n){n&&(o=n,s.on(u.default.METRICS_INITIALISATION_COMPLETE,t,this))}function r(){o=null}function i(e,t){"DVBErrors"===e&&o&&o.report(e,t)}var a=void 0,o=void 0,s=e.eventBus;return a={initialize:n,reset:r,handleNewMetric:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(31),u=r(s);t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){i=e,a=t}function t(){a=null,i=void 0}function n(e,t){e===i&&a&&a.report(i,t)}var r=void 0,i=void 0,a=void 0;return r={initialize:e,reset:t,handleNewMetric:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="GenericMetricHandler",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){var e=c;e.length&&a&&a.report(l,e),c=[]}function t(t,n,r,i){n&&(o=f.validateN(r),a=n,i&&i.length&&(s=i),l=f.reconstructFullMetricName(t,r,i),d=setInterval(e,o))}function n(){clearInterval(d),d=null,o=null,s=null,c=[],a=null}function r(e,t){"HttpList"===e&&(s&&s!==t.type||c.push(t))}var i=void 0,a=void 0,o=void 0,s=void 0,l=void 0,d=void 0,c=[],f=(0,u.default)(this.context).getInstance();return i={initialize:t,reset:n,handleNewMetric:r}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(63),u=r(s);i.__dashjs_factory_name="HttpListHandler",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t,n){var r=new XMLHttpRequest,i=function(){var e=g.indexOf(r);e!==-1&&(g.splice(e,1),r.status>=200&&r.status<300?t&&t():n&&n())};g.push(r);try{r.open("GET",e),r.onloadend=i,r.onerror=i,r.send()}catch(e){r.onerror()}}function t(t,n){Array.isArray(n)||(n=[n]),c&&h.isEnabled()&&n.forEach(function(n){var r=o.serialise(n);l&&"DVBErrors"!==t&&(r="metricname="+t+"&"+r),r=_+"?"+r,e(r,null,function(){c=!1})})}function n(e,t){var n;if(h=t,_=e["dvb:reportingUrl"],!_)throw new Error("required parameter missing (dvb:reportingUrl)");f||(n=e["dvb:probability"]||e["dvb:priority"]||0,n&&(1e3===n||n/1e3>=s.random())&&(c=!0),f=!0)}function r(){p||(g.forEach(function(e){return e.abort()}),g=[]),f=!1,c=!1,_=null,h=null}var i=void 0,a=this.context,o=(0,u.default)(a).getInstance(),s=(0,d.default)(a).getInstance(),l=!0,c=!1,f=!1,_=null,h=null,p=!0,g=[];return i={report:t,initialize:n,reset:r}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(141),u=r(s),l=n(142),d=r(l);i.__dashjs_factory_name="DVBReporting",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){var t=new o.default;if(v){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.mpdurl||(t.mpdurl=v.originalUrl||v.url),t.terror||(t.terror=new Date),g.addDVBErrors(t)}}function n(e){e.error||(v=e.manifest)}function r(e){t({errorcode:o.default.BASE_URL_CHANGED,servicelocation:e.entry})}function i(){t({errorcode:o.default.BECAME_REPORTER})}function a(e){(0===e.responsecode||e.responsecode>=400||e.responsecode<100||e.responsecode>=600)&&t({errorcode:e.responsecode||o.default.CONNECTION_ERROR,url:e.url,terror:e.tresponse,servicelocation:e._serviceLocation})}function s(e){switch(e.metric){case"HttpList":a(e.value)}}function l(e){var n,r=e.error?e.error.code:0;switch(r){case MediaError.MEDIA_ERR_NETWORK:n=o.default.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:n=o.default.CORRUPT_MEDIA_OTHER;break;default:return}t({errorcode:n})}function c(){p.on(u.default.MANIFEST_UPDATED,n,h),p.on(u.default.SERVICE_LOCATION_BLACKLIST_CHANGED,r,h),p.on(d.default.METRIC_ADDED,s,h),p.on(d.default.METRIC_UPDATED,s,h),p.on(d.default.PLAYBACK_ERROR,l,h),p.on(f.default.BECAME_REPORTING_PLAYER,i,h)}function _(){p.off(u.default.MANIFEST_UPDATED,n,h),p.off(u.default.SERVICE_LOCATION_BLACKLIST_CHANGED,r,h),p.off(d.default.METRIC_ADDED,s,h),p.off(d.default.METRIC_UPDATED,s,h),p.off(d.default.PLAYBACK_ERROR,l,h),p.off(f.default.BECAME_REPORTING_PLAYER,i,h)}var h=void 0,p=e.eventBus,g=e.metricsModel,v=void 0;return h={initialise:c,reset:_},c(),h}Object.defineProperty(t,"__esModule",{value:!0});var a=n(143),o=r(a),s=n(2),u=r(s),l=n(22),d=r(l),c=n(31),f=r(c),_=n(1),h=r(_);i.__dashjs_factory_name="DVBErrorsTranslator",t.default=h.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t,n){var r,a,o=i.getMpd(e),s=0;return t?s=o.availabilityStartTime.getTime()/1e3:(r=this.getRegularPeriods(e,o),r.length&&(s=r[0].start)),a=s,n&&n.hasOwnProperty("starttime")&&(a+=n.starttime),a}function n(e){var n=[];return e.Metrics_asArray&&e.Metrics_asArray.forEach(function(r){var a=new o.default,s=i.getIsDynamic(e);r.hasOwnProperty("metrics")&&(a.metrics=r.metrics,r.Range_asArray&&r.Range_asArray.forEach(function(n){var r=new u.default;r.starttime=t(e,s,n),n.hasOwnProperty("duration")?r.duration=n.duration:r.duration=i.getDuration(e),r._useWallClockTime=s,a.Range.push(r)}),r.Reporting_asArray&&(r.Reporting_asArray.forEach(function(e){var t=new d.default;if(e.hasOwnProperty("schemeIdUri")){t.schemeIdUri=e.schemeIdUri;for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);a.Reporting.push(t)}}),n.push(a)))}),n}var r=void 0,i=e.dashManifestModel;return r={getMetrics:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(144),o=r(a),s=n(145),u=r(s),l=n(146),d=r(l),c=n(1),f=r(c);i.__dashjs_factory_name="ManifestParsing",t.default=f.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(t){var n,r,i=[],a=[];for(n in t)if(t.hasOwnProperty(n)&&0!==n.indexOf("_")){if(r=t[n],void 0!==r&&null!==r||(r=""),Array.isArray(r)){if(!r.length)continue;a=[],r.forEach(function(t){var n="Object"!==Object.prototype.toString.call(t).slice(8,-1);a.push(n?t:e(t))}),r=a.map(encodeURIComponent).join(",")}else"string"==typeof r?r=encodeURIComponent(r):r instanceof Date?r=r.toISOString():"number"==typeof r&&(r=Math.round(r));i.push(n+"="+r)}return i.join("&")}return{serialise:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="MetricSerialiser",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){n&&(o||(o=new r(a)),n.getRandomValues(o),s=0)}function t(t,r){var a;return t||(t=0),r||(r=1),n?(s===o.length&&e(),a=o[s]/i,s+=1):a=Math.random(),a*(r-t)+t}var n=window.crypto||window.msCrypto,r=Uint32Array,i=Math.pow(2,8*r.BYTES_PER_ELEMENT)-1,a=10,o=void 0,s=void 0,u=void 0;return u={random:t},e(),u}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="RNG",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};r.SSL_CONNECTION_FAILED_PREFIX="SSL",r.DNS_RESOLUTION_FAILED="C00",r.HOST_UNREACHABLE="C01",r.CONNECTION_REFUSED="C02",r.CONNECTION_ERROR="C03",r.CORRUPT_MEDIA_ISOBMFF="M00",r.CORRUPT_MEDIA_OTHER="M01",r.BASE_URL_CHANGED="F00",r.BECAME_REPORTER="S00",t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.metrics="",this.Range=[],this.Reporting=[]};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.schemeIdUri="",this.value=""};t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(){function e(){c=new _}function t(e,t,n){var r=p.getBaseURLsFromElement(n);e[t]?g.areSimpleEquivalent(r,e[t].data.baseUrls)||(e[t].data.baseUrls=r,e[t].data.selectedIdx=f):e[t]=new _(r)}function n(e){var n=p.getBaseURLsFromElement(e);g.areSimpleEquivalent(n,c.data.baseUrls)||(c.data.baseUrls=n,c.data.selectedIdx=f),e.Period_asArray&&e.Period_asArray.forEach(function(e,n){t(c.children,n,e),e.AdaptationSet_asArray&&e.AdaptationSet_asArray.forEach(function(e,r){t(c.children[n].children,r,e),e.Representation_asArray&&e.Representation_asArray.sort(p.getRepresentationSortFunction()).forEach(function(e,i){t(c.children[n].children[r].children,i,e)})})})}function r(e,t){var n=t||c;e(n.data),n.children&&n.children.forEach(function(t){return r(e,t)})}function i(e){r(function(t){isNaN(t.selectedIdx)||e===t.baseUrls[t.selectedIdx].serviceLocation&&(t.selectedIdx=f)})}function a(e){n(e)}function o(){c=new _}function u(e){var t=c,n=[t.data];return e.forEach(function(e){t=t.children[e],t&&n.push(t.data)}),n.filter(function(e){return e.baseUrls.length})}var d=void 0,c=void 0,h=this.context,p=(0,s.default)(h).getInstance(),g=(0,l.default)(h).getInstance();return d={reset:o,update:a,getForPath:u,invalidateSelectedIndexes:i},e(),d}Object.defineProperty(t,"__esModule",{value:!0});var o=n(13),s=r(o),u=n(177),l=r(u),d=n(1),c=r(d),f=NaN,_=function e(t,n){i(this,e),this.data={baseUrls:t||null,selectedIdx:n||f},this.children=[]};a.__dashjs_factory_name="BaseURLTreeModel",t.default=c.default.getClassFactory(a),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}},s=n(27),u=r(s),l=function(e){function t(){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.INTERNAL_KEY_MESSAGE="internalKeyMessage",this.INTERNAL_KEY_SYSTEM_SELECTED="internalKeySystemSelected",this.KEY_ADDED="public_keyAdded",this.KEY_ERROR="public_keyError",this.KEY_MESSAGE="public_keyMessage",this.KEY_SESSION_CLOSED="public_keySessionClosed",this.KEY_SESSION_CREATED="public_keySessionCreated",this.KEY_SESSION_REMOVED="public_keySessionRemoved",this.KEY_STATUSES_CHANGED="public_keyStatusesChanged",this.KEY_SYSTEM_ACCESS_COMPLETE="keySystemAccessComplete",this.KEY_SYSTEM_SELECTED="public_keySystemSelected",this.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",this.NEED_KEY="needkey",this.PROTECTION_CREATED="public_protectioncreated",this.PROTECTION_DESTROYED="public_protectiondestroyed",this.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",this.TEARDOWN_COMPLETE="protectionTeardownComplete",this.VIDEO_ELEMENT_SELECTED="videoElementSelected"}return a(t,e),t}(u.default),d=new l;t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){P=C.getKeySystems(),b=[],N=!1,k="temporary",x="",u.default.extend(g.default.events)}function n(e,t,n){if(!N){var r;t||n||(r=D.getStreamsInfo(e)[0]),w=t||(r?D.getMediaInfoForType(e,r,"audio"):null),M=n||(r?D.getMediaInfoForType(e,r,"video"):null);var i=M?M:w,a=C.getSupportedKeySystemsFromContentProtection(i.contentProtection);a&&a.length>0&&E(a,!0),N=!0}}function r(e){var t=o.default.getPSSHForKeySystem(U,e);if(t){for(var n=A.getAllInitData(),r=0;r<n.length;r++)if(C.initDataEquals(t,n[r]))return void R("DRM: Ignoring initData because we have already seen it!");try{A.createKeySession(t,k)}catch(e){I.trigger(u.default.KEY_SESSION_CREATED,{data:null,error:"Error creating key session! "+e.message})}}else I.trigger(u.default.KEY_SESSION_CREATED,{data:null,error:"Selected key system is "+U.systemString+".  needkey/encrypted event contains no initData corresponding to that key system!"})}function i(e){A.loadKeySession(e)}function a(e){A.removeKeySession(e)}function s(e){A.closeKeySession(e)}function l(e){A.setServerCertificate(e)}function c(e){e?(A.setMediaElement(e),I.on(u.default.NEED_KEY,S,this),I.on(u.default.INTERNAL_KEY_MESSAGE,T,this)):null===e&&(A.setMediaElement(e),I.off(u.default.NEED_KEY,S,this),I.off(u.default.INTERNAL_KEY_MESSAGE,T,this))}function _(e){k=e}function h(e){x=e}function p(e){L=e}function v(){c(null),U=void 0,A&&(A.reset(),A=null)}function m(e){var t=null,n=e.systemString;return L&&(t=n in L?L[n]:null),t}function E(e,t){var n=this,i=[],a=[];M&&a.push(new d.default(M.codec,x)),w&&i.push(new d.default(w.codec,x));var o,s=new f.default(i,a,"optional","temporary"===k?"optional":"required",[k]),l=[];if(U){for(o=0;o<e.length;o++)if(U===e[o].ks){var c=function(){l.push({ks:e[o].ks,configs:[s]});var i=function i(a){I.off(u.default.KEY_SYSTEM_ACCESS_COMPLETE,i,n),a.error?t||I.trigger(u.default.KEY_SYSTEM_SELECTED,{error:"DRM: KeySystem Access Denied! -- "+a.error}):(R("DRM: KeySystem Access Granted"),I.trigger(u.default.KEY_SYSTEM_SELECTED,{data:a.data}),r(e[o].initData))};return I.on(u.default.KEY_SYSTEM_ACCESS_COMPLETE,i,n),A.requestKeySystemAccess(l),"break"}();if("break"===c)break}}else if(void 0===U){U=null,b.push(e);for(var _=0;_<e.length;_++)l.push({ks:e[_].ks,configs:[s]});var h,p=function e(r){I.off(u.default.KEY_SYSTEM_ACCESS_COMPLETE,e,n),r.error?(U=void 0,I.off(u.default.INTERNAL_KEY_SYSTEM_SELECTED,g,n),t||I.trigger(u.default.KEY_SYSTEM_SELECTED,{data:null,error:"DRM: KeySystem Access Denied! -- "+r.error})):(h=r.data,R("DRM: KeySystem Access Granted ("+h.keySystem.systemString+")!  Selecting key system..."),A.selectKeySystem(h))},g=function e(i){if(I.off(u.default.INTERNAL_KEY_SYSTEM_SELECTED,e,n),I.off(u.default.KEY_SYSTEM_ACCESS_COMPLETE,p,n),i.error)U=void 0,t||I.trigger(u.default.KEY_SYSTEM_SELECTED,{data:null,error:"DRM: Error selecting key system! -- "+i.error});else{U=A.getKeySystem(),I.trigger(u.default.KEY_SYSTEM_SELECTED,{data:h});for(var a=0;a<b.length;a++)for(o=0;o<b[a].length;o++)if(U===b[a][o].ks){r(b[a][o].initData);break}}};I.on(u.default.INTERNAL_KEY_SYSTEM_SELECTED,g,n),I.on(u.default.KEY_SYSTEM_ACCESS_COMPLETE,p,n),A.requestKeySystemAccess(l)}else b.push(e)}function y(e,t){I.trigger(u.default.LICENSE_REQUEST_COMPLETE,{data:e,error:t})}function T(e){if(R("DRM: onKeyMessage"),e.error)return void R(e.error);var t=e.data;I.trigger(u.default.KEY_MESSAGE,{data:t});var n=t.messageType?t.messageType:"license-request",r=t.message,i=t.sessionToken,a=m(U),s=U.systemString,l=C.getLicenseServer(U,a,n),d={sessionToken:i,messageType:n};if(!l)return R("DRM: License server request not required for this message (type = "+e.data.messageType+").  Session ID = "+i.getSessionID()),void y(d);if(C.isClearKey(U)){var c=C.processClearKeyLicenseRequest(a,r);if(c)return R("DRM: ClearKey license request handled by application!"),y(d),void A.updateKeySession(i,c)}var f=new XMLHttpRequest,_=null;if(a&&a.serverURL){var h=a.serverURL;"string"==typeof h&&""!==h?_=h:"object"==typeof h&&h.hasOwnProperty(n)&&(_=h[n])}else a&&a.laURL&&""!==a.laURL?_=a.laURL:(_=U.getLicenseServerURLFromInitData(o.default.getPSSHData(i.initData)),_||(_=e.data.laURL));if(_=l.getServerURLFromMessage(_,r,n),!_)return void y(d,"DRM: No license server URL specified!");f.open(l.getHTTPMethod(n),_,!0),f.responseType=l.getResponseType(s,n),f.onload=function(){200==this.status?(y(d),A.updateKeySession(i,l.getLicenseMessage(this.response,s,n))):y(d,"DRM: "+s+' update, XHR status is "'+this.statusText+'" ('+this.status+"), expected to be 200. readyState is "+this.readyState+".  Response is "+(this.response?l.getErrorResponse(this.response,s,n):"NONE"))},f.onabort=function(){y(d,"DRM: "+s+' update, XHR aborted. status is "'+this.statusText+'" ('+this.status+"), readyState is "+this.readyState)},f.onerror=function(){y(d,"DRM: "+s+' update, XHR error. status is "'+this.statusText+'" ('+this.status+"), readyState is "+this.readyState)};var p=function(e){var t;if(e)for(t in e)"authorization"===t.toLowerCase()&&(f.withCredentials=!0),f.setRequestHeader(t,e[t])};a&&p(a.httpRequestHeaders),p(U.getRequestHeadersFromMessage(r)),a&&a.withCredentials&&(f.withCredentials=!0),f.send(U.getLicenseRequestFromMessage(r))}function S(e){if(R("DRM: onNeedKey"),"cenc"!==e.key.initDataType)return void R("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+e.key.initDataType);var t=e.key.initData;ArrayBuffer.isView(t)&&(t=t.buffer),R("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(t)));var n=C.getSupportedKeySystems(t,L);return 0===n.length?void R("DRM: Received needkey event with initData, but we don't support any of the key systems!"):void E(n,!1)}var C=e.protectionKeyController,A=e.protectionModel,D=e.adapter,I=e.eventBus,R=e.log,O=void 0,P=void 0,b=void 0,w=void 0,M=void 0,L=void 0,N=void 0,k=void 0,x=void 0,U=void 0;return O={initialize:n,createKeySession:r,loadKeySession:i,removeKeySession:a,closeKeySession:s,setServerCertificate:l,setMediaElement:c,setSessionType:_,setRobustnessLevel:h,setProtectionData:p,reset:v},t(),O}Object.defineProperty(t,"__esModule",{value:!0});var a=n(25),o=r(a),s=n(2),u=r(s),l=n(160),d=r(l),c=n(47),f=r(c),_=n(1),h=r(_),p=n(64),g=r(p);i.__dashjs_factory_name="ProtectionController",t.default=h.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){var n=null;if(e){for(var r=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),i=[],a=0;a<r.kids.length;a++){var s=r.kids[a],l=e.clearkeys.hasOwnProperty(s)?e.clearkeys[s]:null;if(!l)throw new Error("DRM: ClearKey keyID ("+s+") is not known!");i.push(new o.default(s,l))}n=new u.default(i)}return n}function t(e){return d.default.parseInitDataFromContentProtection(e)}function n(){return null}function r(e){return new Uint8Array(e)}function i(){return null}var a=void 0;return a={uuid:_,schemeIdURI:p,systemString:h,getInitData:t,getRequestHeadersFromMessage:n,getLicenseRequestFromMessage:r,getLicenseServerURLFromInitData:i,getClearKeysFromProtectionData:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(66),o=r(a),s=n(65),u=r(s),l=n(25),d=r(l),c=n(1),f=r(c),_="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",h="org.w3.clearkey",p="urn:uuid:"+_;i.__dashjs_factory_name="KeySystemClearKey",t.default=f.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){var t,n,r={},i=new DOMParser,a="utf16"===s?new Uint16Array(e):new Uint8Array(e);t=String.fromCharCode.apply(null,a),n=i.parseFromString(t,"application/xml");for(var o=n.getElementsByTagName("name"),u=n.getElementsByTagName("value"),l=0;l<o.length;l++)r[o[l].childNodes[0].nodeValue]=u[l].childNodes[0].nodeValue;return r.hasOwnProperty("Content")&&(r["Content-Type"]=r.Content,delete r.Content),r}function t(e){var t,n,r=null,i=new DOMParser,a="utf16"===s?new Uint16Array(e):new Uint8Array(e);if(t=String.fromCharCode.apply(null,a),n=i.parseFromString(t,"application/xml"),n.getElementsByTagName("Challenge")[0]){var o=n.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;o&&(r=f.default.decode(o))}return r}function n(e){if(e)for(var t=new DataView(e),n=t.getUint16(4,!0),r=6,i=new DOMParser,a=0;a<n;a++){var o=t.getUint16(r,!0);r+=2;var s=t.getUint16(r,!0);if(r+=2,1===o){var u=e.slice(r,r+s),l=String.fromCharCode.apply(null,new Uint16Array(u)),d=i.parseFromString(l,"application/xml");if(d.getElementsByTagName("LA_URL")[0]){var c=d.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(c)return c}if(d.getElementsByTagName("LUI_URL")[0]){var f=d.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(f)return f}}else r+=s}return null}function r(e){var t,n,r,i,a,s=new Uint8Array([112,115,115,104,0,0,0,0]),u=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),l=0,d=null;if("pssh"in e)return o.default.parseInitDataFromContentProtection(e);if("pro"in e)d=f.default.decodeArray(e.pro.__text);else{if(!("prheader"in e))return null;d=f.default.decodeArray(e.prheader.__text)}return t=d.length,n=4+s.length+u.length+4+t,r=new ArrayBuffer(n),i=new Uint8Array(r),a=new DataView(r),a.setUint32(l,n),l+=4,i.set(s,l),l+=s.length,i.set(u,l),l+=u.length,a.setUint32(l,t),l+=4,i.set(d,l),l+=t,i.buffer}function i(e){if("utf8"!==e&&"utf16"!==e)throw new u.default("Illegal PlayReady message format! -- "+e);s=e}var a=void 0,s="utf16";return a={uuid:_,schemeIdURI:p,systemString:h,getInitData:r,getRequestHeadersFromMessage:e,getLicenseRequestFromMessage:t,getLicenseServerURLFromInitData:n,setPlayReadyMessageFormat:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(25),o=r(a),s=n(8),u=r(s),l=n(1),d=r(l),c=n(37),f=r(c),_="9a04f079-9840-4286-ab92-e65be0885f95",h="com.microsoft.playready",p="urn:uuid:"+_;i.__dashjs_factory_name="KeySystemPlayReady",t.default=d.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){return o.default.parseInitDataFromContentProtection(e)}function t(){return null}function n(e){return new Uint8Array(e)}function r(){return null}var i=void 0;return i={uuid:l,schemeIdURI:c,systemString:d,getInitData:e,getRequestHeadersFromMessage:t,getLicenseRequestFromMessage:n,getLicenseServerURLFromInitData:r}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(25),o=r(a),s=n(1),u=r(s),l="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",d="com.widevine.alpha",c="urn:uuid:"+l;i.__dashjs_factory_name="KeySystemWidevine",t.default=u.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){b=null,w=null,N=[],k=[],M=(0,o.default)(D).getInstance(),L=(0,y.default)(D).getInstance(),U=S()}function n(){b&&A();for(var e=0;e<k.length;e++)p(k[e]);I.trigger(m.default.TEARDOWN_COMPLETE)}function r(){return w}function i(){for(var e=[],t=0;t<N.length;t++)e.push(N[t].initData);for(var t=0;t<k.length;t++)e.push(k[t].initData);return e}function a(e){var t=b;t||(t=document.createElement("video"));for(var n=!1,r=0;r<e.length;r++)for(var i=e[r].ks.systemString,a=e[r].configs,o=null,s=null,u=0;u<a.length;u++){var l=a[u].videoCapabilities;if(l&&0!==l.length){s=[];for(var d=0;d<l.length;d++)""!==t.canPlayType(l[d].contentType,i)&&s.push(l[d])}if(!(!o&&!s||o&&0===o.length||s&&0===s.length)){n=!0;var c=new h.default(o,s),f=M.getKeySystemBySystemString(i);I.trigger(m.default.KEY_SYSTEM_ACCESS_COMPLETE,{data:new g.default(f,c)});break}}n||I.trigger(m.default.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})}function s(e){w=e.keySystem,I.trigger(m.default.INTERNAL_KEY_SYSTEM_SELECTED)}function l(e){b!==e&&(b&&A(),b=e,b&&(b.addEventListener(O.keyerror,U),b.addEventListener(O.needkey,U),b.addEventListener(O.keymessage,U),b.addEventListener(O.keyadded,U),I.trigger(m.default.VIDEO_ELEMENT_SELECTED)))}function c(e){if(!w)throw new Error("Can not create sessions until you have selected a key system");if(x||0===k.length){var t={sessionID:null,initData:e,getSessionID:function(){return this.sessionID},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return N.push(t),b[O.generateKeyRequest](w.systemString,new Uint8Array(e)),t}throw new Error("Multiple sessions not allowed!")}function _(e,t){var n=e.sessionID;if(M.isClearKey(w))for(var r=0;r<t.keyPairs.length;r++)b[O.addKey](w.systemString,t.keyPairs[r].key,t.keyPairs[r].keyID,n);else b[O.addKey](w.systemString,new Uint8Array(t),e.initData,n)}function p(e){b[O.cancelKeyRequest](w.systemString,e.sessionID)}function v(){}function E(){}function T(){}function S(){return{handleEvent:function(e){var t=null;switch(e.type){case O.needkey:var n=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;I.trigger(m.default.NEED_KEY,{key:new u.default(n,"cenc")});break;case O.keyerror:if(t=C(k,e.sessionId),t||(t=C(N,e.sessionId)),t){var r="";switch(e.errorCode.code){case 1:r+="MEDIA_KEYERR_UNKNOWN - An unspecified error occurred. This value is used for errors that don't match any of the other codes.";break;case 2:r+="MEDIA_KEYERR_CLIENT - The Key System could not be installed or updated.";break;case 3:r+="MEDIA_KEYERR_SERVICE - The message passed into update indicated an error from the license service.";break;case 4:r+="MEDIA_KEYERR_OUTPUT - There is no available output device with the required characteristics for the content protection system.";break;case 5:r+="MEDIA_KEYERR_HARDWARECHANGE - A hardware configuration change caused a content protection error.";break;case 6:r+="MEDIA_KEYERR_DOMAIN - An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain."}r+="  System Code = "+e.systemCode,I.trigger(m.default.KEY_ERROR,{data:new d.default(t,r)})}else R("No session token found for key error");break;case O.keyadded:t=C(k,e.sessionId),t||(t=C(N,e.sessionId)),t?(R("DRM: Key added."),I.trigger(m.default.KEY_ADDED,{data:t})):R("No session token found for key added");break;case O.keymessage:if(x=null!==e.sessionId&&void 0!==e.sessionId,x?(t=C(k,e.sessionId),!t&&N.length>0&&(t=N.shift(),k.push(t),t.sessionID=e.sessionId)):N.length>0&&(t=N.shift(),k.push(t),0!==N.length&&L.mediaKeyMessageError("Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!")),t){var i=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;t.keyMessage=i,I.trigger(m.default.INTERNAL_KEY_MESSAGE,{data:new f.default(t,i,e.defaultURL)})}else R("No session token found for key message")}}}}function C(e,t){if(t&&e){for(var n=e.length,r=0;r<n;r++)if(e[r].sessionID==t)return e[r];return null}return null}function A(){b.removeEventListener(O.keyerror,U),b.removeEventListener(O.needkey,U),b.removeEventListener(O.keymessage,U),b.removeEventListener(O.keyadded,U)}var D=this.context,I=e.eventBus,R=e.log,O=e.api,P=void 0,b=void 0,w=void 0,M=void 0,L=void 0,N=void 0,k=void 0,x=void 0,U=void 0;return P={getAllInitData:i,requestKeySystemAccess:a,getKeySystem:r,selectKeySystem:s,setMediaElement:l,createKeySession:c,updateKeySession:_,closeKeySession:p,setServerCertificate:v,loadKeySession:E,removeKeySession:T,reset:n},t(),P}Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),o=r(a),s=n(48),u=r(s),l=n(44),d=r(l),c=n(45),f=r(c),_=n(47),h=r(_),p=n(46),g=r(p),v=n(2),m=r(v),E=n(11),y=r(E),T=n(1),S=r(T);i.__dashjs_factory_name="ProtectionModel_01b",t.default=S.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){I=null,R=null,O=null,P=[],w=(0,o.default)(M).getInstance(),b=S()}function n(){var e,t=P.length;if(0!==t)for(var n=function(e){C(e),0===P.length&&(R?(R.removeEventListener("encrypted",b),R.setMediaKeys(null).then(function(){L.trigger(g.default.TEARDOWN_COMPLETE)})):L.trigger(g.default.TEARDOWN_COMPLETE))},r=0;r<t;r++)e=P[r],function(t){e.session.closed.then(function(){n(t)}),T(e).catch(function(){n(t)})}(e);else L.trigger(g.default.TEARDOWN_COMPLETE)}function r(){return I}function i(){for(var e=[],t=0;t<P.length;t++)e.push(P[t].initData);return e}function a(e){y(e,0)}function s(e){e.mksa.createMediaKeys().then(function(t){I=e.keySystem,O=t,R&&R.setMediaKeys(O),L.trigger(g.default.INTERNAL_KEY_SYSTEM_SELECTED)}).catch(function(){L.trigger(g.default.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+e.keySystem.systemString+")! Could not create MediaKeys -- TODO"})})}function l(e){R!==e&&(R&&(R.removeEventListener("encrypted",b),R.setMediaKeys(null)),R=e,R&&(R.addEventListener("encrypted",b),O&&R.setMediaKeys(O)))}function c(e){if(!I||!O)throw new Error("Can not set server certificate until you have selected a key system");O.setServerCertificate(e).then(function(){N("DRM: License server certificate successfully updated."),L.trigger(g.default.SERVER_CERTIFICATE_UPDATED)}).catch(function(e){L.trigger(g.default.SERVER_CERTIFICATE_UPDATED,{error:"Error updating server certificate -- "+e.name})})}function _(e,t){if(!I||!O)throw new Error("Can not create sessions until you have selected a key system");var n=O.createSession(t),r=A(n,e,t);n.generateRequest("cenc",e).then(function(){N("DRM: Session created.  SessionID = "+r.getSessionID()),L.trigger(g.default.KEY_SESSION_CREATED,{data:r})}).catch(function(e){C(r),L.trigger(g.default.KEY_SESSION_CREATED,{data:null,error:"Error generating key request -- "+e.name})})}function p(e,t){var n=e.session;w.isClearKey(I)&&(t=t.toJWK()),n.update(t).catch(function(t){L.trigger(g.default.KEY_ERROR,{data:new d.default(e,"Error sending update() message! "+t.name)})})}function v(e){if(!I||!O)throw new Error("Can not load sessions until you have selected a key system");var t=O.createSession();t.load(e).then(function(n){if(n){var r=A(t);N("DRM: Session created.  SessionID = "+r.getSessionID()),L.trigger(g.default.KEY_SESSION_CREATED,{data:r})}else L.trigger(g.default.KEY_SESSION_CREATED,{data:null,error:"Could not load session! Invalid Session ID ("+e+")"})}).catch(function(t){L.trigger(g.default.KEY_SESSION_CREATED,{data:null,error:"Could not load session ("+e+")! "+t.name})})}function m(e){var t=e.session;t.remove().then(function(){N("DRM: Session removed.  SessionID = "+e.getSessionID()),L.trigger(g.default.KEY_SESSION_REMOVED,{data:e.getSessionID()})},function(t){L.trigger(g.default.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+e.getSessionID()+"). "+t.name})})}function E(e){T(e).catch(function(t){C(e),L.trigger(g.default.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.getSessionID()+") "+t.name})})}function y(e,t){!function(t){var n=e[t].ks,r=e[t].configs;navigator.requestMediaKeySystemAccess(n.systemString,r).then(function(e){var t="function"==typeof e.getConfiguration?e.getConfiguration():null,r=new h.default(n,t);r.mksa=e,L.trigger(g.default.KEY_SYSTEM_ACCESS_COMPLETE,{data:r})}).catch(function(){++t<e.length?y(e,t):L.trigger(g.default.KEY_SYSTEM_ACCESS_COMPLETE,{
error:"Key system access denied!"})})}(t)}function T(e){var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close()}function S(){return{handleEvent:function(e){switch(e.type){case"encrypted":if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;L.trigger(g.default.NEED_KEY,{key:new u.default(t,e.initDataType)})}}}}}function C(e){for(var t=0;t<P.length;t++)if(P[t]===e){P.splice(t,1);break}}function A(e,t,n){var r={session:e,initData:t,handleEvent:function(e){switch(e.type){case"keystatuseschange":L.trigger(g.default.KEY_STATUSES_CHANGED,{data:this});break;case"message":var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;L.trigger(g.default.INTERNAL_KEY_MESSAGE,{data:new f.default(this,t,void 0,e.messageType)})}},getSessionID:function(){return e.sessionId},getExpirationTime:function(){return e.expiration},getKeyStatuses:function(){return e.keyStatuses},getSessionType:function(){return n}};return e.addEventListener("keystatuseschange",r),e.addEventListener("message",r),e.closed.then(function(){C(r),N("DRM: Session closed.  SessionID = "+r.getSessionID()),L.trigger(g.default.KEY_SESSION_CLOSED,{data:r.getSessionID()})}),P.push(r),r}var D,I,R,O,P,b,w,M=this.context,L=e.eventBus,N=e.log;return D={getAllInitData:i,requestKeySystemAccess:a,getKeySystem:r,selectKeySystem:s,setMediaElement:l,setServerCertificate:c,createKeySession:_,updateKeySession:p,loadKeySession:v,removeKeySession:m,closeKeySession:E,reset:n},t(),D}Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),o=r(a),s=n(48),u=r(s),l=n(44),d=r(l),c=n(45),f=r(c),_=n(46),h=r(_),p=n(2),g=r(p),v=n(1),m=r(v);i.__dashjs_factory_name="ProtectionModel_21Jan2015",t.default=m.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){P=null,b=null,w=null,M=null,L=[],k=(0,o.default)(A).getInstance(),N=T()}function n(){try{for(var e=0;e<L.length;e++)p(L[e]);P&&P.removeEventListener(R.needkey,N),D.trigger(m.default.TEARDOWN_COMPLETE)}catch(e){D.trigger(m.default.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+e.message})}}function r(){return b}function i(){for(var e=[],t=0;t<L.length;t++)e.push(L[t].initData);return e}function a(e){for(var t=!1,n=0;n<e.length;n++)for(var r=e[n].ks.systemString,i=e[n].configs,a=null,o=null,s=0;s<i.length;s++){var u=i[s].audioCapabilities,l=i[s].videoCapabilities;if(u&&0!==u.length){a=[];for(var d=0;d<u.length;d++)window[R.MediaKeys].isTypeSupported(r,u[d].contentType)&&a.push(u[d])}if(l&&0!==l.length){o=[];for(var c=0;c<l.length;c++)window[R.MediaKeys].isTypeSupported(r,l[c].contentType)&&o.push(l[c])}if(!(!a&&!o||a&&0===a.length||o&&0===o.length)){t=!0;var f=new h.default(a,o),_=k.getKeySystemBySystemString(r);D.trigger(m.default.KEY_SYSTEM_ACCESS_COMPLETE,{data:new g.default(_,f)});break}}t||D.trigger(m.default.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})}function s(e){try{w=e.mediaKeys=new window[R.MediaKeys](e.keySystem.systemString),b=e.keySystem,M=e,P&&S(),D.trigger(m.default.INTERNAL_KEY_SYSTEM_SELECTED)}catch(e){D.trigger(m.default.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+b.systemString+")! Could not create MediaKeys -- TODO"})}}function l(e){P!==e&&(P&&P.removeEventListener(R.needkey,N),P=e,P&&(P.addEventListener(R.needkey,N),w&&S()))}function c(e){if(!b||!w||!M)throw new Error("Can not create sessions until you have selected a key system");var t=null;if(null!==M.ksConfiguration.videoCapabilities&&M.ksConfiguration.videoCapabilities.length>0&&(t=M.ksConfiguration.videoCapabilities[0]),null===t&&null!==M.ksConfiguration.audioCapabilities&&M.ksConfiguration.audioCapabilities.length>0&&(t=M.ksConfiguration.audioCapabilities[0]),null===t)throw new Error("Can not create sessions for unknown content types.");var n=t.contentType,r=w.createSession(n,new Uint8Array(e)),i=C(r,e);r.addEventListener(R.error,i),r.addEventListener(R.message,i),r.addEventListener(R.ready,i),r.addEventListener(R.close,i),L.push(i),I("DRM: Session created.  SessionID = "+i.getSessionID()),D.trigger(m.default.KEY_SESSION_CREATED,{data:i})}function _(e,t){var n=e.session;k.isClearKey(b)?n.update(new Uint8Array(t.toJWK())):n.update(new Uint8Array(t))}function p(e){var t=e.session;t.removeEventListener(R.error,e),t.removeEventListener(R.message,e),t.removeEventListener(R.ready,e),t.removeEventListener(R.close,e);for(var n=0;n<L.length;n++)if(L[n]===e){L.splice(n,1);break}t[R.release]()}function v(){}function E(){}function y(){}function T(){return{handleEvent:function(e){switch(e.type){case R.needkey:if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;D.trigger(m.default.NEED_KEY,{key:new u.default(t,"cenc")})}}}}}function S(){var e=null,t=function(){P.removeEventListener("loadedmetadata",e),P[R.setMediaKeys](w),D.trigger(m.default.VIDEO_ELEMENT_SELECTED)};P.readyState>=1?t():(e=t.bind(this),P.addEventListener("loadedmetadata",e))}function C(e,t){return{session:e,initData:t,getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(e){switch(e.type){case R.error:var t="KeyError";D.trigger(m.default.KEY_ERROR,{data:new d.default(this,t)});break;case R.message:var n=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;D.trigger(m.default.INTERNAL_KEY_MESSAGE,{data:new f.default(this,n,e.destinationURL)});break;case R.ready:I("DRM: Key added."),D.trigger(m.default.KEY_ADDED);break;case R.close:I("DRM: Session closed.  SessionID = "+this.getSessionID()),D.trigger(m.default.KEY_SESSION_CLOSED,{data:this.getSessionID()})}}}}var A=this.context,D=e.eventBus,I=e.log,R=e.api,O=void 0,P=void 0,b=void 0,w=void 0,M=void 0,L=void 0,N=void 0,k=void 0;return O={getAllInitData:i,requestKeySystemAccess:a,getKeySystem:r,selectKeySystem:s,setMediaElement:l,createKeySession:c,updateKeySession:_,closeKeySession:p,setServerCertificate:v,loadKeySession:E,removeKeySession:y,reset:n},t(),O}Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),o=r(a),s=n(48),u=r(s),l=n(44),d=r(l),c=n(45),f=r(c),_=n(47),h=r(_),p=n(46),g=r(p),v=n(2),m=r(v),E=n(1),y=r(E);i.__dashjs_factory_name="ProtectionModel_3Feb2014",t.default=y.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){var n=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t)));e+="/?";for(var r=0;r<n.kids.length;r++)e+=n.kids[r]+"&";return e=e.substring(0,e.length-1)}function t(){return"GET"}function n(){return"json"}function r(e){if(!e.hasOwnProperty("keys"))return null;for(var t=[],n=0;n<e.keys.length;n++){var r=e.keys[n],i=r.kid.replace(/=/g,""),a=r.k.replace(/=/g,"");t.push(new o.default(i,a))}return new u.default(t)}function i(e){return String.fromCharCode.apply(null,new Uint8Array(e))}var a=void 0;return a={getServerURLFromMessage:e,getHTTPMethod:t,getResponseType:n,getLicenseMessage:r,getErrorResponse:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(66),o=r(a),s=n(65),u=r(s),l=n(1),d=r(l);i.__dashjs_factory_name="ClearKey",t.default=d.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){return e}function t(){return"POST"}function n(e){return a[e].responseType}function r(e,t){return a[t].getLicenseMessage(e)}function i(e,t){return a[t].getErrorResponse(e)}var a={"com.widevine.alpha":{responseType:"json",getLicenseMessage:function(e){return u.default.decodeArray(e.license)},getErrorResponse:function(e){return e}},"com.microsoft.playready":{responseType:"arraybuffer",getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}},o=void 0;return o={getServerURLFromMessage:e,getHTTPMethod:t,getResponseType:n,getLicenseMessage:r,getErrorResponse:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(37),u=r(s);i.__dashjs_factory_name="DRMToday",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){return e}function t(){return"POST"}function n(){return"arraybuffer"}function r(e){return e}function i(e){return String.fromCharCode.apply(null,new Uint8Array(e))}var a=void 0;return a={getServerURLFromMessage:e,getHTTPMethod:t,getResponseType:n,getLicenseMessage:r,getErrorResponse:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="PlayReady",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){return e}function t(){return"POST"}function n(){return"arraybuffer"}function r(e){return e}function i(e){return String.fromCharCode.apply(null,new Uint8Array(e))}var a=void 0;return a={getServerURLFromMessage:e,getHTTPMethod:t,getResponseType:n,getLicenseMessage:r,getErrorResponse:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="Widevine",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t,r){n(this,e),this.contentType=t,this.robustness=r};t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){var n=t.droppedVideoFrames-i;i=t.droppedVideoFrames;var o=t.totalVideoFrames-a;a=t.totalVideoFrames,r[e]?(r[e].droppedVideoFrames+=n,r[e].totalVideoFrames+=o):r[e]={droppedVideoFrames:n,totalVideoFrames:o}}function t(){return r}function n(e){r=[],i=e.droppedVideoFrames,a=e.totalVideoFrames}var r=[],i=0,a=0;return{push:e,getFrameHistory:t,reset:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="DroppedFramesHistory";var s=o.default.getClassFactory(i);t.default=s,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){r[e.oldValue]||(r[e.oldValue]={noDrops:0,drops:0,dropSize:0});var t=e.newValue-e.oldValue,n=t<0?1:0,a=n?-t:0,o=n?0:1;if(r[e.oldValue].drops+=n,r[e.oldValue].dropSize+=a,r[e.oldValue].noDrops+=o,i.push({idx:e.oldValue,noDrop:o,drop:n,dropSize:a}),i.length>s){var u=i.shift();r[u.idx].drops-=u.drop,r[u.idx].dropSize-=u.dropSize,r[u.idx].noDrops-=u.noDrop}}function t(){return r}function n(){r=[],i=[]}var r=[],i=[];return{push:e,getSwitchRequests:t,reset:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=8;i.__dashjs_factory_name="SwitchRequestHistory";var u=o.default.getClassFactory(i);t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){p={},v={},m=[],E=(0,u.default)(_).getInstance(),y=(0,d.default)(_).getInstance(),T=(0,f.default)(_).getInstance()}function t(e,t){p[e]=p[e]||{},p[e][t]=p[e][t]||{}}function n(e,t){m[e]=m[e]||[],m[e].push(t)}function r(e){var r=e.getMediaInfo(),a=r.type,u=e.getCurrentRequest(),d=(0,o.default)(_).create(o.default.NO_CHANGE,{name:i.__dashjs_factory_name});if(!isNaN(u.index)){t(a,u.index);var f=E.getStableBufferTime(),g=y.getCurrentBufferLevel(T.getReadOnlyMetricsFor(a));if(g>f)return d;var S=p[a][u.index];if(null===S||null===u.firstByteDate||v.hasOwnProperty(S.id))return d;if(void 0===S.firstByteTime&&(m[a]=[],S.firstByteTime=u.firstByteDate.getTime(),S.segmentDuration=u.duration,S.bytesTotal=u.bytesTotal,S.id=u.index),S.bytesLoaded=u.bytesLoaded,S.elapsedTime=(new Date).getTime()-S.firstByteTime,S.bytesLoaded>0&&S.elapsedTime>0&&n(a,Math.round(8*S.bytesLoaded/S.elapsedTime)),m[a].length>=c&&S.elapsedTime>l&&S.bytesLoaded<S.bytesTotal){var C=m[a].reduce(function(e,t){return e+t},0);if(S.measuredBandwidthInKbps=Math.round(C/m[a].length),S.estimatedTimeOfDownload=+(8*S.bytesTotal/S.measuredBandwidthInKbps/1e3).toFixed(2),S.estimatedTimeOfDownload<S.segmentDuration*s||0===e.getTrackInfo().quality)return d;if(!v.hasOwnProperty(S.id)){var A=e.getStreamProcessor().getABRController(),D=S.bytesTotal-S.bytesLoaded,I=A.getBitrateList(r),R=A.getQualityForBitrate(r,S.measuredBandwidthInKbps*E.getBandwidthSafetyFactor()),O=S.bytesTotal*I[R].bitrate/I[A.getQualityFor(a,r.streamInfo)].bitrate;D>O&&(d.value=R,d.reason.throughput=S.measuredBandwidthInKbps,d.reason.fragmentID=S.id,v[S.id]=S,h("AbandonRequestsRule ( ",a,"frag id",S.id,") is asking to abandon and switch to quality to ",R," measured bandwidth was",S.measuredBandwidthInKbps),delete p[a][S.id])}}else S.bytesLoaded===S.bytesTotal&&delete p[a][S.id]}return d}function a(){e()}var s=1.8,l=500,c=5,_=this.context,h=(0,g.default)(_).getInstance().log,p=void 0,v=void 0,m=void 0,E=void 0,y=void 0,T=void 0,S={shouldAbandon:r,reset:a};return e(),S}Object.defineProperty(t,"__esModule",{value:!0});var a=n(7),o=r(a),s=n(5),u=r(s),l=n(12),d=r(l),c=n(10),f=r(c),_=n(1),h=r(_),p=n(4),g=r(p);i.__dashjs_factory_name="AbandonRequestsRule",t.default=h.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){m={},E=(0,u.default)(c).getInstance()}function n(e,t,n){m[e]={index:t,quality:n}}function r(e,t,n){var r=m[e];return!r||(t!==r.index||n<r.quality)}function a(e){var t=e.getMediaInfo(),a=t.type,s=g.getReadOnlyMetricsFor(a),u=e.getCurrentRequest(),f=(0,o.default)(c).create(o.default.NO_CHANGE,{name:i.__dashjs_factory_name});if(0===s.BolaState.length)return _("WARNING: executing BolaAbandonRule before initializing BolaRule"),m[a]=null,f;var v=s.BolaState[0]._s,E=u.index,y=u.quality;if(isNaN(E)||0===y||!r(a,E,y)||!u.firstByteDate)return f;var T=Date.now(),S=T-u.firstByteDate.getTime(),C=u.bytesLoaded,A=u.bytesTotal,D=A-C,I=u.duration,R=p.getCurrentBufferLevel(s)?p.getCurrentBufferLevel(s):0,O=R+v.placeholderBuffer,P=8*C/(.001*S),b=v.bandwidthSafetyFactor*P,w=.001*(u.firstByteDate.getTime()-u.requestStartDate.getTime());w<.001*d&&(w=.001*d);var M=w+8*A/b,L="";h.default.BOLA_DEBUG&&(L="index="+E+" quality="+y+" bytesLoaded/bytesTotal="+C+"/"+A+" bufferLevel="+R+" timeSince1stByte="+(S/1e3).toFixed(3)+" estThroughput="+(b/1e6).toFixed(3)+" latency="+w.toFixed(3));var N=A*v.bitrates[0]/v.bitrates[y],k=D-w*b/8;if(k<1&&(k=1),S<l||D<=N||R>v.bufferTarget||k<=N||M<=I)return f;var x=O-w;x<0&&(x=0);for(var U=0;U+1<y&&A*v.bitrates[U+1]/v.bitrates[y]<k;)++U;var F=y;if(v.state===h.default.BOLA_STATE_STARTUP){F=0;for(var B=0;B<=U&&(N=A*v.bitrates[B]/v.bitrates[y],!(8*N/I>b));++B)F=B}else for(var H=(v.Vp*(v.utilities[y]+v.gp)-x)/k,B=0;B<=U;++B){N=A*v.bitrates[B]/v.bitrates[y];var j=(v.Vp*(v.utilities[B]+v.gp)-x)/N;j>H&&(F=B,H=j)}var G=v.rebufferSafetyFactor*P*(R-w)/8;if(F===y&&k>G&&(F=U),F===y)return f;for(;F>0&&(N=A*v.bitrates[F]/v.bitrates[y],!(N<=G));)--F;var K=NaN;if(F>0){var V=v.utilities[F],W=v.utilities[F-1],j=v.bitrates[F],q=v.bitrates[F-1];K=v.Vp*((j*W-q*V)/(j-q)+v.gp)}else{var V=v.utilities[0],W=v.utilities[1],j=v.bitrates[0],q=v.bitrates[1];K=v.Vp*((j*W-q*V)/(j-q)+v.gp),K-=I}return O>K&&(v.placeholderBuffer=K-R,v.placeholderBuffer<0&&(v.placeholderBuffer=0)),v.lastQuality=F,g.updateBolaState(a,v),h.default.BOLA_DEBUG&&_("BolaDebug "+a+" BolaAbandonRule abandon to "+F+" - "+L),n(a,E,y),f.value=F,f.reason.state=v.state,f.reason.throughput=P,f.reason.bufferLevel=R,f.reason.bytesLoaded=u.bytesLoaded,f.reason.bytesTotal=u.bytesTotal,f.reason.elapsedTimeMs=S,f}function s(){m={}}var l=500,d=200,c=this.context,_=(0,f.default)(c).getInstance().log,p=e.dashMetrics,g=e.metricsModel,v=void 0,m=void 0,E=void 0;return v={shouldAbandon:a,reset:s},t(),v}Object.defineProperty(t,"__esModule",{value:!0});var a=n(7),o=r(a),s=n(5),u=r(s),l=n(1),d=r(l),c=n(4),f=r(c),_=n(70),h=r(_);i.__dashjs_factory_name="BolaAbandonRule",t.default=d.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){var a=e.getDroppedFramesHistory();if(a){for(var o=a.getFrameHistory(),s=0,l=0,d=u.default.NO_CHANGE,c=1;c<o.length;c++)if(o[c]&&(s=o[c].droppedVideoFrames,l=o[c].totalVideoFrames,l>i&&s/l>r)){d=c-1,n("DroppedFramesRule, index: "+d+" Dropped Frames: "+s+" Total Frames: "+l);break}return(0,u.default)(t).create(d,{droppedFrames:s})}return(0,u.default)(t).create()}var t=this.context,n=(0,d.default)(t).getInstance().log,r=.15,i=375;return{getMaxIndex:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(7),u=r(s),l=n(4),d=r(l);i.__dashjs_factory_name="DroppedFramesRule";var c=o.default.getClassFactory(i);t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){p={},v=0,m=1e3,c.on(d.default.PLAYBACK_SEEKING,i,_)}function n(e){var t=(new Date).getTime(),n=e.getMediaInfo().type,i=f.getReadOnlyMetricsFor(n),a=i.BufferState.length>0?i.BufferState[i.BufferState.length-1]:null,u=(0,g.default)(s).create();return t-v<m||null===a?u:(r(n,a.state),a.state===o.default.BUFFER_EMPTY&&void 0!==p[n].firstBufferLoadedEvent&&(l("Switch to index 0; buffer is empty."),u.value=0,u.reason="InsufficientBufferRule: Buffer is empty"),v=t,u)}function r(e,t){p[e]=p[e]||{},p[e].state=t,t!==o.default.BUFFER_LOADED||p[e].firstBufferLoadedEvent||(p[e].firstBufferLoadedEvent=!0)}function i(){p={}}function a(){c.off(d.default.PLAYBACK_SEEKING,i,_),p={},v=0}var s=this.context,l=(0,h.default)(s).getInstance().log,c=(0,u.default)(s).getInstance(),f=e.metricsModel,_=void 0,p=void 0,v=void 0,m=void 0;return _={getMaxIndex:n,reset:a},t(),_}Object.defineProperty(t,"__esModule",{value:!0});var a=n(17),o=r(a),s=n(3),u=r(s),l=n(2),d=r(l),c=n(1),f=r(c),_=n(4),h=r(_),p=n(7),g=r(p);i.__dashjs_factory_name="InsufficientBufferRule",t.default=f.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){for(var a=e.getSwitchHistory(),o=a.getSwitchRequests(),s=0,u=0,l=0,c=(0,d.default)(t).create(),f=0;f<o.length;f++)if(void 0!==o[f]&&(s+=o[f].drops,u+=o[f].noDrops,l+=o[f].dropSize,s+u>=i&&s/u>r)){c.value=f>0?f-1:0,c.reason={index:c.value,drops:s,noDrops:u,dropSize:l},n("Switch history rule index: "+c.value+" samples: "+(s+u)+" drops: "+s);break}return c}var t=this.context,n=(0,u.default)(t).getInstance().log,r=.075,i=6;return{getMaxIndex:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(4),u=r(s),l=n(7),d=r(l);i.__dashjs_factory_name="SwitchRequest";var c=o.default.getClassFactory(i);t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){I=[],R=[],O=(0,d.default)(S).getInstance()}function n(e,t){I[e]=I[e]||[],I[e].push(t)}function r(e,t){if(R[e]||(R[e]=[]),R[e].push(t),R[e].length>E)return R[e].shift()}function i(e){var t=void 0;return R[e]&&R[e].length>0&&(t=R[e].reduce(function(e,t){return e+t})/R[e].length),t}function a(e,t){var n=Math.min(I[e].length,t?g:m),r=I[e].slice(n*-1,I[e].length);return r.length>1&&r.reduce(function(e,t){return(e*T<=t||e>=t*y)&&n++,t}),n=Math.min(I[e].length,n),I[e].slice(n*-1,I[e].length)}function s(e,t){var n=a(e,t),r=0;if(n.length>0){var i=n.reduce(function(e,t){return e+t},0);r=i/n.length}return I[e].length>=h&&I[e].shift(),r/1e3*O.getBandwidthSafetyFactor()}function l(e,t,n){var r=O.getCacheLoadThresholdLatency(),i=O.getCacheLoadThresholdVideo(),a=O.getCacheLoadThresholdAudio(),o=!1;if(e<r&&(o=!0),!o)switch(n){case"video":o=t<i;break;case"audio":o=t<a}return o}function f(e){var t=e.getMediaInfo(),a=t.type,d=D.getReadOnlyMetricsFor(a),f=e.getStreamProcessor(),_=f.getABRController(),h=f.isDynamic(),p=A.getCurrentHttpRequest(d),g=d.BufferState.length>0?d.BufferState[d.BufferState.length-1]:null,m=e.hasRichBuffer(),E=(0,v.default)(S).create();if(!d||!p||p.type!==c.HTTPRequest.MEDIA_SEGMENT_TYPE||!g||m)return E;var y=void 0,T=void 0;if(p.trace&&p.trace.length){var O=_.getUseDeadTimeLatency();T=p.tresponse.getTime()-p.trequest.getTime()||1,y=p._tfinish.getTime()-p.tresponse.getTime()||1;var P=p.trace.reduce(function(e,t){return e+t.b[0]},0),b=O?y:T+y,w=Math.round(8*P/(b/1e3)),M=void 0,L=void 0;l(T,y,a)?I[a]&&R[a]?(M=s(a,h),L=i(a)):(M=w/1e3,L=T):(n(a,w),M=s(a,h),r(a,T),L=i(a,h)),_.setAverageThroughput(a,M),_.getAbandonmentStateFor(a)!==u.default.ABANDON_LOAD&&(g.state===o.default.BUFFER_LOADED||h)&&(O?E.value=_.getQualityForBitrate(t,M,L):E.value=_.getQualityForBitrate(t,M),f.getScheduleController().setTimeToLoadDelay(0),C("ThroughputRule requesting switch to index: ",E.value,"type: ",a,"Average throughput",Math.round(M),"kbps"),E.reason={throughput:M,latency:L})}return E}function _(){t()}var h=20,g=3,m=4,E=m,y=1.3,T=1.3,S=this.context,C=(0,p.default)(S).getInstance().log,A=e.dashMetrics,D=e.metricsModel,I=void 0,R=void 0,O=void 0,P={getMaxIndex:f,reset:_};return t(),P}Object.defineProperty(t,"__esModule",{value:!0});var a=n(17),o=r(a),s=n(14),u=r(s),l=n(5),d=r(l),c=n(6),f=n(1),_=r(f),h=n(4),p=r(h),g=n(7),v=r(g);i.__dashjs_factory_name="ThroughputRule",t.default=_.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){var t,n=0;return e&&e.some(function(e,t){return n=t,!r.contains(e.serviceLocation)})&&(t=e[n]),t}var n=void 0,r=e.blacklistController;return n={select:t}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="BasicSelector",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){var t=[],n=function(e){return!t.length||!e.dvb_priority||t.indexOf(e.dvb_priority)===-1},r=function(e){return!a.contains(e.serviceLocation)||(e.dvb_priority&&t.push(e.dvb_priority),!1)};return e.filter(r).filter(n)}function n(e){var t,n,r=function(e,t){var n=e.dvb_priority-t.dvb_priority;return isNaN(n)?0:n},i=function(e,t,n){return!t||n[0].dvb_priority&&e.dvb_priority&&n[0].dvb_priority===e.dvb_priority},a=0,o=[],s=0;if(n=e.sort(r).filter(i),n.length)return n.length>1&&(n.forEach(function(e){a+=e.dvb_weight,o.push(a)}),t=Math.floor(Math.random()*(a-1)),o.every(function(e,n){return s=n,!(t<e)})),n[s]}function r(e){return e&&n(t(e))}var i=void 0,a=e.blacklistController;return i={select:r}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="DVBSelector",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){d=(0,o.default)(i).getInstance(),c=(0,u.default)(i).getInstance()}function n(e,t,n){var i=a.getCurrentBufferLevel(s.getReadOnlyMetricsFor(t));return i<r(e,t,n)}function r(e,t,n){var r=NaN,i=e.getCurrentRepresentationInfo();if("fragmentedText"===t)r=l.getAllTracksAreDisabled()?0:i.fragmentDuration;else if("audio"===t&&n){var o=a.getCurrentBufferLevel(s.getReadOnlyMetricsFor("video"));r=Math.floor(Math.max(o,i.fragmentDuration))}else{var u=i.mediaInfo.streamInfo,c=e.getABRController();if(c.isPlayingAtTopQuality(u)){var f=u.manifestInfo.duration>=d.getLongFormContentDurationThreshold();r=f?d.getBufferTimeAtTopQualityLongForm():d.getBufferTimeAtTopQuality()}else r=d.getStableBufferTime()}return r}var i=this.context,a=e.dashMetrics,s=e.metricsModel,l=e.textSourceBuffer,d=void 0,c=void 0,f={execute:n,getBufferTarget:r};return t(),f}Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),o=r(a),s=n(9),u=r(s),l=n(1),d=r(l);i.__dashjs_factory_name="BufferLevelRule",t.default=d.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t){var n=e.getCurrentRepresentationInfo(),o=n.mediaInfo,u=o.type,l=e.getScheduleController(),d=l.getSeekTarget(),c=!isNaN(d),f=e.getBuffer(),_=c?d:i.getIndexHandlerTime(e);if(isNaN(_)||"fragmentedText"===u&&s.getAllTracksAreDisabled())return null;if(c&&l.setSeekTarget(NaN),f){var h=a.getBufferRange(e.getBuffer(),_);null!==h&&(r("Prior to making a request for time, NextFragmentRequestRule is aligning index handler's currentTime with bufferedRange.end.",_," was changed to ",h.end),_=h.end)}var p=void 0;return t?(_=t.startTime+t.duration/2,p=i.getFragmentRequestForTime(e,n,_,{timeThreshold:0,ignoreIsFinished:!0})):(p=i.getFragmentRequestForTime(e,n,_,{keepIdx:!c}),p&&e.getFragmentModel().isFragmentLoaded(p)&&(p=i.getNextFragmentRequest(e,n)),p&&(i.setIndexHandlerTime(e,p.startTime+p.duration),p.delayLoadingTime=(new Date).getTime()+l.getTimeToLoadDelay(),l.setTimeToLoadDelay(0))),p}var n=this.context,r=(0,o.default)(n).getInstance().log,i=e.adapter,a=e.sourceBufferController,s=e.textSourceBuffer,u={execute:t};return u}Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),o=r(a),s=n(1),u=r(s);i.__dashjs_factory_name="NextFragmentRequestRule",t.default=u.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){_=(0,f.default)(a).create({updateEventName:u.default.SERVICE_LOCATION_BLACKLIST_CHANGED,loadFailedEventName:u.default.FRAGMENT_LOADING_COMPLETED}),p=(0,g.default)(a).create({blacklistController:_}),v=(0,h.default)(a).create({blacklistController:_}),m=p}function t(e){e.selector&&(m=e.selector)}function n(e){m=l.getIsDVB(e)?v:p}function r(e){var t=e.baseUrls,n=e.selectedIdx;if(!isNaN(n))return t[n];var r=m.select(t);return r?(e.selectedIdx=t.indexOf(r),r):void s.trigger(u.default.URL_RESOLUTION_FAILED,{error:new Error(E,y)})}function i(){_.reset()}var a=this.context,s=(0,o.default)(a).getInstance(),l=(0,d.default)(a).getInstance(),c=void 0,_=void 0,p=void 0,v=void 0,m=void 0;return c={chooseSelectorFromManifest:n,select:r,reset:i,setConfig:t},e(),c}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),o=r(a),s=n(2),u=r(s),l=n(13),d=r(l),c=n(120),f=r(c),_=n(170),h=r(_),p=n(169),g=r(p),v=n(1),m=r(v),E=1,y="Failed to resolve a valid URL";i.__dashjs_factory_name="BaseURLSelector";var T=m.default.getClassFactory(i);T.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=E,T.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE=y,t.default=T,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){o=!1}function t(){var e="WebKitMediaSource"in window,t="MediaSource"in window;return e||t}function n(){return o}function r(e){o=e}function i(e,t){var n=e.canPlayType(t);return"probably"===n||"maybe"===n}var a=void 0,o=void 0;return a={supportsMediaSource:t,supportsEncryptedMedia:n,supportsCodec:i,setEncryptedMediaSupported:r},e(),a}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="Capabilities",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){return h}function n(e){h=e}function r(e,t){var n=!0,r=0,i=void 0,a=void 0;if(void 0===t&&(t=!1),e.tag>16777215?(_.getUint32(h)!==e.tag&&(n=!1),r=4):e.tag>65535?(i=_.getUint16(h),a=_.getUint8(h+2),256*i+a!==e.tag&&(n=!1),r=3):e.tag>255?(_.getUint16(h)!==e.tag&&(n=!1),r=2):(_.getUint8(h)!==e.tag&&(n=!1),r=1),!n&&e.required&&!t)throw new u.default("required tag not found");return n&&(h+=r),n}function i(e,t){var n=r(e,t);return n&&s(),n}function a(e){var t=void 0;return r(e),t=s(),f[e.parse](t)}function o(e,t){var n=r(e,t),i=void 0;return n&&(i=s(),h+=i),n}function s(e){var t=1,n=128,r=8,i=-1,a=0,o=_.getUint8(h),s=void 0;for(s=0;s<r;s+=1){if((o&n)===n){a=void 0===e?o&~n:o,i=s;break}n>>=1}for(s=0;s<i;s+=1,t+=1)a=a<<8|255&_.getUint8(h+t);return h+=t,a}function l(e){var t=void 0;switch(e){case 4:t=_.getFloat32(h),h+=4;break;case 8:t=_.getFloat64(h),h+=8}return t}function d(e){var t=0,n=void 0;for(n=0;n<e;n+=1)t<<=8,t|=255&_.getUint8(h+n);return h+=e,t}function c(){return h<_.byteLength}var f=void 0,_=new DataView(e.data),h=0;return f={getPos:t,setPos:n,consumeTag:r,consumeTagAndSize:i,parseTag:a,skipOverElement:o,getMatroskaCodedNum:s,getMatroskaFloat:l,getMatroskaUint:d,moreData:c}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(8),u=r(s);i.__dashjs_factory_name="EBMLParser",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){return e&&d&&d.boxes&&0!==d.boxes.length?u(d.fetch(e)):null}function t(e){for(var t,n=d.fetchAll(e),r=[],i=0,a=n.length;i<a;i++)t=u(n[i]),t&&r.push(t);return r}function n(e){d=e}function r(){if(!d||!d.boxes||!d.boxes.length)return null;var e=d.boxes[d.boxes.length-1].type,n=t(e);return n[n.length-1]}function i(){return d._cursor.offset}function a(){c={offset:"_offset",size:"size",type:"type"},f={references:"references",timescale:"timescale",earliest_presentation_time:"earliest_presentation_time",first_offset:"first_offset"},_={reference_type:"reference_type",referenced_size:"referenced_size",subsegment_duration:"subsegment_duration"},h={id:"id",value:"value",timescale:"timescale",scheme_id_uri:"scheme_id_uri",presentation_time_delta:"presentation_time_delta",event_duration:"event_duration",message_data:"message_data"},p={timescale:"timescale"},g={sequence_number:"sequence_number"},v={samples_with_subsamples:"samples_with_subsamples"},m={base_data_offset:"base_data_offset",sample_description_index:"sample_description_index",default_sample_duration:"default_sample_duration",default_sample_size:"default_sample_size",default_sample_flags:"default_sample_flags",flags:"flags"},E={version:"version",baseMediaDecodeTime:"baseMediaDecodeTime",flags:"flags"},y={sample_count:"sample_count",first_sample_flags:"first_sample_flags",data_offset:"data_offset",flags:"flags",samples:"samples"},T={sample_size:"sample_size",sample_duration:"sample_duration",sample_composition_time_offset:"sample_composition_time_offset"}}function s(e,t,n){for(var r in n)t[r]=e[n[r]]}function u(e){if(!e)return null;var t,n,r=new o.default;switch(s(e,r,c),e.hasOwnProperty("_incomplete")&&(r.isComplete=!e._incomplete),r.type){case"sidx":if(s(e,r,f),r.references)for(t=0,n=r.references.length;t<n;t++)s(e.references[t],r.references[t],_);break;case"emsg":s(e,r,h);break;case"mdhd":s(e,r,p);break;case"mfhd":s(e,r,g);break;case"subs":s(e,r,v);break;case"tfhd":s(e,r,m);break;case"tfdt":s(e,r,E);break;case"trun":if(s(e,r,y),r.samples)for(t=0,n=r.samples.length;t<n;t++)s(e.samples[t],r.samples[t],T)}return r}var l=void 0,d=void 0,c=void 0,f=void 0,_=void 0,h=void 0,p=void 0,g=void 0,v=void 0,m=void 0,E=void 0,y=void 0,T=void 0;return l={getBox:e,getBoxes:t,setData:n,getLastBox:r,getOffset:i},a(),l}Object.defineProperty(t,"__esModule",{value:!0});var a=n(183),o=r(a),s=n(1),u=r(s);i.__dashjs_factory_name="IsoFile",t.default=u.default.getClassFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){return JSON.stringify(e)===JSON.stringify(t)}var t=void 0;return t={areSimpleEquivalent:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a);i.__dashjs_factory_name="ObjectUtils",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){e&&e.videoModel&&(re=e.videoModel)}function t(e){if(e.hasOwnProperty("begin")&&e.hasOwnProperty("end")){var t=h(e.begin),n=h(e.end);return[t,n]}return null}function n(){var e="cue_TTML_"+ae;return ae++,
e}function r(e,t,n){function r(e,t){if(e.hasOwnProperty(t)){var n=e[t];a.indexOf(n)<0&&a.push(n)}}for(var i=[],a=[],o=[],s=0;s<e.length;s++){var u=e[s];r(u,"begin"),r(u,"end")}if(0===a.length)return o;if("undefined"!=typeof t&&"undefined"!=typeof n){for(var s=0;s<a.length;s++){var l=h(a[s]);t<l&&l<n&&i.push(l)}i.push(t),i.push(n)}else for(var s=0;s<a.length;s++)i.push(h(a[s]));i.sort(function(e,t){return e-t});for(var s=0;s<i.length-1;s++)o.push([i[s],i[s+1]]);return o}function i(e,t){return"undefined"!=typeof startInterval&&e<t&&(e=t),e}function a(e,t){return"undefined"!=typeof t&&e>t&&(e=t),e}function o(e,t,n){var r=h(e.begin),o=h(e.end);return r=i(r,t),o=a(o,n),"undefined"!=typeof t&&"undefined"!=typeof n&&(o<t||r>n)?(B("TTML: Cue "+r+"-"+o+" outside interval "+t+"-"+n),null):[r,o]}function s(e,n){var r=!0;if(e.hasOwnProperty("span")){var i=t(e.span);null!==i&&(r=i[0]<n[1]&&i[1]>n[0])}return r}function l(e,i,a,u){var l=void 0,d=void 0,c=void 0,f=void 0,_=void 0,h=void 0,v="";if(G=ie.xml_str2json(e),!G)throw new Error("TTML document could not be parsed");if(re.getTTMLRenderingDiv()&&(_="html"),l=G.tt,!l)throw new Error("TTML document lacks tt element");var m=p(l,"http://www.w3.org/ns/ttml");if(m&&g(l,m),f=l["tts:extent"],d=l.head,!d)throw new Error("TTML document lacks head element");d.layout&&(V=d.layout.region_asArray),d.styling&&(K=d.styling.style_asArray);var E={};if(u)for(h=0;h<u.length;h++){var C="urn:mpeg:14496-30:subs:"+(h+1).toString(),A="data:image/png;base64,"+btoa(u[h]);E[C]=A}if(d.metadata){var D=d.metadata.image_asArray;if(D)for(h=0;h<D.length;h++){var C="#"+D[h]["xml:id"],I=D[h].imagetype.toLowerCase(),A="data:image/"+I+";base64,"+D[h].__text;E[C]=A}}if(c=l.body,!c)throw new Error("TTML document lacks body element");var R=M(),w=re.getElement().clientWidth,U=re.getElement().clientHeight,F=[w/R[0],U/R[1]];Q["font-size"]=F[1]+"px;";var H=[];if(V)for(h=0;h<V.length;h++)H.push(P(JSON.parse(JSON.stringify(V[h])),F));var j=p(G.tt,"http://www.w3.org/ns/ttml#parameter");l.hasOwnProperty(j+":frameRate")&&(l.frameRate=parseInt(l[j+":frameRate"],10));for(var z=[],X=l.body_asArray[0].__children,Z=0;Z<X.length;Z++){var J=X[Z].div,$=null;if(null===($=t(J))){var ee=J.p_asArray;if(null===$&&(!ee||0===ee.length))return v="TTML has div that contains no timing and no paragraphs.",B(v),z;for(var te=0;te<ee.length;te++){var ne=ee[te],ae=ne.span_asArray,oe=[];if(ne.hasOwnProperty("begin")&&ne.hasOwnProperty("end")){var se=o(ne,i,a);null!==se&&oe.push(se)}else oe=r(ae,i,a);if(0!==oe.length)for(var ue=ne.__children,le=0;le<oe.length;le++){for(var de=oe[le],ce=[],fe=0;fe<ue.length;fe++){var _e=ue[fe];s(_e,de)&&ce.push(_e)}if(0!==ce.length)if("html"===_){q={},Y={},W={};var he=k(ne,J,F),pe=x(ne,F),ge=pe[1];pe=pe[0];var ve=document.createElement("div");ve.className=ge;var me=N(ce,F);me.className="cueDirUniWrapper",y("unicode-bidi",pe)&&(me.style.cssText+=T("unicode-bidi",pe),S("unicode-bidi",pe)),y("direction",pe)&&(me.style.cssText+=T("direction",pe),S("direction",pe)),y("padding-left",pe)&&y("padding-right",pe)&&(me.innerHTML=L(me,pe)),y("padding-left",pe)&&y("padding-right",pe)&&(S("padding-left",pe),S("padding-right",pe));var Ee="";if(y("regionID",he)){var ye=T("regionID",he);Ee=ye.slice(ye.indexOf(":")+1,ye.length-1)}pe&&(ve.style.cssText=pe.join(" ")+"display:flex;"),he&&(he=he.join(" ")),ve.appendChild(me);var Te=document.createElement("div");Te.appendChild(ve),Te.id=n(),Te.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+he,0===Object.keys(W).length&&(W.defaultFontSize="100"),z.push({start:de[0],end:de[1],type:"html",cueHTMLElement:Te,regions:H,regionID:Ee,cueID:Te.id,videoHeight:U,videoWidth:w,cellResolution:R,fontSize:W||{defaultFontSize:"100"},lineHeight:q,linePadding:Y})}else{var Se="",Ce=ce;Ce.length&&Ce.forEach(function(e){if(e.hasOwnProperty("span")){var t=e.span.__children;t.forEach(function(e){t.hasOwnProperty("metadata")||(e.hasOwnProperty("#text")?Se+=e["#text"].replace(/[\r\n]+/gm," ").trim():"br"in e&&(Se+="\n"))})}else Se+=e.hasOwnProperty("br")?"\n":e["#text"].replace(/[\r\n]+/gm," ").trim()}),z.push({start:de[0],end:de[1],data:Se,type:"text"})}}else v="TTML: Empty paragraph"}}else{var Ae=void 0;if(J.region){var De=b(V,J.region);Ae=O(De,f)}Ae||(Ae=O(J,f));var Ie=J["smpte:backgroundImage"];void 0!==Ie&&void 0!==E[Ie]&&z.push({start:$[0],end:$[1],id:n(),data:E[Ie],type:"image",layout:Ae})}}if(""!==v&&B(v),z.length>0)return z;throw new Error(v)}function _(){j=/^([0-9][0-9]+):([0-5][0-9]):([0-5][0-9])|(60)(\.([0-9])+)?$/,W={},q={},Y={},z={top:"auto;",left:"auto;",width:"90%;",height:"10%;","align-items":"flex-start;",overflow:"visible;","-ms-writing-mode":"lr-tb, horizontal-tb;","-webkit-writing-mode":"horizontal-tb;","-moz-writing-mode":"horizontal-tb;","writing-mode":"horizontal-tb;"},Q={color:"rgb(255,255,255);",direction:"ltr;","font-family":"monospace, sans-serif;","font-style":"normal;","line-height":"normal;","font-weight":"normal;","text-align":"start;","justify-content":"flex-start;","text-decoration":"none;","unicode-bidi":"normal;","white-space":"normal;",width:"100%;"},X={monospace:"font-family: monospace;",sansSerif:"font-family: sans-serif;",serif:"font-family: serif;",monospaceSansSerif:"font-family: monospace, sans-serif;",monospaceSerif:"font-family: monospace, serif;",proportionalSansSerif:"font-family: Arial;",proportionalSerif:"font-family: Times New Roman;",default:"font-family: monospace, sans-serif;"},Z={right:["justify-content: flex-end;","text-align: right;"],start:["justify-content: flex-start;","text-align: start;"],center:["justify-content: center;","text-align: center;"],end:["justify-content: flex-end;","text-align: end;"],left:["justify-content: flex-start;","text-align: left;"]},J={start:"text-align: start;",center:"text-align: center;",end:"text-align: end;",auto:""},$={wrap:"white-space: normal;",noWrap:"white-space: nowrap;"},ee={normal:"unicode-bidi: normal;",embed:"unicode-bidi: embed;",bidiOverride:"unicode-bidi: bidi-override;"},te={before:"align-items: flex-start;",center:"align-items: center;",after:"align-items: flex-end;"},ne={lrtb:"-webkit-writing-mode: horizontal-tb;writing-mode: horizontal-tb;",rltb:"-webkit-writing-mode: horizontal-tb;writing-mode: horizontal-tb;direction: rtl;unicode-bidi: bidi-override;",tbrl:"-webkit-writing-mode: vertical-rl;writing-mode: vertical-rl;-webkit-text-orientation: upright;text-orientation: upright;",tblr:"-webkit-writing-mode: vertical-lr;writing-mode: vertical-lr;-webkit-text-orientation: upright;text-orientation: upright;",lr:"-webkit-writing-mode: horizontal-tb;writing-mode: horizontal-tb;",rl:"-webkit-writing-mode: horizontal-tb;writing-mode: horizontal-tb;direction: rtl;",tb:"-webkit-writing-mode: vertical-rl;writing-mode: vertical-rl;-webkit-text-orientation: upright;text-orientation: upright;"},ie=new u.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,matchers:[]})}function h(e){var t,n,r,i=j.test(e);if(!i)return NaN;if(t=e.split(":"),n=parseFloat(t[0])*c+parseFloat(t[1])*f+parseFloat(t[2]),t[3]){if(r=G.tt.frameRate,!r||isNaN(r))return NaN;n+=parseFloat(t[3])/r}return n}function p(e,t){var n=Object.keys(e).filter(function(n){return("xmlns"===n.split(":")[0]||"xmlns"===n.split(":")[1])&&e[n]===t}).map(function(e){return e.split(":")[2]||e.split(":")[1]});return 1!=n.length?null:n[0]}function g(e,t){for(var n in e)if(e.hasOwnProperty(n)){if(("object"==typeof e[n]||e[n]instanceof Object)&&!Array.isArray(e[n]))g(e[n],t);else if(Array.isArray(e[n]))for(var r=0;r<e[n].length;r++)g(e[n][r],t);var i=t+":",a=n.indexOf(i);if(a>=0){var o=n.slice(a+i.length);e[o]=e[n],delete e[n]}}}function v(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function m(e){var t=e.slice(1),n=t.match(/.{2}/g),r=parseFloat(parseInt(parseInt(n[3],16)/255*1e3,10)/1e3),i=n.slice(0,3).map(function(e){return parseInt(e,16)});return"rgba("+i.join(",")+","+r+");"}function E(e){var t=void 0,n=void 0,r=void 0;return t=e.replace(/^(rgb|rgba)\(/,"").replace(/\)$/,"").replace(/\s/g,"").split(","),n=parseInt(t[t.length-1],10)/255,r="rgba("+t[0]+","+t[1]+","+t[2]+","+n+");"}function y(e,t){for(var n=0;n<t.length;n++)if(t[n].indexOf(e)>-1)return!0;return!1}function T(e,t){for(var n=0;n<t.length;n++)if(t[n].indexOf(e)>-1)return t[n];return null}function S(e,t){t.splice(t.indexOf(T(e,t)),1)}function C(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<t.length;r++)e[n]&&e[n].split(":")[0].indexOf(t[r].split(":")[0])>-1&&e.splice(n,1);return e.concat(t)}function A(e){var t=new Array(2),n=e.indexOf(":")===-1?0:e.indexOf(":"),r=void 0;return e.indexOf("%")===-1?e.indexOf("c")===-1?e.indexOf("p")===-1?t[0]=t[1]=null:(t[0]="p",r=e.indexOf("p")):(t[0]="c",r=e.indexOf("c")):(t[0]="%",r=e.indexOf("%")),t[1]=e.slice(n,r),t}function D(e,t,n){var r,i,a=[];for(var o in e)if(e.hasOwnProperty(o)){var s=o.replace("ebutts:","");s=s.replace("xml:",""),s=s.replace("tts:",""),s=v(s),e[s]=e[o],delete e[o]}if("line-padding"in e){var u=parseFloat(e["line-padding"].slice(e["line-padding"].indexOf(":")+1,e["line-padding"].indexOf("c")));"id"in e&&(Y[e.id]=u);var l=u*t[0]+"px;";a.push("padding-left:"+l),a.push("padding-right:"+l)}if("font-size"in e){var d=A(e["font-size"]),c=parseFloat(d[1]);"id"in e&&(W[e.id]=d),"%"===d[0]?r=c/100*t[1]+"px;":"c"===d[0]&&(r=c*t[1]+"px;"),a.push("font-size:"+r)}if("line-height"in e)if("normal"===e["line-height"])a.push("line-height: normal;");else{var f=A(e["line-height"]),_=parseFloat(f[1]);"id"in e&&(q[e.id]=f),"%"===f[0]?i=_/100*t[1]+"px;":"c"===f[0]&&(i=_*t[1]+"px;"),a.push("line-height:"+i)}"font-family"in e&&(e["font-family"]in X?a.push(X[e["font-family"]]):a.push("font-family:"+e["font-family"]+";")),"text-align"in e&&e["text-align"]in Z&&(a.push(Z[e["text-align"]][0]),a.push(Z[e["text-align"]][1])),"multi-row-align"in e&&(y("text-align",a)&&"auto"!=e["multi-row-align"]&&S("text-align",a),e["multi-row-align"]in J&&a.push(J[e["multi-row-align"]]));var h;return"background-color"in e&&(h=e["background-color"].indexOf("#")>-1&&e["background-color"].length-1===8?m(e["background-color"]):e["background-color"].indexOf("rgba")>-1?E(e["background-color"]):e["background-color"]+";",a.push("background-color: "+h)),"color"in e&&(h=e.color.indexOf("#")>-1&&e.color.length-1===8?m(e.color):e.color.indexOf("rgba")>-1?E(e.color):e.color+";",a.push("color: "+h)),"wrap-option"in e&&(e["wrap-option"]in $?a.push($[e["wrap-option"]]):a.push("white-space:"+e["wrap-option"])),"unicode-bidi"in e&&(e["unicode-bidi"]in ee?a.push(ee[e["unicode-bidi"]]):a.push("unicode-bidi:"+e["unicode-bidi"])),"font-style"in e&&a.push("font-style:"+e["font-style"]+";"),"font-weight"in e&&a.push("font-weight:"+e["font-weight"]+";"),"direction"in e&&a.push("direction:"+e.direction+";"),"text-decoration"in e&&a.push("text-decoration:"+e["text-decoration"]+";"),n&&(a=a.concat(P(e,t))),G.tt.hasOwnProperty("xml:space")&&"preserve"===G.tt["xml:space"]&&a.push("white-space: pre;"),a}function I(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r["xml:id"]===t||r.id===t)return r}return null}function R(e,t,n){var r=[],i=e.match(/\S+/g);return i.forEach(function(e){var i=I(K,e);if(i){var a=D(JSON.parse(JSON.stringify(i)),t,n);r=r.concat(a)}}),r}function O(e,t){var n=/([\d\.]+)(%|px)\s+([\d\.]+)(%|px)/;if("tts:extent"in e&&"tts:origin"in e){var r=n.exec(e["tts:extent"]),i=n.exec(e["tts:origin"]);if(null===r||null===i)return B("Bad extent or origin: "+e["tts:extent"]+" "+e["tts:origin"]),null;var a=parseFloat(r[1]),o=parseFloat(r[3]),s=parseFloat(i[1]),u=parseFloat(i[3]);if(t){var l=n.exec(t);if(null===l||"px"!==l[2]||"px"!==l[4])return B("Bad tt.extent: "+t),null;var d=parseFloat(l[1]),c=parseFloat(l[3]);"px"===r[2]&&(a=a/d*100),"px"===r[4]&&(o=o/c*100),"px"===i[2]&&(s=s/d*100),"px"===i[4]&&(u=u/c*100)}return{left:s,top:u,width:a,height:o}}return null}function P(e,t){var n=[];for(var r in e){var i=r.replace("tts:","");i=i.replace("xml:",""),i=v(i),e[i]=e[r],i!==r&&delete e[r]}if("extent"in e){var a=e.extent.split(/\s/);n.push("width: "+a[0]+";"),n.push("height: "+a[1]+";")}if("origin"in e){var o=e.origin.split(/\s/);n.push("left: "+o[0]+";"),n.push("top: "+o[1]+";")}if("display-align"in e&&n.push(te[e["display-align"]]),"writing-mode"in e&&n.push(ne[e["writing-mode"]]),"style"in e){var s=R(e.style,t,!0);n=n.concat(s)}return"padding"in e&&n.push("padding:"+e.padding+";"),"overflow"in e&&n.push("overflow:"+e.overflow+";"),"show-background"in e&&n.push("show-background:"+e["show-background"]+";"),"id"in e&&n.push("regionID:"+e.id+";"),n}function b(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r["xml:id"]===t||r.id===t)return r}return null}function w(e,t){var n=[],r=e.match(/\S+/g);return r.forEach(function(e){var r=b(V,e);if(r){var i=P(JSON.parse(JSON.stringify(r)),t);n=n.concat(i)}}),n}function M(){var e=[32,15];return G.tt.hasOwnProperty("ttp:cellResolution")?G.tt["ttp:cellResolution"].split(" ").map(parseFloat):e}function L(e,t){for(var n=T("padding-left",t),r=T("padding-right",t),i=n.concat(" "+r+" "),a="",o="",s="",u=Array.prototype.slice.call(e.children),l=e.getElementsByClassName("lineBreak")[0],d=u.indexOf(l),c=[];d!=-1;)c.push(d),d=u.indexOf(l,d+1);var f="</span>",_="<br>",h='<span class="spanPadding" style="-webkit-box-decoration-break: clone; box-decoration-break: clone; ';if(c.length)c.forEach(function(e,t){if(0===t){for(var n="",r=0;r<e;r++)a+=u[r].outerHTML,0===r&&(n=i.concat(u[r].style.cssText));a=h+n+'">'+a}for(var l="",d=e+1;d<u.length;d++)o+=u[d].outerHTML,d===u.length-1&&(l+=i.concat(u[d].style.cssText));o=h+l+'">'+o,a&&o&&t===c.length-1?s+=a+f+_+o+f:a&&o&&t!==c.length-1?s+=a+f+_+o+f+_:a&&!o?s+=a+f:!a&&o&&t===c.length-1?s+=o+f:!a&&o&&t!==c.length-1&&(s+=o+f+_)});else{for(var p="",g=0;g<u.length;g++)p+=u[g].style.cssText;s=h+i+p+'">'+e.innerHTML+f}return s}function N(e,t){var n=document.createElement("div");return e.forEach(function(e){if(!e.hasOwnProperty("metadata"))if(e.hasOwnProperty("span")){var r=e.span.__children,i=document.createElement("span");if(e.span.hasOwnProperty("style")){var a=R(e.span.style,t);i.className="spanPadding "+e.span.style,i.style.cssText=a.join(" ")}r.forEach(function(e){if(!r.hasOwnProperty("metadata"))if(e.hasOwnProperty("#text")){var t=document.createTextNode(e["#text"]);i.appendChild(t)}else if("br"in e){i.hasChildNodes()&&n.appendChild(i);var a=document.createElement("br");a.className="lineBreak",n.appendChild(a);var o=document.createElement("span");o.className=i.className,o.style.cssText=i.style.cssText,i=o}}),n.appendChild(i)}else if(e.hasOwnProperty("br")){var o=document.createElement("br");o.className="lineBreak",n.appendChild(o)}else if(e.hasOwnProperty("#text")){var s=document.createElement("span");s.textContent=e["#text"],n.appendChild(s)}}),n}function k(e,t,n){var r,i,a=[],o=e.region,s=t.region;return s&&(r=w(s,n)),o?(i=a.concat(w(o,n)),a=r?C(r,i):i):r&&(a=r),U(a,z),a}function x(e,t){var n,r,i,a=[],o=e.style,s=G.tt.body.style,u=G.tt.body.div.style,l="";return s&&(n=R(s,t),l="paragraph "+s),u&&(r=R(u,t),n?(r=C(n,r),l+=" "+u):l="paragraph "+u),o?(i=R(o,t),n&&r?(a=C(r,i),l+=" "+o):n?(a=C(n,i),l+=" "+o):r?(a=C(r,i),l+=" "+o):(a=i,l="paragraph "+o)):n&&!r?a=n:!n&&r&&(a=r),U(a,Q),[a,l]}function U(e,t){for(var n in t)t.hasOwnProperty(n)&&(y(n,e)||e.push(n+":"+t[n]))}var F=this.context,B=(0,d.default)(F).getInstance().log,H=void 0,j=void 0,G=void 0,K=void 0,V=void 0,W=void 0,q=void 0,Y=void 0,z=void 0,Q=void 0,X=void 0,Z=void 0,J=void 0,$=void 0,ee=void 0,te=void 0,ne=void 0,re=void 0,ie=void 0,ae=0;return H={parse:l,setConfig:e},_(),H}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(38),u=r(s),l=n(4),d=r(l),c=3600,f=60;i.__dashjs_factory_name="TTMLParser",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){d=/(?:\r\n|\r|\n)/gm,c=/-->/,f=/(^[\s]+|[\s]+$)/g,_=/\s\b/g}function t(e){var t,i,o=[];e=e.split(d),t=e.length,i=-1;for(var u=0;u<t;u++){var l=e[u];if(l.length>0&&"WEBVTT"!==l&&l.match(c)){var _=r(l),h=_.cuePoints,p=_.styles,g=a(e,u+1),v=n(h[0].replace(f,"")),m=n(h[1].replace(f,""));!isNaN(v)&&!isNaN(m)&&v>=i&&m>v?""!==g?(i=v,o.push({start:v,end:m,data:g,styles:p})):s("Skipping cue due to empty/malformed cue text"):s("Skipping cue due to incorrect cue timing")}}return o}function n(e){var t=e.split(":"),n=t.length-1;return e=60*parseInt(t[n-1],10)+parseFloat(t[n]),2===n&&(e+=3600*parseInt(t[0],10)),e}function r(e){var t=e.split(c),n=t[1].split(_);return n.shift(),t[1]=n[0],n.shift(),{cuePoints:t,styles:i(n)}}function i(e){var t={};return e.forEach(function(e){if(e.split(/:/).length>1){var n=e.split(/:/)[1];n&&n.search(/%/)!=-1&&(n=parseInt(n.replace(/%/,""),10)),(e.match(/align/)||e.match(/A/))&&(t.align=n),(e.match(/line/)||e.match(/L/))&&(t.line=n),(e.match(/position/)||e.match(/P/))&&(t.position=n),(e.match(/size/)||e.match(/S/))&&(t.size=n)}}),t}function a(e,t){for(var n,r=t,i="",a="";""!==e[r]&&r<e.length;)r++;if(n=r-t,n>1)for(var o=0;o<n;o++){if(a=e[t+o],a.match(c)){i="";break}i+=a,o!==n-1&&(i+="\n")}else a=e[t],a.match(c)||(i=a);return decodeURI(i)}var o=this.context,s=(0,u.default)(o).getInstance().log,l=void 0,d=void 0,c=void 0,f=void 0,_=void 0;return l={parse:t},e(),l}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),o=r(a),s=n(4),u=r(s);i.__dashjs_factory_name="VTTParser",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.qualityIndex=NaN};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN};t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}},s=n(19),u=r(s),l=function(e){function t(e){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.url=e||null,this.checkForExistenceOnly=!0}return a(t,e),t}(u.default);t.default=l,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.offset=NaN,this.type=null,this.size=NaN,this.isComplete=!0};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.DVRWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.lang=null,this.viewpoint=null,this.accessibility=null,this.audioChannelConfiguration=null,this.roles=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[],this.BolaState=[]};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0,this.isFirst=!0};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.video=null,this.captionData=null,this.label=null,this.lang=null,this.defaultTrack=!1,this.kind=null,this.isFragmented=!1,this.isEmbedded=!1};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.id=null,this.quality=null,this.DVRWindow=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this._s=void 0};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.t=null,this.level=null};t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=n(17),o=r(a),s=function e(){i(this,e),this.target=null,this.state=o.default.BUFFER_EMPTY};t.default=s,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.time=null,this.range=null,this.manifestInfo=null};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.time=null,this.droppedFrames=null};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.trackInfo=[]},i=function e(){n(this,e),this.id=null,this.index=null,this.start=null,this.duration=null},a=function e(){n(this,e),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null};t.ManifestUpdate=r,t.ManifestUpdateStreamInfo=i,t.ManifestUpdateTrackInfo=a},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.t=null,this.mt=null,this.to=null,this.lto=null};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.loadingRequests=[],this.executedRequests=[]};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null};t.default=r,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){n(this,e),this.tcpid=null,this.dest=null,this.topen=null,this.tclose=null,this.tconnect=null};t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(){this._events=new r,this._eventsCount=0}var o=Object.prototype.hasOwnProperty,s="~";Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(s=!1)),a.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)o.call(e,t)&&n.push(s?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},a.prototype.listeners=function(e,t){var n=s?s+e:e,r=this._events[n];if(t)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var i=0,a=r.length,o=new Array(a);i<a;i++)o[i]=r[i].fn;return o},a.prototype.emit=function(e,t,n,r,i,a){var o=s?s+e:e;if(!this._events[o])return!1;var u,l,d=this._events[o],c=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),c){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,n),!0;case 4:return d.fn.call(d.context,t,n,r),!0;case 5:return d.fn.call(d.context,t,n,r,i),!0;case 6:return d.fn.call(d.context,t,n,r,i,a),!0}for(l=1,u=new Array(c-1);l<c;l++)u[l-1]=arguments[l];d.fn.apply(d.context,u)}else{var f,_=d.length;for(l=0;l<_;l++)switch(d[l].once&&this.removeListener(e,d[l].fn,void 0,!0),c){case 1:d[l].fn.call(d[l].context);break;case 2:d[l].fn.call(d[l].context,t);break;case 3:d[l].fn.call(d[l].context,t,n);break;case 4:d[l].fn.call(d[l].context,t,n,r);break;default:if(!u)for(f=1,u=new Array(c-1);f<c;f++)u[f-1]=arguments[f];d[l].fn.apply(d[l].context,u)}}return!0},a.prototype.on=function(e,t,n){var r=new i(t,n||this),a=s?s+e:e;return this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],r]:this._events[a].push(r):(this._events[a]=r,this._eventsCount++),this},a.prototype.once=function(e,t,n){var r=new i(t,n||this,!0),a=s?s+e:e;return this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],r]:this._events[a].push(r):(this._events[a]=r,this._eventsCount++),this},a.prototype.removeListener=function(e,t,n,i){var a=s?s+e:e;if(!this._events[a])return this;if(!t)return 0===--this._eventsCount?this._events=new r:delete this._events[a],this;var o=this._events[a];if(o.fn)o.fn!==t||i&&!o.once||n&&o.context!==n||(0===--this._eventsCount?this._events=new r:delete this._events[a]);else{for(var u=0,l=[],d=o.length;u<d;u++)(o[u].fn!==t||i&&!o[u].once||n&&o[u].context!==n)&&l.push(o[u]);l.length?this._events[a]=1===l.length?l[0]:l:0===--this._eventsCount?this._events=new r:delete this._events[a]}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=s?s+e:e,this._events[t]&&(0===--this._eventsCount?this._events=new r:delete this._events[t])):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prototype.setMaxListeners=function(){return this},a.prefixed=s,a.EventEmitter=a,e.exports=a},function(e,t){var n=t.decimalAdjust=function(e,t,n){return"undefined"==typeof n||0===+n?Math[e](t):(t=+t,n=+n,isNaN(t)||"number"!=typeof n||n%1!==0?NaN:(t=t.toString().split("e"),t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n))),t=t.toString().split("e"),+(t[0]+"e"+(t[1]?+t[1]+n:n))))};e.exports={round10:function(e,t){return n("round",e,t)},floor10:function(e,t){return n("floor",e,t)},ceil10:function(e,t){return n("ceil",e,t)}},e.exports.polyfill=function(){Math.round10||(Math.round10=e.exports.round10),Math.floor10||(Math.floor10=e.exports.floor10),Math.ceil10||(Math.ceil10=e.exports.ceil10)}},function(e,t){!function(n,r){"object"==typeof t&&"object"==typeof e?e.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof t?t.Downloader=r():(n.Streamroot=n.Streamroot||{},n.Streamroot.Downloader=r())}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=185)}([function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){"use strict";t.__esModule=!0;var r=n(243),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,i.default)(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={ChunkManager:{CHUNK_DOWNLOADED:"chunkDownloaded"},Config:{CONFIG_UPDATED:"configUpdated"},Distributor:{READY:"DISTRIBUTOR_READY"},Metrics:{TRACK_SWITCH:"metricsTrackSwitch"},Media:{ENDED:"mediaEnded"},Scheduler:{REACHED_LIVE_EDGE_STATE_CHANGED:"schedulerReachedLiveEdgeStateChanged"},SRModuleInterface:{ABR_FEEDBACK:"srModuleInterfaceAbrFeedback",UNCOMPLETE_SEGMENT_REQUESTED:"srmoduleinterfaceUncompleteSegmentRequested",SEGMENT_TRANSFERED_TO_MEDIA_ENGINE:"segmentTransferedToMediaEngine"},PeerPool:{PEER_OPEN:"peerpoolPeerOpen",PEER_DESTROYED:"peerpoolPeerDestroyed",PEER_STATS_UPDATE:"peerPoolStat",START_ASKING_PEERS:"startAskingPeers",STOP_ASKING_PEERS:"stopAskingPeers"},BufferManager:{LOW_BUFFER:"buffermanagerLowBuffer",HIGH_BUFFER:"buffermanagerHighBuffer",STATE_CHANGED:"buffermanagerStateChanged"},PeerConnection:{DISCONNECTED:"peerConnectionDisconnected",MESSAGE_RECEIVED:"peerConnectionMessageReceived",BINARY_DATA_RECEIVED:"peerConnectionBinaryDataReceived"},Peer:{REMOVE_PEER:"removePeer"},UploadQueue:{CHUNK_REQUESTED:"chunkRequested"},P2PCache:{REMOVE_SEGMENT_FROM_CACHE:"removeSegmentFromCache"},BufferedAmountObserver:{BUFFER_CHECK:"bufferCheck"},Tracker:{PERM_TRACKER_DISCONNECTION_REQUEST:"permTrackerDisconnectionRequest",
TEMP_TRACKER_DISCONNECTION_REQUEST:"tempTrackerDisconnectionRequest",TRACKER_RECONNECTION_REQUEST:"trackerReconnectionRequest"},TrafficAnalytics:{STOP_SENDING_USAGE:"stopSendingUsage",RESTART_SENDING_USAGE:"restartSendingUsage"},Signaling:{PERM_SIGNALING_DISCONNECTION_REQUEST:"permSignalingDisconnectionRequest",TEMP_SIGNALING_DISCONNECTION_REQUEST:"tempSignalingDisconnectionRequest",SIGNALING_RECONNECTION_REQUEST:"signalingReconnectionRequest"}},e.exports=t.default},function(e,t){var n=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},function(e,t,n){"use strict";function r(e,t){return new o(e,t,a.TIMER_TYPE.INTERVAL)}function i(e,t){return new o(e,t,a.TIMER_TYPE.TIMEOUT)}Object.defineProperty(t,"__esModule",{value:!0}),t.createInterval=r,t.createTimeout=i;var a=n(100),o=void 0;o=n(236)},function(e,t,n){"use strict";e.exports=n(166)},function(e,t,n){var r=n(12),i=n(3),a=n(22),o=n(23),s=function(e,t,n){var u,l,d,c=e&s.F,f=e&s.G,_=e&s.S,h=e&s.P,p=e&s.B,g=e&s.W,v=f?i:i[t]||(i[t]={}),m=v.prototype,E=f?r:_?r[t]:(r[t]||{}).prototype;f&&(n=t);for(u in n)(l=!c&&E&&void 0!==E[u])&&u in v||(d=l?E[u]:n[u],v[u]=f&&"function"!=typeof E[u]?n[u]:p&&l?a(d,r):g&&E[u]==d?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(d):h&&"function"==typeof d?a(Function.call,d):d,h&&((v.virtual||(v.virtual={}))[u]=d,e&s.R&&m&&!m[u]&&o(m,u,d)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,e.exports=s},function(e,t,n){e.exports={default:n(269),__esModule:!0}},function(e,t,n){e.exports={default:n(255),__esModule:!0}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=n(247),a=r(i),o=n(241),s=r(o),u=n(31),l=r(u);t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,l.default)(t)));e.prototype=(0,s.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(a.default?(0,a.default)(e,t):e.__proto__=t)}},function(e,t,n){"use strict";t.__esModule=!0;var r=n(31),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,i.default)(t))&&"function"!=typeof t?e:t}},function(e,t,n){var r=n(78)("wks"),i=n(59),a=n(12).Symbol,o="function"==typeof a;(e.exports=function(e){return r[e]||(r[e]=o&&a[e]||(o?a:i)("Symbol."+e))}).store=r},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(26)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(19),i=n(109),a=n(80),o=Object.defineProperty;t.f=n(14)?Object.defineProperty:function(e,t,n){if(r(e),t=a(t,!0),r(n),i)try{return o(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){e.exports={default:n(258),__esModule:!0}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return"number"==typeof e&&!isNaN(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.isNumeric=t.Delta=void 0;var a=n(0),o=r(a),s=n(1),u=r(s),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(0,o.default)(this,e),this._lastDeltaValue=t}return(0,u.default)(e,[{key:"calcDelta",value:function(e){var t=e-this._lastDeltaValue;return this._lastDeltaValue=e,t}}]),e}();t.Delta=l,t.isNumeric=i},function(e,t,n){e.exports={default:n(262),__esModule:!0}},function(e,t,n){var r=n(13);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var r=n(72),i=n(54);e.exports=function(e){return r(i(e))}},function(e,t,n){"use strict";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(){this._events=new r,this._eventsCount=0}var o=Object.prototype.hasOwnProperty,s="~";Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(s=!1)),a.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)o.call(e,t)&&n.push(s?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},a.prototype.listeners=function(e,t){var n=s?s+e:e,r=this._events[n];if(t)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var i=0,a=r.length,o=new Array(a);i<a;i++)o[i]=r[i].fn;return o},a.prototype.emit=function(e,t,n,r,i,a){var o=s?s+e:e;if(!this._events[o])return!1;var u,l,d=this._events[o],c=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),c){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,n),!0;case 4:return d.fn.call(d.context,t,n,r),!0;case 5:return d.fn.call(d.context,t,n,r,i),!0;case 6:return d.fn.call(d.context,t,n,r,i,a),!0}for(l=1,u=new Array(c-1);l<c;l++)u[l-1]=arguments[l];d.fn.apply(d.context,u)}else{var f,_=d.length;for(l=0;l<_;l++)switch(d[l].once&&this.removeListener(e,d[l].fn,void 0,!0),c){case 1:d[l].fn.call(d[l].context);break;case 2:d[l].fn.call(d[l].context,t);break;case 3:d[l].fn.call(d[l].context,t,n);break;case 4:d[l].fn.call(d[l].context,t,n,r);break;default:if(!u)for(f=1,u=new Array(c-1);f<c;f++)u[f-1]=arguments[f];d[l].fn.apply(d[l].context,u)}}return!0},a.prototype.on=function(e,t,n){var r=new i(t,n||this),a=s?s+e:e;return this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],r]:this._events[a].push(r):(this._events[a]=r,this._eventsCount++),this},a.prototype.once=function(e,t,n){var r=new i(t,n||this,!0),a=s?s+e:e;return this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],r]:this._events[a].push(r):(this._events[a]=r,this._eventsCount++),this},a.prototype.removeListener=function(e,t,n,i){var a=s?s+e:e;if(!this._events[a])return this;if(!t)return 0==--this._eventsCount?this._events=new r:delete this._events[a],this;var o=this._events[a];if(o.fn)o.fn!==t||i&&!o.once||n&&o.context!==n||(0==--this._eventsCount?this._events=new r:delete this._events[a]);else{for(var u=0,l=[],d=o.length;u<d;u++)(o[u].fn!==t||i&&!o[u].once||n&&o[u].context!==n)&&l.push(o[u]);l.length?this._events[a]=1===l.length?l[0]:l:0==--this._eventsCount?this._events=new r:delete this._events[a]}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=s?s+e:e,this._events[t]&&(0==--this._eventsCount?this._events=new r:delete this._events[t])):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prototype.setMaxListeners=function(){return this},a.prefixed=s,a.EventEmitter=a,e.exports=a},function(e,t,n){var r=n(68);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){var r=n(15),i=n(44);e.exports=n(14)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),a=r(i),o=n(16),s=r(o),u=n(0),l=r(u),d=n(1),c=r(d),f=n(5),_=r(f),h=function(){function e(){(0,l.default)(this,e),this._timers=new s.default}return(0,c.default)(e,[{key:"register",value:function(e){var t=e.name;return!this._timers.has(t)&&(this._timers.set(t,e),!0)}},{key:"registerAs",value:function(e,t){return!this._timers.has(e)&&(t.name=e,this._timers.set(e,t),!0)}},{key:"clear",value:function(e){return!!e&&this.clearNamedTimer(e.name)}},{key:"clearNamedTimer",value:function(e){var t=this._timers.get(e);return!!t&&(t.clear(),this._timers.delete(t.name))}},{key:"clearAll",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=(0,a.default)(this._timers.values());!(e=(r=i.next()).done);e=!0){var o=r.value;this.clear(o)||_.default.notify("Cannot remove timer","Timer "+o.id+" was not found in timers map.")}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}}]),e}();t.default=h,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){return parseFloat(e.toFixed(t))}function i(e,t){for(var n=[],r=t>=e?1:-1,i=Math.min(e*r,t*r),a=Math.max(e*r,t*r),o=i;o<=a;o++)n.push(o*r);return n}function a(e,t,n){return Math.min(Math.max(e,t),n)}Object.defineProperty(t,"__esModule",{value:!0}),t.toDecimal=r,t.range=i,t.clamp=a},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(119),i=n(71);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(6),i=n(3),a=n(26);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],o={};o[e]=t(n),r(r.S+r.F*a(function(){n(1)}),"Object",o)}},function(e,t,n){"use strict";var r=n(298)(!0);n(73)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=n(251),a=r(i),o=n(250),s=r(o),u="function"==typeof s.default&&"symbol"==typeof a.default?function(e){return typeof e}:function(e){return e&&"function"==typeof s.default&&e.constructor===s.default&&e!==s.default.prototype?"symbol":typeof e};t.default="function"==typeof s.default&&"symbol"===u(a.default)?function(e){return void 0===e?"undefined":u(e)}:function(e){return e&&"function"==typeof s.default&&e.constructor===s.default&&e!==s.default.prototype?"symbol":void 0===e?"undefined":u(e)}},function(e,t){e.exports={}},function(e,t,n){var r=n(54);e.exports=function(e){return Object(r(e))}},function(e,t,n){n(303);for(var r=n(12),i=n(23),a=n(32),o=n(11)("toStringTag"),s=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],u=0;u<5;u++){var l=s[u],d=r[l],c=d&&d.prototype;c&&!c[o]&&i(c,o,l),a[l]=a.Array}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u="Unvalid weight parameter for EMWA: must be an number in ]0,1[",l=function(){function e(t,n){if((0,a.default)(this,e),n<=0||n>=1)throw new Error(u);this._emwaValue=t,this._weight=n}return(0,s.default)(e,[{key:"update",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=null!==t?t:this._weight;this._emwaValue=(1-n)*this._emwaValue+n*e}},{key:"value",get:function(){return this._emwaValue}}],[{key:"Errors",value:function(){return{UNVALID_WEIGHT:u}}},{key:"fromHalfLife",value:function(t,n,r){return new e(t,this.halfLifeToEMAWeight(n,r))}},{key:"halfLifeToEMAWeight",value:function(e,t){var n=e/t;return 1-1/Math.pow(2,1/n)}}]),e}();t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(){var e=window&&window.navigator?window.navigator.userAgent:"";return(new o.default).setUA(e).getResult()}function i(){var e=r();return"mobile"===e.device.type||"tablet"===e.device.type||"console"===e.device.type||"Android"===e.os.name||"iOS"===e.os.name}Object.defineProperty(t,"__esModule",{value:!0});var a=n(333),o=function(e){return e&&e.__esModule?e:{default:e}}(a);t.default={getUAObject:r,isMobile:i},e.exports=t.default},function(e,t,n){e.exports={default:n(254),__esModule:!0}},function(e,t,n){e.exports={default:n(257),__esModule:!0}},function(e,t,n){e.exports={default:n(261),__esModule:!0}},function(e,t,n){"use strict";t.__esModule=!0;var r=n(37),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return(0,i.default)(e)}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(59)("meta"),i=n(13),a=n(27),o=n(15).f,s=0,u=Object.isExtensible||function(){return!0},l=!n(26)(function(){return u(Object.preventExtensions({}))}),d=function(e){o(e,r,{value:{i:"O"+ ++s,w:{}}})},c=function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,r)){if(!u(e))return"F";if(!t)return"E";d(e)}return e[r].i},f=function(e,t){if(!a(e,r)){if(!u(e))return!0;if(!t)return!1;d(e)}return e[r].w},_=function(e){return l&&h.NEED&&u(e)&&!a(e,r)&&d(e),e},h=e.exports={KEY:r,NEED:!1,fastKey:c,getWeak:f,onFreeze:_}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(15).f,i=n(27),a=n(11)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,a)&&r(e,a,{configurable:!0,value:t})}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n=e.prototype,r=!0,i=!1,o=void 0;try{for(var s,u=(0,_.default)(a(n));!(r=(s=u.next()).done);r=!0){var l=s.value;if((0,c.default)(t[l])!==(0,c.default)(n[l])){var d=t.constructor.name;throw new Error("The method "+l+" of "+e.name+" is not defined in "+d)}}}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}}function a(e){var t=(0,l.default)(e).filter(function(e){return"constructor"!==e}),n=Object.prototype;if((0,s.default)(e)===n)return t;var r=(0,s.default)(e);return t.concat(a(r))}Object.defineProperty(t,"__esModule",{value:!0}),t._getEveryPropertyNames=t.checkInterface=void 0;var o=n(7),s=r(o),u=n(102),l=r(u),d=n(31),c=r(d),f=n(8),_=r(f);t.checkInterface=i,t._getEveryPropertyNames=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.assertStreamType=t.StreamTypes=void 0;var i=n(248),a=r(i),o=n(51),s=r(o),u={HLS:"hls",DASH:"dash",SMOOTH:"smooth"};(0,s.default)(u);var l=function(e){if(-1===(0,a.default)(u).indexOf(e))throw new TypeError("'"+e+"' is not a valid value for stream type.")};t.StreamTypes=u,t.assertStreamType=l},function(e,t,n){"use strict";e.exports=n(169)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){return(0,T.default)(e,t)}function a(e){(0,E.default)(e);for(var t=(0,v.default)(e),n=0;n<t.length;n++){var r=t[n],i=e[r];null===i||"object"!==(void 0===i?"undefined":(0,p.default)(i))||(0,_.default)(i)||a(i)}}function o(e,t){for(var n={},r=(0,c.default)(e),i=0;i<r.length;i++){var a=r[i];t!==a&&(n[a]=e[a])}return n}function s(e){return JSON.parse((0,l.default)(e))}Object.defineProperty(t,"__esModule",{value:!0});var u=n(38),l=r(u),d=n(52),c=r(d),f=n(245),_=r(f),h=n(31),p=r(h),g=n(102),v=r(g),m=n(51),E=r(m),y=n(18),T=r(y);t.default={merge:i,deepFreeze:a,omit:o,deepCopy:s},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={SAFE:"safe",UNSAFE:"unsafe"};t.default=r,e.exports=t.default},function(e,t,n){e.exports={default:n(266),__esModule:!0}},function(e,t,n){e.exports={default:n(272),__esModule:!0}},function(e,t,n){var r=n(41),i=n(11)("toStringTag"),a="Arguments"==r(function(){return arguments}()),o=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=o(t=Object(e),i))?n:a?r(t):"Object"==(s=r(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(22),i=n(112),a=n(110),o=n(19),s=n(58),u=n(83),l={},d={},t=e.exports=function(e,t,n,c,f){var _,h,p,g,v=f?function(){return e}:u(e),m=r(n,c,t?2:1),E=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(a(v)){for(_=s(e.length);_>E;E++)if((g=t?m(o(h=e[E])[0],h[1]):m(e[E]))===l||g===d)return g}else for(p=v.call(e);!(h=p.next()).done;)if((g=i(p,m,h.value,t))===l||g===d)return g};t.BREAK=l,t.RETURN=d},function(e,t){e.exports=!0},function(e,t,n){var r=n(19),i=n(115),a=n(71),o=n(77)("IE_PROTO"),s=function(){},u=function(){var e,t=n(70)("iframe"),r=a.length;for(t.style.display="none",n(108).appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write("<script>document.F=Object</script>"),e.close(),u=e.F;r--;)delete u.prototype[a[r]];return u()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[o]=e):n=u(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(79),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,[{key:"isEqual",value:function(e){return!0}},{key:"viewToString",value:function(){return""}},{key:"toArrayBuffer",value:function(){return new ArrayBuffer(0)}},{key:"isInTrack",value:function(e){return!1}},{key:"getId",value:function(){return 0}}],[{key:"fromArrayBuffer",value:function(t){return new e}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(38),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(158),c=r(d),f=n(235),_=r(f),h=function(){function e(t,n){(0,s.default)(this,e),this._sharedState=t,this._namespace=n}return(0,l.default)(e,[{key:"send",value:function(e,t){var n=this._sharedState,r=n.conf,i=n.moduleState,o=n.peerToken,s=r.ANALYTICS.KLARA_URL;e.customer=r.ID_CLIENT,e.content=i.content,e.peerAgentVersion="4.10.7",e.token=o,e.platform=_.default.get();var u=(0,a.default)(e),l=""+s+this._namespace;t&&(l+="/"+t),c.default.send(l,u,this._sharedState)}}]),e}();t.default=h,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u="Method not implemented",l=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,[{key:"getUpdatedRange",value:function(e){throw new Error(u)}},{key:"getFullSegment",value:function(e,t,n){throw new Error(u)}},{key:"isComplete",value:function(){throw new Error(u)}},{key:"isLocked",value:function(){throw new Error(u)}},{key:"p2pSpeed",get:function(){throw new Error(u)}},{key:"p2pAmount",get:function(){throw new Error(u)}}]),e}();t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(e){if(null===e)throw new Error("Panic! Attempted to unwrap null");if(void 0===e)throw new Error("Panic! Attempted to unwrap undefined");return e}Object.defineProperty(t,"__esModule",{value:!0}),t.unwrap=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(t){(0,a.default)(this,e),this._expirationThreshold=t,this._values=[]}return(0,s.default)(e,[{key:"push",value:function(e){this._cleanExpiredValues(),this._values.push({time:Date.now(),value:e})}},{key:"_cleanExpiredValues",value:function(){for(var e=Date.now();this._values.length>0&&e-this._expirationThreshold>=this._values[0].time;)this._values.shift()}},{key:"subDelta",value:function(e){if(this._cleanExpiredValues(),e>this._expirationThreshold)return null;for(var t=Date.now()-e,n=0;n<this._values.length&&this._values[n].time<=t;)n++;return n<this._values.length-1?this._values[this._values.length-1].value-this._values[n].value:null}},{key:"subTimeDelta",value:function(e){if(this._cleanExpiredValues(),e>this._expirationThreshold)return null;for(var t=Date.now()-e,n=0;n<this._values.length&&this._values[n].time<=t;)n++;return n<this._values.length-1?this._values[this._values.length-1].time-this._values[n].time:null}},{key:"delta",get:function(){return this._cleanExpiredValues(),this._values.length>1?this._values[this._values.length-1].value-this._values[0].value:null}},{key:"timeDelta",get:function(){return this._cleanExpiredValues(),this._values.length>1?this._values[this._values.length-1].time-this._values[0].time:null}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(17),l=function(){function e(){(0,a.default)(this,e);var t=Date.now();this._metricSum=0,this._latestValue=0,this._integralTimestampDelta=new u.Delta(t),this._getterTimestampDelta=new u.Delta(t)}return(0,s.default)(e,[{key:"getAverage",value:function(){var e=this.getIntegral();return e.intervalLength?e.value/e.intervalLength:e.value}},{key:"getIntegral",value:function(){var e=Date.now(),t=this._integralTimestampDelta.calcDelta(e),n=this._getterTimestampDelta.calcDelta(e);this._metricSum+=this._latestValue*t;var r=this._metricSum;return this._metricSum=0,{value:r,intervalLength:n}}},{key:"updateMetric",value:function(e){var t=Date.now(),n=this._integralTimestampDelta.calcDelta(t);this._metricSum+=this._latestValue*n,this._latestValue=e}}]),e}();t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=n(239),a=r(i),o=n(8),s=r(o);t.default=function(){function e(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=(0,s.default)(e);!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if((0,a.default)(Object(t)))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(13),i=n(12).document,a=r(i)&&r(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(41);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){"use strict";var r=n(56),i=n(6),a=n(120),o=n(23),s=n(27),u=n(32),l=n(290),d=n(45),c=n(118),f=n(11)("iterator"),_=!([].keys&&"next"in[].keys()),h=function(){return this};e.exports=function(e,t,n,p,g,v,m){l(n,t,p);var E,y,T,S=function(e){if(!_&&e in I)return I[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},C=t+" Iterator",A="values"==g,D=!1,I=e.prototype,R=I[f]||I["@@iterator"]||g&&I[g],O=R||S(g),P=g?A?S("entries"):O:void 0,b="Array"==t?I.entries||R:R;if(b&&(T=c(b.call(new e)))!==Object.prototype&&(d(T,C,!0),r||s(T,f)||o(T,f,h)),A&&R&&"values"!==R.name&&(D=!0,O=function(){return R.call(this)}),r&&!m||!_&&!D&&I[f]||o(I,f,O),u[t]=O,u[C]=h,g)if(E={values:A?O:S("values"),keys:v?O:S("keys"),entries:P},m)for(y in E)y in I||a(I,y,E[y]);else i(i.P+i.F*(_||D),t,E);return E}},function(e,t,n){var r=n(43),i=n(44),a=n(20),o=n(80),s=n(27),u=n(109),l=Object.getOwnPropertyDescriptor;t.f=n(14)?l:function(e,t){if(e=a(e),t=o(t,!0),u)try{return l(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(23);e.exports=function(e,t,n){for(var i in t)n&&e[i]?e[i]=t[i]:r(e,i,t[i]);return e}},function(e,t,n){var r=n(78)("keys"),i=n(59);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t,n){var r=n(12),i=r["__core-js_shared__"]||(r["__core-js_shared__"]={});e.exports=function(e){return i[e]||(i[e]={})}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(13);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(12),i=n(3),a=n(56),o=n(82),s=n(15).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=a?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:o.f(e)})}},function(e,t,n){t.f=n(11)},function(e,t,n){var r=n(53),i=n(11)("iterator"),a=n(32);e.exports=n(3).getIteratorMethod=function(e){if(void 0!=e)return e[i]||e["@@iterator"]||a[r(e)]}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function r(){var e=s.default.getUAObject();if(!e.ua)return!1;var t=e.browser;return"Edge"===t.name||"Safari"===t.name||"Mobile Safari"===t.name}function i(){return!!(window.RTCPeerConnection||window.webkitPeerConnection00||window.webkitRTCPeerConnection)}function a(e){return!(!(i()&&e.ALLOW_P2P&&e.CONTENT_ACTIVATED)||r())&&(!s.default.isMobile()||e.ENABLE_MOBILE_BROWSER)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(36),s=function(e){return e&&e.__esModule?e:{default:e}}(o);t.default={isP2PAvailable:i,isP2PEnabled:a},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(101),a=r(i),o=n(49),s=r(o),u={BACKEND_USE_SSL:!0,TRACKER_URL:"",SIGNALING_URL:"",FALLBACK_URLS:{KLARA_URL:"https://klara.streamroot.io"},DISTRIBUTOR:{URL:"https://distributor.streamroot.io",OVERRIDDEN:!1,TIMEOUT_DELAY:1e4,MAX_RETRY:1},SIGNALING_DELAY_STEP:1e4,SIGNALING_DELAY_MAX:3e5,SIGNALING_DELAY_MAX_INITIAL:3e4,TRACKER_DELAY_MAX:3e5,TRACKER_DELAY_INIT:2e3,MAX_NUMBER_OF_PEERS_ASKED_BY_GET_PEERS_MESSAGE:10,ASK_PEERS_INTERVAL:6e4,ASK_PEERS_AFTER_TRACK_SWITCH_INTERVAL:1e4,SEND_TRACKS_INTERVAL:6e4,GEOLOCATION_REQUEST_TIMEOUT:3e3,GEOLOCATION_REQUEST_MAX_RETRY:1,CONF_LABEL:"default",ANALYTICS:{KLARA_URL:"",EXPOSE_CONF_LABEL:!1,RETRY_NUMBER:3,RETRY_DELAY:1e4,TIMEOUT_DELAY:3e3,TRAFFIC_INTERVAL_ARRAY:function(e){for(var t=e.from,n=e.to,r=e.step,i=[],a=t;a<n;a+=r)i.push(a);return i.push(n),i}({from:5e3,to:12e4,step:1e4}),STATS_INTERVAL:12e4,CONTROL_INTERVAL:6e5},QOS_REF_PERCENTAGE:0,QOS_P2P_DISABLED:!1,ERRORS:{API_KEY:"d04c6fa616c255ac55dec6b068ad7172",HANDLER:"xhr",STAGES:["staging","qa","production"]},PEER_CONNECTION_TIMEOUT:5e4,ICECANDIDATES_TIMEOUT:15e3,SEND_HEARTBEAT_INTERVAL:5e3,CHECK_HEARTBEAT_INTERVAL:1e4,DATACHANNEL_TYPE:"limited-retransmits",DATACHANNEL_MAX_PACKET_LIFETIME:1e3,DATACHANNEL_MAX_RETRANSMITS:1,ENABLE_STUN:!0,ENABLE_TURN:!1,TRANSFORM_SDP:!0,STUNSERVERS:["stun.l.google.com:19302"],TURNSERVERS:[{urls:"turn:23.97.160.254:3478?transport=udp",credential:"streamroot",username:"streamroot"}],CLIENT_TRACKER_PROTOCOL_VERSION:"3.0.0",P2P_PROTOCOL_VERSION:"3.3.1",CHUNK_SIZE:15360,ALLOW_LIVE_PUSH_SEGMENT:!0,ALLOW_VOD_PUSH_SEGMENT:!0,USE_VOD_PUSH_PATCH:!0,MIN_CHUNK_PERCENTAGE_DOWNLOADED_FOR_HAS_SEGMENT_ANSWER:80,P2P_CACHE_MAX_SIZE:136314880,MAX_DISTRIBUTED_SEGMENT_LIST_LENGTH:300,GETSEGMENTTIME_CACHE_MAX_SIZE:1e3,NB_SEGMENT_P2P_PREBUFFER:10,MAX_BUFFER_DURATION:300,CHUNK_BATCHING_INTERVAL:1e3,CHUNK_TIMEOUT:2500,CHUNK_GRACE_DURATION:1e4,UP_BUFFERED_AMOUNT_LOW_THRESHOLD:15e3,UP_MAX_BUFFERED_AMOUNT:6e4,CHUNK_UP_TIMEOUT:1900,SPLIT_UPLOAD_QUEUE:!1,ENABLE_UPLOAD_DEQUEUE_ALL:!1,LIVE:{LOWER_BUFFER_TARGET:15,HIGHER_BUFFER_TARGET:30,BUFFER_LEVEL_UPLOAD_SPEED_EMWA_WEIGHT:.1,UPLOAD_THRESHOLD_MAX_BUFFER_TARGET_LOCKING:6e3,P2P_CACHE_MAX_SIZE:62914560,CHUNK_TIMEOUT:2e3,CHUNK_UP_TIMEOUT:1400,QOS_REF_PERCENTAGE:0,NEAR_EDGE_MARGIN:12e4,LOW_TARGET_P2P_DL_BLOCK_DURATION:2e4,ENABLE_DYNAMIC_LOWER_TARGET:!1,CRITICAL_LOWER_TARGET_RATIO:.5,FAST_BUFFER_FILL_FRACTION:.5,LOWER_BUFFER_TARGET_DECREASE_STEP:.2,LOWER_BUFFER_TARGET_INCREASE_STEP:.3},BUFFER_CHECK_INTERVAL:100,BUFFER_ZERO_THRESHOLD:2,VOD_CRITICAL_BUFFER_THRESHOLD:-1,VOD_CRITICAL_BUFFER_P2P_STOP_DURATION:1e4,VOD_SAFE_BUFFER_THRESHOLD:20,SPEED_MONITOR_INTERVAL:1e3,MEAN_SPEED_CALCULATION_INTERVAL:500,PEER_UPLOAD_SPEED_EMA_HALF_LIFE:1e4,PEER_DOWNLOAD_SPEED_EMA_HALF_LIFE:15e3,PEER_SPEED_MONITOR_INTERVAL:1e3,PEER_TIMEOUT_RATIO_WINDOW:3e4,PEER_UPLOAD_CAPACITY_SAFE_RATIO:.8,PEER_UPLOAD_CAPACITY_EXTRA_RATIO:.1,PEER_UPLOAD_CAPACITY_COMPUTATION_INTERVAL:1e3,DEFAULT_PEER_UPLOAD_CAPACITY:1e3,MIN_PEER_UPLOAD_CAPACITY:200,MAX_PEER_UPLOAD_CAPACITY_TIMEOUT_RATIO:.1,PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_UP:.3,PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_DOWN:.5,PUC_EMWA_WEIGHT_USE_TIMEOUT_RATIO:!1,PUC_EMWA_WEIGHT_CAP:.9,PEER_INIT_LOCKED_DURATION:1e4,PEER_LOCKED_UPLOAD_THRESHOLD:.05,PEER_LOCKED_DOWNLOAD_THRESHOLD:.1,POST_TRACK_SWITCH_PEER_LOCK_SENSITIVITY_ON:!1,POST_TRACK_SWITCH_PEER_SPEED_SENSITIVITY_DURATION:5e3,PEER_UPLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE:2e3,PEER_DOWNLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE:3e3,PEER_CRITICAL_CHUNK_TIMEOUT_THRESHOLD:.6,LOOSER_UPLOAD_THRESHOLD:50,PEER_POOL_LIMIT:16,PEER_POOL_MAINTENANCE_INTERVAL:1e3,EXPECTED_CONNECTION_SUCCESS_RATE:.4,RESERVED_OFFER_SLOTS:3,CANDIDATE_PEERS_TRY_DEQUEUE_INTERVAL:1e3,MAX_TRACKER_EXCLUSION_LENGTH:100,PEER_DISCONNECTED_EXCLUSION_DURATION:6e4,PEER_DISCONNECTED_EXCLUSION_RANK:1,OFFER_DECLINED_EXCLUSION_DURATION:6e4,OFFER_DECLINED_EXCLUSION_RANK:1,PEER_REMOVED_EXCLUSION_DURATION:9e5,PEER_REMOVED_EXCLUSION_RANK:1,PEER_CONNECTION_ATTEMPT_TIMED_OUT_EXCLUSION_DURATION:9e5,PEER_CONNECTION_ATTEMPT_EXCLUSION_RANK:1,CDN_SPEED_ESTIMATE_CONSIDER_P2P:!0,CDN_CONCURRENT_SCALING_CAP:1.5,P2P_SPEED_ZERO_THRESHOLD:50,P2P_SPEED_ESTIMATION_BUCKET_DURATION:100,P2P_SPEED_ESTIMATION_BUCKET_COUNT:10,P2P_SPEED_EMA_WEIGHT:.5,P2P_SPEED_EMA_ZERO_HALF_LIFE:12e4,P2P_USEFUL_CALCULATION_INTERVAL:5e3,P2P_USEFUL_SMA_WINDOW:12e4,P2P_DL_THRESHOLD_FOR_USEFUL_CORRECTION:50,P2P_USEFUL_RATIO_WEIGHT:.8,ABR_SEGMENT_CDN_RATIO_THRESHOLD:.3,ABR_CDN_SPEED_UPDATE_RATIO_THRESHOLD:.3,ABR_CDN_DL_THRESHOLD:100,ABR_CDN_DL_DECAY_TIME:6e4,USE_COMBINED_ABR_FEEDBACK:!0,BITRATE_ESTIMATION_WINDOW:3e4,ENABLE_PREBUFFER_FEEDBACK:!1,BLOCK_SEEDER_SCHEDULING_WINDOW:6e4,BLOCK_SEEDER_SCHEDULING_DURATION:12e4,BLOCK_SEEDER_SCHEDULING_TIMEOUT_THRESHOLD:1.1,BLOCK_SEEDER_SCHEDULING_REQUEST_THRESHOLD:50,PEER_COMPUTE_RTT_INTERVAL:5e3,USE_CONTINOUS_PROGRESS_FEEDBACK:!1,PROGRESS_ADD_TOTAL:!1,ENABLE_LATENCY_FEEDBACK:!1,LATENCY_CAPPING_RATIO:.5,MAX_PEER_CONNECTION_FAILURES:a.default,SEGMENT_REQUEST_TIMEOUT_TO_STOP_ASKING_PEERS:null,TRANSFER_ACTIVITY_TIMEOUT_TO_DISCONNECT_FROM_BACKEND:null,LOCKED_RETRY_INTERVAL:30,LOCKED_RETRY_TIMEOUT:500,TIMEOUT_GET_FULL_SEGMENT:500,RETURN_COPY_SEGMENT:!0,ENABLE_FIX_UNRELIABLE_SEGMENT_TIME:!1,ALLOW_P2P:!0,RANGE_REQUEST_ALLOWED:!0,DEVICE_INFO:"",ID_CLIENT:"",ENABLE_MOBILE_BROWSER:!1,CONTENT_ACTIVATED:!0,DEBUG:!1};s.default.deepFreeze(u),t.default=u,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(e){return e&&e.__esModule?e:{default:e}}(r),a=function e(t){(0,i.default)(this,e),this.message=t.error.message,this.stacktrace=t.error.stack,this.fileName=t.filename,this.lineNumber=t.lineno,this.columnNumber=t.colno?t.colno:void 0};t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(t,n,r){(0,a.default)(this,e),this._segmentCoord=t,this._chunkIndex=n,this._bandwidthSafety=r,
this._timestamp=Date.now()}return(0,s.default)(e,[{key:"segmentCoord",get:function(){return this._segmentCoord}},{key:"chunkIndex",get:function(){return this._chunkIndex}},{key:"bandwidthSafety",get:function(){return this._bandwidthSafety}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";e.exports=n(192)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={IDLE:"IDLE",NO_PEER:"NO_PEER",RANDOM:"RANDOM",DYNAMIC:"DYNAMIC",TOP_SEEDER:"TOP_SEEDER"};t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(37),a=r(i),o=n(16),s=r(o),u=n(8),l=r(u),d=n(0),c=r(d),f=n(1),_=r(f),h=n(220),p=r(h),g=n(180),v=r(g),m=n(2),E=r(m),y=n(5),T=r(y),S=function(){function e(t,n,r,i){(0,c.default)(this,e),this._reachedLiveEdge=!1,this._sharedState=i,this._currentTracks=i.moduleState.currentTracks,this._p2pCache=n,this._distributedSegmentList=r,this._mediaMapCache=new v.default(t,i),this._edges=new p.default(this._mediaMapCache,i)}return(0,_.default)(e,[{key:"_getSegmentsToDownloadByTrack",value:function(e,t){var n=[],r=void 0;if(r="audio"===t?this._edges.audio:this._edges.video){var i=this._mediaMapCache.getSegmentListAfterEdge(e,r,this._sharedState.conf.MAX_BUFFER_DURATION),a=this._distributedSegmentList.getSegmentListAfter(r),o=this._mergeDedupe(i,a),s=this._p2pCache.listSegmentsToSkipForTrack(e);if("video"===t){var u=this._sharedState.conf.ENABLE_PREBUFFER_FEEDBACK||this._sharedState.conf.ENABLE_FIX_UNRELIABLE_SEGMENT_TIME?!i.length:i.length<=1;u!==this._reachedLiveEdge&&(this._reachedLiveEdge=u,this._sharedState.eventBus.emit(E.default.Scheduler.REACHED_LIVE_EDGE_STATE_CHANGED,u))}n=this._getDifference(o,s),this._sharedState.conf.ENABLE_PREBUFFER_FEEDBACK&&this._checkNextSegmentPrebuffered(t,o,n);var l=this._mediaMapCache.getSegmentTime(r);if(null===l)T.default.notifyError(new Error("Unexpected getSegmentTime error: track edge timestamp is not supposed to be unreliable"));else if(this._sharedState.moduleState.isLive()&&n.length>0){var d=o[0],c=this._mediaMapCache.getSegmentTime(d);if(null!==c){var f=l-c;this._sharedState.moduleState.isNearEdge=f<=this._sharedState.conf.LIVE.NEAR_EDGE_MARGIN}else this._sharedState.moduleState.isNearEdge=!0}}return n}},{key:"_checkNextSegmentPrebuffered",value:function(e,t,n){this._sharedState.moduleState.nextSegmentPrebuffered[e]=t.length>=2&&(!n.length||!t[0].isEqual(n[0])&&!t[1].isEqual(n[0]))}},{key:"isSegmentRequested",value:function(e){var t=this.getSegmentListToDownload(),n=!0,r=!1,i=void 0;try{for(var a,o=(0,l.default)(t);!(n=(a=o.next()).done);n=!0){var s=a.value;if(e.isEqual(s))return!0}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}return!1}},{key:"_getDifference",value:function(e,t){return e.filter(function(e){return void 0===t.find(function(t){return e.isEqual(t)})})}},{key:"_mergeDedupe",value:function(e,t){var n=new s.default,r=!0,i=!1,o=void 0;try{for(var u,d=(0,l.default)(e);!(r=(u=d.next()).done);r=!0){var c=u.value;n.set(c.viewToString(),c)}}catch(e){i=!0,o=e}finally{try{!r&&d.return&&d.return()}finally{if(i)throw o}}var f=!0,_=!1,h=void 0;try{for(var p,g=(0,l.default)(t);!(f=(p=g.next()).done);f=!0){var v=p.value;n.set(v.viewToString(),v)}}catch(e){_=!0,h=e}finally{try{!f&&g.return&&g.return()}finally{if(_)throw h}}return(0,a.default)(n.values())}},{key:"getSegmentListToDownload",value:function(){throw new Error("Cannot call abstract method")}},{key:"updateTrackEdge",value:function(e){throw new Error("Cannot call abstract method")}},{key:"getEdgeSegment",value:function(){return this._edges.video}}]),e}();t.default=S,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={PeerStats:{SAMPLED_PUC:"sampledPUC"}},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e),this._providers={}}return(0,s.default)(e,[{key:"registerProvider",value:function(e,t){this._providers[e]=t}},{key:"getStat",value:function(e){var t=this._providers[e];if(t)return t()}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(51),a=r(i),o=n(0),s=r(o),u=n(17),l=n(61),d=r(l),c=n(46),f=function e(t,n,r){if((0,s.default)(this,e),(0,c.checkInterface)(d.default,t),!(0,u.isNumeric)(n))throw new Error("Invalid value for size");if(!r)throw new Error("No hash");this.segmentCoord=t,this.size=n,this.hash=r,(0,a.default)(this)};t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.BitDataAmount=t.ByteDataAmount=t.DataAmount=t.numToUint8Array4=t.uint16ToUint8Array2=void 0;var i=n(7),a=r(i),o=n(10),s=r(o),u=n(9),l=r(u),d=n(0),c=r(d),f=n(1),_=r(f),h=function(e){var t=Math.floor(e/256),n=e%256;return new Uint8Array([n,t])},p=function(e){var t=h(Math.floor(e/65536)),n=h(e%65536);return new Uint8Array([n[0],n[1],t[0],t[1]])},g=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2;(0,c.default)(this,e),this._rawValue=t,this._unit=n,this._k=r,this._suffix=i,this._decimals=a}return(0,_.default)(e,[{key:"_format",value:function(){if(this._rawValue<1)return"0";var e=["","K","M","G","T","P","E","Z","Y"],t=Math.min(Math.floor(Math.log(this._rawValue)/Math.log(this._k)),e.length-1);return parseFloat((this._rawValue/Math.pow(this._k,t)).toFixed(this._decimals))+e[t]}},{key:"valueOf",value:function(){return this._rawValue}},{key:"toString",value:function(){return this._format()+this._unit+this._suffix}}]),e}(),v=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return(0,c.default)(this,t),(0,s.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,"B",1e3,n,r))}return(0,l.default)(t,e),t}(g),m=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return(0,c.default)(this,t),(0,s.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,"b",1e3,n,r))}return(0,l.default)(t,e),t}(g);t.uint16ToUint8Array2=h,t.numToUint8Array4=p,t.DataAmount=g,t.ByteDataAmount=v,t.BitDataAmount=m},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(t){(0,a.default)(this,e),this._internalQueue=t}return(0,s.default)(e,[{key:"_canDequeue",value:function(){return!0}},{key:"_dequeuedCallback",value:function(e){}},{key:"_emptyCallback",value:function(){}},{key:"_validateItem",value:function(e){return!0}},{key:"push",value:function(e){this._internalQueue.push(e),this.tryDequeue()}},{key:"_skipInvalidItems",value:function(){for(var e=this._internalQueue.shift();void 0!==e&&!this._validateItem(e);)e=this._internalQueue.shift();return e}},{key:"tryDequeue",value:function(){if(this._canDequeue()){var e=this._skipInvalidItems();e?this._dequeuedCallback(e):this._emptyCallback()}}},{key:"tryDequeueN",value:function(e){for(;this._canDequeue()&&e>0;){var t=this._skipInvalidItems();if(!t){this._emptyCallback();break}this._dequeuedCallback(t),e--}}},{key:"tryDequeueAll",value:function(){for(;this._canDequeue();){var e=this._skipInvalidItems();if(!e){this._emptyCallback();break}this._dequeuedCallback(e)}}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){if(0===e.length)return null;e.sort(function(e,t){return e-t});var t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])/2}function i(e){if(0===e.length)return null;for(var t=0,n=0;n<e.length;n++)t+=e[n];return t/e.length}function a(e){var t=i(e);if(!t)return null;for(var n=0,r=0;r<e.length;r++)n+=Math.abs(e[r]-t);return n/e.length}Object.defineProperty(t,"__esModule",{value:!0}),t.default={median:r,mean:i,meanAbsoluteDeviation:a},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(t){(0,a.default)(this,e),this._maxSize=t,this._internalQueue=[]}return(0,s.default)(e,[{key:"addSample",value:function(e){this._internalQueue.length>=this._maxSize&&this._internalQueue.shift(),this._internalQueue.push(e)}},{key:"fetchSample",value:function(){if(this._internalQueue.length>0){var e=Math.floor(Math.random()*this._internalQueue.length);return this._internalQueue.splice(e,1)[0]}}},{key:"mean",get:function(){return this.length>0?this._internalQueue.reduce(function(e,t){return e+t})/this.length:0}},{key:"length",get:function(){return this._internalQueue.length}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),a=r(i),o=n(37),s=r(o),u=n(36),l=r(u),d=window.RTCPeerConnection||window.webkitRTCPeerConnection,c=window.RTCIceCandidate,f=window.RTCSessionDescription,_=function(e){return e=e.replace(/b=AS([^\r\n]+\r\n)/g,""),e=e.replace(/a=mid:audio\r\n/g,"a=mid:audio\r\nb=AS:50\r\n"),e=e.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:256\r\n"),e=e.replace(/a=mid:data\r\n/g,"a=mid:data\r\nb=AS:1638400\r\n")},h=function(e){return new d(p(e),{optional:[{DtlsSrtpKeyAgreement:!0}]})},p=function(e){var t=e.ENABLE_STUN,n=e.ENABLE_TURN;if(!t&&!n)return{};var r=t?[{urls:e.STUNSERVERS.map(function(e){return"stun:"+e})}]:[];return{iceServers:n?e.TURNSERVERS.concat(r):r}},g=function(e,t){var n=l.default.getUAObject().browser;"Chrome"===n.name||"Chromium"===n.name?e.getStats(function(e){var n=[];e.result().forEach(function(e){var t={};e.names().forEach(function(n){t[n]=e.stat(n)}),t.id=e.id,t.type=e.type,t.timestamp=e.timestamp,n.push(t)}),t(n)}):e.getStats(null,function(e){t((0,s.default)(e.values()))},function(){})},v=function(e,t){g(e,function(e){var n=!0,r=!1,i=void 0;try{for(var o,s=(0,a.default)(e);!(n=(o=s.next()).done);n=!0){var u=o.value;if(u.mozRtt)return void t(u.mozRtt);if(u.googRtt)return void t(parseFloat(u.googRtt))}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}})};t.default={transformOutgoingSdp:_,createPeerConnection:h,getPeerConnectionRTT:v,IceCandidate:c,SessionDescription:f,getStats:g},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.TIMER_TYPE=t.AbstractTimer=void 0;var i=n(0),a=r(i),o=n(1),s=r(o),u=n(124),l=r(u),d={TIMEOUT:0,INTERVAL:1},c=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d.TIMEOUT;(0,a.default)(this,e),this._id="timer-"+l.default.v4(),this._name=this._id,this._callback=t,this._time=n,this._type=r,this._isRepeatable=r===d.INTERVAL}return(0,s.default)(e,[{key:"clear",value:function(){throw new Error("Cannot call abstract method")}},{key:"id",get:function(){return this._id}},{key:"name",set:function(e){this._name=e},get:function(){return this._name}}]),e}();t.AbstractTimer=c,t.TIMER_TYPE=d},function(e,t,n){e.exports={default:n(260),__esModule:!0}},function(e,t,n){e.exports={default:n(268),__esModule:!0}},function(e,t,n){e.exports={default:n(273),__esModule:!0}},function(e,t,n){e.exports={default:n(276),__esModule:!0}},function(e,t,n){"use strict";var r=n(15).f,i=n(57),a=n(76),o=n(22),s=n(69),u=n(54),l=n(55),d=n(73),c=n(114),f=n(121),_=n(14),h=n(42).fastKey,p=_?"_s":"size",g=function(e,t){var n,r=h(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,d){var c=e(function(e,r){s(e,c,t,"_i"),e._i=i(null),e._f=void 0,e._l=void 0,e[p]=0,void 0!=r&&l(r,n,e[d],e)});return a(c.prototype,{clear:function(){for(var e=this,t=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete t[n.i];e._f=e._l=void 0,e[p]=0},delete:function(e){var t=this,n=g(t,e);if(n){var r=n.n,i=n.p;delete t._i[n.i],n.r=!0,i&&(i.n=r),r&&(r.p=i),t._f==n&&(t._f=r),t._l==n&&(t._l=i),t[p]--}return!!n},forEach:function(e){s(this,c,"forEach");for(var t,n=o(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.n:this._f;)for(n(t.v,t.k,this);t&&t.r;)t=t.p},has:function(e){return!!g(this,e)}}),_&&r(c.prototype,"size",{get:function(){return u(this[p])}}),c},def:function(e,t,n){var r,i,a=g(e,t);return a?a.v=n:(e._l=a={i:i=h(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=a),r&&(r.n=a),e[p]++,"F"!==i&&(e._i[i]=a)),e},getEntry:g,setStrong:function(e,t,n){d(e,t,function(e,t){this._t=e,this._k=t,this._l=void 0},function(){for(var e=this,t=e._k,n=e._l;n&&n.r;)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?"keys"==t?c(0,n.k):"values"==t?c(0,n.v):c(0,[n.k,n.v]):(e._t=void 0,c(1))},n?"entries":"values",!n,!0),f(t)}}},function(e,t,n){var r=n(53),i=n(281);e.exports=function(e){return function(){if(r(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},function(e,t,n){"use strict";var r=n(12),i=n(6),a=n(42),o=n(26),s=n(23),u=n(76),l=n(55),d=n(69),c=n(13),f=n(45),_=n(15).f,h=n(283)(0),p=n(14);e.exports=function(e,t,n,g,v,m){var E=r[e],y=E,T=v?"set":"add",S=y&&y.prototype,C={};return p&&"function"==typeof y&&(m||S.forEach&&!o(function(){(new y).entries().next()}))?(y=t(function(t,n){d(t,y,e,"_c"),t._c=new E,void 0!=n&&l(n,v,t[T],t)}),h("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in S&&(!m||"clear"!=e)&&s(y.prototype,e,function(n,r){if(d(this,y,e),!t&&m&&!c(n))return"get"==e&&void 0;var i=this._c[e](0===n?0:n,r);return t?this:i})}),"size"in S&&_(y.prototype,"size",{get:function(){return this._c.size}})):(y=g.getConstructor(t,e,v,T),u(y.prototype,n),a.NEED=!0),f(y,e),C[e]=y,i(i.G+i.W+i.F,C),m||g.setStrong(y,e,v),y}},function(e,t,n){e.exports=n(12).document&&document.documentElement},function(e,t,n){e.exports=!n(14)&&!n(26)(function(){return 7!=Object.defineProperty(n(70)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(32),i=n(11)("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||a[i]===e)}},function(e,t,n){var r=n(41);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(19);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var a=e.return;throw void 0!==a&&r(a.call(e)),t}}},function(e,t,n){var r=n(11)("iterator"),i=!1;try{var a=[7][r]();a.return=function(){i=!0},Array.from(a,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var a=[7],o=a[r]();o.next=function(){return{done:n=!0}},a[r]=function(){return o},e(a)}catch(e){}return n}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){var r=n(15),i=n(19),a=n(28);e.exports=n(14)?Object.defineProperties:function(e,t){i(e);for(var n,o=a(t),s=o.length,u=0;s>u;)r.f(e,n=o[u++],t[n]);return e}},function(e,t,n){var r=n(20),i=n(117).f,a={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(e){try{return i(e)}catch(e){return o.slice()}};e.exports.f=function(e){return o&&"[object Window]"==a.call(e)?s(e):i(r(e))}},function(e,t,n){var r=n(119),i=n(71).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(27),i=n(33),a=n(77)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},function(e,t,n){var r=n(27),i=n(20),a=n(282)(!1),o=n(77)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),u=0,l=[];for(n in s)n!=o&&r(s,n)&&l.push(n);for(;t.length>u;)r(s,n=t[u++])&&(~a(l,n)||l.push(n));return l}},function(e,t,n){e.exports=n(23)},function(e,t,n){"use strict";var r=n(12),i=n(3),a=n(15),o=n(14),s=n(11)("species");e.exports=function(e){var t="function"==typeof i[e]?i[e]:r[e];o&&t&&!t[s]&&a.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){var r,i,a,o=n(22),s=n(288),u=n(108),l=n(70),d=n(12),c=d.process,f=d.setImmediate,_=d.clearImmediate,h=d.MessageChannel,p=0,g={},v=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},m=function(e){v.call(e.data)};f&&_||(f=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return g[++p]=function(){s("function"==typeof e?e:Function(e),t)},r(p),p},_=function(e){delete g[e]},"process"==n(41)(c)?r=function(e){c.nextTick(o(v,e,1))}:h?(i=new h,a=i.port2,i.port1.onmessage=m,r=o(a.postMessage,a,1)):d.addEventListener&&"function"==typeof postMessage&&!d.importScripts?(r=function(e){d.postMessage(e+"","*")},d.addEventListener("message",m,!1)):r="onreadystatechange"in l("script")?function(e){u.appendChild(l("script")).onreadystatechange=function(){u.removeChild(this),v.call(e)}}:function(e){setTimeout(o(v,e,1),0)}),e.exports={set:f,clear:_}},function(e,t,n){var r,r;!function(t){e.exports=t()}(function(){return function e(t,n,i){function a(s,u){if(!n[s]){if(!t[s]){var l="function"==typeof r&&r;if(!u&&l)return r(s,!0);if(o)return o(s,!0);var d=new Error("Cannot find module '"+s+"'");throw d.code="MODULE_NOT_FOUND",d}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return a(n||e)},c,c.exports,e,t,n,i)}return n[s].exports}for(var o="function"==typeof r&&r,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=e("babel-runtime/helpers/classCallCheck"),a=r(i),o=e("babel-runtime/helpers/createClass"),s=r(o);n.default=function(e,t){return new u(e,t)};var u=function(){function e(t,n){(0,a.default)(this,e),this._callback=t,this._time=n,this._timer=this._createTimer()}return(0,s.default)(e,[{key:"_createTimer",value:function(){return setInterval(this._callback,this._time)}},{key:"clear",value:function(){clearInterval(this._timer)}}]),e}();t.exports=n.default},{"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r={IDLE:"IDLE",PLAYING:"PLAYING",SEEKING:"SEEKING",BUFFERING:"BUFFERING",PAUSED:"PAUSED",ENDED:"ENDED"};n.default=r,t.exports=n.default},{}],3:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=e("babel-runtime/helpers/classCallCheck"),a=r(i),o=e("babel-runtime/helpers/createClass"),s=r(o),u=e("./PlaybackState"),l=r(u),d=function(){function e(){(0,a.default)(this,e),this._stateChangedCallbacks=[],this.gotoIdle()}return(0,s.default)(e,[{key:"_setState",value:function(e){var t=this;this._state!==e&&(this._prevState=this._state,this._state=e,this._stateChangedCallbacks.forEach(function(e){e(t._state,t._prevState)}))}},{key:"gotoIdle",value:function(){this._setState(l.default.IDLE)}},{key:"gotoPlaying",value:function(){this._setState(l.default.PLAYING)}},{key:"gotoSeeking",value:function(){this._setState(l.default.SEEKING)}},{key:"gotoBuffering",value:function(){this._setState(l.default.BUFFERING)}},{key:"gotoPaused",value:function(){this._setState(l.default.PAUSED)}},{key:"gotoEnded",value:function(){this._setState(l.default.ENDED)}},{key:"getState",value:function(){return this._state}},{key:"addObserver",value:function(e){this._stateChangedCallbacks.indexOf(e)<0&&this._stateChangedCallbacks.push(e)}},{key:"removeObserver",value:function(e){var t=this._stateChangedCallbacks.indexOf(e);t>-1&&this._stateChangedCallbacks.splice(t,1)}},{key:"isIdle",value:function(){return this._state===l.default.IDLE}},{key:"isPlaying",value:function(){return this._state===l.default.PLAYING}},{key:"isSeeking",value:function(){return this._state===l.default.SEEKING}},{key:"isBuffering",value:function(){return this._state===l.default.BUFFERING}},{key:"isPaused",value:function(){return this._state===l.default.PAUSED}},{key:"isEnded",value:function(){return this._state===l.default.ENDED}}]),e}();n.default=d,t.exports=n.default},{"./PlaybackState":2,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12}],4:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=e("babel-runtime/helpers/classCallCheck"),a=r(i),o=e("babel-runtime/helpers/createClass"),s=r(o),u=function(){function e(t,n,r){(0,a.default)(this,e),this._createInterval=r,this._video=t,this._stateMachine=n,this._previousPlaybackTime=0,this.resume()}return(0,s.default)(e,[{key:"dispose",value:function(){this.pause()}},{key:"pause",value:function(){this._tickInterval.clear()}},{key:"resume",value:function(){this._tickInterval=this._createInterval(this._tickHandler.bind(this),100)}},{key:"_tickHandler",value:function(){var e=this._video.duration-this._video.currentTime,t=Math.abs(this._video.currentTime-this._previousPlaybackTime);isNaN(t)?this._stateMachine.gotoIdle():this._video.seeking?this._stateMachine.gotoSeeking():this._video.paused?this._stateMachine.isIdle()||(!isNaN(e)&&e<.3?this._stateMachine.gotoEnded():this._stateMachine.gotoPaused()):t>0?this._stateMachine.gotoPlaying():this._stateMachine.isIdle()||this._stateMachine.isSeeking()||this._stateMachine.gotoBuffering(),this._previousPlaybackTime=this._video.currentTime}}]),e}();n.default=u,t.exports=n.default},{"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12}],5:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=e("babel-runtime/helpers/classCallCheck"),a=r(i),o=e("babel-runtime/helpers/createClass"),s=r(o),u=e("./PlaybackStateMachine"),l=r(u),d=e("./PlaybackWatcher"),c=r(d),f=e("./StateTimeCalculator"),_=r(f),h=e("./CreateIntervalPlaceholder"),p=r(h),g=e("./QoSStats"),v=r(g),m={ATTACHED:"ATTACHED",DETACHED:"DETACHED",DISPOSED:"DISPOSED"},E=function(){function e(t,n){(0,a.default)(this,e),this._state=m.ATTACHED,this._stateMachine=new l.default,this._playbackWatcher=new c.default(t,this._stateMachine,n||p.default),this._stateTimeCalculator=new _.default(this._stateMachine),this._qosStats=new v.default(t,this._stateTimeCalculator)}return(0,s.default)(e,[{key:"getQoSAnalytics",value:function(){return this._qosStats.getAnalytics()}},{key:"attach",value:function(){this._state===m.DETACHED?(console.info("attaching QoSModule"),this._state=m.ATTACHED,this._playbackWatcher.resume(),this._stateTimeCalculator.resume()):console.info("can not attach QoSModule, state=",this._state)}},{key:"detach",value:function(){this._state===m.ATTACHED?(console.info("detaching QoSModule"),this._state=m.DETACHED,this._playbackWatcher.pause(),this._stateTimeCalculator.pause()):console.info("can not detach QoSModule, state=",this._state)}},{key:"dispose",value:function(){console.info("disposing QoSModule"),this._state=m.DISPOSED,this._playbackWatcher.dispose(),this._stateTimeCalculator.dispose()}}]),e}();n.default=E,t.exports=n.default},{"./CreateIntervalPlaceholder":1,"./PlaybackStateMachine":3,"./PlaybackWatcher":4,"./QoSStats":6,"./StateTimeCalculator":7,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12}],6:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=e("babel-runtime/helpers/classCallCheck"),a=r(i),o=e("babel-runtime/helpers/createClass"),s=r(o),u=e("./PlaybackState"),l=r(u),d=function(){function e(t,n){(0,a.default)(this,e),this._video=t,this._stateTimeCalculator=n}return(0,s.default)(e,[{key:"getAnalytics",value:function(){var e=this._stateTimeCalculator.getStats();return{droppedFrameCount:this._video.webkitDroppedFrameCount||this._video.droppedFrameCount||0,timeSpentPlaying:e[l.default.PLAYING].timeSpent,timeSpentPaused:e[l.default.PAUSED].timeSpent,timeSpentSeeking:e[l.default.SEEKING].timeSpent,timeSpentEnded:e[l.default.ENDED].timeSpent,rebufferingCount:e[l.default.BUFFERING].count,timeSpentRebuffering:e[l.default.BUFFERING].timeSpent}}}]),e}();n.default=d,t.exports=n.default},{"./PlaybackState":2,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12}],7:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=e("babel-runtime/core-js/object/keys"),a=r(i),o=e("babel-runtime/core-js/get-iterator"),s=r(o),u=e("babel-runtime/helpers/classCallCheck"),l=r(u),d=e("babel-runtime/helpers/createClass"),c=r(d),f=e("./PlaybackState"),_=r(f),h=function(){function e(t){(0,l.default)(this,e),this._stateMachine=t,this._stats={};var n=!0,r=!1,i=void 0;try{for(var o,u=(0,s.default)((0,a.default)(_.default));!(n=(o=u.next()).done);n=!0){var d=o.value;this._stats[d]={count:0,timeSpent:0}}}catch(e){r=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(r)throw i}}this.resume(),this._onStateChangedCallback=this._onStateChanged.bind(this),this._stateMachine.addObserver(this._onStateChangedCallback)}return(0,c.default)(e,[{key:"getStats",value:function(){return this._isAttached&&this._updateStateTimeSpent(this._stateMachine.getState()),this._stats}},{key:"pause",value:function(){this._isAttached=!1,this._terminateState(this._stateMachine.getState())}},{key:"resume",value:function(){this._isAttached=!0,this._resumeState(this._stateMachine.getState())}},{key:"dispose",value:function(){this.pause(),this._stateMachine.removeObserver(this._onStateChangedCallback)}},{key:"_onStateChanged",value:function(e,t){this._terminateState(t),this._resumeState(e)}},{key:"_terminateState",value:function(e){this._updateStateTimeSpent(e),this._stats[e].startTimeStamp=null}},{key:"_updateStateTimeSpent",value:function(e){var t=this._stats[e],n=Date.now();t.timeSpent+=(n-t.startTimeStamp)/1e3,t.startTimeStamp=n}},{key:"_resumeState",value:function(e){var t=this._stats[e];t.count++,t.startTimeStamp=Date.now()}}]),e}();n.default=h,t.exports=n.default},{"./PlaybackState":2,"babel-runtime/core-js/get-iterator":8,"babel-runtime/core-js/object/keys":10,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12}],8:[function(e,t,n){t.exports={default:e("core-js/library/fn/get-iterator"),__esModule:!0}},{"core-js/library/fn/get-iterator":13}],9:[function(e,t,n){t.exports={default:e("core-js/library/fn/object/define-property"),__esModule:!0}},{"core-js/library/fn/object/define-property":14}],10:[function(e,t,n){t.exports={default:e("core-js/library/fn/object/keys"),__esModule:!0}},{"core-js/library/fn/object/keys":15}],11:[function(e,t,n){"use strict";n.__esModule=!0,n.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},{}],12:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("../core-js/object/define-property"),i=function(e){return e&&e.__esModule?e:{default:e}}(r);n.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,i.default)(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()},{"../core-js/object/define-property":9}],13:[function(e,t,n){e("../modules/web.dom.iterable"),e("../modules/es6.string.iterator"),t.exports=e("../modules/core.get-iterator")},{"../modules/core.get-iterator":64,"../modules/es6.string.iterator":68,"../modules/web.dom.iterable":69}],14:[function(e,t,n){e("../../modules/es6.object.define-property");var r=e("../../modules/_core").Object;t.exports=function(e,t,n){return r.defineProperty(e,t,n)}},{"../../modules/_core":22,"../../modules/es6.object.define-property":66}],15:[function(e,t,n){e("../../modules/es6.object.keys"),t.exports=e("../../modules/_core").Object.keys},{"../../modules/_core":22,"../../modules/es6.object.keys":67}],16:[function(e,t,n){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],17:[function(e,t,n){t.exports=function(){}},{}],18:[function(e,t,n){var r=e("./_is-object");t.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},{"./_is-object":36}],19:[function(e,t,n){var r=e("./_to-iobject"),i=e("./_to-length"),a=e("./_to-index");t.exports=function(e){return function(t,n,o){var s,u=r(t),l=i(u.length),d=a(o,l);if(e&&n!=n){for(;l>d;)if((s=u[d++])!=s)return!0}else for(;l>d;d++)if((e||d in u)&&u[d]===n)return e||d||0;return!e&&-1}}},{"./_to-index":55,"./_to-iobject":57,"./_to-length":58}],20:[function(e,t,n){var r=e("./_cof"),i=e("./_wks")("toStringTag"),a="Arguments"==r(function(){return arguments}()),o=function(e,t){try{return e[t]}catch(e){}};t.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=o(t=Object(e),i))?n:a?r(t):"Object"==(s=r(t))&&"function"==typeof t.callee?"Arguments":s}},{"./_cof":21,"./_wks":62}],21:[function(e,t,n){var r={}.toString;t.exports=function(e){return r.call(e).slice(8,-1)}},{}],22:[function(e,t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},{}],23:[function(e,t,n){var r=e("./_a-function");t.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},{"./_a-function":16}],24:[function(e,t,n){t.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},{}],25:[function(e,t,n){t.exports=!e("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./_fails":29}],26:[function(e,t,n){var r=e("./_is-object"),i=e("./_global").document,a=r(i)&&r(i.createElement);t.exports=function(e){return a?i.createElement(e):{}}},{"./_global":30,"./_is-object":36}],27:[function(e,t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},{}],28:[function(e,t,n){var r=e("./_global"),i=e("./_core"),a=e("./_ctx"),o=e("./_hide"),s=function(e,t,n){var u,l,d,c=e&s.F,f=e&s.G,_=e&s.S,h=e&s.P,p=e&s.B,g=e&s.W,v=f?i:i[t]||(i[t]={}),m=v.prototype,E=f?r:_?r[t]:(r[t]||{}).prototype;f&&(n=t);for(u in n)(l=!c&&E&&void 0!==E[u])&&u in v||(d=l?E[u]:n[u],v[u]=f&&"function"!=typeof E[u]?n[u]:p&&l?a(d,r):g&&E[u]==d?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(d):h&&"function"==typeof d?a(Function.call,d):d,h&&((v.virtual||(v.virtual={}))[u]=d,e&s.R&&m&&!m[u]&&o(m,u,d)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,t.exports=s},{"./_core":22,"./_ctx":23,"./_global":30,"./_hide":32}],29:[function(e,t,n){t.exports=function(e){try{return!!e()}catch(e){return!0}}},{}],30:[function(e,t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},{}],31:[function(e,t,n){var r={}.hasOwnProperty;t.exports=function(e,t){return r.call(e,t)}},{}],32:[function(e,t,n){var r=e("./_object-dp"),i=e("./_property-desc");t.exports=e("./_descriptors")?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},{"./_descriptors":25,"./_object-dp":43,"./_property-desc":49}],33:[function(e,t,n){t.exports=e("./_global").document&&document.documentElement},{"./_global":30}],34:[function(e,t,n){t.exports=!e("./_descriptors")&&!e("./_fails")(function(){return 7!=Object.defineProperty(e("./_dom-create")("div"),"a",{get:function(){
return 7}}).a})},{"./_descriptors":25,"./_dom-create":26,"./_fails":29}],35:[function(e,t,n){var r=e("./_cof");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},{"./_cof":21}],36:[function(e,t,n){t.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},{}],37:[function(e,t,n){"use strict";var r=e("./_object-create"),i=e("./_property-desc"),a=e("./_set-to-string-tag"),o={};e("./_hide")(o,e("./_wks")("iterator"),function(){return this}),t.exports=function(e,t,n){e.prototype=r(o,{next:i(1,n)}),a(e,t+" Iterator")}},{"./_hide":32,"./_object-create":42,"./_property-desc":49,"./_set-to-string-tag":51,"./_wks":62}],38:[function(e,t,n){"use strict";var r=e("./_library"),i=e("./_export"),a=e("./_redefine"),o=e("./_hide"),s=e("./_has"),u=e("./_iterators"),l=e("./_iter-create"),d=e("./_set-to-string-tag"),c=e("./_object-gpo"),f=e("./_wks")("iterator"),_=!([].keys&&"next"in[].keys()),h=function(){return this};t.exports=function(e,t,n,p,g,v,m){l(n,t,p);var E,y,T,S=function(e){if(!_&&e in I)return I[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},C=t+" Iterator",A="values"==g,D=!1,I=e.prototype,R=I[f]||I["@@iterator"]||g&&I[g],O=R||S(g),P=g?A?S("entries"):O:void 0,b="Array"==t?I.entries||R:R;if(b&&(T=c(b.call(new e)))!==Object.prototype&&(d(T,C,!0),r||s(T,f)||o(T,f,h)),A&&R&&"values"!==R.name&&(D=!0,O=function(){return R.call(this)}),r&&!m||!_&&!D&&I[f]||o(I,f,O),u[t]=O,u[C]=h,g)if(E={values:A?O:S("values"),keys:v?O:S("keys"),entries:P},m)for(y in E)y in I||a(I,y,E[y]);else i(i.P+i.F*(_||D),t,E);return E}},{"./_export":28,"./_has":31,"./_hide":32,"./_iter-create":37,"./_iterators":40,"./_library":41,"./_object-gpo":45,"./_redefine":50,"./_set-to-string-tag":51,"./_wks":62}],39:[function(e,t,n){t.exports=function(e,t){return{value:t,done:!!e}}},{}],40:[function(e,t,n){t.exports={}},{}],41:[function(e,t,n){t.exports=!0},{}],42:[function(e,t,n){var r=e("./_an-object"),i=e("./_object-dps"),a=e("./_enum-bug-keys"),o=e("./_shared-key")("IE_PROTO"),s=function(){},u=function(){var t,n=e("./_dom-create")("iframe"),r=a.length;for(n.style.display="none",e("./_html").appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object</script>"),t.close(),u=t.F;r--;)delete u.prototype[a[r]];return u()};t.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[o]=e):n=u(),void 0===t?n:i(n,t)}},{"./_an-object":18,"./_dom-create":26,"./_enum-bug-keys":27,"./_html":33,"./_object-dps":44,"./_shared-key":52}],43:[function(e,t,n){var r=e("./_an-object"),i=e("./_ie8-dom-define"),a=e("./_to-primitive"),o=Object.defineProperty;n.f=e("./_descriptors")?Object.defineProperty:function(e,t,n){if(r(e),t=a(t,!0),r(n),i)try{return o(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},{"./_an-object":18,"./_descriptors":25,"./_ie8-dom-define":34,"./_to-primitive":60}],44:[function(e,t,n){var r=e("./_object-dp"),i=e("./_an-object"),a=e("./_object-keys");t.exports=e("./_descriptors")?Object.defineProperties:function(e,t){i(e);for(var n,o=a(t),s=o.length,u=0;s>u;)r.f(e,n=o[u++],t[n]);return e}},{"./_an-object":18,"./_descriptors":25,"./_object-dp":43,"./_object-keys":47}],45:[function(e,t,n){var r=e("./_has"),i=e("./_to-object"),a=e("./_shared-key")("IE_PROTO"),o=Object.prototype;t.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},{"./_has":31,"./_shared-key":52,"./_to-object":59}],46:[function(e,t,n){var r=e("./_has"),i=e("./_to-iobject"),a=e("./_array-includes")(!1),o=e("./_shared-key")("IE_PROTO");t.exports=function(e,t){var n,s=i(e),u=0,l=[];for(n in s)n!=o&&r(s,n)&&l.push(n);for(;t.length>u;)r(s,n=t[u++])&&(~a(l,n)||l.push(n));return l}},{"./_array-includes":19,"./_has":31,"./_shared-key":52,"./_to-iobject":57}],47:[function(e,t,n){var r=e("./_object-keys-internal"),i=e("./_enum-bug-keys");t.exports=Object.keys||function(e){return r(e,i)}},{"./_enum-bug-keys":27,"./_object-keys-internal":46}],48:[function(e,t,n){var r=e("./_export"),i=e("./_core"),a=e("./_fails");t.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],o={};o[e]=t(n),r(r.S+r.F*a(function(){n(1)}),"Object",o)}},{"./_core":22,"./_export":28,"./_fails":29}],49:[function(e,t,n){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],50:[function(e,t,n){t.exports=e("./_hide")},{"./_hide":32}],51:[function(e,t,n){var r=e("./_object-dp").f,i=e("./_has"),a=e("./_wks")("toStringTag");t.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,a)&&r(e,a,{configurable:!0,value:t})}},{"./_has":31,"./_object-dp":43,"./_wks":62}],52:[function(e,t,n){var r=e("./_shared")("keys"),i=e("./_uid");t.exports=function(e){return r[e]||(r[e]=i(e))}},{"./_shared":53,"./_uid":61}],53:[function(e,t,n){var r=e("./_global"),i=r["__core-js_shared__"]||(r["__core-js_shared__"]={});t.exports=function(e){return i[e]||(i[e]={})}},{"./_global":30}],54:[function(e,t,n){var r=e("./_to-integer"),i=e("./_defined");t.exports=function(e){return function(t,n){var a,o,s=String(i(t)),u=r(n),l=s.length;return u<0||u>=l?e?"":void 0:(a=s.charCodeAt(u),a<55296||a>56319||u+1===l||(o=s.charCodeAt(u+1))<56320||o>57343?e?s.charAt(u):a:e?s.slice(u,u+2):o-56320+(a-55296<<10)+65536)}}},{"./_defined":24,"./_to-integer":56}],55:[function(e,t,n){var r=e("./_to-integer"),i=Math.max,a=Math.min;t.exports=function(e,t){return e=r(e),e<0?i(e+t,0):a(e,t)}},{"./_to-integer":56}],56:[function(e,t,n){var r=Math.ceil,i=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(e>0?i:r)(e)}},{}],57:[function(e,t,n){var r=e("./_iobject"),i=e("./_defined");t.exports=function(e){return r(i(e))}},{"./_defined":24,"./_iobject":35}],58:[function(e,t,n){var r=e("./_to-integer"),i=Math.min;t.exports=function(e){return e>0?i(r(e),9007199254740991):0}},{"./_to-integer":56}],59:[function(e,t,n){var r=e("./_defined");t.exports=function(e){return Object(r(e))}},{"./_defined":24}],60:[function(e,t,n){var r=e("./_is-object");t.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":36}],61:[function(e,t,n){var r=0,i=Math.random();t.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+i).toString(36))}},{}],62:[function(e,t,n){var r=e("./_shared")("wks"),i=e("./_uid"),a=e("./_global").Symbol,o="function"==typeof a;(t.exports=function(e){return r[e]||(r[e]=o&&a[e]||(o?a:i)("Symbol."+e))}).store=r},{"./_global":30,"./_shared":53,"./_uid":61}],63:[function(e,t,n){var r=e("./_classof"),i=e("./_wks")("iterator"),a=e("./_iterators");t.exports=e("./_core").getIteratorMethod=function(e){if(void 0!=e)return e[i]||e["@@iterator"]||a[r(e)]}},{"./_classof":20,"./_core":22,"./_iterators":40,"./_wks":62}],64:[function(e,t,n){var r=e("./_an-object"),i=e("./core.get-iterator-method");t.exports=e("./_core").getIterator=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return r(t.call(e))}},{"./_an-object":18,"./_core":22,"./core.get-iterator-method":63}],65:[function(e,t,n){"use strict";var r=e("./_add-to-unscopables"),i=e("./_iter-step"),a=e("./_iterators"),o=e("./_to-iobject");t.exports=e("./_iter-define")(Array,"Array",function(e,t){this._t=o(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):"keys"==t?i(0,n):"values"==t?i(0,e[n]):i(0,[n,e[n]])},"values"),a.Arguments=a.Array,r("keys"),r("values"),r("entries")},{"./_add-to-unscopables":17,"./_iter-define":38,"./_iter-step":39,"./_iterators":40,"./_to-iobject":57}],66:[function(e,t,n){var r=e("./_export");r(r.S+r.F*!e("./_descriptors"),"Object",{defineProperty:e("./_object-dp").f})},{"./_descriptors":25,"./_export":28,"./_object-dp":43}],67:[function(e,t,n){var r=e("./_to-object"),i=e("./_object-keys");e("./_object-sap")("keys",function(){return function(e){return i(r(e))}})},{"./_object-keys":47,"./_object-sap":48,"./_to-object":59}],68:[function(e,t,n){"use strict";var r=e("./_string-at")(!0);e("./_iter-define")(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},{"./_iter-define":38,"./_string-at":54}],69:[function(e,t,n){e("./es6.array.iterator");for(var r=e("./_global"),i=e("./_hide"),a=e("./_iterators"),o=e("./_wks")("toStringTag"),s=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],u=0;u<5;u++){var l=s[u],d=r[l],c=d&&d.prototype;c&&!c[o]&&i(c,o,l),a[l]=a.Array}},{"./_global":30,"./_hide":32,"./_iterators":40,"./_wks":62,"./es6.array.iterator":65}]},{},[5])(5)})},function(e,t,n){var r=n(336),i=n(337),a=i;a.v1=r,a.v4=i,e.exports=a},function(e,t){function n(e,t){var n=t||0,i=r;return i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]}for(var r=[],i=0;i<256;++i)r[i]=(i+256).toString(16).substr(1);e.exports=n},function(e,t,n){(function(t){var n,r=t.crypto||t.msCrypto;if(r&&r.getRandomValues){var i=new Uint8Array(16);n=function(){return r.getRandomValues(i),i}}if(!n){var a=new Array(16);n=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),a[t]=e>>>((3&t)<<3)&255;return a}}e.exports=n}).call(t,n(84))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(162),l=r(u),d=n(161),c=r(d),f=n(156),_=r(f),h=n(157),p=r(h),g=n(24),v=r(g),m=n(2),E=r(m),y=n(4),T=function(){function e(t,n){(0,a.default)(this,e),this._trafficIntervalCounter=0,this._conf=n.conf,this._timerStore=new v.default,this._configAnalytics=new _.default(n),this._trafficAnalytics=new l.default(n),this._statsAnalytics=new c.default(t,n),this._mediaEndedListener=new p.default(t,n),n.eventBus.once(E.default.Distributor.READY,this._init.bind(this))}return(0,s.default)(e,[{key:"_init",value:function(e){this._conf.CONTENT_ACTIVATED&&(this._sendConfigReport(),e?(this._scheduleTrafficReport(),this._scheduleStatReport(),this._scheduleControlReport()):this._conf.ALLOW_P2P=!1),this._onBU=this._onBeforeUnload.bind(this),window.addEventListener("beforeunload",this._onBU)}},{key:"_onBeforeUnload",value:function(){this._trafficAnalytics.sendUsage(!0)}},{key:"dispose",value:function(){this._timerStore.clearAll(),this._statsAnalytics.dispose(),this._mediaEndedListener.dispose(),window.removeEventListener("beforeunload",this._onBU)}},{key:"_sendConfigReport",value:function(){this._configAnalytics.sendConfig()}},{key:"_scheduleTrafficReport",value:function(){var e=this;if(this._trafficIntervalCounter<this._conf.ANALYTICS.TRAFFIC_INTERVAL_ARRAY.length-1){var t=(0,y.createTimeout)(function(){e._trafficAnalytics.sendUsage(),e._scheduleTrafficReport()},this._conf.ANALYTICS.TRAFFIC_INTERVAL_ARRAY[this._trafficIntervalCounter]);this._timerStore.register(t),this._trafficIntervalCounter++}else{var n=this._conf.ANALYTICS.TRAFFIC_INTERVAL_ARRAY[this._conf.ANALYTICS.TRAFFIC_INTERVAL_ARRAY.length-1],r=this._trafficAnalytics.sendUsage.bind(this._trafficAnalytics,!1),i=(0,y.createInterval)(r,n);this._timerStore.register(i)}}},{key:"_scheduleStatReport",value:function(){var e=(0,y.createInterval)(this._statsAnalytics.sendStats.bind(this._statsAnalytics),this._conf.ANALYTICS.STATS_INTERVAL);this._timerStore.register(e)}},{key:"_scheduleControlReport",value:function(){var e=(0,y.createInterval)(this._statsAnalytics.sendControl.bind(this._statsAnalytics),this._conf.ANALYTICS.CONTROL_INTERVAL);this._timerStore.register(e)}}]),e}();t.default=T,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e),this._mediaElement=null}return(0,s.default)(e,[{key:"mediaElement",get:function(){return this._mediaElement},set:function(e){this._mediaElement=e}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=new o.default(e.conf.BITRATE_ESTIMATION_WINDOW);e.eventBus.on(u.default.SRModuleInterface.ABR_FEEDBACK,function(){t.push(e.transferStats.p2pConsumed+e.transferStats.cdnConsumed);var n=t.delta,r=t.timeDelta;n&&r&&(e.abrStats.estimatedBitrate=8*n/r)})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var a=n(65),o=r(a),s=n(2),u=r(s);e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(4),l=n(232),d=r(l),c=n(2),f=r(c),_=function(){function e(t,n){(0,a.default)(this,e),this._mediaElementPlaceholder=t,this._sharedState=n,this._bufferCheck(),this._bufferCheckInterval=(0,u.createInterval)(this._bufferCheck.bind(this),this._sharedState.conf.BUFFER_CHECK_INTERVAL)}return(0,s.default)(e,[{key:"_bufferCheck",value:function(){this._bufferedAmount=d.default.getBufferedAmount(this._mediaElementPlaceholder),this._sharedState.bufferStats.bufferedAmount=this._bufferedAmount,this._sharedState.eventBus.emit(f.default.BufferedAmountObserver.BUFFER_CHECK,this._bufferedAmount)}},{key:"dispose",value:function(){this._bufferCheckInterval.clear()}}]),e}();t.default=_,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(39),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(4),c=n(189),f=r(c),_=n(2),h=r(_),p=n(50),g=r(p),v=function(){function e(t,n,r){var i=this;(0,s.default)(this,e),this._wasLowBuffer=!1,this._lowToHighBufTargetTimestamp=a.default,this._p2pCache=t,this._scheduler=n,this._sharedState=r,this._sharedState.eventBus.once(h.default.Distributor.READY,function(){i._timer=(0,d.createInterval)(i._scheduleChunkDownloads.bind(i),i._sharedState.conf.CHUNK_BATCHING_INTERVAL)})}return(0,l.default)(e,[{key:"dispose",value:function(){this._timer&&this._timer.clear()}},{key:"_scheduleChunkRequestsForSegment",value:function(e,t,n,r){for(var i=t.seeders.all(),a=i.length,o=0;o<a;o++){for(var s=i[o],u=n.getOrCreate(s);u[r]>0&&t.hasChunksToDownload;){var l=t.chunkManager.getNextChunks(s,u[r],r);u[r]-=l.size,s.requestChunks(e,l.encoded,r,t.chunkManager)}if(!t.hasChunksToDownload)break}}},{key:"_scheduleChunkDownloads",value:function(){for(var e=new f.default(this._sharedState.conf.CHUNK_BATCHING_INTERVAL),t=this._scheduler.getSegmentListToDownload().slice(0,this._sharedState.conf.NB_SEGMENT_P2P_PREBUFFER),n=t.length,r=0;r<n;r++){var i=t[r],a=this._p2pCache.getOrCreateSegmentHandler(i);this._sharedState.isP2PDownloadOn&&a.hasChunksToDownload&&!this._sharedState.isP2PDownloadBlocked&&(this._scheduleChunkRequestsForSegment(i,a,e,g.default.SAFE),this._scheduleChunkRequestsForSegment(i,a,e,g.default.UNSAFE))}}}]),e}();t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(67),a=r(i),o=n(8),s=r(o),u=n(16),l=r(u),d=n(0),c=r(d),f=n(1),_=r(f),h=n(64),p=n(5),g=r(p),v=function(){function e(t,n){(0,c.default)(this,e),this._segmentListMap=new l.default,this._conf=n.conf;for(var r=t.getTrackList(),i=0;i<r.length;i++)this._segmentListMap.set(r[i],[])}return(0,_.default)(e,[{key:"insert",value:function(e){var t=this._getMatchingTrack(e);if(t){var n=(0,h.unwrap)(this._segmentListMap.get(t));if(0===n.length)n.push(e);else if(n[0].getId()>e.getId())n.unshift(e);else for(var r=n.length;r>0;r--)if(e.getId()>n[r-1].getId()){n.splice(r,0,e);break}var i=n.length;if(i>this._conf.MAX_DISTRIBUTED_SEGMENT_LIST_LENGTH){var a=n.slice(i-this._conf.MAX_DISTRIBUTED_SEGMENT_LIST_LENGTH);this._segmentListMap.set(t,a)}}}},{key:"getSegmentListAfter",value:function(e){var t=this._getMatchingTrack(e);if(t){var n=(0,h.unwrap)(this._segmentListMap.get(t)),r=n.filter(function(t){return t.getId()>e.getId()});return this._segmentListMap.set(t,r),r}return[]}},{key:"_getMatchingTrack",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=(0,s.default)(this._segmentListMap);!(t=(i=o.next()).done);t=!0){var u=(0,a.default)(i.value,1),l=u[0];if(e.isInTrack(l))return l}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}g.default.notifyError(new Error("Pushed segment belongs to no track"))}}]),e}();t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=e.conf.DISTRIBUTOR.URL,n=e.conf.ID_CLIENT,r=e.moduleState.content,i=t+"?customer="+n+"&content="+r+"&version=4.10.7",a={timeout:e.conf.DISTRIBUTOR.TIMEOUT_DELAY,retry:e.conf.DISTRIBUTOR.MAX_RETRY},s=new o.default(o.default.Methods.GET,i,a);e.controlStats.sentDistributorRootCount++,s.isStreamroot=!0,s.send().then(function(t){e.injectConfigFromDistributor(t),e.eventBus.emit(d.default.Distributor.READY,!0)}).catch(function(t){e.conf.DISTRIBUTOR.OVERRIDDEN||(e.setBackendFallbackUrls(),e.eventBus.emit(d.default.Distributor.READY,!1)),u.default.notifyError(new Error("Could not connect to distributor: "+t.message+". Status: "+t.status))})}Object.defineProperty(t,"__esModule",{value:!0});var a=n(48),o=r(a),s=n(5),u=r(s),l=n(2),d=r(l);t.default={connect:i},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(40),i=function(e){return e&&e.__esModule?e:{default:e}}(r),a=function(e){var t=[],n=[],r=e,a={},o=function(e,n){t.push({eventName:e,fn:n}),r.addEventListener(e,n)},s=function(e,t){n.push({eventName:e,fn:t}),window.addEventListener(e,t)},u=function(){for(var e=0;e<t.length;e++){var n=t[e].eventName,i=t[e].fn;r.removeEventListener(n,i)}t=[]},l=function(){for(var e=0;e<n.length;e++){var t=n[e].eventName,r=n[e].fn;window.removeEventListener(t,r)}n=[]},d=function(){u(),l()},c=function(e){function t(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];a[e].arguments=n}return a[e]={arguments:void 0,handler:t},t},f=function(e){r.addEventListener(e,c(e))},_=function(e,t){if(!a[e]||!a[e].arguments)throw new Error("You are trying to trigger an event that have not been cached before");r.removeEventListener(e,a[e].handler),a[e].arguments&&t.apply(void 0,(0,i.default)(a[e].arguments))};this.addMediaEventListener=o,this.addWindowEventListener=s,this.removeAllExternalEventListener=d,this.cacheMediaEvent=f,this.triggerCachedEvent=_};t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(101),a=r(i),o=n(67),s=r(o),u=n(40),l=r(u),d=n(8),c=r(d),f=n(16),_=r(f),h=n(0),p=r(h),g=n(1),v=r(g),m=n(219),E=r(m),y=n(89),T=r(y),S=n(2),C=r(S),A=function(){function e(t,n,r){var i=this;(0,p.default)(this,e),this._peerPool=t,this._segmentInfoMap=n,this._sharedState=r,this._segmentHandlers=new _.default,this._sharedState.eventBus.on(C.default.P2PCache.REMOVE_SEGMENT_FROM_CACHE,function(e){i.removeSegmentHandler(e)})}return(0,v.default)(e,[{key:"getSegmentHandler",value:function(e){var t=this._segmentHandlers.get(e.viewToString());return t||!1}},{key:"removePeer",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=(0,c.default)(this._segmentHandlers.values());!(t=(i=a.next()).done);t=!0)i.value.seeders.remove(e)}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}}},{key:"getOrCreateSegmentHandler",value:function(e){var t=this.getSegmentHandler(e);return!1===t&&(t=new E.default(e,this,this._peerPool,this._segmentInfoMap,this._sharedState),this._segmentHandlers.set(t.segmentCoord.viewToString(),t),this._peerPool.requestHasSegment(e),this._manageP2PCache()),t}},{key:"removeSegmentHandler",value:function(e){var t=e.viewToString(),n=this._segmentHandlers.get(t);n&&(n.dispose(),this._segmentHandlers.delete(t))}},{key:"fillSegment",value:function(e,t){var n=this.getOrCreateSegmentHandler(e),r=n.chunkManager,i=new T.default(t,e,this._sharedState.eventBus);r.storeSegment(i),n.seeders.clear(),(this._sharedState.moduleState.isLive()&&this._sharedState.conf.ALLOW_LIVE_PUSH_SEGMENT||!this._sharedState.moduleState.isLive()&&this._sharedState.conf.ALLOW_VOD_PUSH_SEGMENT)&&this._peerPool.broadcastSegmentInfo(e)}},{key:"getPartialSegment",value:function(e){var t=this.getSegmentHandler(e).chunkManager;return!!t&&t.getPartialSegment()}},{key:"listSegmentsToSkipForTrack",value:function(e){return[].concat((0,l.default)(this._segmentHandlers)).filter(function(t){var n=(0,s.default)(t,2),r=(n[0],n[1]);return r.segmentCoord.isInTrack(e)&&!r.chunkManager.shouldDownloadSegment()}).map(function(e){var t=(0,s.default)(e,2);return t[0],t[1].segmentCoord})}},{key:"listSegmentsDownloadStatus",value:function(){return[].concat((0,l.default)(this._segmentHandlers)).map(function(e){var t=(0,s.default)(e,2),n=(t[0],t[1]);return{segmentcoord:n.segmentCoord,downloadStatusList:n.chunkManager.downloadStatus,seederCount:n.seeders.length}})}},{key:"listDownloadedSegmentsForTrack",value:function(e){return[].concat((0,l.default)(this._segmentHandlers)).filter(function(t){var n=(0,s.default)(t,2),r=(n[0],n[1]);return r.segmentCoord.isInTrack(e)&&r.chunkManager.isSegmentDownloaded()}).map(function(e){var t=(0,s.default)(e,2);return t[0],t[1].segmentCoord})}},{key:"getSegmentsStats",value:function(){if(!this._segmentHandlers.size)return{};var e=void 0,t=0,n=a.default,r=!0,i=!1,o=void 0;try{for(var s,u=(0,c.default)(this._segmentHandlers.values());!(r=(s=u.next()).done);r=!0)e=s.value.segmentCoord.getId(),n=Math.min(n,e),t=Math.max(t,e)}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return{minSegmentId:n,maxSegmentId:t}}},{key:"dispose",value:function(){this._segmentHandlers=new _.default}},{key:"_manageP2PCache",value:function(){var e=0,t=this._sharedState.moduleState.isLive()?this._sharedState.conf.LIVE.P2P_CACHE_MAX_SIZE:this._sharedState.conf.P2P_CACHE_MAX_SIZE,n=void 0,r=0,i=!0,a=!1,o=void 0;try{for(var s,u=(0,c.default)(this._segmentHandlers.values());!(i=(s=u.next()).done);i=!0){var l=s.value;if(l.chunkManager.size&&(e+=l.chunkManager.size),e>t){n=this._segmentHandlers.size-r;break}r++}}catch(e){a=!0,o=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw o}}if(n){var d=this._segmentHandlers.keys(),f=!0,_=!1,h=void 0;try{for(var p,g=(0,c.default)(d);!(f=(p=g.next()).done);f=!0){var v=p.value;if(0===n)break;var m=this._segmentHandlers.get(v),E=m.segmentCoord;this.removeSegmentHandler(E),this._segmentInfoMap.removeSegmentInfo(E),n--}}catch(e){_=!0,h=e}finally{try{!f&&g.return&&g.return()}finally{if(_)throw h}}}}}]),e}();t.default=A,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,[{key:"init",value:function(e,t){this._p2pCache=e,this._scheduler=t}},{key:"getStats",value:function(){var e=this._scheduler.getEdgeSegment();if(e){var t=e.getId(),n=this._p2pCache.getSegmentsStats(),r=n.minSegmentId,i=n.maxSegmentId;return{min:r||t,max:i||t,current:t}}return null}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(2),l=r(u),d=function(){function e(t,n,r,i,o){(0,a.default)(this,e),this._scheduler=t,this._p2pCache=n,this._segmentInfoMap=r,this._distributedSegmentList=i,this._sharedState=o}return(0,s.default)(e,[{key:"_onHasSegment",value:function(e,t,n){var r=n.pushed;if(this._segmentInfoMap.addSegmentInfo(t),!r||this._sharedState.conf.USE_VOD_PUSH_PATCH&&!this._sharedState.moduleState.isLive()||this._distributedSegmentList.insert(t.segmentCoord),this._scheduler.isSegmentRequested(t.segmentCoord)){var i=this._p2pCache.getOrCreateSegmentHandler(t.segmentCoord);i.chunkManager.setSegmentSize(t.size),e.isBannedSeeder()||i.seeders.add(e)}}},{key:"_onPeerOpen",value:function(){this._sharedState.eventBus.emit("segmentInfo",this._scheduler.getSegmentListToDownload(),this._segmentInfoMap)}},{key:"_onPeerDestroyed",value:function(e){var t=e.remotePeer;this._p2pCache.removePeer(t)}}],[{key:"listenEvents",value:function(t,n,r,i,a){var o=new e(t,n,r,i,a);a.eventBus.on(l.default.PeerPool.PEER_OPEN,o._onPeerOpen.bind(o)),a.eventBus.on("hasSegment",o._onHasSegment.bind(o)),a.eventBus.on(l.default.PeerPool.PEER_DESTROYED,o._onPeerDestroyed.bind(o))}}]),e}();t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(24),l=r(u),d=n(5),c=r(d),f=n(4),_=n(17),h=n(25),p=n(172),g=r(p),v=n(35),m=r(v),E=function(){function e(t){var n=this;(0,a.default)(this,e);var r=t.conf,i=t.transferStats,o=t.abrStats;this._conf=r,this._transferStats=i,this._abrStats=o,this._p2pMediaDownloadedDelta=new _.Delta,this._p2pTimeElapsedDelta=new _.Delta(Date.now());var s=r.P2P_SPEED_ESTIMATION_BUCKET_COUNT*r.P2P_SPEED_ESTIMATION_BUCKET_DURATION;this._p2pMediaDownloadedSMWA=new g.default(s),this._p2pMediaDownloadedEMWA=new m.default(0,r.P2P_SPEED_EMA_WEIGHT),this._p2pMediaDownloadedLongSMA=new g.default(r.P2P_USEFUL_SMA_WINDOW),this._p2pMediaDownloadedLongDelta=new _.Delta,this._p2pUsefulLongSMA=new g.default(r.P2P_USEFUL_SMA_WINDOW),this._p2pUsefulLongDelta=new _.Delta,this._timerStore=new l.default,this._ewmaZeroWeight=1-Math.exp(Math.log(.5)*r.MEAN_SPEED_CALCULATION_INTERVAL/r.P2P_SPEED_EMA_ZERO_HALF_LIFE);var u=(0,f.createInterval)(function(){n._computeMeanInstantSpeed()},this._conf.MEAN_SPEED_CALCULATION_INTERVAL),d=(0,f.createInterval)(function(){n._computeDeltaP2PSpeed()},r.P2P_SPEED_ESTIMATION_BUCKET_DURATION),c=(0,f.createInterval)(function(){n._updateUsefulP2PRatio()},this._conf.P2P_USEFUL_CALCULATION_INTERVAL);this._timerStore.register(u),this._timerStore.register(d),this._timerStore.register(c)}return(0,s.default)(e,[{key:"getP2PSpeedEstimate",value:function(){var e=this._p2pMediaDownloadedEMWA.value;return e*(1-this._conf.P2P_USEFUL_RATIO_WEIGHT)+e*this._abrStats.p2pUsefulEstimate*this._conf.P2P_USEFUL_RATIO_WEIGHT}},{key:"_updateUsefulP2PRatio",value:function(){var e=this._p2pUsefulLongDelta.calcDelta(this._transferStats.p2pUseful),t=this._p2pMediaDownloadedLongDelta.calcDelta(this._transferStats.p2pMediaDownloaded);t>0&&(this._p2pMediaDownloadedLongSMA.addPoint(t),this._p2pUsefulLongSMA.addPoint(e));var n=this._p2pMediaDownloadedLongSMA.computeSum(),r=this._p2pUsefulLongSMA.computeSum(),i=8*n/this._conf.P2P_USEFUL_SMA_WINDOW<this._conf.P2P_DL_THRESHOLD_FOR_USEFUL_CORRECTION?1:Math.min(1,r/n);this._abrStats.p2pUsefulEstimate=(0,h.toDecimal)(i,3)}},{key:"_computeMeanInstantSpeed",value:function(){var e=this._p2pMediaDownloadedSMWA.compute();this._abrStats.p2pSpeedWindowsCount++,0===e&&this._abrStats.zeroP2pSpeedWindowsCount++,e<0?c.default.notifyError(new Error("Negative p2pMediaDownloaded delta.")):this._p2pMediaDownloadedEMWA.value<this._conf.P2P_SPEED_ZERO_THRESHOLD?this._p2pMediaDownloadedEMWA.update(e,1):e>0?this._p2pMediaDownloadedEMWA.update(e):0===e&&this._p2pMediaDownloadedEMWA.update(e,this._ewmaZeroWeight),this._abrStats.p2pSpeed=this.getP2PSpeedEstimate()}},{key:"_computeDeltaP2PSpeed",value:function(){var e=this._p2pMediaDownloadedDelta.calcDelta(this._transferStats.p2pMediaDownloaded),t=this._p2pTimeElapsedDelta.calcDelta(Date.now());e>0&&t>0?this._p2pMediaDownloadedSMWA.addPoint(8*e/t):e<0&&c.default.notifyError(new Error("Negative p2pMediaDownloaded delta."))}},{key:"dispose",value:function(){this._timerStore.clearAll()}}]),e}();t.default=E,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(10),c=r(d),f=n(9),_=r(f),h=n(63),p=r(h),g=function(e){function t(e){(0,s.default)(this,t);var n=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this));return n._segmentCoord=e,n}return(0,_.default)(t,e),(0,l.default)(t,[{key:"getUpdatedRange",value:function(e){return e}},{key:"getFullSegment",value:function(e,t){t(e,this._segmentCoord)}},{key:"isComplete",value:function(){return!1}},{key:"isLocked",value:function(){return!1}},{key:"p2pSpeed",get:function(){return 0}},{key:"p2pAmount",get:function(){return 0}}]),t}(p.default);t.default=g,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(10),c=r(d),f=n(9),_=r(f),h=n(63),p=r(h),g=n(94),v=r(g),m=function(e){function t(e,n,r,i){function o(e,t){function i(i,a){e.response=i;var o=new v.default(f,i.byteLength,a);r.addSegmentInfo(o),n.fillSegment(f,e.response),t(e,f)}l.callHashWorker(e.response,i)}(0,s.default)(this,t);var u=i.eventBus,l=i.workerHelper,d=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this)),f=e;return d.getFullSegment=function(e,t){u.emit("CDNSegmentDownloaded",f);var n=e.response;i.transferStats.cdnDownloaded+=n.byteLength,o(e,t)},d}return(0,_.default)(t,e),(0,l.default)(t,[{key:"isComplete",value:function(){return!1}},{key:"isLocked",value:function(){return!1}},{key:"getUpdatedRange",value:function(e){return e}},{key:"p2pSpeed",get:function(){return 0}},{key:"p2pAmount",get:function(){return 0}}]),t}(p.default);t.default=m,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),a=r(i),o=n(39),s=r(o),u=n(227),l=r(u),d=n(24),c=r(d),f=n(4),_=n(183),h=r(_),p=n(206),g=r(p),v=n(2),m=r(v),E=n(97),y=r(E),T=n(188),S=r(T),C=n(175),A=r(C),D=n(178),I=r(D),R=n(92),O=r(R),P={EXCLUSION_REMOVED:"removed",EXCLUSION_DISCONNECTED:"disconnected",EXCLUSION_OFFER_DECLINED:"offer_declined",EXCLUSION_CONNECTION_ATTEMPT_TIMED_OUT:"timed_out"},b=function(e,t,n,r,i){var o=i.conf,u=i.status,d=i.peerStats,_=void 0,p=null,v=!1,E=void 0,T=null,C=void 0,D=!1,R=[],b=0,w=s.default,M=new S.default(e,t,i),L=r,N=this,k=i.eventBus,x=i.statsProvider,U=new c.default,F=function(){v=!0,H()},B=function(){v=!1,H()},H=function(e){if(U.clear(p),p=null,!v){var t=Date.now()-w,n=e-t;n>0?(p=(0,f.createTimeout)(z,n),U.register(p)):z()}},j=function(e){if(e.isVideo){var t=!0,n=!1,r=void 0;try{for(var s,u=(0,a.default)(R);!(t=(s=u.next()).done);t=!0)if(s.value.isOnSameTrack()){i.abrStats.trackSwitchWithPeers++;break}}catch(e){n=!0,r=e}finally{try{!t&&u.return&&u.return()}finally{if(n)throw r}}p&&H(o.ASK_PEERS_AFTER_TRACK_SWITCH_INTERVAL)}},G=function(){de()&&N.makeRoom();var e=0,t=0,n=!0,r=!1,i=void 0;try{for(var o,s=(0,a.default)(R);!(n=(o=s.next()).done);n=!0){var u=o.value;u.locked()&&e++,u.isLooser()&&t++}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}d.locked.updateMetric(e),d.loosers.updateMetric(t);var l=0,c=!0,f=!1,_=void 0;try{for(var h,p=(0,a.default)(R);!(c=(h=p.next()).done);c=!0)h.value.isOnSameTrack()&&l++}catch(e){f=!0,_=e}finally{try{!c&&p.return&&p.return()}finally{if(f)throw _}}k.emit(m.default.PeerPool.PEER_STATS_UPDATE,{peerCount:R.length,sameTrackPeerCount:l})},K=function(){for(var e=0,t=0,n=0;n<R.length;n++){var r=R[n];e+=r.getDlSpeed(),t+=r.getUpSpeed()}u.setDlSpeed(e),u.setUpSpeed(t),u.computeMaxAndAvgSpeed()},V=function(){null!==T&&T.dispose(),T=new g.default(u.getMyPeerId(),this,n,i),C=new A.default(T,i),
E=new I.default(this,T,i),_=C.onPeersFromTracker.bind(C),D&&q()},W=function(){p&&(U.clear(p),p=null)},q=function(){if(u.getConnected()&&u.getConnectedToSignalingServer()){var e=Date.now()-w,t=Date.now()-i.moduleState.currentTracks.lastSwitchTimestamp,n=t<e?o.ASK_PEERS_AFTER_TRACK_SWITCH_INTERVAL:o.ASK_PEERS_INTERVAL;H(n),D=!0}},Y=function(e,t){R=l.default.without(R,e),k.emit(m.default.PeerPool.PEER_DESTROYED,{remotePeer:e,peerCount:R.length}),t?E.addSecondOrderExclusion(e.getId(),o.PEER_DISCONNECTED_EXCLUSION_RANK,o.PEER_DISCONNECTED_EXCLUSION_DURATION,P.EXCLUSION_DISCONNECTED):(E.addSecondOrderExclusion(e.getId(),o.PEER_REMOVED_EXCLUSION_RANK,o.PEER_REMOVED_EXCLUSION_DURATION,P.EXCLUSION_REMOVED),e.isOnSameTrack()?d.droppedSameTrack++:d.droppedOtherTrack++)},z=function e(){w=Date.now();var t=E.exclusionList;d.exclusionSize=E.secondOrderExclusions.size,M.askPeers(t,_),p=(0,f.createTimeout)(e,o.ASK_PEERS_INTERVAL),U.register(p)},Q=function(){return R.length},X=function(e){for(var t=0;t<R.length;t++)R[t].requestHasSegment(e)},Z=function(){for(;R.length>0;)R[R.length-1].close()},J=function(e,t,r){var a=$(),o=new h.default(e,n,t,i,a);R.push(o),r?d.openedMatch++:d.openedOffer++,k.emit(m.default.PeerPool.PEER_OPEN,{remotePeer:o,peerCount:R.length}),ae()},$=function(){for(var e=[],t=0,n=R.length;t<n;t++)e.push(R[t].getUploadCapacity());var r=y.default.median(e);return r?Math.max(r,o.MIN_PEER_UPLOAD_CAPACITY):o.DEFAULT_PEER_UPLOAD_CAPACITY},ee=function(){for(var e=0,t=0,n=R.length;t<n;t++)e+=R[t].getUploadCapacity();d.peerPoolUploadCapacity.updateMetric(e)},te=function(){return R.length>0?R[Math.floor(Math.random()*R.length)].getUploadCapacity():0},ne=function(e){E.addSecondOrderExclusion(e,o.OFFER_DECLINED_EXCLUSION_RANK,o.OFFER_DECLINED_EXCLUSION_DURATION,P.EXCLUSION_OFFER_DECLINED),d.denied++},re=function(e){E.addSecondOrderExclusion(e,o.PEER_CONNECTION_ATTEMPT_EXCLUSION_RANK,o.PEER_CONNECTION_ATTEMPT_TIMED_OUT_EXCLUSION_DURATION,P.EXCLUSION_CONNECTION_ATTEMPT_TIMED_OUT),ie()},ie=function(){++b>o.MAX_PEER_CONNECTION_FAILURES&&(oe(),se())},ae=function(){b=0},oe=function(){k.emit(m.default.Tracker.PERM_TRACKER_DISCONNECTION_REQUEST)},se=function(){k.emit(m.default.Signaling.PERM_SIGNALING_DISCONNECTION_REQUEST)},ue=function(e){var t=L.getSegmentInfo(e),n=!0,r=!1,i=void 0;try{for(var o,s=(0,a.default)(R);!(n=(o=s.next()).done);n=!0)o.value.answerHasSegment(t,{pushed:!0})}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}},le=function(){var e=[],t=[],n=1,r=1,i=!0,o=!1,s=void 0;try{for(var u,l=(0,a.default)(R);!(i=(u=l.next()).done);i=!0){var d=u.value;d.locked()||(d.isLooser()?e.push(d):t.push(d)),n=Math.max(n,d.getUpSpeedEMA()),r=Math.max(r,d.getUsefulDlSpeedEMA())}}catch(e){o=!0,s=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw s}}return{loosers:e,unlocked:t,maxUpSpeed:n,maxDownSpeed:r}},de=function(){return R.length-o.PEER_POOL_LIMIT>0},ce=function(e,t,n){var r=e.getUpSpeedEMA()/t+e.getUsefulDlSpeedEMA()/n;return r},fe=function(){null!==T&&T.dispose(),C&&C.dispose(),U.clearAll(),Z(),M.dispose()};N.getPeerArray=function(){return R},N.lockedCount=function(){var e=0,t=!0,n=!1,r=void 0;try{for(var i,o=(0,a.default)(R);!(t=(i=o.next()).done);t=!0)i.value.locked()&&e++}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return e},N.openSlotsCount=function(){return Math.max(o.PEER_POOL_LIMIT-N.lockedCount(),0)},N.makeRoom=function(){var e=le(),t=e.loosers,n=e.unlocked,r=e.maxUpSpeed,i=e.maxDownSpeed;for(t.sort(function(e,t){return t.getUpSpeedEMA()-e.getUpSpeedEMA()});t.length>0&&de();){var a=t.pop();Y(a,!1)}if(de())for(n.sort(function(e,t){return ce(t,r,i)-ce(e,r,i)});n.length>0&&de();){var o=n.pop();Y(o,!1)}},N.getPeerCount=Q,N.getPendingConnectionDebugInfos=function(){return T?T.getPendingConnectionDebugInfos():[]},N.requestHasSegment=X,N.addPeerConnection=J,this.offerDeclined=ne,this.connectionAttemptTimeout=re,N.broadcastSegmentInfo=ue,N.dispose=fe,function(){var e=(0,f.createInterval)(K,o.SPEED_MONITOR_INTERVAL),t=(0,f.createInterval)(ee,o.PEER_UPLOAD_CAPACITY_COMPUTATION_INTERVAL),n=(0,f.createInterval)(G,o.PEER_POOL_MAINTENANCE_INTERVAL);U.register(e),U.register(t),U.register(n),k.on(m.default.Peer.REMOVE_PEER,Y),k.on(m.default.Metrics.TRACK_SWITCH,j,this),k.on(m.default.PeerPool.STOP_ASKING_PEERS,F),k.on(m.default.PeerPool.START_ASKING_PEERS,B),u.getEE().on("tracker_ready",V,N),u.getEE().on("tracker_disconnected",W,N),u.getEE().on("signaling_ready",q,N),u.getEE().on("signaling_disconnected",W,N),x.registerProvider(O.default.PeerStats.SAMPLED_PUC,te)}()};t.default=b,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var i=n(18),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(5),c=r(d),f=n(48),_=r(f),h=n(2),p=r(h),g=n(4),v=n(174),m=r(v),E=function(){},y=function(){function e(t,n,r,i,a){var o=r.onProgress,u=void 0===o?E:o,l=r.onError,d=void 0===l?E:l,f=r.onSuccess,_=void 0===f?E:f,h=this;(0,s.default)(this,e),this._firstByteCdnTimestamp=null,this._request=n,this._initialHandlers={onProgress:u,onError:d,onSuccess:_},this._handlers={},this._srModule=t,this._transferStats=a.transferStats,this._controlStats=a.controlStats,this._mediaStats=a.mediaStats,this._abrStats=a.abrStats,this._conf=a.conf,this._eventBus=a.eventBus,this._stats={cdnDownloaded:0,cdnDuration:0,p2pDownloaded:0,p2pDuration:0},this._segmentCoord=i,this._handlers.onSuccess=function(e,t,n){if((0,m.default)(t,h._abrStats,h._conf),h._conf.ENABLE_LATENCY_FEEDBACK){var r=h._stats.latency||h._abrStats.latencyHistoricalValue;t.latency=Math.min(r,Math.ceil((t.cdnDuration+t.p2pDuration)*h._conf.LATENCY_CAPPING_RATIO))}h._transferStats.p2pConsumed+=t.p2pDownloaded,h._transferStats.cdnConsumed+=t.cdnDownloaded;var i=e.slice(0);try{h._initialHandlers.onSuccess(i,t,n)}catch(e){console.error(e),c.default.notifyError(e)}h._eventBus.emit(p.default.SRModuleInterface.ABR_FEEDBACK,t),h._eventBus.emit(p.default.SRModuleInterface.SEGMENT_TRANSFERED_TO_MEDIA_ENGINE)},this._handlers.onError=function(e,t){try{h._initialHandlers.onError(e,t)}catch(e){console.error(e),c.default.notifyError(e)}},this._handlers.onProgress=function(e,t){try{h._initialHandlers.onProgress(e,t)}catch(e){console.error(e),c.default.notifyError(e)}}}return(0,l.default)(e,[{key:"getSegment",value:function(){try{null===this._segmentCoord?this._getFullSegmentFromCDN():(this._partialSegment=this._srModule.getP2PData(this._segmentCoord),this._setP2PStats(),this._partialSegment.isComplete()?(this._conf.ENABLE_LATENCY_FEEDBACK&&(this._stats.latency=Math.min(this._abrStats.latencyHistoricalValue,Math.ceil(this._stats.p2pDuration*this._conf.LATENCY_CAPPING_RATIO))),this._handlers.onProgress(this._stats,this._request),this._getFullP2PSegment()):(this._eventBus.emit(p.default.SRModuleInterface.UNCOMPLETE_SEGMENT_REQUESTED),this._getRemainingRangeFromCDN())),this._controlStats.getSegmentSuccess++}catch(e){console.error(e),c.default.notifyError(e),this._getFullSegmentFromCDN(),this._controlStats.getSegmentFallback++}return{abort:this._abort.bind(this)}}},{key:"_abort",value:function(){this._httpRequest&&this._httpRequest.abort(),this._handlers.onSuccess=E,null!==this._segmentCoord&&this._mediaStats.abortFragmentCount++}},{key:"_getFullP2PSegment",value:function(){var e=this;this._waitSegmentUnlocked(function(t){t?e._fillSegment(null):(e._controlStats.segmentLockTimeout++,e._getFullSegmentFromCDN())})}},{key:"_getRemainingRangeFromCDN",value:function(){var e=this,t=this._getRangeFromRequest();this._fallbackRange=t,this._rangeToDownload=this._partialSegment.getUpdatedRange(t),this._downloadFromCDN(this._rangeToDownload,function(t,n){return t?void e._handlers.onError(t,e._request):void e._fillSegment(n)})}},{key:"_onCDNProgress",value:function(e){var t=Date.now();null===this._firstByteCdnTimestamp&&(this._firstByteCdnTimestamp=t,this._conf.ENABLE_LATENCY_FEEDBACK&&(this._stats.latency=this._firstByteCdnTimestamp-this._startDownloadCdn)),this._stats.cdnDuration=t-this._startDownloadCdn,this._stats.cdnDownloaded=e.loaded;var n={};if((0,a.default)(n,this._stats),this._conf.USE_CONTINOUS_PROGRESS_FEEDBACK)if(e.lengthComputable){var r=e.loaded/e.total;n.p2pDownloaded=Math.round(r*this._stats.p2pDownloaded),n.p2pDuration=Math.round(r*this._stats.p2pDuration)}else n.p2pDownloaded=0,n.p2pDuration=0;this._conf.PROGRESS_ADD_TOTAL&&(n.lengthComputable=e.lengthComputable,n.total=e.lengthComputable?e.total+this._stats.p2pDownloaded:0),this._handlers.onProgress(n,this._request)}},{key:"_downloadFromCDN",value:function(e,t){var n=this,r=_.default.Methods.GET,i={headers:this._getHttpRequestHeaders(e),responseType:_.default.ResponseTypes.ARRAY_BUFFER,withCredentials:!!this._request.withCredentials,events:{onprogress:this._onCDNProgress.bind(this)}};this._httpRequest=new _.default(r,this._request.url,i),this._httpRequest.send().then(function(e){var r=Date.now();n._stats.cdnDownloaded=e.byteLength||0,n._stats.cdnDuration=r-n._startDownloadCdn;var i=n._transferStats.p2pMediaDownloaded-n._p2pAmountOnStart;n._abrStats.concurrentP2pDownloaded+=i,n._abrStats.cdnEstimationCount++,0!==i&&n._abrStats.concurrentP2pDownloadCount++;var a=n._stats.cdnDownloaded+n._stats.p2pDownloaded;if(n._stats.cdnDownloaded/a>=n._conf.ABR_CDN_SPEED_UPDATE_RATIO_THRESHOLD&&n._stats.cdnDownloaded>=n._conf.ABR_CDN_DL_THRESHOLD||a<n._conf.ABR_CDN_DL_THRESHOLD){if(n._conf.CDN_SPEED_ESTIMATE_CONSIDER_P2P){var o=Math.min(n._stats.cdnDownloaded+i,n._stats.cdnDownloaded*n._conf.CDN_CONCURRENT_SCALING_CAP);n._abrStats.cdnSpeed=8*o/n._stats.cdnDuration}else n._abrStats.cdnSpeed=8*n._stats.cdnDownloaded/n._stats.cdnDuration;n._abrStats.cdnTimestamp=Date.now()}t(null,e)}).catch(function(e){t(e,null)}),this._startDownloadCdn=Date.now(),this._p2pAmountOnStart=this._transferStats.p2pMediaDownloaded}},{key:"_getHttpRequestHeaders",value:function(e){var t={},n=this._request.headers;if(n&&void 0!==n.length)throw new Error("Custom headers object should not have a `length` attribute (you might use the previous API format)");return n&&((0,a.default)(t,n),this._rangeToDownload&&delete t.Range),void 0===t.Range&&e&&(t.Range=this._rangeValue(e)),t}},{key:"_rangeValue",value:function(e){return"bytes="+e.start+"-"+(e.end||"")}},{key:"_fillSegment",value:function(e){var t=this,n=!1,r=function(e){return function(r,i){n||(n=!0,e.call(t,r,i))}};try{this._partialSegment.getFullSegment({response:e},r(this._onSuccessAsynchronous),r(this._getFullSegmentFromCDN)),this._controlStats.fillSegmentSuccess++}catch(e){return console.error(e),c.default.notifyError(e),this._getFullSegmentFromCDN(),void this._controlStats.fillSegmentFallback++}(0,g.createTimeout)(function(){n||(n=!0,t._getFullSegmentFromCDN(),t._controlStats.fillSegmentSuccess--,t._controlStats.fillSegmentTimeout++)},this._conf.TIMEOUT_GET_FULL_SEGMENT)}},{key:"_waitSegmentUnlocked",value:function(e){var t=this;if(!this._partialSegment.isLocked())return void e(!0);var n=0,r=(0,g.createInterval)(function(){return t._partialSegment=t._srModule.getP2PData(t._segmentCoord),t._partialSegment.isLocked()?void((n+=t._conf.LOCKED_RETRY_INTERVAL)>t._conf.LOCKED_RETRY_TIMEOUT&&(r.clear(),e(!1))):(r.clear(),void e(!0))},this._conf.LOCKED_RETRY_INTERVAL)}},{key:"_getRangeFromRequest",value:function(){var e=this._request.headers;if(e&&void 0!==e.Range){var t=e.Range.split("="),n=t[1].split("-");return{start:parseInt(n[0],10),end:parseInt(n[1],10)}}}},{key:"_getFullSegmentFromCDN",value:function(){var e=this;this._stats.p2pDownloaded=0,this._stats.p2pDuration=0,this._downloadFromCDN(this._fallbackRange,function(t,n){return t?void e._handlers.onError(t,e._request):void e._handlers.onSuccess(n,e._stats,e._request)})}},{key:"_setP2PStats",value:function(){this._stats.p2pDownloaded=this._partialSegment.p2pAmount,this._stats.p2pDuration=0===this._partialSegment.p2pSpeed?0:Math.round(this._partialSegment.p2pAmount/this._partialSegment.p2pSpeed*1e3)}},{key:"_onSuccessAsynchronous",value:function(e){var t=this;(0,g.createTimeout)(function(){t._handlers.onSuccess(e.response,t._stats,t._request)},0)}}]),e}();e.exports={getSegment:function(e,t,n,r,i){return new y(e,t,n,r,i).getSegment()}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(16),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=function(){function e(){(0,s.default)(this,e),this._map=new a.default}return(0,l.default)(e,[{key:"addSegmentInfo",value:function(e){var t=e.segmentCoord.viewToString();this._map.set(t,e)}},{key:"getSegmentInfo",value:function(e){var t=e.viewToString(),n=this._map.get(t);if(!n)throw new Error("segmentInfo not found in the map for the given SegmentCoord");return n}},{key:"removeSegmentInfo",value:function(e){var t=e.viewToString();this._map.delete(t)}}]),e}();t.default=d,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,n){function r(e,t){if(n.isP2PUploadOn&&!n.isP2PUploadBlocked){var r=a.getSegmentHandler(t).chunkManager;if(r&&r.getPercentageOfChunksDownloaded()>=n.conf.MIN_CHUNK_PERCENTAGE_DOWNLOADED_FOR_HAS_SEGMENT_ANSWER){var o=i.getSegmentInfo(t);e.answerHasSegment(o,{pushed:!1})}}}var i=e,a=t;n.eventBus.on("segmentRequested",r)};t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(39),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(124),c=r(d),f=n(21),_=r(f),h=n(187),p=r(h),g=n(217),v=r(g),m=n(214),E=r(m),y=n(213),T=r(y),S=n(212),C=r(S),A=n(216),D=r(A),I=n(215),R=r(I),O=n(211),P=r(O),b=n(93),w=r(b),M=n(86),L=r(M),N=n(181),k=r(N),x=n(224),U=r(x),F=n(49),B=r(F),H=n(200),j=r(H),G=n(2),K=r(G),V=n(234),W=n(230),q=n(238),Y={WS:"ws",WSS:"wss",HTTPS:"https",HTTP:"http"},z=function(){function e(t,n,r,i,o,u,l){(0,s.default)(this,e),this._p2pDownloadBlockExpirationTimestamp=a.default,this._p2pUploadBlockExpirationTimestamp=a.default;var d=B.default.deepCopy(L.default);this.p2pConfig=t,(0,V.overloadP2PConfig)(d,t,r),this.conf=d;var f=(0,W.formatContentId)({contentId:t.contentId,contentUrl:n});this.eventBus=new _.default,this.workerHelper=new U.default,this.moduleState=new k.default(this.eventBus,i,l),this.moduleState.content=f,this.isP2PDownloadOn=!0,this.isP2PUploadOn=!0,this.peerToken=c.default.v4(),this.status=new p.default,this.statsProvider=new w.default,this.peerStats=new D.default(this.statsProvider),this.transferStats=new v.default,this.efficiencyStats=new E.default,this.controlStats=new T.default,this.mediaStats=new R.default(i,o,u),this.abrStats=new P.default(this.eventBus),this.bufferStats=new C.default(this.eventBus),this._backendManager=new j.default(this.conf,this.eventBus)}return(0,l.default)(e,[{key:"blockP2PDownload",value:function(e){var t=Date.now()+e;return t>this._p2pDownloadBlockExpirationTimestamp&&(this._p2pDownloadBlockExpirationTimestamp=t,!0)}},{key:"unblockP2PDownload",value:function(){this._p2pDownloadBlockExpirationTimestamp=a.default}},{key:"blockP2PUpload",value:function(e){var t=Date.now()+e;return t>this._p2pUploadBlockExpirationTimestamp&&(this._p2pUploadBlockExpirationTimestamp=t,!0)}},{key:"unblockP2PUpload",value:function(){this._p2pUploadBlockExpirationTimestamp=a.default}},{key:"injectConfigFromDistributor",value:function(e){e.configuration&&((0,V.overloadConfigFromDistributor)(this.conf,e.configuration,e.isClustered),this.eventBus.emit(K.default.Config.CONFIG_UPDATED));var t=this.conf.BACKEND_USE_SSL?Y.HTTPS:Y.HTTP,n=this.conf.BACKEND_USE_SSL?Y.WSS:Y.WS;this.conf.TRACKER_URL=(0,q.formatUrl)(t+"://"+e.trackerDns),this.conf.ANALYTICS.KLARA_URL=(0,q.formatUrl)(t+"://"+e.klaraDns),this.conf.SIGNALING_URL=(0,q.formatUrl)(n+"://"+e.signalingDns),this.status.setBearerToken(e.token),this._decideIfQOSTester(),null!=e.contentActivated&&(this.conf.CONTENT_ACTIVATED=e.contentActivated)}},{key:"setBackendFallbackUrls",value:function(){var e=this.conf.FALLBACK_URLS;this.conf.ANALYTICS.KLARA_URL=(0,q.formatUrl)(e.KLARA_URL),this._decideIfQOSTester()}},{key:"_decideIfQOSTester",value:function(){var e=this.moduleState.isLive()?this.conf.LIVE.QOS_REF_PERCENTAGE:this.conf.QOS_REF_PERCENTAGE;e===parseFloat(e,3)&&100*Math.random()<e&&(this.conf.QOS_P2P_DISABLED=!0)}},{key:"dispose",value:function(){this.workerHelper.dispose(),this._backendManager.dispose()}},{key:"isP2PDownloadBlocked",get:function(){return Date.now()<this._p2pDownloadBlockExpirationTimestamp}},{key:"isP2PUploadBlocked",get:function(){return Date.now()<this._p2pUploadBlockExpirationTimestamp}}]),e}();t.default=z,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,r){var i=t.transferStats,a=i.cdnDownloaded,o=i.p2pUseful,s=i.p2pUploaded,u=e?e.getPeerArray().length:0,l={cdn:a,p2p:o,peers:u,upload:s,confLabel:""};if(t.conf.ANALYTICS.EXPOSE_CONF_LABEL){var d=t.conf.QOS_P2P_DISABLED?"off":"on";l.confLabel=t.conf.CONF_LABEL+"|"+d}return l}Object.defineProperty(t,"__esModule",{value:!0});var a=n(252),o=(r(a),n(123));r(o),n(4),t.default={get:i},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(208),l=r(u),d=n(46),c=n(179),f=r(c),_=function(){function e(t,n){(0,a.default)(this,e),this._externalEventManager=t,this._externalEventManager.cacheMediaEvent(f.default.TRACK_CHANGE_EVENT),this._sharedState=n}return(0,s.default)(e,[{key:"listenEvents",value:function(e){var t=this._updateCurrentTracks.bind(this),n=this._onFragLoadAborted.bind(this);this._externalEventManager.addMediaEventListener(f.default.TRACK_CHANGE_EVENT,t),this._externalEventManager.addMediaEventListener(f.default.EMERGENCY_FRAG_LOAD_ABORT,n);try{this._externalEventManager.triggerCachedEvent(f.default.TRACK_CHANGE_EVENT,t)}catch(t){if(!e)throw t}}},{key:"_onFragLoadAborted",value:function(){this._sharedState.mediaStats.emergencyTrackSwitchCount++}},{key:"_updateCurrentTracks",value:function(e){var t=e.audio,n=e.video;t&&(0,d.checkInterface)(l.default,t),n&&(0,d.checkInterface)(l.default,n),this._sharedState.moduleState.currentTracks.update({audio:t,video:n})}},{key:"updateWithSegmentView",value:function(e){var t={};t[e.trackView.type]=e.trackView,this._updateCurrentTracks(t)}}]),e}();t.default=_,e.exports=t.default},function(e,t,n){"use strict";function r(e){var t=!1;e.eventBus.on(a.default.BufferedAmountObserver.BUFFER_CHECK,function(n){n<=e.conf.BUFFER_ZERO_THRESHOLD?t=!1:!t&&n>e.conf.VOD_CRITICAL_BUFFER_THRESHOLD&&(t=!0),t&&n<e.conf.VOD_CRITICAL_BUFFER_THRESHOLD?e.blockP2PDownload(e.conf.VOD_CRITICAL_BUFFER_P2P_STOP_DURATION):n>e.conf.VOD_SAFE_BUFFER_THRESHOLD&&e.unblockP2PDownload()})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(2),a=function(e){return e&&e.__esModule?e:{default:e}}(i);e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(47),l=n(2),d=r(l),c=n(196),f=r(c),_=n(193),h=r(_),p=n(195),g=r(p),v=n(194),m=r(v),E=n(4),y=n(25),T=function(){function e(t,n,r){(0,a.default)(this,e),this._peerCount=0,this._bufferTarget=0,this._bufferedAmount=0,this._randomBufferLevel=null,this._reachedLiveEdge=!1,this._enableDynamicLowerTarget=!1,this._bufferTargetState=g.default.INIT,this._bufferStatus=m.default.ZERO,this._lastLowToModerateBufferTimestamp=null,this._droppedUnderLow=!1,this._reboundCount=0,this._netLowTargetChange=0,this._targetGapSamplerTimeout=null,this._sharedState=r,this._playerInterface=t,this._mediaElementPlaceholder=n,this._bufferStateMachine=new h.default(r.eventBus),this._sharedState.eventBus.on(d.default.Scheduler.REACHED_LIVE_EDGE_STATE_CHANGED,this._onLiveEdgeChanged.bind(this)),this._sharedState.eventBus.on(d.default.SRModuleInterface.UNCOMPLETE_SEGMENT_REQUESTED,this._onUncompleteSegmentRequested.bind(this)),this._sharedState.eventBus.on(d.default.PeerPool.PEER_OPEN,this._onPeerCountChanged.bind(this)),this._sharedState.eventBus.on(d.default.PeerPool.PEER_DESTROYED,this._onPeerCountChanged.bind(this)),this._sharedState.eventBus.on(d.default.BufferedAmountObserver.BUFFER_CHECK,this._bufferCheck.bind(this)),this._sharedState.eventBus.on(d.default.Distributor.READY,this._resetDynamicBufferLevels.bind(this)),this._currentLowerBufferTarget=this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET,this._uploadCapacityCalculator=new f.default(this._sharedState),this._sampleTargetGap(0)}return(0,s.default)(e,[{key:"_sampleTargetGap",value:function(e){this._sharedState.bufferStats.sampledHighLowBufferTargetGap=this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET-this._currentLowerBufferTarget;var t=Math.random()*this._sharedState.conf.ANALYTICS.STATS_INTERVAL;this._targetGapSamplerTimeout=(0,E.createTimeout)(this._sampleTargetGap.bind(this,this._sharedState.conf.ANALYTICS.STATS_INTERVAL-t),e+t)}},{key:"_onUncompleteSegmentRequested",value:function(){this._isLowBufferTarget()&&(this._sharedState.eventBus.emit(d.default.BufferManager.LOW_BUFFER,this._bufferedAmount),this._setHighTarget())}},{key:"_onLiveEdgeChanged",value:function(e){this._reachedLiveEdge=e&&(this._sharedState.moduleState.streamType!==u.StreamTypes.SMOOTH||this._bufferedAmount>this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET-3)}},{key:"_onPeerCountChanged",value:function(e){var t=e.peerCount;this._peerCount=t}},{key:"_bufferCheck",value:function(e){this._bufferedAmount=e,0===this._peerCount?(this._bufferStateMachine.gotoNoPeer(),this._setHighTarget()):this._uploadCapacityCalculator.uploadCapacityEMWA>=this._sharedState.conf.LIVE.UPLOAD_THRESHOLD_MAX_BUFFER_TARGET_LOCKING?(this._bufferStateMachine.gotoTopSeeder(),this._setHighTarget()):null!==this._mediaElementPlaceholder.mediaElement?(this._bufferStateMachine.gotoDynamic(),this._dynamicBufferCheck()):(this._bufferStateMachine.gotoRandom(),this._setRandomTarget());var t=void 0;t=this._reachedLiveEdge||this._bufferedAmount>this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET?m.default.HIGH:this._bufferedAmount>this._currentLowerBufferTarget?m.default.MODERATE:this._bufferedAmount>this._sharedState.conf.LIVE.CRITICAL_LOWER_TARGET_RATIO*this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET?m.default.LOW:this._bufferedAmount>this._sharedState.conf.BUFFER_ZERO_THRESHOLD?m.default.CRITICALLY_LOW:m.default.ZERO,this._bufferedAmount<this._currentLowerBufferTarget&&this._reachedLiveEdge?this._sharedState.bufferStats.timeLowerTargetAboveLiveEdgeStaircase.updateMetric(1):this._sharedState.bufferStats.timeLowerTargetAboveLiveEdgeStaircase.updateMetric(0),this._bufferStatus!==t&&(this._bufferStatusChanged(this._bufferStatus,t),this._bufferStatus=t)}},{key:"_bufferStatusChanged",value:function(e,t){if(this._sharedState.conf.LIVE.ENABLE_DYNAMIC_LOWER_TARGET){if(t===m.default.CRITICALLY_LOW&&this._enableDynamicLowerTarget&&this._adjustLowerTarget((this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET-this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET)*this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET_INCREASE_STEP),e!==m.default.CRITICALLY_LOW&&e!==m.default.LOW||t!==m.default.MODERATE&&t!==m.default.HIGH||(this._lastLowToModerateBufferTimestamp=Date.now()),e!==m.default.MODERATE&&e!==m.default.HIGH||t!==m.default.CRITICALLY_LOW&&t!==m.default.LOW||(this._droppedUnderLow=!0),t===m.default.ZERO&&this._resetDynamicBufferLevels(),t===m.default.HIGH){if(this._enableDynamicLowerTarget=!0,null!=this._lastLowToModerateBufferTimestamp){var n=(Date.now()-this._lastLowToModerateBufferTimestamp)/1e3;this._lastLowToModerateBufferTimestamp=null;var r=(this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET-this._currentLowerBufferTarget)*this._sharedState.conf.LIVE.FAST_BUFFER_FILL_FRACTION;(n<=r||0===r)&&this._adjustLowerTarget(-(this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET-this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET)*this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET_DECREASE_STEP)}this._droppedUnderLow&&this._reboundCount++}this._reboundCount>0&&(this._sharedState.bufferStats.lowerBufferTargetNetChangePerRebound=this._netLowTargetChange/this._reboundCount)}}},{key:"_resetDynamicBufferLevels",value:function(){this._enableDynamicLowerTarget&&this._sharedState.bufferStats.lowerTargetResetCount++;var e=this._isLowBufferTarget();this._enableDynamicLowerTarget=!1,this._currentLowerBufferTarget=this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET,this._droppedUnderLow=!1,e&&this._setLowTarget()}},{key:"_adjustLowerTarget",value:function(e){var t=this._currentLowerBufferTarget,n=this._isLowBufferTarget();this._currentLowerBufferTarget=(0,y.clamp)(this._currentLowerBufferTarget+e,this._sharedState.conf.LIVE.CRITICAL_LOWER_TARGET_RATIO*this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET,this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET),this._netLowTargetChange+=Math.abs(t-this._currentLowerBufferTarget),n&&this._setLowTarget()}},{key:"_dynamicBufferCheck",value:function(){this._isHighBufferTarget()?(this._bufferedAmount>=this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET||this._reachedLiveEdge)&&(this._sharedState.eventBus.emit(d.default.BufferManager.HIGH_BUFFER,this._bufferedAmount),this._setLowTarget()):this._isLowBufferTarget()||this._setHighTarget()}},{key:"_bufferTargetStateChanged",value:function(e){e!==this._bufferTargetState&&(this._bufferTargetState===g.default.LOW&&e===g.default.HIGH?this._sharedState.blockP2PDownload(this._sharedState.conf.LIVE.LOW_TARGET_P2P_DL_BLOCK_DURATION):this._bufferTargetState===g.default.HIGH&&e===g.default.LOW&&this._sharedState.unblockP2PDownload(),this._bufferTargetState=e)}},{key:"_setRandomTarget",value:function(){this._bufferTargetStateChanged(g.default.RANDOM),this._bufferTarget=this._getRandomBufferLevel(),this._playerInterface.setBufferMarginLive(this._bufferTarget)}},{key:"_setHighTarget",value:function(){this._bufferTargetStateChanged(g.default.HIGH),this._bufferTarget=this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET,this._playerInterface.setBufferMarginLive(this._bufferTarget)}},{key:"_setLowTarget",value:function(){this._bufferTargetStateChanged(g.default.LOW),this._bufferTarget=this._currentLowerBufferTarget,this._playerInterface.setBufferMarginLive(this._bufferTarget)}},{key:"_isLowBufferTarget",value:function(){return this._bufferTarget===this._currentLowerBufferTarget}},{key:"_isHighBufferTarget",value:function(){return this._bufferTarget===this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET}},{key:"_getRandomBufferLevel",value:function(){return this._randomBufferLevel=this._randomBufferLevel||Math.floor(Math.random()*(this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET-this._currentLowerBufferTarget+1))+this._currentLowerBufferTarget,this._randomBufferLevel}},{key:"dispose",value:function(){this._uploadCapacityCalculator.dispose(),this._targetGapSamplerTimeout&&this._targetGapSamplerTimeout.clear()}},{key:"bufferTarget",get:function(){return this._bufferTarget}},{key:"bufferedAmount",get:function(){return this._bufferedAmount}},{key:"mediaElementPlaceholder",set:function(e){this._mediaElementPlaceholder=e}},{key:"reachedLiveEdge",get:function(){return this._reachedLiveEdge}}]),e}();t.default=T,e.exports=t.default},function(e,t,n){"use strict";(function(n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,r){var i=r.status,a=function(){for(var n={download:{p2pUseful:r.transferStats.p2pUseful,p2pUploaded:r.transferStats.p2pUploaded,cdnDownloaded:r.transferStats.cdnDownloaded,dlSpeed:i.getDlSpeed(),upSpeed:i.getUpSpeed(),p2pDownloaded:r.transferStats.p2pUseful,p2pDownloadedNewAnalytics:r.transferStats.p2pUseful},peers:{count:0},buffer:{bufferTarget:t?t.bufferTarget:0,bufferedAmount:r.bufferStats.bufferedAmount,reachedLiveEdge:t?t._reachedLiveEdge:void 0},tracker:{connected:i.getConnected()},trackerConnected:i.getConnected(),sigConnected:i.getConnectedToSignalingServer(),isLive:r.moduleState.isLive()},a=[],o=0;o<e.getPeerArray().length;o++){var s=e.getPeerArray()[o];s.getId()&&n.peers.count++,a.push(s.getDebugInfos())}return n.peerList=a,n};!function(){console.warn("SR_DISPLAY_INTERFACE is deprecated, use Streamroot.PeerAgents[<id>] instead."),n.SR_DISPLAY_INTERFACE={getStats:a}}(),this.dispose=function(){delete window.SR_DISPLAY_INTERFACE}};t.default=r,e.exports=t.default}).call(t,n(84))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,[{key:"getSegmentTime",value:function(e){}},{key:"getSegmentList",value:function(e,t,n){}},{key:"getTrackList",value:function(){}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,r){return r.moduleState.streamType===l.StreamTypes.HLS?new o.default(e,t,n,r):new u.default(e,t,n,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.createScheduler=i;var a=n(210),o=r(a),s=n(209),u=r(s),l=n(47)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=function(e){return e&&e.__esModule?e:{default:e}}(r),a=function(e,t){function n(e,t){var n=r.getSegmentHandler(t.segmentCoord).chunkManager;n&&n.getChunk(t.chunkIndex,function(n){n?e.onChunkFound(t,n):e.onChunkMissed()})}var r=e;t.eventBus.on(i.default.UploadQueue.CHUNK_REQUESTED,n)};t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){window.Streamroot=window.Streamroot||{},window.Streamroot.Downloader=window.Streamroot.Downloader||e,window.Streamroot.peerAgents=window.Streamroot.peerAgents||{},window.Streamroot.uaHelper=d.default,Object.defineProperty(window.Streamroot,"p2pAvailable",{get:function(){var e=(0,u.default)(window.Streamroot.peerAgents);return e.length?window.Streamroot.peerAgents[e[0]].isP2PEnabled:(0,c.isP2PAvailable)()}})}function a(e,t){window.Streamroot.peerAgents&&(window.Streamroot.peerAgents[e]=t.PublicAPI)}function o(e){window.Streamroot.peerAgents[e]&&delete window.Streamroot.peerAgents[e]}Object.defineProperty(t,"__esModule",{value:!0});var s=n(52),u=r(s),l=n(36),d=r(l),c=n(85);t.default={setup:i,addToPeerAgentList:a,removeFromPeerAgentList:o},e.exports=t.default},function(e,t,n){"use strict";function r(e){var t=e.version,n={version:t,get isP2PEnabled(){return e.isP2PEnabled},get stats(){return e.stats},get p2pDownloadOn(){return e.p2pDownloadOn},set p2pDownloadOn(t){e.p2pDownloadOn=t},get p2pUploadOn(){return e.p2pUploadOn},set p2pUploadOn(t){e.p2pUploadOn=t}};return n}Object.defineProperty(t,"__esModule",{value:!0}),t.default={get:r},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(62),l=r(u),d=function(){function e(t){(0,a.default)(this,e),this._sharedState=t,this._analyticsClient=new l.default(t,"p2pconfig")}return(0,s.default)(e,[{key:"sendConfig",value:function(){var e={};e.activateP2P=this._sharedState.conf.ALLOW_P2P,e.debug=this._sharedState.p2pConfig.debug||!1,e.deviceInfo=this._sharedState.conf.DEVICE_INFO,e.trackerUrl=this._sharedState.conf.TRACKER_URL,e.backendUrl=this._sharedState.conf.DISTRIBUTOR.URL,e.signalingUrl=this._sharedState.conf.SIGNALING_URL,e.analyticsUrl=this._sharedState.conf.ANALYTICS.KLARA_URL,e.vodCacheSize=this._sharedState.conf.P2P_CACHE_MAX_SIZE/1048576,e.liveCacheSize=this._sharedState.conf.LIVE.P2P_CACHE_MAX_SIZE/1048576,e.rangeRequestEnabled=this._sharedState.conf.RANGE_REQUEST_ALLOWED,e.mobileBrowserEnabled=this._sharedState.conf.ENABLE_MOBILE_BROWSER,e.enableStunServers=this._sharedState.conf.ENABLE_STUN;var t={live:this._sharedState.moduleState.isLive(),p2pConfig:e};this._analyticsClient.send(t)}}]),e}();t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(2),l=r(u),d=n(4),c=100,f=function(){
function e(t,n){(0,a.default)(this,e),this._tickInterval=null,this._sharedState=n,null===t.mediaElement||this._sharedState.moduleState.isLive()||(this._mediaElement=t.mediaElement,this._tickInterval=(0,d.createInterval)(this._tick.bind(this),c))}return(0,s.default)(e,[{key:"_tick",value:function(){if(null!==this._mediaElement){var e=this._mediaElement.duration,t=this._mediaElement.currentTime;e&&e-t<.3&&(null!==this._tickInterval&&(this._tickInterval.clear(),this._tickInterval=null),this._sharedState.eventBus.emit(l.default.Media.ENDED))}}},{key:"dispose",value:function(){null!==this._tickInterval&&this._tickInterval.clear()}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(48),l=r(u),d=n(5),c=r(d),f=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,null,[{key:"send",value:function(e,t,n){var r=n.conf,i=n.status,a={timeout:r.ANALYTICS.TIMEOUT_DELAY,retry:r.ANALYTICS.RETRY_NUMBER,retryDelay:r.ANALYTICS.RETRY_DELAY,headers:{Authorization:i.getBearerToken(),"Content-Type":"application/json;charset=UTF-8"}},o=new l.default(l.default.Methods.POST,e,a);o.isStreamroot=!0,o.send(t).catch(function(e){c.default.notifyError(new Error("Could not send analytics payload: "+e.message+". Status: "+e.status))})}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(t){(0,a.default)(this,e),this._sharedState=t,this._init()}return(0,s.default)(e,[{key:"_init",value:function(){var e=this;this.reset(),this._sharedState.eventBus.on("p2pUploadToggle",function(t){t||(e._p2pUploadAlwaysOn=!1)}),this._sharedState.eventBus.on("p2pDownloadToggle",function(t){t||(e._p2pDownloadAlwaysOn=!1)})}},{key:"reset",value:function(){this._p2pDownloadAlwaysOn=this._sharedState.isP2PDownloadOn,this._p2pUploadAlwaysOn=this._sharedState.isP2PUploadOn}},{key:"p2pDownloadAlwaysOn",get:function(){return this._p2pDownloadAlwaysOn}},{key:"p2pUploadAlwaysOn",get:function(){return this._p2pUploadAlwaysOn}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(66),l=r(u),d=n(25),c=n(2),f=r(c),_=function(){function e(t){(0,a.default)(this,e),this._peerCountStaircaseFunctionIntegral=new l.default,this._sameTrackPeerCountStaircaseFunctionIntegral=new l.default,this._abovePeerPoolLimitPeerCount=new l.default,this._abovePeerPoolLimitTime=new l.default,this._sharedState=t,t.eventBus.on(f.default.PeerPool.PEER_STATS_UPDATE,this._processPeerPoolStats,this),t.eventBus.on(f.default.PeerPool.PEER_OPEN,this._trackPeerCount,this),t.eventBus.on(f.default.PeerPool.PEER_DESTROYED,this._trackPeerCount,this)}return(0,s.default)(e,[{key:"_trackPeerCount",value:function(e){var t=e.peerCount,n=Math.max(0,t-this._sharedState.conf.PEER_POOL_LIMIT);this._abovePeerPoolLimitPeerCount.updateMetric(n),this._abovePeerPoolLimitTime.updateMetric(n>0?1:0)}},{key:"_processPeerPoolStats",value:function(e){var t=e.peerCount,n=e.sameTrackPeerCount;this._peerCountStaircaseFunctionIntegral.updateMetric(t),this._sameTrackPeerCountStaircaseFunctionIntegral.updateMetric(n)}},{key:"getAveragePeerCount",value:function(){return(0,d.toDecimal)(this._peerCountStaircaseFunctionIntegral.getAverage(),2)}},{key:"getSameTrackPeerCount",value:function(){return(0,d.toDecimal)(this._sameTrackPeerCountStaircaseFunctionIntegral.getAverage(),2)}},{key:"getUncorrectedAverageAboveLimitPeerCount",value:function(){return this._abovePeerPoolLimitPeerCount.getAverage()}},{key:"getAbovePeerPoolLimitTime",value:function(){return this._abovePeerPoolLimitTime.getIntegral().value}}]),e}();t.default=_,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(18),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(62),c=r(d),f=n(160),_=r(f),h=n(159),p=r(h),g=n(17),v=n(25),m=n(164),E=r(m),y=function(){function e(t,n){(0,s.default)(this,e);var r=n.conf,i=n.moduleState,a=n.status,o=n.transferStats,u=n.efficiencyStats,l=n.controlStats,d=n.bufferStats,f=n.abrStats;this._conf=r,this._status=a,this._transferStats=o,this._efficiencyStats=u,this._controlStats=l,this._abrStats=f,this._moduleState=i,this._bufferStats=d,this._analyticsClient=new c.default(n,"stats"),this._peerStats=n.peerStats,this._mediaStats=n.mediaStats,this._sessionStartTime=Date.now(),this._p2pUseful=new g.Delta,this._cdnDownloaded=new g.Delta,this._p2pConsumed=new g.Delta,this._cdnConsumed=new g.Delta,this._p2pMediaDownloaded=new g.Delta,this._p2pMessagesDownloaded=new g.Delta,this._p2pHeadersDownloaded=new g.Delta,this._p2pMessagesCount=new g.Delta,this._p2pUploaded=new g.Delta,this._PP=new g.Delta,this._PC=new g.Delta,this._CP=new g.Delta,this._CC=new g.Delta,this._HP=new g.Delta,this._HD=new g.Delta,this._M=new g.Delta,this._total=new g.Delta,this._concurrentP2pDownloaded=new g.Delta,this._concurrentP2pDownloadCount=new g.Delta,this._cdnEstimationCount=new g.Delta,this._p2pSpeedWindowsCount=new g.Delta,this._zeroP2pSpeedWindowsCount=new g.Delta,this._peerPoolObserver=new _.default(n),this._optionsObserver=new p.default(n),this._receivedChunkRequest=new g.Delta,this._missedDequeuedChunkRequest=new g.Delta,this._dequeuedReceivedChunkRequest=new g.Delta,this._sentSafeChunkRequest=new g.Delta,this._sentUnsafeChunkRequest=new g.Delta,this._timeoutSentSafeChunkRequest=new g.Delta,this._timeoutSentUnsafeChunkRequest=new g.Delta,this._gracedChunk=new g.Delta,this._expiredGraceChunk=new g.Delta,this._openedMatch=new g.Delta,this._openedOffer=new g.Delta,this._match=new g.Delta,this._excessMatch=new g.Delta,this._unansweredOffer=new g.Delta,this._offer=new g.Delta,this._active=new g.Delta,this._transfer=new g.Delta,this._denied=new g.Delta,this._droppedSameTrack=new g.Delta,this._droppedOtherTrack=new g.Delta,this._offerTimeout=new g.Delta,this._answerTimeout=new g.Delta,this._timeoutNewConnection=new g.Delta,this._timeoutCheckingConnection=new g.Delta,this._timeoutFailedConnection=new g.Delta,this._timeoutNewIce=new g.Delta,this._timeoutGatheringIce=new g.Delta,this._timeoutCompleteIce=new g.Delta,this._disconnected=new g.Delta,this._lateMessage=new g.Delta,this._timeoutLocalSdp=new g.Delta,this._timeoutRemoteSdp=new g.Delta,this._timeoutLocalSdpWithStun=new g.Delta,this._timeoutRemoteSdpWithStun=new g.Delta,this._timeoutWithLocalStunIce=new g.Delta,this._timeoutWithRemoteStunIce=new g.Delta,this._missedIceCandidate=new g.Delta,this._gatheredIceCandidate=new g.Delta,this._iceCandidatesBucket=new g.Delta,this._earlyIceGatheringFinished=new g.Delta,this._p2pSgtCheckSuccess=new g.Delta,this._p2pSgtCheckFail=new g.Delta,this._hybridSgtCheckSuccess=new g.Delta,this._hybridSgtCheckFail=new g.Delta,this._checkHeartbeatFailed=new g.Delta,this._getSegmentSuccess=new g.Delta,this._getSegmentFallback=new g.Delta,this._segmentLockTimeout=new g.Delta,this._fillSegmentSuccess=new g.Delta,this._fillSegmentFallback=new g.Delta,this._fillSegmentTimeout=new g.Delta,this._counterControl=0,this._sentOfferSdpVolume=new g.Delta,this._sentAnswerSdpVolume=new g.Delta,this._sentIceCandidatesVolune=new g.Delta,this._signalingMessageCount=new g.Delta,this._sentDistributorRootCount=new g.Delta,this._sentTrackerInitCount=new g.Delta,this._sentTrackerPeersCount=new g.Delta,this._sentTrackerTracksCount=new g.Delta,this._timeSpentOnEdge=new g.Delta,this._timeSpentStatic=new g.Delta,this._timeSpentLow=new g.Delta,this._timeSpentHigh=new g.Delta,this._bufferedAmount=new g.Delta,this._bufferRefill=new g.Delta,this._lowerTargetResetCount=new g.Delta,this._abortFragmentCount=new g.Delta,this._emergencyTrackSwitchCount=new g.Delta,this._qosAnalyticsHandler=new E.default(t,n),this._feebackCount=new g.Delta,this._zeroDurationFeedbackCount=new g.Delta,this._lastPayloadTimestamps={},this._trackSwitchWithPeers=new g.Delta,this._sharedState=n}return(0,l.default)(e,[{key:"_getSessionDuration",value:function(){return Date.now()-this._sessionStartTime}},{key:"_getTimespanSinceLastPayload",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";return isNaN(this._lastPayloadTimestamps[e])?this._getSessionDuration():Date.now()-this._lastPayloadTimestamps[e]}},{key:"_updateLastPayloadTimestamp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";this._lastPayloadTimestamps[e]=Date.now()}},{key:"_getPeerStats",value:function(){var e=this._peerPoolObserver.getUncorrectedAverageAboveLimitPeerCount(),t=this._peerPoolObserver.getAbovePeerPoolLimitTime(),n=this._peerStats.dataChannelBufferEmptyingStats.fetchSample();return e=t>0?e*this._getTimespanSinceLastPayload()/t:0,{count:this._peerPoolObserver.getAveragePeerCount(),sameTrackCount:this._peerPoolObserver.getSameTrackPeerCount(),match:this._match.calcDelta(this._peerStats.match),excessMatch:this._excessMatch.calcDelta(this._peerStats.excessMatch),openedMatch:this._openedMatch.calcDelta(this._peerStats.openedMatch),openedOffer:this._openedOffer.calcDelta(this._peerStats.openedOffer),unansweredOffer:this._unansweredOffer.calcDelta(this._peerStats.unansweredOffer),offer:this._offer.calcDelta(this._peerStats.offer),locked:this._peerStats.locked.getAverage(),loosers:this._peerStats.loosers.getAverage(),active:this._active.calcDelta(this._peerStats.active),transfer:this._transfer.calcDelta(this._peerStats.transfer),denied:this._denied.calcDelta(this._peerStats.denied),droppedSameTrack:this._droppedSameTrack.calcDelta(this._peerStats.droppedSameTrack),droppedOtherTrack:this._droppedOtherTrack.calcDelta(this._peerStats.droppedOtherTrack),offerTimeout:this._offerTimeout.calcDelta(this._peerStats.offerTimeout),answerTimeout:this._answerTimeout.calcDelta(this._peerStats.answerTimeout),timeoutNewConnection:this._timeoutNewConnection.calcDelta(this._peerStats.timeoutNewConnection),timeoutCheckingConnection:this._timeoutCheckingConnection.calcDelta(this._peerStats.timeoutCheckingConnection),timeoutFailedConnection:this._timeoutFailedConnection.calcDelta(this._peerStats.timeoutFailedConnection),timeoutNewIce:this._timeoutNewIce.calcDelta(this._peerStats.timeoutNewIce),timeoutGatheringIce:this._timeoutGatheringIce.calcDelta(this._peerStats.timeoutGatheringIce),timeoutCompleteIce:this._timeoutCompleteIce.calcDelta(this._peerStats.timeoutCompleteIce),disconnected:this._disconnected.calcDelta(this._peerStats.disconnected),lateMessage:this._lateMessage.calcDelta(this._peerStats.lateMessage),sampledPUC:this._peerStats.sampledPUC,peerPoolUploadCapacity:this._peerStats.peerPoolUploadCapacity.getAverage(),exclusionSize:this._peerStats.exclusionSize,successPeerConnectionAttemptDuration:this._peerStats.successPeerConnectionAttemptDuration.fetchSample()||0,failedPeerConnectionAttemptDuration:this._peerStats.failedPeerConnectionAttemptDuration.fetchSample()||0,dataChannelBufferEmptyingTime:n?n.time:0,dataChannelBufferEmptyingAmount:n?n.amount:0,timeSpentAbovePeerLimit:t,averageOverLimitPeerCount:e,timeoutLocalSdp:this._timeoutLocalSdp.calcDelta(this._peerStats.timeoutLocalSdp),timeoutRemoteSdp:this._timeoutRemoteSdp.calcDelta(this._peerStats.timeoutRemoteSdp),timeoutLocalSdpWithStun:this._timeoutLocalSdpWithStun.calcDelta(this._peerStats.timeoutLocalSdpWithStun),timeoutRemoteSdpWithStun:this._timeoutRemoteSdpWithStun.calcDelta(this._peerStats.timeoutRemoteSdpWithStun),timeoutWithLocalStunIce:this._timeoutWithLocalStunIce.calcDelta(this._peerStats.timeoutWithLocalStunIce),timeoutWithRemoteStunIce:this._timeoutWithRemoteStunIce.calcDelta(this._peerStats.timeoutWithRemoteStunIce)}}},{key:"_getBufferStats",value:function(){if(this._bufferStats){var e=(0,v.toDecimal)(this._bufferStats.getTimeSpentOnEdgeRatio(),2),t=(0,v.toDecimal)(this._bufferStats.getTimeSpentWithoutPeerRatio(),2),n=(0,v.toDecimal)(this._bufferStats.getTimeSpentTopSeederRatio(),2),r=this._bufferStats.getTimeSpentDynamicIntegral(),i=r.intervalLength?(0,v.toDecimal)(r.value/r.intervalLength,2):(0,v.toDecimal)(r.value,2),a=(0,v.toDecimal)(1e3*this._bufferRefill.calcDelta(this._bufferStats.bufferRefill)/(r.value+this._bufferStats.bufferedAmount),2),o=this._bufferStats.alwaysDynamicBuffer,s=(0,v.toDecimal)(this._bufferStats.lowerBufferTargetNetChangePerRebound,2),u=this._bufferStats.sampledHighLowBufferTargetGap,l=(0,v.toDecimal)(this._bufferStats.timeLowerTargetAboveLiveEdgeStaircase.getAverage(),2);return{bufferState:this._bufferStats.bufferState,alwaysDynamicBuffer:o,timeSpentOnEdgeRatio:e,timeSpentWithoutPeerRatio:t,timeSpentDynamicRatio:i,timeSpentTopSeederRatio:n,bufferRefillRatio:a,lowerBufferTargetNetChangePerRebound:s,timeLowerTargetAboveLiveEdgeRatio:l,sampledHighLowBufferTargetGap:u,lowerTargetResetCount:this._lowerTargetResetCount.calcDelta(this._bufferStats.lowerTargetResetCount)}}}},{key:"_getAbrStats",value:function(){var e=this._abrStats.p2pUsefulEstimate,t=this._concurrentP2pDownloaded.calcDelta(this._abrStats.concurrentP2pDownloaded),n=this._concurrentP2pDownloadCount.calcDelta(this._abrStats.concurrentP2pDownloadCount),r=this._cdnEstimationCount.calcDelta(this._abrStats.cdnEstimationCount),i=this._p2pSpeedWindowsCount.calcDelta(this._abrStats.p2pSpeedWindowsCount),a=this._zeroP2pSpeedWindowsCount.calcDelta(this._abrStats.zeroP2pSpeedWindowsCount),o=this._abrStats.bandwidthEstimateCV,s=this._feebackCount.calcDelta(this._abrStats.feebackCount),u=this._zeroDurationFeedbackCount.calcDelta(this._abrStats.zeroDurationFeedbackCount),l=this._trackSwitchWithPeers.calcDelta(this._abrStats.trackSwitchWithPeers);return this._abrStats.flushBandwidthEstimates(),{p2pUsefulEstimate:e,concurrentP2pDownloaded:t,concurrentP2pDownloadCount:n,cdnEstimationCount:r,p2pSpeedWindowsCount:i,zeroP2pSpeedWindowsCount:a,bandwidthEstimateCV:o,feebackCount:s,zeroDurationFeedbackCount:u,trackSwitchWithPeers:l}}},{key:"_calculateStatsPayload",value:function(){var e=this._status.getConnectedToSignalingServer(),t=this._status.getConnected(),n=this._status.getTrackerVersion(),r=this._status.getTrackerId(),i={PP:this._transferStats.multipleDlPP,PC:this._transferStats.multipleDlPC,CP:this._transferStats.multipleDlCP,CC:this._transferStats.multipleDlCC,HP:this._transferStats.multipleDlHP,HD:this._transferStats.multipleDlHD,M:this._transferStats.multipleDlM},o=i.PP+i.PC+i.CP+i.CC+i.HP+i.HD+i.M,s=this._cdnDownloaded.calcDelta(this._transferStats.cdnDownloaded),u=s,l=this._p2pUseful.calcDelta(this._transferStats.p2pUseful),d=this._p2pConsumed.calcDelta(this._transferStats.p2pConsumed),c=this._cdnConsumed.calcDelta(this._transferStats.cdnConsumed),f=this._p2pMediaDownloaded.calcDelta(this._transferStats.p2pMediaDownloaded),_=this._p2pHeadersDownloaded.calcDelta(this._transferStats.p2pHeadersDownloaded),h=this._p2pMessagesDownloaded.calcDelta(this._transferStats.p2pMessagesDownloaded),p=this._p2pMessagesCount.calcDelta(this._transferStats.p2pMessagesCount),g=this._p2pUploaded.calcDelta(this._transferStats.p2pUploaded),m={p2pMediaDownloaded:f,p2pHeadersDownloaded:_,p2pMessagesDownloaded:h,p2pMessagesCount:p,cdnDownloaded:s,p2pUseful:l,cdnUseful:u,p2pConsumed:d,cdnConsumed:c,p2pUploaded:g,multipleDl:{PP:this._PP.calcDelta(i.PP),PC:this._PC.calcDelta(i.PC),CP:this._CP.calcDelta(i.CP),CC:this._CC.calcDelta(i.CC),HP:this._HP.calcDelta(i.HP),HD:this._HD.calcDelta(i.HD),M:this._M.calcDelta(i.M),total:this._total.calcDelta(o)}},E=this._receivedChunkRequest.calcDelta(this._efficiencyStats.receivedChunkRequestCount),y=this._dequeuedReceivedChunkRequest.calcDelta(this._efficiencyStats.dequeuedReceivedChunkRequestCount),T=this._missedDequeuedChunkRequest.calcDelta(this._efficiencyStats.missedDequeuedChunkRequestCount),S=this._sentSafeChunkRequest.calcDelta(this._efficiencyStats.safeChunkRequestCount),C=this._sentUnsafeChunkRequest.calcDelta(this._efficiencyStats.unsafeChunkRequestCount),A=this._timeoutSentSafeChunkRequest.calcDelta(this._efficiencyStats.safeChunkRequestTimeoutCount),D=this._timeoutSentUnsafeChunkRequest.calcDelta(this._efficiencyStats.unsafeChunkRequestTimeoutCount),I=this._getTimespanSinceLastPayload(),R=I>0?Math.round(E*this._conf.CHUNK_SIZE*8/I):0,O=I>0?Math.round((S+C)*this._conf.CHUNK_SIZE*8/I):0,P=this._gracedChunk.calcDelta(this._efficiencyStats.gracedChunksCount),b=this._expiredGraceChunk.calcDelta(this._efficiencyStats.expiredGraceChunksCount),w={receivedChunkRequestBitrate:R,sentChunkRequestBitrate:O,receivedChunkRequestsMissedRatio:y>0?(0,v.toDecimal)(T/y,2):0,sentSafeChunkRequests:S,sentUnsafeChunkRequests:C,sentSafeChunkRequestsTimeout:A,sentUnsafeChunkRequestsTimeout:D,uploadQueueExpirationRatio:E>0?(0,v.toDecimal)(1-y/E,2):0,gracedChunks:P,expiredGraceChunks:b},M=this._abortFragmentCount.calcDelta(this._mediaStats.abortFragmentCount),L=this._emergencyTrackSwitchCount.calcDelta(this._mediaStats.emergencyTrackSwitchCount),N={emergencyTrackSwitchCPM:L/(I/6e4)};this._qosAnalyticsHandler.initialized&&(N=(0,a.default)(N,this._qosAnalyticsHandler.getQoSAnalytics()));var k=this._moduleState.isAlwaysDvr&&this._moduleState.isLive();this._moduleState.resetIsAlwaysDvr();var x={transfers:m,efficiency:w,qos:N,peers:this._getPeerStats(),buffer:this._getBufferStats(),abr:this._getAbrStats(),live:this._moduleState.isLive(),signalingServerConnected:e,trackerConnected:t,trackerVersion:n,trackerId:r,sessionDuration:this._getSessionDuration(),timespan:I,options:{p2pDownloadAlwaysOn:this._optionsObserver.p2pDownloadAlwaysOn,p2pUploadAlwaysOn:this._optionsObserver.p2pUploadAlwaysOn},confLabel:this._conf.CONF_LABEL,qosTester:this._conf.QOS_P2P_DISABLED,mediaDuration:Math.round(this._mediaStats.duration),videoTrackCount:this._mediaStats.videoTrackCount,minBitrate:this._mediaStats.minBitrate,maxBitrate:this._mediaStats.maxBitrate,abortFragmentCount:M,isAlwaysDvr:k};return this._updateLastPayloadTimestamp(),this._optionsObserver.reset(),x}},{key:"_calculateControlPayload",value:function(){var e=this._missedIceCandidate.calcDelta(this._controlStats.missedIceCandidateCount),t=this._gatheredIceCandidate.calcDelta(this._controlStats.gatheredIceCandidateCount),n=this._iceCandidatesBucket.calcDelta(this._controlStats.iceCandidatesBucketCount),r=this._earlyIceGatheringFinished.calcDelta(this._controlStats.earlyIceGatheringFinishedCount),i=n>0?(0,v.toDecimal)(e/n,2):0,a=n>0?(0,v.toDecimal)(t/n,2):0,o=n>0?r/n:0,s=this._controlStats.getSampledIceGatheringDuration(),u=this._p2pSgtCheckSuccess.calcDelta(this._controlStats.nbRightHashP2P),l=this._p2pSgtCheckFail.calcDelta(this._controlStats.nbWrongHashP2P),d=this._hybridSgtCheckSuccess.calcDelta(this._controlStats.nbRightHashDLM),c=this._hybridSgtCheckFail.calcDelta(this._controlStats.nbWrongHashDLM),f=this._checkHeartbeatFailed.calcDelta(this._controlStats.checkHeartbeatFailed),_=this._getSegmentSuccess.calcDelta(this._controlStats.getSegmentSuccess),h=this._getSegmentFallback.calcDelta(this._controlStats.getSegmentFallback),p=this._segmentLockTimeout.calcDelta(this._controlStats.segmentLockTimeout),g=this._fillSegmentSuccess.calcDelta(this._controlStats.fillSegmentSuccess),m=this._fillSegmentFallback.calcDelta(this._controlStats.fillSegmentFallback),E=this._fillSegmentTimeout.calcDelta(this._controlStats.fillSegmentTimeout),y=this._sentOfferSdpVolume.calcDelta(this._controlStats.sentOfferSdpVolume),T=this._sentAnswerSdpVolume.calcDelta(this._controlStats.sentAnswerSdpVolume),S=this._sentIceCandidatesVolune.calcDelta(this._controlStats.sentIceCandidatesVolume),C=this._signalingMessageCount.calcDelta(this._controlStats.signalingMessagesCount),A=this._sentDistributorRootCount.calcDelta(this._controlStats.sentDistributorRootCount),D=this._sentTrackerInitCount.calcDelta(this._controlStats.sentTrackerInitCount),I=this._sentTrackerPeersCount.calcDelta(this._controlStats.sentTrackerPeersCount),R=this._sentTrackerTracksCount.calcDelta(this._controlStats.sentTrackerTracksCount),O={live:this._moduleState.isLive(),meanMissedIceCandidate:i,meanGatheredIceCandidate:a,earlyIceCandidateGatheringRatio:o,sampledIceGatheringDuration:s,p2pSgtCheckSuccess:u,p2pSgtCheckFail:l,hybridSgtCheckSuccess:d,hybridSgtCheckFail:c,checkHeartbeatFailed:f,getSegmentSuccess:_,getSegmentFallback:h,segmentLockTimeout:p,fillSegmentSuccess:g,fillSegmentFallback:m,fillSegmentTimeout:E,sessionDuration:this._getSessionDuration(),timespan:this._getTimespanSinceLastPayload("control"),confLabel:this._conf.CONF_LABEL,sentOfferSdpVolume:y,sentAnswerSdpVolume:T,sentIceCandidatesVolume:S,signalingMessagesCount:C,sentDistributorRootCount:A,sentTrackerInitCount:D,sentTrackerPeersCount:I,sentTrackerTracksCount:R};return this._updateLastPayloadTimestamp("control"),O}},{key:"sendStats",value:function(){var e=this._calculateStatsPayload();e.timespan<2*this._conf.ANALYTICS.STATS_INTERVAL&&this._analyticsClient.send(e)}},{key:"sendControl",value:function(){var e=this._calculateControlPayload();e.timespan<2*this._conf.ANALYTICS.CONTROL_INTERVAL&&this._analyticsClient.send(e,"control")}},{key:"dispose",value:function(){this._qosAnalyticsHandler.dispose()}}]),e}();t.default=y,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(62),l=r(u),d=n(17),c=n(2),f=r(c),_=function(){function e(t){var n=this;(0,a.default)(this,e);var r=t.moduleState,i=t.transferStats,o=t.eventBus;this._analyticsClient=new l.default(t,"traffic"),this._moduleState=r,this._transferStats=i,this._p2p=new d.Delta,this._cdn=new d.Delta,this._upload=new d.Delta,this._lastPayloadTimestamp=Date.now(),o.once(f.default.Media.ENDED,this.sendUsage.bind(this)),o.on(f.default.TrafficAnalytics.STOP_SENDING_USAGE,function(){n._disconnected=!0}),o.on(f.default.TrafficAnalytics.RESTART_SENDING_USAGE,function(){n._disconnected=!1})}return(0,s.default)(e,[{key:"_calculateUsagePayload",value:function(){var e=this._p2p.calcDelta(this._transferStats.p2pUseful),t=this._cdn.calcDelta(this._transferStats.cdnDownloaded),n=this._upload.calcDelta(this._transferStats.p2pUploaded),r=this._getTimespanSinceLastPayload(),i={live:this._moduleState.isLive(),cdn:t,p2p:e,upload:n,timespan:r};return this._updateLastPayloadTimestamp(),i}},{key:"_getTimespanSinceLastPayload",value:function(){return Date.now()-this._lastPayloadTimestamp}},{key:"_updateLastPayloadTimestamp",value:function(){this._lastPayloadTimestamp=Date.now()}},{key:"sendUsage",value:function(e){if(!this._disconnected){var t=this._calculateUsagePayload();e&&(t.unload=!0),this._analyticsClient.send(t,"usage")}}}]),e}();t.default=_,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(17),l=n(25),d=function(){function e(){(0,a.default)(this,e),this._timeSpentPlayingDelta=new u.Delta,this._timeSpentPausedDelta=new u.Delta,this._timeSpentRebufferingDelta=new u.Delta,this._timeSpentSeekingDelta=new u.Delta,this._timeSpentEndedDelta=new u.Delta,this._rebufferingCountDelta=new u.Delta,this._lastTimeDelta=new u.Delta(Date.now()),this._droppedFrameCountDelta=new u.Delta,this._trackSwitchCountDelta=new u.Delta}return(0,s.default)(e,[{key:"_normalizePerMinute",value:function(e,t,n){var r=this._lastTimeDelta.calcDelta(Date.now()),i=this._rebufferingCountDelta.calcDelta(e),a=i/(r/6e4),o=this._droppedFrameCountDelta.calcDelta(t),s=o/(r/6e4),u=this._trackSwitchCountDelta.calcDelta(n),d=u/(r/6e4);return{rebufferingCPM:(0,l.toDecimal)(a,2),droppedFrameCPM:(0,l.toDecimal)(s,2),trackSwitchCPM:(0,l.toDecimal)(d,2)}}},{key:"format",value:function(e,t){var n=this._normalizePerMinute(e.rebufferingCount,e.droppedFrameCount,t);return{rebufferingCPM:n.rebufferingCPM,droppedFrameCPM:n.droppedFrameCPM,trackSwitchCPM:n.trackSwitchCPM,timeSpentPlaying:(0,l.toDecimal)(this._timeSpentPlayingDelta.calcDelta(e.timeSpentPlaying),2),timeSpentPaused:(0,l.toDecimal)(this._timeSpentPausedDelta.calcDelta(e.timeSpentPaused),2),timeSpentEnded:(0,l.toDecimal)(this._timeSpentEndedDelta.calcDelta(e.timeSpentEnded),2),timeSpentRebuffering:(0,l.toDecimal)(this._timeSpentRebufferingDelta.calcDelta(e.timeSpentRebuffering),2),timeSpentSeeking:(0,l.toDecimal)(this._timeSpentSeekingDelta.calcDelta(e.timeSpentSeeking),2),startupTime:e.startupTime,endedOnce:e.endedOnce}}}]),e}();t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(123),l=r(u),d=n(163),c=r(d),f=n(4),_=n(2),h=r(_),p=function(){function e(t,n){(0,a.default)(this,e),this._trackSwitchCount=-1,n.eventBus.on(h.default.Metrics.TRACK_SWITCH,this._onTrackSwitch.bind(this)),null!==t.mediaElement&&(this._initialized=!0,this._qosAnalytics=new l.default(t.mediaElement,f.createInterval),this._qoSAnalyticsFormatter=new c.default)}return(0,s.default)(e,[{key:"_onTrackSwitch",value:function(){this._trackSwitchCount++}},{key:"getQoSAnalytics",value:function(){if(!this._initialized)throw new Error("getQoSAnalytics was called on non-initialized QoSAnalyticsHandler");var e=this._qosAnalytics.getQoSAnalytics();return this._qoSAnalyticsFormatter.format(e,this._trackSwitchCount)}},{key:"dispose",value:function(){this._qosAnalytics&&this._qosAnalytics.dispose()}},{key:"initialized",get:function(){return this._initialized}}]),e}();t.default=p,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(18),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(87),c=r(d),f=function(){function e(){(0,s.default)(this,e),this._scriptOrigin=null,this._metadata={}}return(0,l.default)(e,[{key:"_onErrorListener",value:function(e){e.filename&&e.filename===this._scriptOrigin&&this.notifyError(new c.default(e))}},{key:"notify",value:function(e,t){throw arguments.length>2&&void 0!==arguments[2]&&arguments[2],new Error("AbstractError#notify should be implemented")}},{key:"notifyError",value:function(e,t){throw new Error("AbstractError#notifyError should be implemented")}},{key:"_getAppVersion",value:function(){return"4.10.7".split("-")[0]}},{key:"setMetadata",value:function(e){(0,a.default)(this._metadata,e)}},{key:"setScriptOrigin",value:function(e){this._scriptOrigin=e}},{key:"setCustomer",value:function(e){}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(10),c=r(d),f=n(253),_=r(f),h=n(9),p=r(h),g=n(165),v=r(g),m=n(167),E=r(m),y=n(86),T=r(y),S=n(87),C=(r(S),function(e){function t(){(0,s.default)(this,t);var e=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this));return window.addEventListener("error",e._onErrorListener.bind(e)),E.default.apiKey=T.default.ERRORS.API_KEY,E.default.notifyHandler=T.default.ERRORS.HANDLER,E.default.notifyReleaseStages=T.default.ERRORS.STAGES,E.default.disableLog=!0,E.default.releaseStage="production",E.default.autoNotify=!1,E.default.appVersion=e._getAppVersion(),e}return(0,p.default)(t,e),(0,l.default)(t,[{key:"notify",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"warning",r=n;r.match(/^(warning|info|error)$/)||(r="warning"),E.default.notify(e,t,this._metadata,r)}},{key:"notifyError",value:function(e,t){E.default.notifyException(e,{groupingHash:t||e.message})}},{key:"setMetadata",value:function(e){(0,_.default)(t.prototype.__proto__||(0,a.default)(t.prototype),"setMetadata",this).call(this,e),E.default.metaData=this._metadata}},{key:"setCustomer",value:function(e){E.default.userId=e}}]),t}(v.default));t.default=new C,e.exports=t.default},function(e,t,n){"use strict";var r,i,a=n(31),o=function(e){return e&&e.__esModule?e:{default:e}}(a);!function(n,a){function s(){O=!1}function u(){var e=document.currentScript||C;if(!e&&O){var t=document.scripts||document.getElementsByTagName("script");e=t[t.length-1]}return e}function l(e){var t=u();t&&(e.script={src:t.src,content:p("inlineScript",!0)?t.innerHTML:""})}function d(e){var t=p("disableLog"),r=n.console;void 0===r||void 0===r.log||t||r.log("[Bugsnag] "+e)}function c(e,t,r){if(r>=p("maxDepth",R))return encodeURIComponent(t)+"=[RECURSIVE]";r=r+1||1;try{if(n.Node&&e instanceof n.Node)return encodeURIComponent(t)+"="+encodeURIComponent(T(e));var i=[];for(var a in e)if(e.hasOwnProperty(a)&&null!=a&&null!=e[a]){var s=t?t+"["+a+"]":a,u=e[a];i.push("object"===(void 0===u?"undefined":(0,o.default)(u))?c(u,s,r):encodeURIComponent(s)+"="+encodeURIComponent(u))}return i.join("&")}catch(e){return encodeURIComponent(t)+"="+encodeURIComponent(""+e)}}function f(e,t,n){if(null==t)return e;if(n>=p("maxDepth",R))return"[RECURSIVE]";e=e||{};for(var r in t)if(t.hasOwnProperty(r))try{t[r].constructor===Object?e[r]=f(e[r],t[r],n+1||1):e[r]=t[r]}catch(n){e[r]=t[r]}return e}function _(e,t){if(e+="?"+c(t)+"&ct=img&cb="+(new Date).getTime(),"undefined"!=typeof BUGSNAG_TESTING&&D.testRequest)D.testRequest(e,t);else if("xhr"===p("notifyHandler")){var n=new XMLHttpRequest;n.open("GET",e,!0),n.send()}else(new Image).src=e}function h(e){var t={},n=/^data\-([\w\-]+)$/;if(e)for(var r=e.attributes,i=0;i<r.length;i++){var a=r[i];if(n.test(a.nodeName)){var o=a.nodeName.match(n)[1];t[o]=a.value||a.nodeValue}}return t}function p(e,t){P=P||h(k);var n=void 0!==D[e]?D[e]:P[e.toLowerCase()];return"false"===n&&(n=!1),void 0!==n?n:t}function g(e){return!(!e||!e.match(b))||(d("Invalid API key '"+e+"'"),!1)}function v(e,t){var r=p("apiKey");if(g(r)&&I){I-=1;var i=p("releaseStage","production"),a=p("notifyReleaseStages");if(a){for(var o=!1,s=0;s<a.length;s++)if(i===a[s]){o=!0;break}if(!o)return}var u=[e.name,e.message,e.stacktrace].join("|");if(u!==A){A=u,S&&(t=t||{},t["Last Event"]=y(S));var l={notifierVersion:L,apiKey:r,projectRoot:p("projectRoot")||n.location.protocol+"//"+n.location.host,context:p("context")||n.location.pathname,userId:p("userId"),user:p("user"),metaData:f(f({},p("metaData")),t),releaseStage:i,appVersion:p("appVersion"),url:n.location.href,userAgent:navigator.userAgent,language:navigator.language||navigator.userLanguage,severity:e.severity,name:e.name,message:e.message,stacktrace:e.stacktrace,file:e.file,lineNumber:e.lineNumber,columnNumber:e.columnNumber,payloadVersion:"2"},c=D.beforeNotify;if("function"==typeof c&&!1===c(l,l.metaData))return;if(0===l.lineNumber&&/Script error\.?/.test(l.message))return d("Ignoring cross-domain script error. See https://bugsnag.com/docs/notifiers/js/cors");_(p("endpoint")||M,l)}}}function m(){var e,t;try{throw new Error("")}catch(n){e="<generated>\n",t=E(n)}if(!t){e="<generated-ie>\n";var n=[];try{for(var r=arguments.callee.caller.caller;r&&n.length<10;){var i=w.test(r.toString())?RegExp.$1||"[anonymous]":"[anonymous]";n.push(i),r=r.caller}}catch(e){d(e)}t=n.join("\n")}return e+t}function E(e){return e.stack||e.backtrace||e.stacktrace}function y(e){return{millisecondsAgo:new Date-e.timeStamp,type:e.type,which:e.which,target:T(e.target)}}function T(e){if(e){var t=e.attributes;if(t){for(var n="<"+e.nodeName.toLowerCase(),r=0;r<t.length;r++)t[r].value&&"null"!==t[r].value.toString()&&(n+=" "+t[r].name+'="'+t[r].value+'"');return n+">"}return e.nodeName}}var S,C,A,D={},I=10,R=5;D.noConflict=function(){return n.Bugsnag=a,void 0===a&&delete n.Bugsnag,D},D.refresh=function(){I=10},D.notifyException=function(e,t,n,r){e&&(t&&"string"!=typeof t&&(n=t,t=void 0),n||(n={}),l(n),v({name:t||e.name,message:e.message||e.description,stacktrace:E(e)||m(),file:e.fileName||e.sourceURL,lineNumber:e.lineNumber||e.line,columnNumber:e.columnNumber?e.columnNumber+1:void 0,severity:r||"warning"},n))},D.notify=function(e,t,r,i){v({name:e,message:t,stacktrace:m(),file:n.location.toString(),lineNumber:1,severity:i||"warning"
},r)};var O="complete"!==document.readyState;document.addEventListener?(document.addEventListener("DOMContentLoaded",s,!0),n.addEventListener("load",s,!0)):n.attachEvent("onload",s);var P,b=/^[0-9a-f]{32}$/i,w=/function\s*([\w\-$]+)?\s*\(/i,M="https://notify.bugsnag.com/js",L="2.5.0",N=document.getElementsByTagName("script"),k=N[N.length-1];if(n.atob&&n.ErrorEvent)try{0===new n.ErrorEvent("test").colno&&!1}catch(e){}n.Bugsnag=D,r=[],void 0!==(i=function(){return D}.apply(t,r))&&(e.exports=i)}(window,window.Bugsnag)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(104),a=r(i),o=n(40),s=r(o),u=n(0),l=r(u),d=n(1),c=r(d),f=n(4),_=n(25),h=n(49),p=r(h),g=n(231),v={GET:"GET",POST:"POST"},m={JSON:"json",ARRAY_BUFFER:"arraybuffer"},E={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},y={INVALID_STATUS:"Response status is not part of valid status codes",REQUEST_ABORTED:"Request has been aborted",REQUEST_ERROR:"An error occured while sending the request",REQUEST_TIMEOUT:"Request timeout"},T=function(){function e(t,n,r){(0,l.default)(this,e),this._method=t,this._url=n,this._retryCount=0,this._aborted=!1,this._options=p.default.merge({responseType:e.ResponseTypes.JSON,validStatusCodes:[].concat((0,s.default)((0,_.range)(200,206)),[304]),timeout:0,retry:0,retryDelay:0,withCredentials:!1,headers:{},events:{onprogress:g.noop}},r)}return(0,c.default)(e,[{key:"send",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new a.default(function(n,r){function i(){var e=this;this._send(t).then(function(e){n(e)}).catch(function(t){return e._retryCount===e._options.retry?void r(t):(e._retryCount++,void(0,f.createTimeout)(function(){e._init(),i.call(e)},e._options.retryDelay))})}i.call(e)})}},{key:"abort",value:function(){throw new TypeError("Cannot call abstract method")}},{key:"_send",value:function(){throw new TypeError("Cannot call abstract method")}},{key:"_init",value:function(){throw new TypeError("Cannot call abstract method")}},{key:"isStreamroot",set:function(e){this._isStreamrootEndpoint=e}}]),e}();T.Methods=v,T.ResponseTypes=m,T.ReadyStates=E,T.Errors=y,t.default=T,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(104),a=r(i),o=n(52),s=r(o),u=n(7),l=r(u),d=n(0),c=r(d),f=n(1),_=r(f),h=n(10),p=r(h),g=n(9),v=r(g),m=n(168),E=r(m),y=n(4),T=n(170),S=r(T),C=n(171),A=r(C),D=function(e){function t(e,n,r){(0,c.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,l.default)(t)).call(this,e,n,r));return i._init(),i}return(0,v.default)(t,e),(0,_.default)(t,[{key:"_init",value:function(){this._xhr=new XMLHttpRequest,this._xhr.open(this._method,this._url,!0),this._xhr.responseType=this._options.responseType,this._xhr.withCredentials=this._options.withCredentials;for(var e=(0,s.default)(this._options.headers),t=0,n=e.length;t<n;t++){var r=e[t];this._xhr.setRequestHeader(r,this._options.headers[r])}this._aborted=!1}},{key:"abort",value:function(){this._aborted=!0,this._xhr.abort()}},{key:"_send",value:function(e){var n=this;return new a.default(function(r,i){n._aborted?i(new S.default(t.Errors.REQUEST_ABORTED)):n._options.timeout&&(n._retryTimer=(0,y.createTimeout)(function(){n.abort(),i(new S.default(t.Errors.REQUEST_TIMEOUT))},n._options.timeout)),n._xhr.onloadend=function(){n._aborted?i(new S.default(t.Errors.REQUEST_ABORTED)):n._xhr.readyState===t.ReadyStates.DONE?n._options.validStatusCodes.indexOf(n._xhr.status)>-1?r(n._xhr.response):i(new S.default(t.Errors.INVALID_STATUS,n._xhr.status)):i(new S.default(t.Errors.REQUEST_ERROR))},n._xhr.onprogress=function(e){var t=new A.default(e.lengthComputable,e.loaded,e.total);n._options.events.onprogress(t)},n._xhr.onerror=function(){i(new S.default(t.Errors.REQUEST_ERROR))},n._xhr.send(e)})}}]),t}(E.default);t.default=D,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,a.default)(this,e),this._message=t,this._status=n}return(0,s.default)(e,[{key:"message",get:function(){return this._message}},{key:"status",get:function(){return this._status}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(t,n,r){(0,a.default)(this,e),this._lengthComputable=t,this._loaded=n,this._total=r}return(0,s.default)(e,[{key:"lengthComputable",get:function(){return this._lengthComputable}},{key:"loaded",get:function(){return this._loaded}},{key:"total",get:function(){return this._total}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(173),i=function(e){return e&&e.__esModule?e:{default:e}}(r),a=function(e){var t=[],n=e,r=function(){for(var e=-1,r=Date.now(),i=0;i<t.length&&r-t[i].timestamp()>n;i++)e=i;return e},a=function(){var e=r();e>-1&&t.splice(0,e+1)},o=function(e){a();var n=new i.default(e);t.push(n)},s=function(){if(a(),!t.length)return 0;for(var e=0,n=0;n<t.length;n++)e+=t[n].value();return e/t.length},u=function(){if(a(),!t.length)return 0;for(var e=0,n=0;n<t.length;n++)e+=t[n].value();return e};this.addPoint=o,this.compute=s,this.computeSum=u};t.default=a,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){var t=e,n=Date.now();this.timestamp=function(){return n},this.value=function(){return t}};t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(n.USE_COMBINED_ABR_FEEDBACK){var r=e.cdnDownloaded+e.p2pDownloaded,i=e.cdnDownloaded/r,a=void 0;if(i<n.ABR_SEGMENT_CDN_RATIO_THRESHOLD||e.cdnDownloaded<n.ABR_CDN_DL_THRESHOLD){var o=void 0;if(null!==t.cdnTimestamp){var s=Date.now()-t.cdnTimestamp,u=Math.max(0,1-s/n.ABR_CDN_DL_DECAY_TIME);o=(1-u)*t.p2pSpeed+u*t.cdnSpeed}else o=t.p2pSpeed;a=8*r/o}else a=8*e.cdnDownloaded/t.cdnSpeed/i;e.p2pDuration=(1-i)*a,e.cdnDuration=i*a}else t.p2pSpeed>0?e.p2pDuration=8*e.p2pDownloaded/t.p2pSpeed:e.p2pDuration=0,null!==t.cdnSpeed?e.cdnDuration=8*e.cdnDownloaded/t.cdnSpeed:e.cdnDuration=0},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(40),a=r(i),o=n(8),s=r(o),u=n(7),l=r(u),d=n(0),c=r(d),f=n(1),_=r(f),h=n(10),p=r(h),g=n(9),v=r(g),m=n(96),E=r(m),y=n(2),T=r(y),S=n(5),C=r(S),A=n(4),D=function(e){function t(e,n){(0,c.default)(this,t);var r=[],i=(0,p.default)(this,(t.__proto__||(0,l.default)(t)).call(this,r));return i._peerIds=r,i._peerConnector=e,i._sharedState=n,i._sharedState.eventBus.on(T.default.Metrics.TRACK_SWITCH,i._onTrackSwitch,i),i}return(0,v.default)(t,e),(0,_.default)(t,[{key:"dispose",value:function(){this._tryDequeueTimer&&this._tryDequeueTimer.clear(),this._sharedState.eventBus.removeListener(T.default.Metrics.TRACK_SWITCH,this._onTrackSwitch,this)}},{key:"flush",value:function(){this._sharedState.peerStats.excessMatch+=this._peerIds.length,this._peerIds.length=0}},{key:"onPeersFromTracker",value:function(e,t){if(null!==e)return void C.default.notify("Error asking peers from tracker:",e.message);var n=[],r=!0,i=!1,o=void 0;try{for(var u,l=(0,s.default)(t);!(r=(u=l.next()).done);r=!0){var d=u.value,c=d.peers;n.push.apply(n,(0,a.default)(c))}}catch(e){i=!0,o=e}finally{try{!r&&l.return&&l.return()}finally{if(i)throw o}}if(!(n.length<1)){this.flush(),this._sharedState.peerStats.match+=n.length;var f=!0,_=!1,h=void 0;try{for(var p,g=(0,s.default)(n);!(f=(p=g.next()).done);f=!0){var v=p.value;this.push(v)}}catch(e){_=!0,h=e}finally{try{!f&&g.return&&g.return()}finally{if(_)throw h}}void 0===this._tryDequeueTimer&&this._createTryDequeueTimer()}}},{key:"_onTrackSwitch",value:function(e){e.isVideo&&this.flush()}},{key:"_createTryDequeueTimer",value:function(){this._tryDequeueTimer=(0,A.createInterval)(this._onTryDequeueTimer.bind(this),this._sharedState.conf.CANDIDATE_PEERS_TRY_DEQUEUE_INTERVAL)}},{key:"_onTryDequeueTimer",value:function(){var e=Math.min(this._peerIds.length,this._peerConnector.getOpenConnectorSlotsCount());e>0&&this.tryDequeueN(e)}},{key:"_canDequeue",value:function(){return this._peerIds.length>0&&this._peerConnector.getOpenConnectorSlotsCount()>this._sharedState.conf.RESERVED_OFFER_SLOTS}},{key:"_dequeuedCallback",value:function(e){this._peerConnector.createPeerConnection(e)}}]),t}(E.default);t.default=D,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(21),l=r(u),d=n(182),c=r(d),f=n(89),_=r(f),h=n(2),p=r(h),g={PENDING:"pending",DOWNLOADING:"downloading",DOWNLOADED:"downloaded",CDN_DOWNLOADED:"CDNdownloaded",FAILED:"failed"},v=function(){function e(t,n,r,i,o){(0,a.default)(this,e),this._sharedState=o,this._conf=o.conf,this._transferStats=o.transferStats,this._efficiencyStats=o.efficiencyStats,this._controlStats=o.controlStats,this._workerHelper=o.workerHelper,this._p2pCache=n,this._dataLocked=!1,this._downloadStatus=[],this._writeLock=!1,this._isEmpty=!0,this._partialSegmentRequested=!1,this._broadcastedSegmentInfoCalled=!1,this._segmentCoord=t,this._peerPool=r,this._segmentInfoMap=i,this._ee=new l.default}return(0,s.default)(e,[{key:"getEE",value:function(){return this._ee}},{key:"setSegmentSize",value:function(e){if(!this.size){this.size=e;for(var t=Math.ceil(this.size/this._conf.CHUNK_SIZE),n=0;n<t;n++)this._downloadStatus.push(g.PENDING);this.segment=new _.default(e,this._segmentCoord,this._sharedState.eventBus)}}},{key:"getNumberOfChunks",value:function(){return this._downloadStatus.length}},{key:"getChunk",value:function(e,t){if(!this._dataLocked&&this._isChunkP2POrCDNDownloaded(e)){var n=this._conf.CHUNK_SIZE,r=e*this._conf.CHUNK_SIZE;r+n>this.size&&(n=this.size-r),this.segment.getBinaryData(r,n,t)}else this._dataLocked&&console.warn("locked data, not sending"),t(null)}},{key:"_getConsecutiveChunksCount",value:function(e,t,n){for(var r=1,i=1===t?0:e.length-1,a=1===t?e.length-1:0,o=i;o!==a;o+=t){var s=o+t;if(s>=0&&s<=e.length-1){if(1!==Math.abs(e[o]-e[s])||r===n)break;r++}}return r}},{key:"_getRemainingChunks",value:function(){for(var e=[],t=0,n=this._downloadStatus.length;t<n;t++)this._downloadStatus[t]!==g.FAILED&&this._downloadStatus[t]!==g.PENDING||e.push(t);return e}},{key:"_encodePartialBatchStr",value:function(e,t){var n=e;return e&&(n+=","),n+=""+t[0],t.length>1&&(n+="-"+t[t.length-1]),n}},{key:"getNextChunks",value:function(e,t){for(var n="",r=t,i=this._getRemainingChunks();i.length>0&&r>0;){var a=i[0],o=i[i.length-1],s=void 0,u=void 0;if(this._downloadStatus.length-1-o===a){var l=this._getConsecutiveChunksCount(i,1,r),d=this._getConsecutiveChunksCount(i,-1,r);u=Math.max(l,d),s=u===l?1:-1}else s=this._downloadStatus.length-1-o>a?1:-1,u=this._getConsecutiveChunksCount(i,s,r);var c=1===s?0:i.length-u,f=i.splice(c,u);f=1===s?f:f.reverse(),n=this._encodePartialBatchStr(n,f),r-=f.length;for(var _=0,h=f.length;_<h;_++)this._downloadStatus[f[_]]=g.DOWNLOADING}return{encoded:n,size:t-r}}},{key:"chunkDownloaded",value:function(e,t){if(!this.segment||t>=this._downloadStatus.length)return void(this._transferStats.multipleDlM+=e.byteLength);if(this._isEmpty=!1,this._isChunkP2POrCDNDownloaded(t)||this._writeLock){var n=this._downloadStatus[t];n===g.DOWNLOADED?this._transferStats.multipleDlPP+=e.byteLength:(n===g.CDN_DOWNLOADED||this._writeLock)&&(this._transferStats.multipleDlCP+=e.byteLength)}else if(this._downloadStatus[t]=g.DOWNLOADED,this.segment.setBinaryData(e,t*this._conf.CHUNK_SIZE),(this._sharedState.moduleState.isLive()&&this._conf.ALLOW_LIVE_PUSH_SEGMENT||!this._sharedState.moduleState.isLive()&&this._conf.ALLOW_VOD_PUSH_SEGMENT)&&this._broadcastSegmentInfo(),this.isSegmentDownloaded()){var r=this._p2pCache.getSegmentHandler(this._segmentCoord).seeders;r&&r.clear(),this.lockSegmentData(),this._checkHashP2P(this.segment)}this._sharedState.eventBus.emit(p.default.ChunkManager.CHUNK_DOWNLOADED)}},{key:"timeout",value:function(e){this._downloadStatus[e]===g.DOWNLOADING&&(this._downloadStatus[e]=g.FAILED)}},{key:"isSegmentDownloaded",value:function(){var e=this;return!!this.size&&this._downloadStatus.every(function(t,n){return e._isChunkP2POrCDNDownloaded(n)})}},{key:"shouldDownloadSegment",value:function(){return!this.isSegmentDownloaded()&&!this.partialSegment&&!this._partialSegmentRequested}},{key:"getPartialSegment",value:function(){var e=this;return this._partialSegmentRequested=!0,!(this._isEmpty||!this.size)&&(function(){e.partialSegment||e._dataLocked||(e.partialSegment=new c.default(e._segmentCoord,e._p2pCache,e.segment,e._downloadStatus,e.size,e,e.isSegmentDownloaded(),e._segmentInfoMap,e._sharedState))}(),this._dataLocked||(this._writeLock=!0),this.partialSegment)}},{key:"getPercentageOfChunksDownloaded",value:function(){var e=this;return this._downloadStatus.reduce(function(t,n,r){return t+(e._isChunkP2POrCDNDownloaded(r)?1/e.getNumberOfChunks()*100:0)},0)}},{key:"storeSegment",value:function(e){this._isEmpty=!1,this.size||this.setSegmentSize(e.byteLength),this.segment=e,this._updateDownloadStatus();var t=this.getP2PAndCDNDownloads();this._transferStats.p2pUseful+=t.p2pDownloaded}},{key:"_broadcastSegmentInfo",value:function(){var e=this.getPercentageOfChunksDownloaded();!this._broadcastedSegmentInfoCalled&&e>=this._conf.MIN_CHUNK_PERCENTAGE_DOWNLOADED_FOR_HAS_SEGMENT_ANSWER&&(this._broadcastedSegmentInfoCalled=!0,this._peerPool.broadcastSegmentInfo(this._segmentCoord))}},{key:"_updateDownloadStatus",value:function(){var e=void 0;e={start:0,end:this.getNumberOfChunks()},this.partialSegment&&this.partialSegment.getCDNIndexRange()&&(e=this.partialSegment.getCDNIndexRange());for(var t=e.start;t<e.end;t++){if(this._isChunkP2POrCDNDownloaded(t)){var n=this._conf.CHUNK_SIZE;t===this.getNumberOfChunks()-1&&(n=this.size-(this.getNumberOfChunks()-1)*this._conf.CHUNK_SIZE),this._downloadStatus[t]===g.DOWNLOADED?this._transferStats.multipleDlPC+=n:this._downloadStatus[t]===g.CDN_DOWNLOADED&&(this._transferStats.multipleDlCC+=n)}this._downloadStatus[t]=g.CDN_DOWNLOADED}}},{key:"getP2PAndCDNDownloads",value:function(){var e=0,t=0,n=this.getNumberOfChunks()-1;if(this.size)for(var r=0;r<this._downloadStatus.length;r++){var i=void 0,a=this._downloadStatus[r];i=r<n?this._conf.CHUNK_SIZE:this.size-n*this._conf.CHUNK_SIZE,a===g.DOWNLOADED?e+=i:a===g.CDN_DOWNLOADED&&(t+=i)}return{p2pDownloaded:e,cdnDownloaded:t}}},{key:"lockSegmentData",value:function(){this._dataLocked=!0}},{key:"unlockSegmentData",value:function(){this._dataLocked=!1}},{key:"removePartialSegment",value:function(){delete this.partialSegment}},{key:"_checkHashP2P",value:function(e){var t=this,n=this._segmentInfoMap.getSegmentInfo(this._segmentCoord),r=function(e,r){n.hash===r?(t._controlStats.nbRightHashP2P++,t.segment.setBinaryData(e),t._transferStats.p2pUseful+=t.size,t.unlockSegmentData()):(t._controlStats.nbWrongHashP2P++,t._p2pCache.removeSegmentHandler(n.segmentCoord),t._transferStats.multipleDlHP+=t.size)};e.getBinaryData(0,e.byteLength,function(e){t._workerHelper.callHashWorker(e,r)})}},{key:"_isChunkP2POrCDNDownloaded",value:function(e){var t=this._downloadStatus[e];return t===g.DOWNLOADED||t===g.CDN_DOWNLOADED}},{key:"dispose",value:function(){this.segment&&this.segment.destroy()}},{key:"hasChunksToDownload",get:function(){return this._downloadStatus.indexOf(g.FAILED)>=0||this._downloadStatus.indexOf(g.PENDING)>=0}}]),e}();t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(10),c=r(d),f=n(9),_=r(f),h=n(88),p=r(h),g=n(4),v=n(50),m=r(v),E=n(5),y=r(E),T=function(e){function t(e,n,r,i,o,u){(0,s.default)(this,t);var l=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n,u));l._chunkManager=o,l._peer=r,l._sharedState=i;var d=i.moduleState.isLive()?i.conf.LIVE.CHUNK_TIMEOUT:i.conf.CHUNK_TIMEOUT;return l._timeoutTimer=(0,g.createTimeout)(function(){l._chunkTimedOut()},d),l._timedOut=!1,l}return(0,_.default)(t,e),(0,l.default)(t,[{key:"isEqual",value:function(e){return this.id===e.id}},{key:"_chunkTimedOut",value:function(){this._timedOut=!0,this._chunkManager.timeout(this._chunkIndex,this._bandwidthSafety),this._bandwidthSafety===m.default.SAFE?(this._sharedState.efficiencyStats.safeChunkRequestCount++,this._sharedState.efficiencyStats.safeChunkRequestTimeoutCount++):this._bandwidthSafety===m.default.UNSAFE&&(this._sharedState.efficiencyStats.unsafeChunkRequestCount++,this._sharedState.efficiencyStats.unsafeChunkRequestTimeoutCount++),this._peer.timeoutChunk(this)}},{key:"dataDownloaded",value:function(e){this._chunkManager.chunkDownloaded(e,this._chunkIndex),this._timedOut||(this._bandwidthSafety===m.default.SAFE?this._sharedState.efficiencyStats.safeChunkRequestCount++:this._bandwidthSafety===m.default.UNSAFE&&this._sharedState.efficiencyStats.unsafeChunkRequestCount++,this._timeoutTimer?this._timeoutTimer.clear():y.default.notifyError(new Error("clear() call on undefined DownloadChunkRequest.timeoutTimer.")))}},{key:"id",get:function(){return t.getIdOf(this._segmentCoord,this._chunkIndex)}},{key:"timestamp",get:function(){return this._timestamp}}],[{key:"getIdOf",value:function(e,t){return e.viewToString()+"C"+t}}]),t}(p.default);t.default=T,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(37),a=r(i),o=n(40),s=r(o),u=n(67),l=r(u),d=n(8),c=r(d),f=n(16),_=r(f),h=n(0),p=r(h),g=n(1),v=r(g),m=function(){function e(t,n,r){(0,p.default)(this,e),this._peerPool=t,this._peerConnector=n,this._secondOrderExclusions=new _.default,this._sharedState=r}return(0,v.default)(e,[{key:"addSecondOrderExclusion",value:function(e,t,n,r){this._secondOrderExclusions.set(e,{rank:t,releaseTimestamp:Date.now()+n,tag:r})}},{key:"_clearExpiredExclusions",value:function(){var e=Date.now(),t=!0,n=!1,r=void 0;try{for(var i,a=(0,c.default)(this._secondOrderExclusions.entries());!(t=(i=a.next()).done);t=!0){var o=(0,l.default)(i.value,2),s=o[0];o[1].releaseTimestamp<=e&&this._secondOrderExclusions.delete(s)}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}}},{key:"exclusionList",get:function(){this._clearExpiredExclusions();var e=this._peerConnector.getPendingConnectionPeers(),t=!0,n=!1,r=void 0;try{for(var i,o=(0,c.default)(this._peerPool.getPeerArray());!(t=(i=o.next()).done);t=!0){var u=i.value;e.push(u.getId())}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var d=this._sharedState.conf.MAX_TRACKER_EXCLUSION_LENGTH-e.length;if(d>=this._secondOrderExclusions.size)return[].concat((0,s.default)(e),(0,s.default)(this._secondOrderExclusions.keys()));var f=Date.now(),_=(0,a.default)(this._secondOrderExclusions.entries());_.sort(function(e,t){var n=(0,l.default)(e,2),r=(n[0],n[1]),i=(0,l.default)(t,2),a=(i[0],i[1]);return(a.releaseTimestamp-f)*a.rank-(r.releaseTimestamp-f)*r.rank});var h=_.map(function(e){var t=(0,l.default)(e,2),n=t[0];return t[1],n});return[].concat((0,s.default)(e),(0,s.default)(h.slice(0,d)))}},{key:"secondOrderExclusions",get:function(){return this._clearExpiredExclusions(),this._secondOrderExclusions}}]),e}();t.default=m,e.exports=t.default},function(e,t,n){"use strict";e.exports={TRACK_CHANGE_EVENT:"onTrackChange",EMERGENCY_FRAG_LOAD_ABORT:"onEmergencyFragLoadAborted"}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(16),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(64),c=n(47),f=n(5),_=r(f),h=function(){function e(t,n){(0,s.default)(this,e),this._mediaMap=t,this._sharedState=n,this._cachedSegmentList=new a.default,this._cachedSegmentTime=new a.default}return(0,l.default)(e,[{key:"getSegmentListAfterEdge",value:function(e,t,n){var r=t.viewToString(),i=this._cachedSegmentList.get(e.viewToString());if(i&&i.edgeString===r&&i.duration===n)return i.cachedSegmentList;var a=this.getSegmentTime(t),o=void 0;return null===a?(_.default.notifyError(new Error("Unexpected getSegmentTime error: track edge timestamp is not supposed to be unreliable")),o=[]):o=this._mediaMap.getSegmentList(e,a,n),(this._sharedState.conf.ENABLE_PREBUFFER_FEEDBACK||this._sharedState.conf.ENABLE_FIX_UNRELIABLE_SEGMENT_TIME)&&(o=this._filterGreaterThanTrackEdge(o,t)),this._cachedSegmentList.set(e.viewToString(),{edgeString:r,cachedSegmentList:o,duration:n}),o}},{key:"_filterGreaterThanTrackEdge",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n].getId()>t.getId())return e.slice(n);return[]}},{key:"getSegmentTime",value:function(e){if(e.fromPeer&&this._sharedState.moduleState.streamType===c.StreamTypes.HLS&&this._sharedState.conf.ENABLE_FIX_UNRELIABLE_SEGMENT_TIME)return null;var t=this._cachedSegmentTime.get(e.viewToString());if(void 0!==t)return t;var n=this._mediaMap.getSegmentTime(e);if(this._cachedSegmentTime.set(e.viewToString(),n),this._cachedSegmentTime.size>this._sharedState.conf.GETSEGMENTTIME_CACHE_MAX_SIZE){var r=this._cachedSegmentTime.keys(),i=r.next().value,a=(0,d.unwrap)(i);this._cachedSegmentTime.delete(a)}return n}}]),e}();t.default=h,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(218),l=function(){function e(t,n,r){(0,a.default)(this,e),this._isNearEdge=!1,this.isAlwaysDvr=!0,this.currentTracks=new u.CurrentTracks(t),this._playerInterface=n,this._streamType=r,this.nextSegmentPrebuffered={video:!1,audio:!1}}return(0,s.default)(e,[{key:"isLive",value:function(){return this._playerInterface.isLive()}},{key:"resetIsAlwaysDvr",value:function(){!this._isNearEdge&&this.isLive()&&(this.isAlwaysDvr=!0)}},{key:"isNearEdge",get:function(){return this._isNearEdge},set:function(e){e&&this.isAlwaysDvr&&(this.isAlwaysDvr=!1),this._isNearEdge=e}},{key:"streamType",get:function(){return this._streamType}}]),e}();t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(242),a=r(i),o=n(7),s=r(o),u=n(0),l=r(u),d=n(10),c=r(d),f=n(9),_=r(f),h=n(5),p=r(h),g=n(63),v=r(g),m=function(e){function t(e,n,r,i,o,u,d,f,_){function h(e,t,r,i){function a(a,o){t.hash===o?(k.nbRightHashDLM++,e.response=a,g(e),r(e,M)):(k.nbWrongHashDLM++,N.multipleDlHD+=j,N.multipleDlHP+=U,n.removeSegmentHandler(M),i(e,M))}R.callHashWorker(e.response,a)}function g(e){B=e.response,n.fillSegment(M,e.response),u.unlockSegmentData(),u.removePartialSegment()}function v(){w?U=o:(U=x.start*A.CHUNK_SIZE,x.end<H.length&&(U+=(H.length-x.end-1)*A.CHUNK_SIZE,U+=o-(H.length-1)*A.CHUNK_SIZE))}function m(){for(var e=0;e<H.length;e++)if("downloaded"!==H[e]&&"CDNdownloaded"!==H[e])return e}function E(){for(var e=H.length-1;e>=0;e--)if("downloaded"!==H[e]&&"CDNdownloaded"!==H[e])return e+1}function y(){x=A.RANGE_REQUEST_ALLOWED?{start:m(),end:E()}:{start:0,end:H.length}}function T(e){if(!A.RANGE_REQUEST_ALLOWED)return e;var t=void 0;if(void 0===x.start||void 0===x.end)throw new Error("PartialSegmentP2P: getUpdatedRange called with complete segment");var n=e?e.start+x.start*A.CHUNK_SIZE:x.start*A.CHUNK_SIZE;return x.end===H.length&&e?t=e.end:x.end<H.length&&(t=e?e.start+x.end*A.CHUNK_SIZE-1:x.end*A.CHUNK_SIZE-1),{start:n,end:t}}function S(e){if(void 0===x)throw new Error("assertion: _cdnIndexRange is not defined");if(void 0===B)throw new Error("assertion: _segmentData is not defined");try{B.setBinaryData(e,x.start*A.CHUNK_SIZE)}catch(e){throw p.default.notifyError(e),new Error("Invalid configuration: The current stream has no range request enabled and the p2p configuration has range request set to true.")}return B}function C(e){_.transferStats.cdnDownloaded+=e.byteLength}(0,l.default)(this,t);var A=_.conf,D=_.status,I=_.eventBus,R=_.workerHelper,O=_.controlStats,P=_.transferStats,b=(0,c.default)(this,(t.__proto__||(0,s.default)(t)).call(this)),w=d,M=e,L=f,N=P,k=O,x=void 0,U=void 0,F=void 0,B=void 0,H=void 0,j=0;return b.getFullSegment=function(e,t,n){if(this.isComplete())B.getBinaryData(0,B.byteLength,function(n){e.response=n,u.removePartialSegment(),t(e,null)});else{I.emit("CDNSegmentDownloaded",M);var r=e.response;C(r),j=r.byteLength,S(r).getBinaryData(0,B.byteLength,function(r){if(e.response=r,0!==U){u.lockSegmentData();var i=L.getSegmentInfo(M);h(e,i,t,n)}else g(e),t(e,M)})}},b.getUpdatedRange=T,b.getCDNIndexRange=function(){return x},b.isComplete=function(){return w},b.isLocked=function(){return u.dataLocked},function(){if(B=r,!i.length)throw new Error("PartialSegmentP2P should not be instantiated with an empty segment");H=i.slice(),y(),v(),F=D.getMeanInstantSpeed()}(),(0,a.default)(b,{p2pSpeed:{get:function(){return F},set:void 0},p2pAmount:{get:function(){return U},set:void 0}}),b}return(0,_.default)(t,e),t}(v.default);t.default=m,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),a=r(i),o=n(39),s=r(o),u=n(16),l=r(u),d=n(4),c=n(94),f=r(c),_=n(223),h=r(_),p=n(17),g=n(95),v=n(203),m=r(v),E=n(184),y=r(E),T=n(2),S=r(T),C=n(177),A=r(C),D=n(222),I=r(D),R=n(50),O=r(R),P=n(35),b=r(P),w=n(65),M=r(w),L=n(5),N=r(L),k=function(e,t,n,r,i){var o=r,u=r.conf,c=r.peerStats,_=new p.Delta,v=new p.Delta,E=new p.Delta,T=new p.Delta(Date.now()),C=r.eventBus,D=e,R=c,P=new h.default(n,r),w=this,L=b.default.fromHalfLife(0,u.PEER_UPLOAD_SPEED_EMA_HALF_LIFE,u.PEER_SPEED_MONITOR_INTERVAL),k=b.default.fromHalfLife(0,u.PEER_DOWNLOAD_SPEED_EMA_HALF_LIFE,u.PEER_SPEED_MONITOR_INTERVAL),x=Math.max(u.BLOCK_SEEDER_SCHEDULING_WINDOW,u.PEER_TIMEOUT_RATIO_WINDOW),U=new M.default(x),F=new M.default(x),B=Date.now(),H=0,j=0,G=!1,K=void 0,V=0,W=0,q=void 0,Y=0,z=0,Q=0,X=0,Z=!1,J=!1,$=void 0,ee=!1,te=new l.default,ne=new l.default,re=s.default,ie=function(){var e=T.calcDelta(Date.now()),t=_.calcDelta(H),n=v.calcDelta(j),i=E.calcDelta(P.dataUploaded);V=8*t/e,W=8*i/e;var a=8*n/e,o=Date.now()-r.moduleState.currentTracks.lastSwitchTimestamp;Z?u.POST_TRACK_SWITCH_PEER_LOCK_SENSITIVITY_ON&&o<u.POST_TRACK_SWITCH_PEER_SPEED_SENSITIVITY_DURATION?k.update(a,b.default.halfLifeToEMAWeight(u.PEER_DOWNLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE,u.PEER_SPEED_MONITOR_INTERVAL)):k.update(a):a>0&&(k.update(a,1),Z=!0),J?u.POST_TRACK_SWITCH_PEER_LOCK_SENSITIVITY_ON&&o<u.POST_TRACK_SWITCH_PEER_SPEED_SENSITIVITY_DURATION?L.update(W,b.default.halfLifeToEMAWeight(u.PEER_UPLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE,u.PEER_SPEED_MONITOR_INTERVAL)):L.update(W):W>0&&(L.update(W,1),J=!0),U.push(Y),F.push(z)},ae=function(e){n.sendMessage("requestHasSegment",{segmentCoord:e})},oe=function(e,t){var r=t.pushed;n.sendMessage("hasSegment",{segmentInfo:e,pushed:!!r})},se=function(e){Y++,z++,ne.set(e.id,te.get(e.id)),te.delete(e.id),(0,d.createTimeout)(function(){var t=ne.get(e.id);t&&t.timestamp===e.timestamp&&ne.delete(e.id)},u.CHUNK_GRACE_DURATION),this.isBannedSeeder()||ge(u.BLOCK_SEEDER_SCHEDULING_WINDOW)>u.BLOCK_SEEDER_SCHEDULING_TIMEOUT_THRESHOLD&&Y>u.BLOCK_SEEDER_SCHEDULING_REQUEST_THRESHOLD&&(re=Date.now())},ue=function(e,t,r,i){var s=m.default.decode(t),u=!0,l=!1,d=void 0;try{for(var c,f=(0,a.default)(s);!(u=(c=f.next()).done);u=!0){var _=c.value,h=new A.default(e,_,this,o,i,r);te.set(h.id,h)}}catch(e){l=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(l)throw d}}n.sendMessage("requestChunks",{segmentCoord:e,ids:t,safe:r===O.default.SAFE})},le=function(){$?$.clear():N.default.notifyError(new Error("clear() call on undefined Peer.speedMonitorTimer")),n.close()},de=function(){$?$.clear():N.default.notifyError(new Error("clear() call on undefined Peer.speedMonitorTimer")),P.dispose(),q.dispose(),n.destroy()},ce=function(e,n){var i=void 0;switch(e){case"heartbeat":K=n.videoTrack;break;case"requestHasSegment":C.emit("segmentRequested",w,new t(n.segmentCoord));break;case"hasSegment":i=new t(n.segmentInfo.segmentCoord),i.fromPeer=!0;var o=new f.default(i,n.segmentInfo.size,n.segmentInfo.hash),s=!!n.pushed;C.emit("hasSegment",w,o,{pushed:s});break;case"requestChunks":if(!r.isP2PUploadOn)return;i=new t(n.segmentCoord);var u=m.default.decode(n.ids),l=n.safe?O.default.SAFE:O.default.UNSAFE,d=!0,c=!1,_=void 0;try{for(var h,p=(0,a.default)(u);!(d=(h=p.next()).done);d=!0){var g=h.value;r.efficiencyStats.receivedChunkRequestCount++,P.push(new I.default(i,g,r,l))}}catch(e){c=!0,_=e}finally{try{!d&&p.return&&p.return()}finally{if(c)throw _}}break;default:return void N.default.notifyError(new Error("Invalid message "+e+" sent by peerConnection"))}ee||(R.active++,ee=!0)},fe=function(e,t,n){H+=e.byteLength;var i=te.get(A.default.getIdOf(n,t));i?(Y++,i.dataDownloaded(e),j+=e.byteLength,te.delete(i.id)):(X++,i=ne.get(A.default.getIdOf(n,t)),i?(Q++,r.efficiencyStats.gracedChunksCount++,i.dataDownloaded(e),ne.delete(i.id)):(r.efficiencyStats.expiredGraceChunksCount++,r.transferStats.multipleDlM+=e.byteLength)),_e()},_e=function(){G||(R.transfer++,G=!0)},he=function(){return!K||r.moduleState.currentTracks.video.viewToString()===K},pe=function(){return Date.now()-B<u.PEER_INIT_LOCKED_DURATION},ge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.PEER_TIMEOUT_RATIO_WINDOW,t=U.subDelta(e),n=F.subDelta(e);return t>0?n/t:0},ve=function(e){for(var t=0;t<e.length;t++)ae(e[t])};w.getRtt=n.getRtt.bind(n),w.requestHasSegment=ae,w.answerHasSegment=oe,w.requestChunks=ue,w.timeoutChunk=se,w.isOnSameTrack=he,w.close=le,w.getDataDownloaded=function(){return H},w.getDataUploaded=function(){return P.dataUploaded},w.getId=function(){return D},w.getDlSpeed=function(){return V},w.getUpSpeed=function(){return W},w.getUsefulDlSpeedEMA=function(){return k.value},w.getUpSpeedEMA=function(){return L.value},w.getChunkTimeoutCount=function(){return z},w.getChunkRequestedCount=function(){return Y},w.getLateChunksCount=function(){return X},w.getGracedChunksCount=function(){return Q},w.getUploadCapacity=function(){return q.value},w.isLooser=function(){var e=ge()>u.PEER_CRITICAL_CHUNK_TIMEOUT_THRESHOLD,t=L.value<u.LOOSER_UPLOAD_THRESHOLD;return e&&t},w.isBannedSeeder=function(){return Date.now()-re<u.BLOCK_SEEDER_SCHEDULING_DURATION},w.getChunksQuantityForInterval=function(e){var t=q.value*(e/1e3),n=Math.ceil(t*(1+u.PEER_UPLOAD_CAPACITY_EXTRA_RATIO)/(8*u.CHUNK_SIZE/1024)),r=Math.floor(n*u.PEER_UPLOAD_CAPACITY_SAFE_RATIO/(1+u.PEER_UPLOAD_CAPACITY_EXTRA_RATIO));return{safe:r,unsafe:n-r}},w.locked=function(){return(!!u.POST_TRACK_SWITCH_PEER_LOCK_SENSITIVITY_ON||he())&&(pe()||L.value/r.abrStats.estimatedBitrate>u.PEER_LOCKED_UPLOAD_THRESHOLD||k.value/r.abrStats.estimatedBitrate>u.PEER_LOCKED_DOWNLOAD_THRESHOLD)},w.getDebugInfos=function(){return{id:D.slice(-7),RawDownloadSpeed:new g.BitDataAmount(1e3*V,"ps"),RawUploadSpeed:new g.BitDataAmount(1e3*W,"ps"),DataDownloaded:new g.ByteDataAmount(H),DataUploaded:new g.ByteDataAmount(P.dataUploaded),RTT:n.getRtt()>=0?n.getRtt():"unavailable",UploadCapacity:new g.BitDataAmount(1e3*q.value,"ps"),ConenctedDuration:Math.round((Date.now()-B)/1e3),OngoingRequests:te.size,GracingRequests:ne.size,RequestedChunks:Y,GracedChunks:Q,TimeoutChunks:z,LateChunks:X,GracedRatio:(Y?Q/Y:0).toFixed(2),TimeoutRatio:(Y?z/Y:0).toFixed(2),LateRatio:(Y?X/Y:0).toFixed(2),SmoothedUsefulDownloadSpeed:new g.ByteDataAmount(1e3*this.getUsefulDlSpeedEMA()/8,"ps"),SmoothedUploadSpeed:new g.ByteDataAmount(1e3*this.getUpSpeedEMA()/8,"ps"),WindowedTimeoutRatio:ge().toFixed(2),PeerStatus:(this.locked()?"locked":"unlocked")+"-"+(this.isLooser()?"looser":"normal"),
LastCRank:this.lastCRank?this.lastCRank.toFixed(2):"unavailable",SeederTimeoutRatio:ge(u.BLOCK_SEEDER_SCHEDULING_WINDOW).toFixed(2),SeederBanned:this.isBannedSeeder(),VideoTrack:K,SameTrack:he()}},function(){q=new y.default(r,w,i),$=(0,d.createInterval)(ie,u.PEER_SPEED_MONITOR_INTERVAL),P.onTransfering=_e,n.once(S.default.PeerConnection.DISCONNECTED,function(){R.disconnected++,C.emit(S.default.Peer.REMOVE_PEER,w,!0),de()}),n.on(S.default.PeerConnection.BINARY_DATA_RECEIVED,fe),n.on(S.default.PeerConnection.MESSAGE_RECEIVED,ce),C.once("segmentInfo",ve,w),U.push(0),F.push(0)}()};t.default=k,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(35),l=r(u),d=n(65),c=r(d),f=n(17),_=n(4),h=function(){function e(t,n,r){var i=this;(0,a.default)(this,e);var o=t.conf,s=this._getTrimmedWindowTimeout(t),u=new f.Delta(n.getDataDownloaded()),d=new f.Delta(Date.now()),h=new c.default(s),p=new c.default(s);this._capacityEmwa=new l.default(r,o.PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_UP),h.push(n.getChunkTimeoutCount()),p.push(n.getChunkRequestedCount()),this._timer=(0,_.createInterval)(function(){h.push(n.getChunkTimeoutCount()),p.push(n.getChunkRequestedCount());var e=p.delta,t=h.delta,r=u.calcDelta(n.getDataDownloaded()),a=d.calcDelta(Date.now());if(null!==t&&null!==e){var s=8*r/1024*1e3/a,l=e>0?t/e:0;s>=i._capacityEmwa.value?i._capacityEmwa.update(s):l>=o.MAX_PEER_UPLOAD_CAPACITY_TIMEOUT_RATIO&&(o.PUC_EMWA_WEIGHT_USE_TIMEOUT_RATIO?i._capacityEmwa.update(s,Math.min(l,o.PUC_EMWA_WEIGHT_CAP)):i._capacityEmwa.update(s,o.PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_DOWN))}},o.PEER_UPLOAD_CAPACITY_COMPUTATION_INTERVAL)}return(0,s.default)(e,[{key:"_getTrimmedWindowTimeout",value:function(e){var t=e.conf,n=e.moduleState,r=t.PEER_UPLOAD_CAPACITY_COMPUTATION_INTERVAL,i=n.isLive()?t.LIVE.CHUNK_TIMEOUT:t.CHUNK_TIMEOUT;return r*Math.ceil(i/r)+100}},{key:"dispose",value:function(){this._timer.clear()}},{key:"value",get:function(){return this._capacityEmwa.value}}]),e}();t.default=h,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(137),a=r(i),o=n(131),s=r(o),u=n(134),l=r(u),d=n(140),c=r(d),f=n(139),_=r(f),h=n(150),p=r(h),g=n(130),v=r(g),m=n(149),E=r(m),y=n(127),T=r(y),S=n(141),C=r(S),A=n(138),D=r(A),I=n(135),R=r(I),O=n(144),P=r(O),b=n(153),w=r(b),M=n(152),L=n(143),N=r(L),k=n(132),x=r(k),U=n(24),F=r(U),B=n(4),H=n(142),j=r(H),G=n(61),K=r(G),V=n(151),W=r(V),q=n(46),Y=n(145),z=r(Y),Q=n(47),X=n(146),Z=r(X),J=n(5),$=r(J),ee=n(128),te=r(ee),ne=n(133),re=r(ne),ie=n(85),ae=r(ie),oe=n(154),se=r(oe),ue=n(155),le=r(ue),de=n(136),ce=r(de),fe=n(129),_e=r(fe),he=n(147),pe=r(he),ge=n(148),ve=r(ge);$.default.setScriptOrigin(window.document.currentScript&&window.document.currentScript.src?window.document.currentScript.src:null);var me=function e(t,n,r,i,o,u,d){var f=this;if("string"!=typeof d||""===d||d.length>10)throw new Error("Unvalid argument in PeerAgent constructor: integration version must be a non-empty string of less than 10 characters");var h=new te.default,g=new z.default(i,n,d,t,h,r,u);$.default.setCustomer(g.conf.ID_CLIENT),$.default.setMetadata({stream:g.moduleState.content}),(0,q.checkInterface)(W.default,r),(0,q.checkInterface)(K.default,o.prototype),(0,Q.assertStreamType)(u);var m=void 0,y=void 0,S=void 0,A=void 0,I=void 0,O=void 0,b=void 0,L=void 0,k=void 0,U=void 0,H=void 0,G=void 0,V=void 0,Y=void 0,X=void 0,J=!1,ee=void 0,ne=void 0,ie=void 0,oe=new F.default,ue=function(){k=(0,M.createScheduler)(r,A,O,g)},de=function(){U&&(H=new N.default,I=new ce.default,y=new C.default(t,I,o,H,g),S=new D.default(g),Y=new v.default(h,g),t.isLive()?X=new E.default(t,h,g):(0,ve.default)(g),A=new R.default(y,H,g),b=new P.default(H,A,g),L=new w.default(A,g),O=new x.default(r,g),ue(),I.init(A,k),m=new s.default(A,k,g),V=new T.default(h,g),(0,_e.default)(g),re.default.connect(g),a.default.listenEvents(k,A,H,O,g),ne.listenEvents(ie),fe()),J=!0},fe=function e(){if(!t.areBuffersInitialized||t.areBuffersInitialized())g.conf.DEBUG&&(G=new p.default(y,X,g));else{var n=(0,B.createTimeout)(e,300);oe.register(n)}},he=function(e){return e.trackView&&e.trackView.type&&("audio"===e.trackView.type||"video"===e.trackView.type)},ge=function(e){if(!U)throw new Error("P2P is not activated, getP2PData can't be called");var t=void 0;return J?t=U?A.getPartialSegment(e)||new c.default(e,A,H,g):new _.default(e):(ie=he(e),de(),t=new _.default(e)),ie&&ne.updateWithSegmentView(e),k.updateTrackEdge(e),t},me=function(e,t,n){return null!==n&&(0,q.checkInterface)(K.default,n),j.default.getSegment(this,e,t,n,g)},Ee=function(){U&&(J&&(ee.removeAllExternalEventListener(),V.dispose(),m.dispose(),A.dispose(),oe.clearAll(),y.dispose(),S.dispose(),G&&G.dispose(),Y.dispose(),X&&X.dispose()),se.default.removeFromPeerAgentList(g.peerToken),g.dispose())};!function(){(U=ae.default.isP2PEnabled(g.conf))&&(ee=new l.default(t),ne=new pe.default(ee,g))}(),this.getSegment=me,this.getP2PData=ge,this.dispose=Ee,this.setMediaElement=function(e){f.mediaElement=e},Object.defineProperty(this,"mediaElement",{get:function(){return h.mediaElement},set:function(e){h.mediaElement=e}}),Object.defineProperty(this,"p2pDownloadOn",{get:function(){return g.isP2PDownloadOn},set:function(e){e!==g.isP2PDownloadOn&&(g.isP2PDownloadOn=e,g.eventBus.emit("p2pDownloadToggle",e))}}),Object.defineProperty(this,"version",{get:function(){return e.version}}),Object.defineProperty(this,"p2pUploadOn",{get:function(){return g.isP2PUploadOn},set:function(e){e!==g.isP2PUploadOn&&(g.isP2PUploadOn=e,g.eventBus.emit("p2pUploadToggle",e))}}),Object.defineProperty(this,"isP2PEnabled",{get:function(){return ae.default.isP2PEnabled(g.conf)}}),Object.defineProperty(this,"stats",{get:function(){return Z.default.get(y,g,X,h)}}),Object.defineProperty(this,"nextSegmentPrebuffered",{get:function(){return g.moduleState.nextSegmentPrebuffered}}),Object.defineProperty(this,"PublicAPI",{get:function(){return le.default.get(f)}}),se.default.addToPeerAgentList(g.peerToken,this)};Object.defineProperty(me,"StreamTypes",{get:function(){return Q.StreamTypes}}),Object.defineProperty(me,"version",{get:function(){return"4.10.7"}}),se.default.setup(me),t.default=me,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(t){(0,a.default)(this,e),this._conf=t,this._peers=[]}return(0,s.default)(e,[{key:"add",value:function(e){this.remove(e),this._peers.push(e)}},{key:"remove",value:function(e){var t=e.getId();this._peers=this._peers.filter(function(e){return e.getId()!==t})}},{key:"all",value:function(){var e=this;return this._peers.sort(function(t,n){var r=t.getChunksQuantityForInterval(e._conf.CHUNK_BATCHING_INTERVAL).safe;return n.getChunksQuantityForInterval(e._conf.CHUNK_BATCHING_INTERVAL).safe-r})}},{key:"clear",value:function(){this._peers.length=0}},{key:"length",get:function(){return this._peers.length}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(21),i=function(e){return e&&e.__esModule?e:{default:e}}(r),a=function(){var e=!1,t=void 0,n=0,r=0,a=0,o=0,s=0,u=0,l=0,d=0,c="",f=!1,_="",h=this,p=void 0,g=void 0,v=new i.default,m=null,E=function(){var e=void 0,t=void 0,i=void 0,l=void 0;n&&(n>a&&(a=n),e=r?(r*p+n)/(p+1):n,t=p?p+1:1,p=t,r=e),o&&(o>u&&(u=o),i=s?(s*g+o)/(g+1):o,l=g?g+1:1,g=l,s=i)};h.getMyPeerId=function(){return t},h.setMyPeerId=function(e){t!==e&&(t=e)},h.getDlSpeed=function(){return n},h.setDlSpeed=function(e){n=e},h.getAvgDlSpeed=function(){return r},h.getMaxDlSpeed=function(){return a},h.getUpSpeed=function(){return o},h.setUpSpeed=function(e){o=e},h.getAvgUpSpeed=function(){return s},h.getMaxUpSpeed=function(){return u},h.getCdnCancelled=function(){return d},h.increaseCdnCancelledBy=function(e){d+=e},h.getConnected=function(){return e},h.setTrackerVersion=function(e){c=e},h.getTrackerVersion=function(){return c},h.setTrackerId=function(e){_=e},h.getTrackerId=function(){return _},h.setConnected=function(t){t!==e&&(e=t,v.emit("change:connected"),!0===t?v.emit("tracker_ready"):v.emit("tracker_disconnected"))},h.getEE=function(){return v},h.setConnectedToSignalingServer=function(){f=!0,v.emit("signaling_ready")},h.setDisconnectedToSignalingServer=function(){f=!1,v.emit("signaling_disconnected")},h.getConnectedToSignalingServer=function(){return f},h.computeMaxAndAvgSpeed=E,h.setMeanInstantSpeed=function(e){l=e},h.getMeanInstantSpeed=function(){return l},h.setBearerToken=function(e){m=e},h.getBearerToken=function(){return m}};t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,r){var i=t?y.default.Methods.POST:y.default.Methods.GET,a=new y.default(i,e,{headers:{Authorization:r}}),s=t?(0,o.default)(t):null;a.isStreamroot=!0,a.send(s).then(function(e){n(null,e)},function(e){n(e,null)})}Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_TRACK_HASH=void 0;var a=n(38),o=r(a),s=n(18),u=r(s),l=n(0),d=r(l),c=n(1),f=r(c),_=n(21),h=r(_),p=n(24),g=r(p),v=n(4),m=n(64),E=n(48),y=r(E),T=n(2),S=r(T),C=n(5),A=r(C),D={TRACKS:"tracks",RECONNECT:"reconnect"},I={INIT:"init",PEERS:"peers",TRACKS:"tracks"},R=t.DEFAULT_TRACK_HASH="defautTrackHash",O=function(){function e(t,n,r){var i=this;(0,d.default)(this,e),this._conf=r.conf,this._status=r.status,this._moduleState=r.moduleState,this._controlStats=r.controlStats;var a=new h.default;this._trackerProtocolVersion=this._conf.CLIENT_TRACKER_PROTOCOL_VERSION,this._playerInterface=t,this._p2pCacheStats=n,this._connected=!1,this._delayReconnection=this._conf.TRACKER_DELAY_INIT,this._timerStore=new g.default,this._callQueue=[],this._pending=!1,this.getEE=function(){return a},r.eventBus.once(S.default.Distributor.READY,this._init.bind(this)),r.eventBus.on(S.default.Tracker.TRACKER_RECONNECTION_REQUEST,function(){i._init()}),r.eventBus.on(S.default.Tracker.TEMP_TRACKER_DISCONNECTION_REQUEST,function(){i.dispose()}),r.eventBus.on(S.default.Tracker.PERM_TRACKER_DISCONNECTION_REQUEST,function(){i.dispose(!0)})}return(0,f.default)(e,[{key:"_getVideoTrackHash",value:function(){var e=this._moduleState.currentTracks.video;return e?e.viewToString():R}},{key:"askPeers",value:function(e,t){var n=function(e,n){t(e,[n])},r={tracks:[this._getVideoTrackHash()],exclusions:e,peer_number:this._conf.MAX_NUMBER_OF_PEERS_ASKED_BY_GET_PEERS_MESSAGE,current_position:this._moduleState.videoCurrentTime,id:(0,m.unwrap)(this._peerID)};this._injectBufferIntoPayload(r),this._sendRequest(I.PEERS,r,n,!0)}},{key:"dispose",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._disconnect(e),this._timerStore.clearAll()}},{key:"_init",value:function(){if(!0!==this._conf.QOS_P2P_DISABLED&&""!==this._conf.TRACKER_URL&&!this._isPermanentlyDisconnected&&this._conf.CONTENT_ACTIVATED){this._trackerURL=this._conf.TRACKER_URL,this._bearerToken=this._status.getBearerToken();var e=(0,m.unwrap)(this._moduleState.content),t=this._conf.P2P_PROTOCOL_VERSION,n=this._conf.ID_CLIENT,r=this._moduleState.isLive(),i=this._status.getTrackerId(),a=void 0;a=r?{content:e,p2p_protocol:t,customer_id:n,is_live:r,buffer_level_max:this._playerInterface.getBufferLevelMax(),tracker_id:i}:{content:e,p2p_protocol:t,customer_id:n,is_live:r,tracker_id:i},this._sendRequest(I.INIT,a,this._onTrackerReady.bind(this),!0)}}},{key:"_onTrackerReady",value:function(e,t){if(e)return void A.default.notifyError(e);this._peerID=t.peer_id,this._status.setMyPeerId(this._peerID);var n=(0,v.createInterval)(this._publishTracks.bind(this),this._conf.SEND_TRACKS_INTERVAL);this._timerStore.registerAs(D.TRACKS,n),this._status.setConnected(!0),this._status.setTrackerId(t.tracker_id),this._connected=!0,this.getEE().emit("tracker_ready")}},{key:"_publishTracks",value:function(){var e={tracks:[this._getVideoTrackHash()],id:(0,m.unwrap)(this._peerID),current_position:this._moduleState.videoCurrentTime};this._injectBufferIntoPayload(e),this._sendRequest(I.TRACKS,e,function(){},!0)}},{key:"_injectBufferIntoPayload",value:function(e){var t=this._p2pCacheStats.getStats();t&&(this._moduleState.isLive()&&(t.near_edge=this._moduleState.isNearEdge),(0,u.default)(e,{buffer:t}))}},{key:"_sendRequest",value:function(e,t,n,r){var a=this;switch(e){case I.INIT:this._controlStats.sentTrackerInitCount++;break;case I.PEERS:this._controlStats.sentTrackerPeersCount++;break;case I.TRACKS:this._controlStats.sentTrackerTracksCount++;break;default:A.default.notifyError(new Error("Unexpected tracker route: "+e))}var o=function(e,t){if(e&&r)return a._disconnect(),a._scheduleReconnect(),void n(e,t);var o=a._callQueue.shift();void 0===o?a._pending=!1:i(o.url,o.data,o.callback,a._bearerToken),n(e,t)},s=this._trackerURL+e;this._pending?this._callQueue.push({url:s,data:t,callback:o}):(this._pending=!0,i(s,t,o,this._bearerToken))}},{key:"_disconnect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._isPermanentlyDisconnected=e,this._timerStore.clearNamedTimer(D.TRACKS),this._timerStore.clearNamedTimer(D.RECONNECT),this._pending=!1,this._callQueue=[],!0===this._connected&&(this._delayReconnection=this._conf.TRACKER_DELAY_INIT,this._status.setConnected(!1),this._connected=!1,i(this._trackerURL+"bye",{id:(0,m.unwrap)(this._peerID)},function(){},this._bearerToken),this.getEE().emit("tracker_disconnected"))}},{key:"_scheduleReconnect",value:function(){var e=(0,v.createTimeout)(this._init.bind(this),this._delayReconnection);this._timerStore.registerAs(D.RECONNECT,e),this._delayReconnection=Math.min(2*this._delayReconnection,this._conf.TRACKER_DELAY_MAX)}}]),e}();t.default=O},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(16),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=function(){function e(t){(0,s.default)(this,e),this._collection=new a.default,this._computationInterval=t}return(0,l.default)(e,[{key:"getOrCreate",value:function(e){var t=e.getId(),n=this._collection.get(t);return n||(n=e.getChunksQuantityForInterval(this._computationInterval),this._collection.set(t,n)),n}}]),e}();t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,[{key:"getBinaryData",value:function(e,t,n){throw new Error("must be implemented")}},{key:"setBinaryData",value:function(e,t){throw new Error("must be implemented")}},{key:"destroy",value:function(){}},{key:"byteLength",get:function(){return this._byteLength},set:function(e){this._byteLength=e}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=ArrayBuffer,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(10),c=r(d),f=n(9),_=r(f),h=n(191),p=r(h),g=n(190),v=r(g),m=function(e){function t(e){(0,s.default)(this,t);var n=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this));if("number"==typeof e)n._binaryData=new p.default(e);else{if(!(e instanceof p.default))throw new Error(t.ERR_WRONG_PARAM_TYPE);n._binaryData=e}return n}return(0,_.default)(t,e),(0,l.default)(t,[{key:"getBinaryData",value:function(e,t,n){n(this._binaryData.slice(e,e+t))}},{key:"setBinaryData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;0===t&&e.byteLength===this._binaryData.byteLength?this._binaryData=e:this._binaryData=this._appendBuffer(e,t)}},{key:"_appendBuffer",value:function(e,t){var n=new Uint8Array(this._binaryData);return n.set(new Uint8Array(e),t),n.buffer}},{key:"byteLength",get:function(){return this._binaryData.byteLength},set:function(e){throw new TypeError(t.ERR_CANNOT_SET_BYTE_LENGTH)}}]),t}(v.default);m.ERR_CANNOT_SET_BYTE_LENGTH="Cannot manually set the byteLength",m.ERR_WRONG_PARAM_TYPE="Wrong parameter in Segment Constructor",t.default=m,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(2),l=r(u),d=n(90),c=r(d),f=function(){function e(t){(0,a.default)(this,e),this._ee=t,this.gotoIdle()}return(0,s.default)(e,[{key:"_setState",value:function(e){this._state!==e&&(this._prevState=this._state,this._state=e,this._prevState&&this._ee.emit(l.default.BufferManager.STATE_CHANGED,this._prevState,this._state))}},{key:"gotoIdle",value:function(){this._setState(c.default.IDLE)}},{key:"gotoNoPeer",value:function(){this._setState(c.default.NO_PEER)}},{key:"gotoRandom",value:function(){this._setState(c.default.RANDOM)}},{key:"gotoDynamic",value:function(){this._setState(c.default.DYNAMIC)}},{key:"gotoTopSeeder",value:function(){this._setState(c.default.TOP_SEEDER)}},{key:"getState",value:function(){return this._state}},{key:"isIdle",value:function(){return this._state===c.default.IDLE}},{key:"isNoPeer",value:function(){return this._state===c.default.NO_PEER}},{key:"isRandom",value:function(){return this._state===c.default.RANDOM}},{key:"isDynamic",value:function(){return this._state===c.default.DYNAMIC}},{key:"isTopSeeder",value:function(){return this._state===c.default.TOP_SEEDER}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={ZERO:"zero",CRITICALLY_LOW:"crit_low",LOW:"low",MODERATE:"moderate",HIGH:"high"};t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={LOW:"target_low",HIGH:"target_high",RANDOM:"target_random",INIT:"target_init"};t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(17),l=n(4),d=n(35),c=r(d),f=1e3,_=function(){function e(t){(0,a.default)(this,e),this._uploadSpeedDelta=new u.Delta,this._uploadSpeedTimestampDelta=new u.Delta(Date.now()),this._sharedState=t,this._uploadCapacityEMWA=new c.default(0,this._sharedState.conf.LIVE.BUFFER_LEVEL_UPLOAD_SPEED_EMWA_WEIGHT),this._uploadSpeedInterval=(0,l.createInterval)(this._refreshUploadSpeed.bind(this),f)}return(0,s.default)(e,[{key:"_refreshUploadSpeed",value:function(){var e=this._sharedState.transferStats.p2pUploaded,t=this._uploadSpeedDelta.calcDelta(e),n=this._uploadSpeedTimestampDelta.calcDelta(Date.now()),r=8*t/n;r>0&&this._uploadCapacityEMWA.update(r)}},{key:"dispose",value:function(){this._uploadSpeedInterval.clear()}},{key:"uploadCapacityEMWA",get:function(){return this._uploadCapacityEMWA.value}}]),e}();t.default=_,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(21),l=r(u),d=n(24),c=r(d),f=n(2),_=r(f),h=n(5),p=r(h),g=n(4),v=function(){function e(t){(0,a.default)(this,e),this._isCommunicating=!0,this._isConnected=!0,this._rtt=-1,this._ee=new l.default,this._timerStore=new c.default,this._sharedState=t}return(0,s.default)(e,[{key:"_sendHeartbeat",value:function(){return this.sendMessage("heartbeat",{videoTrack:this._getVideoTrack()})}},{key:"_manageHeartbeat",value:function(){var e=this;this._sendHeartbeat();var t=(0,g.createInterval)(function(){e._isCommunicating||(e._sharedState.controlStats.checkHeartbeatFailed++,e._closeConnectionIfOpen()),e._isCommunicating=!1},this._sharedState.conf.CHECK_HEARTBEAT_INTERVAL),n=(0,g.createInterval)(this._sendHeartbeat.bind(this),this._sharedState.conf.SEND_HEARTBEAT_INTERVAL);this._timerStore.register(t),this._timerStore.register(n)}},{key:"_getVideoTrack",value:function(){var e="noTrack";return this._sharedState.moduleState.currentTracks.video&&(e=this._sharedState.moduleState.currentTracks.video.viewToString()),e}},{key:"_setDisconnected",value:function(){return this._isConnected?(this._isConnected=!1,void this._ee.emit(_.default.PeerConnection.DISCONNECTED)):void p.default.notifyError(new Error("Guarded attempt to trigger 'disconnected' event on PeerConnection more than once"))}},{key:"_closeConnectionIfOpen",value:function(){throw new Error("Cannot call abstract method")}},{key:"sendMessage",value:function(e,t){throw new Error("Cannot call abstract method")}},{key:"sendBinaryData",value:function(e,t){throw new Error("Cannot call abstract method")}},{key:"emit",value:function(e){for(var t,n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=this._ee).emit.apply(t,[e].concat(r))}},{key:"on",value:function(e,t){this._ee.on(e,t)}},{key:"once",value:function(e,t){this._ee.once(e,t)}},{key:"getRtt",value:function(){return this._rtt}},{key:"getBufferedAmount",value:function(){throw new Error("Cannot call abstract method")}},{key:"onbufferedamountlow",set:function(e){throw new Error("Cannot call abstract method")}}]),e}();t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(21),l=(r(u),n(2)),d=r(l),c=n(4),f=function(){function e(t,n){var r=this;(0,a.default)(this,e),this._stoppedAskingPeers=!1,this._conf=t,this._eventBus=n,this._updateSegmentTransferToPlayerTimestamp(),this._initTickInerval(),n.on(d.default.SRModuleInterface.SEGMENT_TRANSFERED_TO_MEDIA_ENGINE,function(){r._updateSegmentTransferToPlayerTimestamp()})}return(0,s.default)(e,[{key:"dispose",value:function(){this._tickInterval.clear()}},{key:"_initTickInerval",value:function(){var e=this;this._tickInterval=(0,c.createInterval)(function(){e._checkTimeSinceLastSegmentTransferToPlayer()},1e3)}},{key:"_updateSegmentTransferToPlayerTimestamp",value:function(){this._lastSegmentToPlayerTransferTimestamp=Date.now(),this._stoppedAskingPeers&&this._startAskingPeers()}},{key:"_checkTimeSinceLastSegmentTransferToPlayer",value:function(){Date.now()-this._lastSegmentToPlayerTransferTimestamp>=Number(this._conf.SEGMENT_REQUEST_TIMEOUT_TO_STOP_ASKING_PEERS)&&this._stopAskingPeers()}},{key:"_stopAskingPeers",value:function(){!1===this._stoppedAskingPeers&&(this._stoppedAskingPeers=!0,this._eventBus.emit(d.default.PeerPool.STOP_ASKING_PEERS),this._tickInterval.clear())}},{key:"_startAskingPeers",value:function(){this._stoppedAskingPeers&&(this._stoppedAskingPeers=!1,this._eventBus.emit(d.default.PeerPool.START_ASKING_PEERS),this._initTickInerval())}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(21),l=(r(u),n(2)),d=r(l),c=n(4),f=function(){function e(t,n){var r=this;(0,a.default)(this,e),this._tempDisconnectedFromBackend=!1,this._conf=t,this._eventBus=n,this._updateTransferTimestamp(),this._initTickInerval(),n.on(d.default.UploadQueue.CHUNK_REQUESTED,function(){r._updateTransferTimestamp()}),n.on(d.default.ChunkManager.CHUNK_DOWNLOADED,function(){r._updateTransferTimestamp()}),n.on(d.default.SRModuleInterface.SEGMENT_TRANSFERED_TO_MEDIA_ENGINE,function(){r._updateTransferTimestamp()})}return(0,s.default)(e,[{key:"dispose",value:function(){this._tickInterval.clear()}},{key:"_initTickInerval",value:function(){var e=this;this._tickInterval=(0,c.createInterval)(function(){e._checkTimeSinceLastTransfer()},1e3)}},{key:"_updateTransferTimestamp",value:function(){this._lastTransferTimestamp=Date.now(),this._tempDisconnectedFromBackend&&this._reconnectToBackend()}},{key:"_checkTimeSinceLastTransfer",value:function(){Date.now()-this._lastTransferTimestamp>=Number(this._conf.TRANSFER_ACTIVITY_TIMEOUT_TO_DISCONNECT_FROM_BACKEND)&&this._temporarilyDisconnectFromBackend()}},{key:"_temporarilyDisconnectFromBackend",value:function(){!1===this._tempDisconnectedFromBackend&&(this._tempDisconnectedFromBackend=!0,this._eventBus.emit(d.default.Tracker.TEMP_TRACKER_DISCONNECTION_REQUEST),this._eventBus.emit(d.default.Signaling.TEMP_SIGNALING_DISCONNECTION_REQUEST),this._eventBus.emit(d.default.TrafficAnalytics.STOP_SENDING_USAGE),this._tickInterval.clear())}},{key:"_reconnectToBackend",value:function(){this._tempDisconnectedFromBackend&&(this._tempDisconnectedFromBackend=!1,this._eventBus.emit(d.default.Tracker.TRACKER_RECONNECTION_REQUEST),this._eventBus.emit(d.default.Signaling.SIGNALING_RECONNECTION_REQUEST),this._eventBus.emit(d.default.TrafficAnalytics.RESTART_SENDING_USAGE),this._initTickInerval())}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(21),l=(r(u),n(199)),d=r(l),c=n(198),f=r(c),_=n(2),h=r(_),p=function(){function e(t,n){var r=this;(0,a.default)(this,e),this._conf=t,this._eventBus=n,this._eventBus.on(h.default.Config.CONFIG_UPDATED,function(){r._init()}),this._init()}return(0,s.default)(e,[{key:"dispose",value:function(){this._backendConnectionManager&&this._backendConnectionManager.dispose(),this._askPeersManager&&this._askPeersManager.dispose()}},{key:"_init",value:function(){this._conf.TRANSFER_ACTIVITY_TIMEOUT_TO_DISCONNECT_FROM_BACKEND&&!this._backendConnectionManager&&(this._backendConnectionManager=new d.default(this._conf,this._eventBus)),this._conf.SEGMENT_REQUEST_TIMEOUT_TO_STOP_ASKING_PEERS&&!this._askPeersManager&&(this._askPeersManager=new f.default(this._conf,this._eventBus))}}]),e}();t.default=p,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var i=n(18),a=r(i),o=n(38),s=r(o),u=n(31),l=r(u),d=n(7),c=r(d),f=n(0),_=r(f),h=n(1),p=r(h),g=n(10),v=r(g),m=n(9),E=r(m),y=n(197),T=r(y),S=n(205),C=r(S),A=n(5),D=r(A),I=n(99),R=r(I),O=n(2),P=r(O),b=n(204),w=r(b),M=n(4),L=n(229),N=function(e){function t(e,n,r,i){(0,_.default)(this,t);var a=(0,v.default)(this,(t.__proto__||(0,c.default)(t)).call(this,i));return a._rtcPeerConnection=e,a._rtcDataChannel=n,a._segmentCoord=r,a._initialize(),a}return(0,E.default)(t,e),(0,p.default)(t,[{key:"_initialize",value:function(){var e=this;this._rtcDataChannel.bufferedAmountLowThreshold=this._sharedState.conf.UP_BUFFERED_AMOUNT_LOW_THRESHOLD,this._rtcDataChannel.onclose=function(){e._setDisconnected()},this._rtcDataChannel.onerror=function(t){console.error(t),e._setDisconnected()},this._rtcDataChannel.onmessage=this._messageHandler.bind(this),this._rtcPeerConnection.oniceconnectionstatechange=function(){switch(e._rtcPeerConnection.iceConnectionState){case"failed":case"closed":e._rtcPeerConnection.oniceconnectionstatechange=function(){},e._closeConnectionIfOpen()}},this._manageHeartbeat();var t=(0,M.createInterval)(this._updateRTT.bind(this),this._sharedState.conf.PEER_COMPUTE_RTT_INTERVAL);this._timerStore.register(t)}},{key:"_messageHandler",value:function(e){switch(this._isCommunicating=!0,(0,l.default)(e.data)){case"string":this._messageDataHandler(e.data);break;default:this._binaryDataHandler(e.data)}}},{key:"_messageDataHandler",value:function(e){this._sharedState.transferStats.p2pMessagesDownloaded+=e.length,this._sharedState.transferStats.p2pMessagesCount++;var t=C.default.decode(JSON.parse(e));this.emit(P.default.PeerConnection.MESSAGE_RECEIVED,t.type,t.args)}},{key:"_binaryDataHandler",value:function(e){var t=(0,L.parseMetaData)(e,this._segmentCoord.fromArrayBuffer);this._sharedState.transferStats.p2pHeadersDownloaded+=e.byteLength-t.data.byteLength,this._sharedState.transferStats.p2pMediaDownloaded+=t.data.byteLength,this.emit(P.default.PeerConnection.BINARY_DATA_RECEIVED,t.data,t.chunkIndex,t.segmentCoord)}},{key:"_closeConnectionIfOpen",value:function(){"closing"!==this._rtcDataChannel.readyState&&"closed"!==this._rtcDataChannel.readyState&&this._rtcDataChannel.close(),"closed"!==this._rtcPeerConnection.signalingState&&this._rtcPeerConnection.close(),this._setDisconnected()}},{key:"_handleSendFailure",value:function(e){var t=new Error(e);D.default.notifyError(t),this._setDisconnected()}},{key:"_updateRTT",value:function(){var e=this;R.default.getPeerConnectionRTT(this._rtcPeerConnection,function(t){e._rtt=t})}},{key:"sendMessage",value:function(e,t){if("open"===this._rtcDataChannel.readyState){var n=C.default.encode(e,t),r=(0,s.default)(n);try{this._rtcDataChannel.send(r)}catch(e){return this._handleSendFailure("sendMessage failed while data channel open"),!1}return!0}return this._handleSendFailure("sendMessage failed: DataChannel readyState is not open but "+this._rtcDataChannel.readyState),!1}},{key:"sendBinaryData",value:function(e,t){var n=(0,L.encodeMetaData)(e,t);if("open"===this._rtcDataChannel.readyState){try{this._rtcDataChannel.send(n)}catch(e){return this._handleSendFailure("sendBinaryData failed while data channel open"),!1}return!0}return this._handleSendFailure("sendBinaryData failed: DataChannel readyState is not open but "+this._rtcDataChannel.readyState),!1}},{key:"close",value:function(){this._closeConnectionIfOpen(),this.destroy()}},{key:"destroy",value:function(){this._timerStore.clearAll(),(0,a.default)(this,new w.default)}},{key:"getBufferedAmount",value:function(){return this._rtcDataChannel.bufferedAmount}},{key:"onbufferedamountlow",set:function(e){this._rtcDataChannel.onbufferedamountlow=e}}]),t}(T.default);e.exports=N},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){A.default.notifyError(e)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(37),o=r(a),s=n(249),u=r(s),l=n(18),d=r(l),c=n(8),f=r(c),_=n(16),h=r(_),p=n(0),g=r(p),v=n(1),m=r(v),E=n(207),y=r(E),T=n(201),S=r(T),C=n(5),A=r(C),D=n(99),I=r(D),R=n(228),O=r(R),P=n(24),b=r(P),w=n(4),M=n(36),L=r(M),N=/typ srflx/,k={ordered:!1,maxRetransmits:1},x=function(){function e(t,n,r,i){(0,g.default)(this,e),this._sharedState=i,this._conf=i.conf,this._controlStats=i.controlStats,this._signalingClient=new y.default(i),this._myPeerId=t,this._peerPool=n,this._peerStats=i.peerStats,this._signalingClient.connect(this._conf.SIGNALING_URL,t),this._signalingClient.on("webrtc_offer",this._onOffer.bind(this)),this._signalingClient.on("webrtc_answer",this._onAnswer.bind(this)),this._signalingClient.on("webrtc_icecandidate",this._onIceCandidate.bind(this)),this._peerConnectionCollection=new h.default,this.SegmentCoord=r,this._timerStore=new b.default}return(0,m.default)(e,[{key:"_autoSelectDataChannelType",value:function(){var e=L.default.getUAObject().browser;return"Firefox"===e.name&&"53"===e.major?"limited-retransmits":"limited-lifetime"}},{key:"_getDataChannelOptions",value:function(){var e=this._conf.DATACHANNEL_TYPE;switch("auto"===e&&(e=this._autoSelectDataChannelType()),e){case"reliable":return{ordered:!0};case"limited-lifetime":return{ordered:!1,maxPacketLifeTime:this._conf.DATACHANNEL_MAX_PACKET_LIFETIME};case"limited-retransmits":return{ordered:!1,maxRetransmits:this._conf.DATACHANNEL_MAX_RETRANSMITS};default:return A.default.notifyError(new Error("Invalid data channel type in injected config.")),k}}},{key:"createPeerConnection",value:function(e){var t=this,n=Math.random().toString().substr(2),r=I.default.createPeerConnection(this._conf),a=r.createDataChannel("comm",this._getDataChannelOptions());a.binaryType="arraybuffer";var o=Date.now(),s=this._manageConnectionTimeout(r,e,n,!0),u=this._createOpenDataChannelHandler(r,a,s,e,n,!0);a.onopen=u;var l={remotePeerId:e,rtcPeerConnection:r,connectionAttemptTimestamp:o,connectionTimeout:s,rtcDataChannel:a,connectionProgress:{hasLocalDescription:!1,hasRemoteDescription:!1,hasLocalDescriptionWithStun:!1,hasRemoteDescriptionWithStun:!1,hasLocalStunIceCandidate:!1,
hasRemoteStunIceCandidate:!1}};this._peerConnectionCollection.set(n,l),r.createOffer(function(a){r.setLocalDescription(a,function(){var r=t._conf.TRANSFORM_SDP?I.default.transformOutgoingSdp(a.sdp):a.sdp,i={type:"webrtc_offer",connexion_id:n,sender_id:t._myPeerId,receiver_id:e,sdp:r};t._signalingClient.send(i),l.connectionProgress.hasLocalDescription=!0,N.test(r)&&(l.connectionProgress.hasLocalDescriptionWithStun=!0)},i)},i),this._manageIceCandidate(r,e,n)}},{key:"_manageIceCandidate",value:function(e,t,n){var r=this,i=this._createIceCandidateBucket(this._myPeerId,t,n);this._peerConnectionCollection.get(n).iceCandidatesBucket=i,e.onicecandidate=function(t){if(t.candidate){i.add(t.candidate);var a=r._peerConnectionCollection.get(n);a&&N.test(t.candidate.candidate)&&(a.connectionProgress.hasLocalStunIceCandidate=!0)}"complete"===e.iceGatheringState&&i.triggerEnd()&&(r._controlStats.earlyIceGatheringFinishedCount++,r._controlStats.setSampledIceGatheringDuration(i.timespan))}}},{key:"_onConnexionRefused",value:function(e,t){this._peerConnectionCollection.get(t).rtcPeerConnection.close(),this._peerConnectionCollection.delete(t),this._peerPool.offerDeclined(e)}},{key:"_onConnexionTimeout",value:function(e,t,n,r,i){e.oniceconnectionstatechange=function(){},this._timerStore.clear(i);var a=this._peerConnectionCollection.get(n);this._peerStats.incrementTimeout(e.iceConnectionState,e.iceGatheringState,r,a.connectionProgress),a.iceCandidatesBucket&&a.iceCandidatesBucket.cancel(),"have-local-offer"===e.signalingState&&this._peerStats.unansweredOffer++,e.close();var o=this._peerConnectionCollection.get(n);void 0!==o.connectionAttemptTimestamp&&this._peerStats.failedPeerConnectionAttemptDuration.addSample(Date.now()-o.connectionAttemptTimestamp),this._peerConnectionCollection.delete(n),this._peerPool.connectionAttemptTimeout(t)}},{key:"_manageConnectionTimeout",value:function(e,t,n,r){var i=this,a=(0,w.createTimeout)(function(){i._onConnexionTimeout(e,t,n,r,a)},this._conf.PEER_CONNECTION_TIMEOUT);return this._timerStore.register(a),e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"failed":i._onConnexionTimeout(e,t,n,r,a)}},a}},{key:"_onOffer",value:function(e){var t=this;this._peerStats.offer++;var n=e.sender_id,r=e.connexion_id;if(this.getOpenConnectorSlotsCount()<=0){var a={type:"webrtc_answer",connexion_id:r,sender_id:this._myPeerId,receiver_id:n,accepted:!1};return void this._signalingClient.send(a)}var o=I.default.createPeerConnection(this._conf),s={remotePeerId:n,rtcPeerConnection:o,offeredAttemptTimestamp:Date.now(),connectionProgress:{hasLocalDescription:!1,hasRemoteDescription:!1,hasLocalDescriptionWithStun:!1,hasRemoteDescriptionWithStun:!1,hasLocalStunIceCandidate:!1,hasRemoteStunIceCandidate:!1}};this._peerConnectionCollection.set(r,s),this._manageIceCandidate(o,n,r);var u={sdp:e.sdp,type:"offer"},l=new I.default.SessionDescription(u);o.setRemoteDescription(l,function(){o.createAnswer(function(e){o.setLocalDescription(e,function(){e.sdp=t._conf.TRANSFORM_SDP?I.default.transformOutgoingSdp(e.sdp):e.sdp;var i={type:"webrtc_answer",connexion_id:r,sender_id:t._myPeerId,receiver_id:n,accepted:!0,sdp:e.sdp};t._signalingClient.send(i),s.connectionProgress.hasLocalDescription=!0,N.test(e.sdp)&&(s.connectionProgress.hasLocalDescriptionWithStun=!0)},i)},i),s.connectionProgress.hasRemoteDescription=!0,N.test(l.sdp)&&(s.connectionProgress.hasRemoteDescriptionWithStun=!0)},i);var d=this._manageConnectionTimeout(o,n,r,!1);o.ondatachannel=function(e){var a=e.channel||e;a.binaryType="arraybuffer";var s=t._createOpenDataChannelHandler(o,a,d,n,r,!1);"connecting"===a.readyState?a.onopen=s:s(),a.onerror=i}}},{key:"_createOpenDataChannelHandler",value:function(e,t,n,r,i,a){var o=this;return function(){if(!o._peerConnectionCollection.get(i))return void o._peerStats.lateMessage++;var s=o._peerConnectionCollection.get(i);void 0!==s.connectionAttemptTimestamp&&o._peerStats.successPeerConnectionAttemptDuration.addSample(Date.now()-s.connectionAttemptTimestamp),o._peerConnectionCollection.delete(i),o._timerStore.clear(n);var u=new S.default(e,t,o.SegmentCoord,o._sharedState);o._peerPool.addPeerConnection(r,u,a)}}},{key:"_onAnswer",value:function(e){var t=e.sender_id,n=e.connexion_id;if(!this._peerConnectionCollection.get(n))return void this._peerStats.lateMessage++;var r=this._peerConnectionCollection.get(n),a=r.rtcPeerConnection,o=r.connectionTimeout,s=r.connectionProgress;if(a)if(e.accepted){var u={sdp:e.sdp,type:"answer"},l=new I.default.SessionDescription(u);a.setRemoteDescription(l,function(){s.hasRemoteDescription=!0,N.test(l.sdp)&&(s.hasRemoteDescriptionWithStun=!0)},i)}else this._timerStore.clear(o),this._onConnexionRefused(t,n)}},{key:"_onIceCandidate",value:function(e){var t=e.connexion_id;if(!this._peerConnectionCollection.get(t))return void this._peerStats.lateMessage++;for(var n=this._peerConnectionCollection.get(t),r=n.rtcPeerConnection,i=n.connectionProgress,a=0;a<e.icecandidate_array.length;a++){var o=e.icecandidate_array[a];N.test(o.candidate)&&(i.hasRemoteStunIceCandidate=!0),this._addIceCandidate(r,o)}}},{key:"_addIceCandidate",value:function(e,t){try{e.addIceCandidate(new I.default.IceCandidate(t))}catch(e){A.default.notifyError(e)}}},{key:"_createIceCandidateBucket",value:function(e,t,n){var r=this;return this._controlStats.iceCandidatesBucketCount++,new O.default(function(i){r._signalingClient.send({connexion_id:n,icecandidate_array:i,receiver_id:t,sender_id:e,type:"webrtc_icecandidate"})},function(){r._controlStats.gatheredIceCandidateCount++},function(){r._controlStats.missedIceCandidateCount++},this._conf.ICECANDIDATES_TIMEOUT)}},{key:"getPeerConnectionCount",value:function(){return this._peerConnectionCollection.size}},{key:"getOpenConnectorSlotsCount",value:function(){return Math.max(Math.round(this._peerPool.openSlotsCount()-this.getPeerConnectionCount()*this._conf.EXPECTED_CONNECTION_SUCCESS_RATE),0)}},{key:"dispose",value:function(){this._signalingClient.close(),this._timerStore.clearAll();var e=!0,t=!1,n=void 0;try{for(var r,i=(0,f.default)(this._peerConnectionCollection.values());!(e=(r=i.next()).done);e=!0)r.value.rtcPeerConnection.close()}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"getPendingConnectionDebugInfos",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,a=(0,f.default)(this._peerConnectionCollection.values());!(t=(i=a.next()).done);t=!0){var o=i.value,s=o.rtcPeerConnection,u=s.iceGatheringState,l=s.signalingState,c=s.iceConnectionState,_=o.rtcDataChannel?o.rtcDataChannel.readyState:"offered",h=o.connectionAttemptTimestamp||o.offeredAttemptTimestamp,p=h?Math.round((h+this._conf.PEER_CONNECTION_TIMEOUT-Date.now())/1e3):"unavailable",g={id:o.remotePeerId.slice(-7),timestamp:h,remainingTimeout:p,iceGatheringState:u,signalingState:l,iceConnectionState:c,readyState:_};e.push((0,d.default)(g,o.connectionProgress))}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}return e}},{key:"getPendingConnectionPeers",value:function(){var e=new u.default,t=!0,n=!1,r=void 0;try{for(var i,a=(0,f.default)(this._peerConnectionCollection.values());!(t=(i=a.next()).done);t=!0){var s=i.value;e.add(s.remotePeerId)}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}return(0,o.default)(e)}}]),e}();t.default=x,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=[],n=e.split(","),r=!0,i=!1,a=void 0;try{for(var s,d=(0,u.default)(n);!(r=(s=d.next()).done);r=!0){var c=s.value,f=c.split("-"),_=""!==f[0]?Number(f[0]):NaN,h=""!==f[1]?Number(f[1]):NaN;if(1===f.length&&(0,o.default)(_))t.push(_);else{if(2!==f.length||!(0,o.default)(_)||!(0,o.default)(h))throw new Error("P2P protocol error: could not decode chunk batch");t=t.concat((0,l.range)(_,h))}}}catch(e){i=!0,a=e}finally{try{!r&&d.return&&d.return()}finally{if(i)throw a}}return t}Object.defineProperty(t,"__esModule",{value:!0});var a=n(240),o=r(a),s=n(8),u=r(s),l=n(25);t.default={decode:i},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,[{key:"sendMessage",value:function(){throw new Error("One should not call sendMessage on a PeerConnection that has already been destroyed")}},{key:"sendBinaryData",value:function(){throw new Error("One should not call sendBinaryData on a PeerConnection that has already been destroyed")}},{key:"getRtt",value:function(){throw new Error("One should not call getRtt on a PeerConnection that has already been destroyed")}},{key:"getBufferedAmount",value:function(){throw new Error("One should not call getBufferedAmount on a PeerConnection that has already been destroyed")}},{key:"destroy",value:function(){throw new Error("One should not call destroy on a PeerConnection that has already been destroyed")}},{key:"close",value:function(){throw new Error("One should not call close on a PeerConnection that has already been destroyed")}},{key:"on",value:function(){throw new Error("One should not call on on a PeerConnection that has already been destroyed")}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={a:g[e]},r=l(e),i=o(t,r);return(0,p.default)(n,i),n}function a(e){var t=s(e.a);return{type:t,args:u(e,l(t))}}function o(e,t){var n={},r=!0,i=!1,a=void 0;try{for(var o,s=(0,_.default)((0,c.default)(t));!(r=(o=s.next()).done);r=!0){var u=o.value;if(void 0===e[u])throw new Error("P2P protocol error: missing mandatory property "+u+" from message to encode");var l=t[u];void 0!==l&&(n[l]=e[u])}}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}function s(e){var t=!0,n=!1,r=void 0;try{for(var i,a=(0,_.default)((0,c.default)(g));!(t=(i=a.next()).done);t=!0){var o=i.value;if(g[o]===e)return o}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}return null}function u(e,t){var n={},r=!0,i=!1,a=void 0;try{for(var o,s=(0,_.default)((0,c.default)(t));!(r=(o=s.next()).done);r=!0){var u=o.value,l=t[u],d=e[l];if(void 0===d)throw new Error("P2P protocol error: could not decode property "+u+" from encoded payload");n[u]=d}}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}function l(e){switch(e){case"info":return v;case"heartbeat":return T;case"requestHasSegment":return m;case"hasSegment":return E;case"requestChunks":return y;default:throw new Error("P2P protocol error: unhandled message type")}}Object.defineProperty(t,"__esModule",{value:!0});var d=n(52),c=r(d),f=n(8),_=r(f),h=n(18),p=r(h),g={info:"a",requestHasSegment:"b",hasSegment:"c",requestChunks:"d",heartbeat:"e"},v={city:"c",country:"d",latitude:"e",longitude:"f"},m={segmentCoord:"b"},E={segmentInfo:"b",pushed:"c"},y={segmentCoord:"b",ids:"c",safe:"d"},T={videoTrack:"b"};t.default={encode:i,decode:a},e.exports=t.default},function(e,t,n){"use strict";function r(e,t,n,r){return new i(e,t,n,r)}Object.defineProperty(t,"__esModule",{value:!0});var i=void 0;i=n(202),t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(38),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(49),c=r(d),f=n(5),_=r(f),h=n(2),p=r(h),g=n(4),v=function(){function e(t){var n=this;(0,s.default)(this,e),this._conf=t.conf,this._status=t.status,this._controlStats=t.controlStats,t.eventBus.on(p.default.Signaling.SIGNALING_RECONNECTION_REQUEST,function(){n._createConnection()}),t.eventBus.on(p.default.Signaling.TEMP_SIGNALING_DISCONNECTION_REQUEST,function(){n.close()}),t.eventBus.on(p.default.Signaling.PERM_SIGNALING_DISCONNECTION_REQUEST,function(){n.close(!0)}),this._init()}return(0,l.default)(e,[{key:"connect",value:function(e,t){this._url=e,this._id=t,""!==this._url&&this._createConnection()}},{key:"send",value:function(e){if(this._connection&&this._connection.readyState===WebSocket.OPEN){var t=e.receiver_id+","+(0,a.default)(c.default.omit(e,"receiver_id"));switch(this._connection.send(t),this._controlStats.signalingMessagesCount++,e.type){case"webrtc_answer":this._controlStats.sentAnswerSdpVolume+=t.length;break;case"webrtc_offer":this._controlStats.sentOfferSdpVolume+=t.length;break;case"webrtc_icecandidate":this._controlStats.sentIceCandidatesVolume+=t.length;break;default:_.default.notifyError(new Error("Invalid signaling message type sent."))}}else this._msgBuffer.push(e)}},{key:"on",value:function(e,t){this._handlers[e]=t}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._isPermanentlyDisconnected=e,this._disposing=!0,this._status.setDisconnectedToSignalingServer(),this._stopReconnectionLoop(),this._connection&&this._connection.close(),void 0!==this._connectionTimeout&&(this._connectionTimeout.clear(),delete this._connectionTimeout),void 0!==this._nextReconnectAttempt&&(this._nextReconnectAttempt.clear(),delete this._nextReconnectAttempt),this._init()}},{key:"_createConnection",value:function(){if(!this._isPermanentlyDisconnected){this._disposing=!1,!this._connection||this._connection.readyState!==WebSocket.CONNECTING&&this._connection.readyState!==WebSocket.OPEN||this.close(),this._connection=new WebSocket(this._url+"?id="+this._id+"&p2pVersion=4.10.7&client_id="+this._conf.ID_CLIENT);var e=this._connection;this._connectionTimeout=(0,g.createTimeout)(function(){e.close()},1e4),this._handleConnectionSuccess(),this._handleErrorAndClose(),this._handleMessages()}}},{key:"_handleErrorAndClose",value:function(){var e=this,t=this._connection,n=function(){t===e._connection&&(_.default.notify("Error on signaling connection"),e._status.setDisconnectedToSignalingServer(),e._tryReconnect())};this._connection.onerror=n,this._connection.onclose=n}},{key:"_tryReconnect",value:function(){var e=this,t=function(){delete e._nextReconnectAttempt,e._createConnection(),e._updateDelay()};if(void 0===this._nextReconnectAttempt&&!this._disposing){var n=this._delayReconnection;0===n&&(n=Math.round(Math.random()*this._conf.SIGNALING_DELAY_MAX_INIT)),this._nextReconnectAttempt=(0,g.createTimeout)(t,n)}}},{key:"_updateDelay",value:function(){this._delayReconnection=Math.min(this._delayReconnection+this._conf.SIGNALING_DELAY_STEP,this._conf.SIGNALING_DELAY_MAX)}},{key:"_handleConnectionSuccess",value:function(){var e=this;this._connection.onopen=function(){e._status.setConnectedToSignalingServer(),e._connectionTimeout&&(e._connectionTimeout.clear(),delete e._connectionTimeout),e._stopReconnectionLoop(),e._sendMessagesInBuffer()}}},{key:"_handleMessages",value:function(){var e=this;this._connection.onmessage=function(t){var n=JSON.parse(t.data);if(e._handlers[n.type]){var r=c.default.omit(n,"type");e._handlers[n.type](r)}}}},{key:"_init",value:function(){this._handlers={},this._delayReconnection=0,this._msgBuffer=[]}},{key:"_stopReconnectionLoop",value:function(){this._delayReconnection=0}},{key:"_sendMessagesInBuffer",value:function(){for(var e=0;e<this._msgBuffer.length;e++)this.send(this._msgBuffer[e]);this._msgBuffer=[]}}]),e}();t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,[{key:"viewToString",value:function(){return""}},{key:"isEqual",value:function(e){return!0}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(10),c=r(d),f=n(9),_=r(f),h=n(91),p=r(h),g=function(e){function t(){return(0,s.default)(this,t),(0,c.default)(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}return(0,_.default)(t,e),(0,l.default)(t,[{key:"getSegmentListToDownload",value:function(){var e=[],t=this._currentTracks.audio;t&&(e=this._getSegmentsToDownloadByTrack(t,"audio"));var n=this._currentTracks.video;n&&(e=e.concat(this._getSegmentsToDownloadByTrack(n,"video")));var r=e.sort(function(e,t){return e.getId()-t.getId()});return this._sharedState.conf.USE_VOD_PUSH_PATCH?r.slice(0,this._sharedState.conf.NB_SEGMENT_P2P_PREBUFFER):r}},{key:"updateTrackEdge",value:function(e){var t=this._findTrack(e);"audio"===t?this._edges.update({audio:e,video:null}):"video"===t&&this._edges.update({audio:null,video:e})}},{key:"_findTrack",value:function(e){var t=this._currentTracks.video;if(t&&e.isInTrack(t))return"video";var n=this._currentTracks.audio;return n&&e.isInTrack(n)?"audio":void 0}}]),t}(p.default);t.default=g,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(10),c=r(d),f=n(9),_=r(f),h=n(91),p=r(h),g=function(e){function t(){return(0,s.default)(this,t),(0,c.default)(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}return(0,_.default)(t,e),(0,l.default)(t,[{key:"getSegmentListToDownload",value:function(){var e=[],t=this._currentTracks.video;t&&(e=this._getSegmentsToDownloadByTrack(t,"video"));var n=e.sort(function(e,t){return e.getId()-t.getId()});return this._sharedState.conf.USE_VOD_PUSH_PATCH?n.slice(0,this._sharedState.conf.NB_SEGMENT_P2P_PREBUFFER):n}},{key:"updateTrackEdge",value:function(e){this._currentTracks.video&&e.isInTrack(this._currentTracks.video)&&this._edges.update({video:e,audio:null})}}]),t}(p.default);t.default=g,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(21),l=(r(u),n(2)),d=r(l),c=n(35),f=r(c),_=n(97),h=r(_),p=n(98),g=r(p),v=.1,m=10,E=function(){function e(t){var n=this;(0,a.default)(this,e),this._bandwidthEstimates=[],this._latencyHistory=new g.default(m),this.cdnSpeed=null,this.cdnTimestamp=null,this.p2pSpeed=0,this.estimatedBitrate=0,this.p2pUsefulEstimate=1,this.concurrentP2pDownloaded=0,this.concurrentP2pDownloadCount=0,this.cdnEstimationCount=0,this.zeroP2pSpeedWindowsCount=0,this.p2pSpeedWindowsCount=0,this.feebackCount=0,this.zeroDurationFeedbackCount=0,this.trackSwitchWithPeers=0,this._addBandwidthEstimate=function(e){n.feebackCount++;var t=e.p2pDuration+e.cdnDuration;if(0===t)return void n.zeroDurationFeedbackCount++;var r=e.p2pDownloaded+e.cdnDownloaded/t;n._bandwidthEWMA?n._bandwidthEWMA.update(r):n._bandwidthEWMA=new f.default(r,v),n._bandwidthEstimates.push(n._bandwidthEWMA.value),null!=e.latency&&e.cdnDownloaded>0&&n._latencyHistory.addSample(e.latency)},this._eventBus=t,this._eventBus.on(d.default.SRModuleInterface.ABR_FEEDBACK,this._addBandwidthEstimate)}return(0,s.default)(e,[{key:"flushBandwidthEstimates",value:function(){this._bandwidthEstimates=[]}},{key:"dispose",value:function(){this.flushBandwidthEstimates()}},{key:"bandwidthEstimateCV",get:function(){var e=h.default.meanAbsoluteDeviation(this._bandwidthEstimates),t=h.default.mean(this._bandwidthEstimates);return e&&t&&0!==t?e/t:0}},{key:"latencyHistoricalValue",get:function(){return 0===this._latencyHistory.length?50:Math.round(this._latencyHistory.mean)}}]),e}();t.default=E,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(2),l=r(u),d=n(90),c=r(d),f=n(66),_=r(f),h=function(){function e(t){(0,a.default)(this,e),this._alwaysDynamicBuffer=!0,this._lastLowBuffer=0,this.bufferRefill=0,this.bufferedAmount=0,this.lowerBufferTargetNetChangePerRebound=0,this.sampledHighLowBufferTargetGap=0,this.lowerTargetResetCount=0,this._timeSpentOnEdgeStaircase=new _.default,this._timeSpentWithoutPeerStaircase=new _.default,this._timeSpentDynamicStaircase=new _.default,this._timeSpentTopSeederStaircase=new _.default,this.timeLowerTargetAboveLiveEdgeStaircase=new _.default,this._globalEventBus=t,this._globalEventBus.on(l.default.Scheduler.REACHED_LIVE_EDGE_STATE_CHANGED,this._onLiveEdgeChanged.bind(this)),this._globalEventBus.on(l.default.BufferManager.LOW_BUFFER,this._onLowBuffer.bind(this)),this._globalEventBus.on(l.default.BufferManager.HIGH_BUFFER,this._onHighBuffer.bind(this)),this._globalEventBus.on(l.default.BufferManager.STATE_CHANGED,this._onBufferStateChange.bind(this))}return(0,s.default)(e,[{key:"_onLiveEdgeChanged",value:function(e){var t=e?1:0;this._timeSpentOnEdgeStaircase.updateMetric(t)}},{key:"_onBufferStateChange",value:function(e,t){switch(e){case c.default.NO_PEER:this._timeSpentWithoutPeerStaircase.updateMetric(0);break;case c.default.DYNAMIC:this._timeSpentDynamicStaircase.updateMetric(0);break;case c.default.TOP_SEEDER:this._timeSpentTopSeederStaircase.updateMetric(0)}switch(t){case c.default.NO_PEER:this._timeSpentWithoutPeerStaircase.updateMetric(1),e!==c.default.IDLE&&(this._alwaysDynamicBuffer=!1);break;case c.default.DYNAMIC:this._timeSpentDynamicStaircase.updateMetric(1);break;case c.default.TOP_SEEDER:this._timeSpentTopSeederStaircase.updateMetric(1),this._alwaysDynamicBuffer=!1;break;case c.default.RANDOM:this._alwaysDynamicBuffer=!1}this.bufferState=t}},{key:"_onLowBuffer",value:function(e){this._lastLowBuffer=e}},{key:"_onHighBuffer",value:function(e){this.bufferRefill+=e-this._lastLowBuffer}},{key:"_resetDynamicFlag",value:function(){this._alwaysDynamicBuffer=this.bufferState===c.default.DYNAMIC}},{key:"getTimeSpentOnEdgeRatio",value:function(){return this._timeSpentOnEdgeStaircase.getAverage()}},{key:"getTimeSpentWithoutPeerRatio",value:function(){return this._timeSpentWithoutPeerStaircase.getAverage()}},{key:"getTimeSpentTopSeederRatio",value:function(){return this._timeSpentTopSeederStaircase.getAverage()}},{key:"getTimeSpentDynamicIntegral",value:function(){return this._timeSpentDynamicStaircase.getIntegral()}},{key:"alwaysDynamicBuffer",get:function(){var e=void 0;return e=this.bufferState!==c.default.NO_PEER&&this._alwaysDynamicBuffer,this._resetDynamicFlag(),e}}]),e}();t.default=h,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e),this._sampledIceGatheringDuration=0,this.missedIceCandidateCount=0,this.gatheredIceCandidateCount=0,this.iceCandidatesBucketCount=0,this.earlyIceGatheringFinishedCount=0,this.newPeerConnectionCount=0,this.nbRightHashP2P=0,this.nbWrongHashP2P=0,this.nbRightHashDLM=0,this.nbWrongHashDLM=0,this.checkHeartbeatFailed=0,this.getSegmentSuccess=0,this.getSegmentFallback=0,this.segmentLockTimeout=0,this.fillSegmentSuccess=0,this.fillSegmentFallback=0,this.fillSegmentTimeout=0,this.signalingMessagesCount=0,this.sentOfferSdpVolume=0,this.sentAnswerSdpVolume=0,this.sentIceCandidatesVolume=0,this.sentDistributorRootCount=0,this.sentTrackerInitCount=0,this.sentTrackerPeersCount=0,this.sentTrackerTracksCount=0}return(0,s.default)(e,[{key:"getSampledIceGatheringDuration",value:function(){var e=this._sampledIceGatheringDuration;return this._sampledIceGatheringDuration=0,e}},{key:"setSampledIceGatheringDuration",value:function(e){0===this._sampledIceGatheringDuration&&(this._sampledIceGatheringDuration=e)}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(e){return e&&e.__esModule?e:{default:e}}(r),a=function e(){(0,i.default)(this,e),this.receivedChunkRequestCount=0,this.dequeuedReceivedChunkRequestCount=0,this.missedDequeuedChunkRequestCount=0,this.safeChunkRequestCount=0,this.unsafeChunkRequestCount=0,this.safeChunkRequestTimeoutCount=0,this.unsafeChunkRequestTimeoutCount=0,this.gracedChunksCount=0,this.expiredGraceChunksCount=0};t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=function(){function e(t,n,r){(0,s.default)(this,e),this.abortFragmentCount=0,this.emergencyTrackSwitchCount=0,this.maxBitrate=0,this.minBitrate=0,this._playerInterface=t,this._mediaElementPlaceholder=n,this._mediaMap=r}return(0,l.default)(e,[{key:"duration",get:function(){return!this._playerInterface.isLive()&&this._mediaElementPlaceholder.mediaElement?this._mediaElementPlaceholder.mediaElement.duration:0}},{key:"videoTrackCount",get:function(){var e=this._mediaMap.getTrackList(),t=0,n=!0,r=!1,i=void 0;try{for(var o,s=(0,a.default)(e);!(n=(o=s.next()).done);n=!0){var u=o.value;u.type&&"video"!==u.type||(t++,u.bitrate&&(this.maxBitrate=Math.max(this.maxBitrate,u.bitrate),this.minBitrate=0===this.minBitrate?u.bitrate:Math.min(this.minBitrate,u.bitrate)))}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}return t}}]),e}();t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(66),l=r(u),d=n(92),c=r(d),f=n(93),_=(r(f),n(98)),h=r(_),p=n(233),g=r(p),v=20,m=10,E=function(){function e(t){(0,a.default)(this,e),this.match=0,this.excessMatch=0,this.offer=0,this.openedMatch=0,this.openedOffer=0,this.unansweredOffer=0,this.active=0,this.transfer=0,this.denied=0,this.droppedSameTrack=0,this.droppedOtherTrack=0,this.offerTimeout=0,this.answerTimeout=0,this.timeoutNewConnection=0,this.timeoutCheckingConnection=0,this.timeoutFailedConnection=0,this.timeoutNewIce=0,this.timeoutGatheringIce=0,this.timeoutCompleteIce=0,this.disconnected=0,this.lateMessage=0,this.exclusionSize=0,this.timeoutLocalSdp=0,this.timeoutRemoteSdp=0,this.timeoutLocalSdpWithStun=0,this.timeoutRemoteSdpWithStun=0,this.timeoutWithLocalStunIce=0,this.timeoutWithRemoteStunIce=0,this._statsProvider=t,this.peerPoolUploadCapacity=new l.default,this.locked=new l.default,this.loosers=new l.default,this.successPeerConnectionAttemptDuration=new h.default(v),this.failedPeerConnectionAttemptDuration=new h.default(v),this.dataChannelBufferEmptyingStats=new g.default(m)}return(0,s.default)(e,[{key:"incrementTimeout",value:function(e,t,n,r){switch(n?this.offerTimeout++:this.answerTimeout++,r.hasLocalDescription&&this.timeoutLocalSdp++,r.hasRemoteDescription&&this.timeoutRemoteSdp++,r.hasLocalDescriptionWithStun&&this.timeoutLocalSdpWithStun++,r.hasRemoteDescriptionWithStun&&this.timeoutRemoteSdpWithStun++,r.hasLocalStunIceCandidate&&this.timeoutWithLocalStunIce++,r.hasRemoteStunIceCandidate&&this.timeoutWithRemoteStunIce++,e){case"new":this.timeoutNewConnection++;break;case"checking":this.timeoutCheckingConnection++;break;case"failed":this.timeoutFailedConnection++}switch(t){case"new":this.timeoutNewIce++;break;case"gathering":this.timeoutGatheringIce++;break;case"complete":this.timeoutCompleteIce++}}},{key:"sampledPUC",get:function(){return this._statsProvider.getStat(c.default.PeerStats.SAMPLED_PUC)}}]),e}();t.default=E,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e),this._p2pUseful=0,this.cdnDownloaded=0,this.p2pConsumed=0,this.cdnConsumed=0,this.p2pMediaDownloaded=0,this.p2pHeadersDownloaded=0,this.p2pMessagesDownloaded=0,this.p2pMessagesCount=0,this.p2pUploaded=0,this.multipleDlPP=0,this.multipleDlPC=0,this.multipleDlCP=0,this.multipleDlCC=0,this.multipleDlHP=0,this.multipleDlHD=0,this.multipleDlM=0}return(0,s.default)(e,[{key:"p2pUseful",get:function(){return this._p2pUseful},set:function(e){if(e<this._p2pUseful)throw new TypeError("p2pUseful increment is not a positive number");this._p2pUseful=e}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.CurrentTracks=void 0;var i=n(103),a=r(i),o=n(39),s=r(o),u=n(0),l=r(u),d=n(1),c=r(d),f=n(2),_=r(f);t.CurrentTracks=function(){function e(t){(0,l.default)(this,e),this.audio=void 0,this.video=void 0,this._globalEventBus=t,this._lastSwitchTimestamp=s.default,(0,a.default)(this)}return(0,c.default)(e,[{key:"update",value:function(e){var t=e.audio,n=e.video;if(!t&&!n)throw new Error("There must be at least one updated track");!t||this.audio&&this.audio.viewToString()===t.viewToString()||(this.audio=t,this._globalEventBus.emit(_.default.Metrics.TRACK_SWITCH,{isVideo:!1})),!n||this.video&&this.video.viewToString()===n.viewToString()||(this.video=n||this.video,this._lastSwitchTimestamp=Date.now(),this._globalEventBus.emit(_.default.Metrics.TRACK_SWITCH,{isVideo:!0}))}},{key:"lastSwitchTimestamp",get:function(){return this._lastSwitchTimestamp}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(51),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(176),c=r(d),f=n(186),_=r(f),h=n(61),p=r(h),g=n(46),v=function(){function e(t,n,r,i,o){(0,s.default)(this,e),(0,g.checkInterface)(p.default,t),this.segmentCoord=t,this.chunkManager=new c.default(t,n,r,i,o),this.seeders=new _.default(o.conf),(0,a.default)(this)}return(0,l.default)(e,[{key:"dispose",value:function(){this.chunkManager.dispose(),this.seeders.clear()}},{key:"hasChunksToDownload",get:function(){return this.chunkManager.hasChunksToDownload}}]),e}();t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(103),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(5),c=r(d),f=function(){function e(t,n){(0,s.default)(this,e),this.audio=void 0,this.video=void 0,this._mediaMapCache=t,this._moduleState=n.moduleState,(0,a.default)(this)}return(0,l.default)(e,[{key:"update",value:function(e){var t=e.audio,n=e.video;if(void 0===t&&void 0===n)throw new Error("There must be at least one updated track edge");if(t&&(this.audio=t),n){this.video=n;var r=this._mediaMapCache.getSegmentTime(n);null!==r?this._moduleState.videoCurrentTime=r:c.default.notifyError(new Error("Unexpected getSegmentTime error: track edge timestamp is not supposed to be unreliable"))}}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(50),l=r(u),d=function(){function e(t){(0,a.default)(this,e),this._safeQueue=[],this._unsafeQueue=[],this._sharedState=t}return(0,s.default)(e,[{key:"push",value:function(e){this._sharedState.conf.SPLIT_UPLOAD_QUEUE&&e.bandwidthSafety!==l.default.SAFE?this._unsafeQueue.push(e):this._safeQueue.push(e)}},{key:"shift",value:function(){return this._safeQueue.length?this._safeQueue.shift():this._unsafeQueue.shift()}},{key:"dispose",value:function(){this._safeQueue=[],this._unsafeQueue=[]}},{key:"length",get:function(){return this._safeQueue.length+this._unsafeQueue.length}}]),e}();t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(10),c=r(d),f=n(9),_=r(f),h=n(88),p=r(h),g=function(e){function t(e,n,r,i){(0,s.default)(this,t);var o=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n,i));return o._sharedState=r,o}return(0,_.default)(t,e),(0,l.default)(t,[{key:"isExpired",get:function(){var e=this._sharedState.moduleState.isLive()?this._sharedState.conf.LIVE.CHUNK_UP_TIMEOUT:this._sharedState.conf.CHUNK_UP_TIMEOUT;return Date.now()-this._timestamp>e}}]),t}(p.default);t.default=g,e.exports=t.default},function(e,t,n){"use strict";
function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(10),c=r(d),f=n(9),_=r(f),h=n(221),p=r(h),g=n(96),v=r(g),m=n(2),E=r(m),y=function(e){function t(e,n){(0,s.default)(this,t);var r=new p.default(n),i=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this,r));return i._dataUploaded=0,i._onTransfering=function(){},i._lastBufferedAmountMaxTimestamp=null,i._bufferedAmountAccumulator=0,i._peerConnection=e,i._sharedState=n,i._peerConnection.onbufferedamountlow=i._onBufferedAmountLow.bind(i),i._splittedQueue=r,i}return(0,_.default)(t,e),(0,l.default)(t,[{key:"_validateItem",value:function(e){return!e.isExpired}},{key:"_dequeuedCallback",value:function(e){this._sharedState.efficiencyStats.dequeuedReceivedChunkRequestCount++,this._sharedState.eventBus.emit(E.default.UploadQueue.CHUNK_REQUESTED,this,e)}},{key:"onChunkFound",value:function(e,t){var n=t.byteLength;this._lastBufferedAmountMaxTimestamp&&(this._bufferedAmountAccumulator+=n),this._peerConnection.sendBinaryData(t,e)&&(this._dataUploaded+=n,this._sharedState.transferStats.p2pUploaded+=n,this._onTransfering())}},{key:"onChunkMissed",value:function(){this._sharedState.efficiencyStats.missedDequeuedChunkRequestCount++,this._sharedState.conf.ENABLE_UPLOAD_DEQUEUE_ALL||this.tryDequeue()}},{key:"_canDequeue",value:function(){var e=this._peerConnection.getBufferedAmount()<=this._sharedState.conf.UP_MAX_BUFFERED_AMOUNT;return e||(this._lastBufferedAmountMaxTimestamp=Date.now(),this._bufferedAmountAccumulator=this._peerConnection.getBufferedAmount()),e}},{key:"_onBufferedAmountLow",value:function(){if(this._lastBufferedAmountMaxTimestamp){var e=Date.now()-this._lastBufferedAmountMaxTimestamp;e>0&&this._sharedState.peerStats.dataChannelBufferEmptyingStats.addSample({time:e,amount:this._bufferedAmountAccumulator}),this._lastBufferedAmountMaxTimestamp=null}this._sharedState.conf.ENABLE_UPLOAD_DEQUEUE_ALL?this.tryDequeueAll():this.tryDequeue()}},{key:"dispose",value:function(){this._splittedQueue.dispose()}},{key:"dataUploaded",get:function(){return this._dataUploaded}},{key:"onTransfering",set:function(e){this._onTransfering=e}}]),t}(v.default);t.default=y,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=void 0;u=n(226);var l=function(){function e(){(0,a.default)(this,e),this._disposed=!1}return(0,s.default)(e,[{key:"callHashWorker",value:function(e,t){var n=this;return u(e,function(){n._disposed||t.apply(void 0,arguments)})}},{key:"dispose",value:function(){this._disposed=!0}}]),e}();t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(){var e={mul32:function(e,t){var n=65535&t;return((t-n)*e|0)+(n*e|0)|0},hashBytes:function(e,t,n){for(var r=3432918353,i=461845907,a=n,o=-4&t,s=0;s<o;s+=4){var u=255&e[s]|(255&e[s+1])<<8|(255&e[s+2])<<16|(255&e[s+3])<<24;u=this.mul32(u,r),u=(131071&u)<<15|u>>>17,u=this.mul32(u,i),a^=u,a=(524287&a)<<13|a>>>19,a=5*a+3864292196|0}switch(u=0,t%4){case 3:u=(255&e[o+2])<<16;case 2:u|=(255&e[o+1])<<8;case 1:u|=255&e[o],u=this.mul32(u,r),u=(131071&u)<<15|u>>>17,u=this.mul32(u,i),a^=u}return a^=t,a^=a>>>16,a=this.mul32(a,2246822507),a^=a>>>13,a=this.mul32(a,3266489909),a^=a>>>16}};self.onmessage=function(t){var n=new Uint8Array(t.data.segmentData),r=e.hashBytes(n,n.length,0).toString();self.postMessage({segmentData:t.data.segmentData,jobIndex:t.data.jobIndex,hash:r},[t.data.segmentData])}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){var t=e.data,n=t.jobIndex,r=t.segmentData,i=t.hash,a=s[n];delete s[n],a(r,i)}function i(e,t){var n=s.push(t)-1;u.postMessage({segmentData:e,jobIndex:n},[e])}Object.defineProperty(t,"__esModule",{value:!0});var a=n(225),o=function(e){return e&&e.__esModule?e:{default:e}}(a),s=[],u=function(){try{var e=URL.createObjectURL(new Blob(["("+o.default.toString()+")()"],{type:"application/javascript"})),t=new Worker(e);return URL.revokeObjectURL(e),t}catch(e){return{onerror:null,onmessage:null,postMessage:function(){},terminate:function(){}}}}();u.onmessage=r,t.default=i,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){for(var n=[],r=0;r<e.length;r++)(0,a.default)(e[r],t)||n.push(e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var i=n(246),a=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default={without:r},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(4),l=function(){function e(t,n,r,i){(0,a.default)(this,e),this._startTime=Date.now(),this._timespan=0,this._callbacks={added:n,finished:t,missed:r},this._elements=[],this._ended=!1,this._timer=(0,u.createTimeout)(this._ends.bind(this),i)}return(0,s.default)(e,[{key:"add",value:function(e){this._callbacks.added(e),this._ended?this._callbacks.missed(e):this._elements.push(e)}},{key:"triggerEnd",value:function(){return!this._ended&&(this._timer.clear(),this._ends(),this._timespan=Date.now()-this._startTime,!0)}},{key:"cancel",value:function(){if(!this._ended)return this._timer.clear(),this._ended=!0,this._elements=[],this._timespan=Date.now()-this._startTime,!0}},{key:"_ends",value:function(){this._ended=!0,this._callbacks.finished(this._elements),this._elements=[]}},{key:"timespan",get:function(){return this._timespan}}]),e}();t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){var n=t.chunkIndex,r=t.segmentCoord,i=r.toArrayBuffer(),o=(0,a.numToUint8Array4)(n),s=e.byteLength,u=(0,a.uint16ToUint8Array2)(s),l=new Uint8Array(o.byteLength+u.byteLength+s+i.byteLength);return l.set(o,0),l.set(u,4),l.set(new Uint8Array(e),6),l.set(new Uint8Array(i),6+s),l.buffer}function i(e,t){var n=e.slice(0,4),r=e.slice(4,6),i=new Uint16Array(r)[0],a=e.slice(6,6+i),o=e.slice(6+i),s=new Uint32Array(n)[0];return{segmentCoord:t(o),chunkIndex:s,data:a}}Object.defineProperty(t,"__esModule",{value:!0}),t.parseMetaData=t.encodeMetaData=void 0;var a=n(95);t.encodeMetaData=r,t.parseMetaData=i},function(e,t,n){"use strict";function r(e,t){if("string"!=typeof e||!e.length)throw new TypeError(t)}function i(e){var t=e.contentUrl,n=e.contentId;if(null!==n&&void 0!==n)return r(n,"Unvalid p2pConfig property: contentId needs to be a non-empty string"),n;r(t,"Unvalid PeerAgent constructor argument: contentUrl needs to be a non-empty string");var i=o.default.parse(t,!0,!0);return i.host+i.pathname}Object.defineProperty(t,"__esModule",{value:!0}),t.formatContentId=void 0;var a=n(334),o=function(e){return e&&e.__esModule?e:{default:e}}(a);t.formatContentId=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.noop=function(){}},function(e,t,n){"use strict";function r(e){if(null===e.mediaElement)return 0;for(var t=e.mediaElement.buffered,n=e.mediaElement.currentTime,r=n,a=0;a<t.length;a++)t.start(a)<r+i&&t.end(a)>r&&(r=t.end(a));return r-n}Object.defineProperty(t,"__esModule",{value:!0});var i=.3;t.default={getBufferedAmount:r},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(t){(0,a.default)(this,e),this._maxSize=t,this._internalQueue=[]}return(0,s.default)(e,[{key:"addSample",value:function(e){this._internalQueue.length>=this._maxSize&&this._internalQueue.shift(),this._internalQueue.push(e)}},{key:"fetchSample",value:function(){if(this._internalQueue.length>0){var e=Math.floor(Math.random()*this._internalQueue.length);return this._internalQueue.splice(e,1)[0]}}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e,t,n){if(void 0!==t.backendUrl&&(e.DISTRIBUTOR.URL=t.backendUrl,e.DISTRIBUTOR.OVERRIDDEN=!0),t.cacheSize&&(e.P2P_CACHE_MAX_SIZE=1024*t.cacheSize*1024,e.LIVE.P2P_CACHE_MAX_SIZE=e.P2P_CACHE_MAX_SIZE),void 0!==t.activateP2P&&(e.ALLOW_P2P=!!t.activateP2P),void 0!==t.debug&&(e.DEBUG=!!t.debug),t.signalingUrl&&(e.SIGNALING_URL=t.signalingUrl),t.trackerUrl&&(e.TRACKER_URL=t.trackerUrl),t.analyticsUrl&&(e.ANALYTICS.KLARA_URL=t.analyticsUrl),t.deviceInfo&&(e.DEVICE_INFO=t.deviceInfo),void 0!==t.rangeRequestEnabled&&(e.RANGE_REQUEST_ALLOWED=!!t.rangeRequestEnabled),void 0!==t.enableStunServers&&(e.ENABLE_STUN=!!t.enableStunServers),!t.streamrootKey)throw new Error("There must be a streamrootKey in the P2PConfig object");e.ID_CLIENT=t.streamrootKey,e.ENABLE_MOBILE_BROWSER=!!t.mobileBrowserEnabled,e.P2P_PROTOCOL_VERSION+="-"+n}function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return void 0===t.CONF_LABEL?void o.default.notify("Received config from distributor, but no CONF_LABEL was present"):(e.CONF_LABEL=t.CONF_LABEL,n&&(e.P2P_PROTOCOL_VERSION+="-"+e.CONF_LABEL),void 0!==t.BACKEND_USE_SSL&&(e.BACKEND_USE_SSL=t.BACKEND_USE_SSL),void 0!==t.CHUNK_BATCHING_INTERVAL&&(e.CHUNK_BATCHING_INTERVAL=t.CHUNK_BATCHING_INTERVAL),void 0!==t.NB_SEGMENT_P2P_PREBUFFER&&(e.NB_SEGMENT_P2P_PREBUFFER=t.NB_SEGMENT_P2P_PREBUFFER),void 0!==t.MAX_BUFFER_DURATION&&(e.MAX_BUFFER_DURATION=t.MAX_BUFFER_DURATION),void 0!==t.MAX_NUMBER_OF_PEERS_ASKED_BY_GET_PEERS_MESSAGE&&(e.MAX_NUMBER_OF_PEERS_ASKED_BY_GET_PEERS_MESSAGE=t.MAX_NUMBER_OF_PEERS_ASKED_BY_GET_PEERS_MESSAGE),void 0!==t.CHUNK_TIMEOUT&&(e.CHUNK_TIMEOUT=t.CHUNK_TIMEOUT),void 0!==t.CHUNK_UP_TIMEOUT&&(e.CHUNK_UP_TIMEOUT=t.CHUNK_UP_TIMEOUT),void 0!==t.ICECANDIDATES_TIMEOUT&&(e.ICECANDIDATES_TIMEOUT=t.ICECANDIDATES_TIMEOUT),void 0!==t.UP_BUFFERED_AMOUNT_LOW_THRESHOLD&&(e.UP_BUFFERED_AMOUNT_LOW_THRESHOLD=t.UP_BUFFERED_AMOUNT_LOW_THRESHOLD),void 0!==t.UP_MAX_BUFFERED_AMOUNT&&(e.UP_MAX_BUFFERED_AMOUNT=t.UP_MAX_BUFFERED_AMOUNT),void 0!==t.OFFER_DECLINED_EXCLUSION_DURATION&&(e.OFFER_DECLINED_EXCLUSION_DURATION=t.OFFER_DECLINED_EXCLUSION_DURATION),void 0!==t.PEER_REMOVED_EXCLUSION_DURATION&&(e.PEER_REMOVED_EXCLUSION_DURATION=t.PEER_REMOVED_EXCLUSION_DURATION),void 0!==t.PEER_CONNECTION_ATTEMPT_TIMED_OUT_EXCLUSION_DURATION&&(e.PEER_CONNECTION_ATTEMPT_TIMED_OUT_EXCLUSION_DURATION=t.PEER_CONNECTION_ATTEMPT_TIMED_OUT_EXCLUSION_DURATION),void 0!==t.MIN_CHUNK_PERCENTAGE_DOWNLOADED_FOR_HAS_SEGMENT_ANSWER&&(e.MIN_CHUNK_PERCENTAGE_DOWNLOADED_FOR_HAS_SEGMENT_ANSWER=t.MIN_CHUNK_PERCENTAGE_DOWNLOADED_FOR_HAS_SEGMENT_ANSWER),void 0!==t.ALLOW_LIVE_PUSH_SEGMENT&&(e.ALLOW_LIVE_PUSH_SEGMENT=t.ALLOW_LIVE_PUSH_SEGMENT),void 0!==t.ALLOW_VOD_PUSH_SEGMENT&&(e.ALLOW_VOD_PUSH_SEGMENT=t.ALLOW_VOD_PUSH_SEGMENT),void 0!==t.USE_VOD_PUSH_PATCH&&(e.USE_VOD_PUSH_PATCH=t.USE_VOD_PUSH_PATCH),void 0!==t.STUNSERVERS&&(e.STUNSERVERS=t.STUNSERVERS),void 0!==t.TRANSFORM_SDP&&(e.TRANSFORM_SDP=t.TRANSFORM_SDP),void 0!==t.LIVE&&(void 0!==t.LIVE.CHUNK_TIMEOUT&&(e.LIVE.CHUNK_TIMEOUT=t.LIVE.CHUNK_TIMEOUT),void 0!==t.LIVE.CHUNK_UP_TIMEOUT&&(e.LIVE.CHUNK_UP_TIMEOUT=t.LIVE.CHUNK_UP_TIMEOUT),void 0!==t.LIVE.LOWER_BUFFER_TARGET&&(e.LIVE.LOWER_BUFFER_TARGET=t.LIVE.LOWER_BUFFER_TARGET),void 0!==t.LIVE.HIGHER_BUFFER_TARGET&&(e.LIVE.HIGHER_BUFFER_TARGET=t.LIVE.HIGHER_BUFFER_TARGET),void 0!==t.LIVE.BUFFER_LEVEL_UPLOAD_SPEED_EMWA_WEIGHT&&(e.LIVE.BUFFER_LEVEL_UPLOAD_SPEED_EMWA_WEIGHT=t.LIVE.BUFFER_LEVEL_UPLOAD_SPEED_EMWA_WEIGHT),void 0!==t.LIVE.UPLOAD_THRESHOLD_MAX_BUFFER_TARGET_LOCKING&&(e.LIVE.UPLOAD_THRESHOLD_MAX_BUFFER_TARGET_LOCKING=t.LIVE.UPLOAD_THRESHOLD_MAX_BUFFER_TARGET_LOCKING),void 0!==t.LIVE.QOS_REF_PERCENTAGE&&(e.LIVE.QOS_REF_PERCENTAGE=t.LIVE.QOS_REF_PERCENTAGE),void 0!==t.LIVE.NEAR_EDGE_MARGIN&&(e.LIVE.NEAR_EDGE_MARGIN=t.LIVE.NEAR_EDGE_MARGIN),void 0!==t.LIVE.LOW_TARGET_P2P_DL_BLOCK_DURATION&&(e.LIVE.LOW_TARGET_P2P_DL_BLOCK_DURATION=t.LIVE.LOW_TARGET_P2P_DL_BLOCK_DURATION),void 0!==t.LIVE.CRITICAL_LOWER_TARGET_RATIO&&(e.LIVE.CRITICAL_LOWER_TARGET_RATIO=t.LIVE.CRITICAL_LOWER_TARGET_RATIO),void 0!==t.LIVE.FAST_BUFFER_FILL_FRACTION&&(e.LIVE.FAST_BUFFER_FILL_FRACTION=t.LIVE.FAST_BUFFER_FILL_FRACTION),void 0!==t.LIVE.LOWER_BUFFER_TARGET_DECREASE_STEP&&(e.LIVE.LOWER_BUFFER_TARGET_DECREASE_STEP=t.LIVE.LOWER_BUFFER_TARGET_DECREASE_STEP),void 0!==t.LIVE.LOWER_BUFFER_TARGET_INCREASE_STEP&&(e.LIVE.LOWER_BUFFER_TARGET_INCREASE_STEP=t.LIVE.LOWER_BUFFER_TARGET_INCREASE_STEP),void 0!==t.LIVE.ENABLE_DYNAMIC_LOWER_TARGET&&(e.LIVE.ENABLE_DYNAMIC_LOWER_TARGET=t.LIVE.ENABLE_DYNAMIC_LOWER_TARGET)),void 0!==t.QOS_REF_PERCENTAGE&&(e.QOS_REF_PERCENTAGE=t.QOS_REF_PERCENTAGE),void 0!==t.PEER_UPLOAD_CAPACITY_COMPUTATION_INTERVAL&&(e.PEER_UPLOAD_CAPACITY_COMPUTATION_INTERVAL=t.PEER_UPLOAD_CAPACITY_COMPUTATION_INTERVAL),void 0!==t.DEFAULT_PEER_UPLOAD_CAPACITY&&(e.DEFAULT_PEER_UPLOAD_CAPACITY=t.DEFAULT_PEER_UPLOAD_CAPACITY),void 0!==t.MIN_PEER_UPLOAD_CAPACITY&&(e.MIN_PEER_UPLOAD_CAPACITY=t.MIN_PEER_UPLOAD_CAPACITY),void 0!==t.MAX_PEER_UPLOAD_CAPACITY_TIMEOUT_RATIO&&(e.MAX_PEER_UPLOAD_CAPACITY_TIMEOUT_RATIO=t.MAX_PEER_UPLOAD_CAPACITY_TIMEOUT_RATIO),void 0!==t.PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_UP&&(e.PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_UP=t.PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_UP),void 0!==t.PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_DOWN&&(e.PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_DOWN=t.PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_DOWN),void 0!==t.PUC_EMWA_WEIGHT_USE_TIMEOUT_RATIO&&(e.PUC_EMWA_WEIGHT_USE_TIMEOUT_RATIO=t.PUC_EMWA_WEIGHT_USE_TIMEOUT_RATIO),void 0!==t.PUC_EMWA_WEIGHT_CAP&&(e.PUC_EMWA_WEIGHT_CAP=t.PUC_EMWA_WEIGHT_CAP),void 0!==t.PEER_UPLOAD_CAPACITY_SAFE_RATIO&&(e.PEER_UPLOAD_CAPACITY_SAFE_RATIO=t.PEER_UPLOAD_CAPACITY_SAFE_RATIO),void 0!==t.PEER_UPLOAD_CAPACITY_EXTRA_RATIO&&(e.PEER_UPLOAD_CAPACITY_EXTRA_RATIO=t.PEER_UPLOAD_CAPACITY_EXTRA_RATIO),void 0!==t.SPLIT_UPLOAD_QUEUE&&(e.SPLIT_UPLOAD_QUEUE=t.SPLIT_UPLOAD_QUEUE),void 0!==t.ENABLE_UPLOAD_DEQUEUE_ALL&&(e.ENABLE_UPLOAD_DEQUEUE_ALL=t.ENABLE_UPLOAD_DEQUEUE_ALL),void 0!==t.USE_CONTINOUS_PROGRESS_FEEDBACK&&(e.USE_CONTINOUS_PROGRESS_FEEDBACK=t.USE_CONTINOUS_PROGRESS_FEEDBACK),void 0!==t.PROGRESS_ADD_TOTAL&&(e.PROGRESS_ADD_TOTAL=t.PROGRESS_ADD_TOTAL),void 0!==t.DATACHANNEL_MAX_PACKET_LIFETIME&&(e.DATACHANNEL_MAX_PACKET_LIFETIME=t.DATACHANNEL_MAX_PACKET_LIFETIME),void 0!==t.DATACHANNEL_TYPE&&(e.DATACHANNEL_TYPE=t.DATACHANNEL_TYPE),void 0!==t.DATACHANNEL_MAX_RETRANSMITS&&(e.DATACHANNEL_MAX_RETRANSMITS=t.DATACHANNEL_MAX_RETRANSMITS),void 0!==t.ANALYTICS&&void 0!==t.ANALYTICS.EXPOSE_CONF_LABEL&&(e.ANALYTICS.EXPOSE_CONF_LABEL=t.ANALYTICS.EXPOSE_CONF_LABEL),void 0!==t.RANGE_REQUEST_ALLOWED&&(e.RANGE_REQUEST_ALLOWED=t.RANGE_REQUEST_ALLOWED),void 0!==t.ENABLE_STUN&&(e.ENABLE_STUN=t.ENABLE_STUN),void 0!==t.P2P_SPEED_ZERO_THRESHOLD&&(e.P2P_SPEED_ZERO_THRESHOLD=t.P2P_SPEED_ZERO_THRESHOLD),void 0!==t.P2P_SPEED_ESTIMATION_BUCKET_DURATION&&(e.P2P_SPEED_ESTIMATION_BUCKET_DURATION=t.P2P_SPEED_ESTIMATION_BUCKET_DURATION),void 0!==t.P2P_SPEED_ESTIMATION_BUCKET_COUNT&&(e.P2P_SPEED_ESTIMATION_BUCKET_COUNT=t.P2P_SPEED_ESTIMATION_BUCKET_COUNT),void 0!==t.P2P_SPEED_EMA_WEIGHT&&(e.P2P_SPEED_EMA_WEIGHT=t.P2P_SPEED_EMA_WEIGHT),void 0!==t.P2P_SPEED_EMA_ZERO_HALF_LIFE&&(e.P2P_SPEED_EMA_ZERO_HALF_LIFE=t.P2P_SPEED_EMA_ZERO_HALF_LIFE),void 0!==t.P2P_USEFUL_SMA_WINDOW&&(e.P2P_USEFUL_SMA_WINDOW=t.P2P_USEFUL_SMA_WINDOW),void 0!==t.P2P_USEFUL_CALCULATION_INTERVAL&&(e.P2P_USEFUL_CALCULATION_INTERVAL=t.P2P_USEFUL_CALCULATION_INTERVAL),void 0!==t.P2P_USEFUL_RATIO_WEIGHT&&(e.P2P_USEFUL_RATIO_WEIGHT=t.P2P_USEFUL_RATIO_WEIGHT),void 0!==t.P2P_DL_THRESHOLD_FOR_USEFUL_CORRECTION&&(e.P2P_DL_THRESHOLD_FOR_USEFUL_CORRECTION=t.P2P_DL_THRESHOLD_FOR_USEFUL_CORRECTION),void 0!==t.CDN_SPEED_ESTIMATE_CONSIDER_P2P&&(e.CDN_SPEED_ESTIMATE_CONSIDER_P2P=t.CDN_SPEED_ESTIMATE_CONSIDER_P2P),void 0!==t.ABR_SEGMENT_CDN_RATIO_THRESHOLD&&(e.ABR_SEGMENT_CDN_RATIO_THRESHOLD=t.ABR_SEGMENT_CDN_RATIO_THRESHOLD),void 0!==t.ABR_CDN_DL_THRESHOLD&&(e.ABR_CDN_DL_THRESHOLD=t.ABR_CDN_DL_THRESHOLD),void 0!==t.ABR_CDN_DL_DECAY_TIME&&(e.ABR_CDN_DL_DECAY_TIME=t.ABR_CDN_DL_DECAY_TIME),void 0!==t.USE_COMBINED_ABR_FEEDBACK&&(e.USE_COMBINED_ABR_FEEDBACK=t.USE_COMBINED_ABR_FEEDBACK),void 0!==t.CDN_CONCURRENT_SCALING_CAP&&(e.CDN_CONCURRENT_SCALING_CAP=t.CDN_CONCURRENT_SCALING_CAP),void 0!==t.ABR_CDN_SPEED_UPDATE_RATIO_THRESHOLD&&(e.ABR_CDN_SPEED_UPDATE_RATIO_THRESHOLD=t.ABR_CDN_SPEED_UPDATE_RATIO_THRESHOLD),void 0!==t.ENABLE_LATENCY_FEEDBACK&&(e.ENABLE_LATENCY_FEEDBACK=t.ENABLE_LATENCY_FEEDBACK),void 0!==t.ENABLE_PREBUFFER_FEEDBACK&&(e.ENABLE_PREBUFFER_FEEDBACK=t.ENABLE_PREBUFFER_FEEDBACK),void 0!==t.PEER_UPLOAD_SPEED_EMA_HALF_LIFE&&(e.PEER_UPLOAD_SPEED_EMA_HALF_LIFE=t.PEER_UPLOAD_SPEED_EMA_HALF_LIFE),void 0!==t.PEER_DOWNLOAD_SPEED_EMA_HALF_LIFE&&(e.PEER_DOWNLOAD_SPEED_EMA_HALF_LIFE=t.PEER_DOWNLOAD_SPEED_EMA_HALF_LIFE),void 0!==t.PEER_INIT_LOCKED_DURATION&&(e.PEER_INIT_LOCKED_DURATION=t.PEER_INIT_LOCKED_DURATION),void 0!==t.PEER_LOCKED_UPLOAD_THRESHOLD&&(e.PEER_LOCKED_UPLOAD_THRESHOLD=t.PEER_LOCKED_UPLOAD_THRESHOLD),void 0!==t.PEER_LOCKED_DOWNLOAD_THRESHOLD&&(e.PEER_LOCKED_DOWNLOAD_THRESHOLD=t.PEER_LOCKED_DOWNLOAD_THRESHOLD),void 0!==t.PEER_SPEED_MONITOR_INTERVAL&&(e.PEER_SPEED_MONITOR_INTERVAL=t.PEER_SPEED_MONITOR_INTERVAL),void 0!==t.PEER_TIMEOUT_RATIO_WINDOW&&(e.PEER_TIMEOUT_RATIO_WINDOW=t.PEER_TIMEOUT_RATIO_WINDOW),void 0!==t.PEER_CRITICAL_CHUNK_TIMEOUT_THRESHOLD&&(e.PEER_CRITICAL_CHUNK_TIMEOUT_THRESHOLD=t.PEER_CRITICAL_CHUNK_TIMEOUT_THRESHOLD),void 0!==t.LOOSER_UPLOAD_THRESHOLD&&(e.LOOSER_UPLOAD_THRESHOLD=t.LOOSER_UPLOAD_THRESHOLD),void 0!==t.CHUNK_GRACE_DURATION&&(e.CHUNK_GRACE_DURATION=t.CHUNK_GRACE_DURATION),void 0!==t.PEER_POOL_LIMIT&&(e.PEER_POOL_LIMIT=t.PEER_POOL_LIMIT),void 0!==t.RESERVED_OFFER_SLOTS&&(e.RESERVED_OFFER_SLOTS=t.RESERVED_OFFER_SLOTS),void 0!==t.CANDIDATE_PEERS_TRY_DEQUEUE_INTERVAL&&(e.CANDIDATE_PEERS_TRY_DEQUEUE_INTERVAL=t.CANDIDATE_PEERS_TRY_DEQUEUE_INTERVAL),void 0!==t.EXPECTED_CONNECTION_SUCCESS_RATE&&(e.EXPECTED_CONNECTION_SUCCESS_RATE=t.EXPECTED_CONNECTION_SUCCESS_RATE),void 0!==t.POST_TRACK_SWITCH_PEER_LOCK_SENSITIVITY_ON&&(e.POST_TRACK_SWITCH_PEER_LOCK_SENSITIVITY_ON=t.POST_TRACK_SWITCH_PEER_LOCK_SENSITIVITY_ON),void 0!==t.POST_TRACK_SWITCH_PEER_SPEED_SENSITIVITY_DURATION&&(e.POST_TRACK_SWITCH_PEER_SPEED_SENSITIVITY_DURATION=t.POST_TRACK_SWITCH_PEER_SPEED_SENSITIVITY_DURATION),void 0!==t.PEER_UPLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE&&(e.PEER_UPLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE=t.PEER_UPLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE),void 0!==t.PEER_DOWNLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE&&(e.PEER_DOWNLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE=t.PEER_DOWNLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE),void 0!==t.MAX_TRACKER_EXCLUSION_LENGTH&&(e.MAX_TRACKER_EXCLUSION_LENGTH=t.MAX_TRACKER_EXCLUSION_LENGTH),void 0!==t.PEER_DISCONNECTED_EXCLUSION_DURATION&&(e.PEER_DISCONNECTED_EXCLUSION_DURATION=t.PEER_DISCONNECTED_EXCLUSION_DURATION),void 0!==t.PEER_DISCONNECTED_EXCLUSION_RANK&&(e.PEER_DISCONNECTED_EXCLUSION_RANK=t.PEER_DISCONNECTED_EXCLUSION_RANK),void 0!==t.OFFER_DECLINED_EXCLUSION_RANK&&(e.OFFER_DECLINED_EXCLUSION_RANK=t.OFFER_DECLINED_EXCLUSION_RANK),void 0!==t.PEER_REMOVED_EXCLUSION_RANK&&(e.PEER_REMOVED_EXCLUSION_RANK=t.PEER_REMOVED_EXCLUSION_RANK),void 0!==t.PEER_CONNECTION_ATTEMPT_EXCLUSION_RANK&&(e.PEER_CONNECTION_ATTEMPT_EXCLUSION_RANK=t.PEER_CONNECTION_ATTEMPT_EXCLUSION_RANK),void 0!==t.BLOCK_SEEDER_SCHEDULING_WINDOW&&(e.BLOCK_SEEDER_SCHEDULING_WINDOW=t.BLOCK_SEEDER_SCHEDULING_WINDOW),void 0!==t.BLOCK_SEEDER_SCHEDULING_DURATION&&(e.BLOCK_SEEDER_SCHEDULING_DURATION=t.BLOCK_SEEDER_SCHEDULING_DURATION),void 0!==t.BLOCK_SEEDER_SCHEDULING_TIMEOUT_THRESHOLD&&(e.BLOCK_SEEDER_SCHEDULING_TIMEOUT_THRESHOLD=t.BLOCK_SEEDER_SCHEDULING_TIMEOUT_THRESHOLD),void 0!==t.BLOCK_SEEDER_SCHEDULING_REQUEST_THRESHOLD&&(e.BLOCK_SEEDER_SCHEDULING_REQUEST_THRESHOLD=t.BLOCK_SEEDER_SCHEDULING_REQUEST_THRESHOLD),void 0!==t.VOD_CRITICAL_BUFFER_THRESHOLD&&(e.VOD_CRITICAL_BUFFER_THRESHOLD=t.VOD_CRITICAL_BUFFER_THRESHOLD),void 0!==t.VOD_CRITICAL_BUFFER_P2P_STOP_DURATION&&(e.VOD_CRITICAL_BUFFER_P2P_STOP_DURATION=t.VOD_CRITICAL_BUFFER_P2P_STOP_DURATION),void 0!==t.VOD_SAFE_BUFFER_THRESHOLD&&(e.VOD_SAFE_BUFFER_THRESHOLD=t.VOD_SAFE_BUFFER_THRESHOLD),void 0!==t.MAX_PEER_CONNECTION_FAILURES&&(e.MAX_PEER_CONNECTION_FAILURES=t.MAX_PEER_CONNECTION_FAILURES),void 0!==t.SEGMENT_REQUEST_TIMEOUT_TO_STOP_ASKING_PEERS&&(e.SEGMENT_REQUEST_TIMEOUT_TO_STOP_ASKING_PEERS=t.SEGMENT_REQUEST_TIMEOUT_TO_STOP_ASKING_PEERS),void 0!==t.TRANSFER_ACTIVITY_TIMEOUT_TO_DISCONNECT_FROM_BACKEND&&(e.TRANSFER_ACTIVITY_TIMEOUT_TO_DISCONNECT_FROM_BACKEND=t.TRANSFER_ACTIVITY_TIMEOUT_TO_DISCONNECT_FROM_BACKEND),void 0!==t.ENABLE_FIX_UNRELIABLE_SEGMENT_TIME&&(e.ENABLE_FIX_UNRELIABLE_SEGMENT_TIME=t.ENABLE_FIX_UNRELIABLE_SEGMENT_TIME),void 0)}Object.defineProperty(t,"__esModule",{value:!0}),t.overloadConfigFromDistributor=t.overloadP2PConfig=void 0;var a=n(5),o=function(e){return e&&e.__esModule?e:{default:e}}(a);t.overloadP2PConfig=r,t.overloadConfigFromDistributor=i},function(e,t,n){"use strict";function r(e){if(/Android.* Chrome\/[0-9.]+ /.test(e)){if(-1!==e.indexOf("wv"))return!0;if(/ Version\/[0-9]+\.[0.9]+ /.test(e))return!0}return!1}function i(){var e=o.default.getUAObject();return e.ua?-1!==e.ua.indexOf("CrKey")?"chromecast":(e.device,e.os,o.default.isMobile()?r(e.ua)?"android-webview":"web-mobile":"web-desktop"):"unknown"}Object.defineProperty(t,"__esModule",{value:!0});var a=n(36),o=function(e){return e&&e.__esModule?e:{default:e}}(a);t.default={get:i},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),d=n(10),c=r(d),f=n(9),_=r(f),h=n(5),p=r(h),g=n(100),v=n(237),m=r(v),E=null,y={},T={},S=function(){},C=function(e){function t(e,n,r){(0,s.default)(this,t);var i=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n,r));return i._createTimer(),i}return(0,_.default)(t,e),(0,l.default)(t,[{key:"_createTimer",value:function(){var e=this;if(E){var t=this._isRepeatable?"setInterval":"setTimeout";E.postMessage({command:t,id:this._id,time:this._time}),y[this._id]=this._callback}else if(this._isRepeatable){var n=function t(){T[e._id]=setTimeout(t,e._time),e._callback()};T[this._id]=setTimeout(n,this._time)}else{var r=function(){e._callback(),e._callback=S};T[this._id]=setTimeout(r,this._time)}}},{key:"clear",value:function(){E?(delete y[this._id],E.postMessage({command:"clear",id:this._id})):(clearTimeout(T[this._id]),delete T[this._id]),this._callback=S}}]),t}(g.AbstractTimer);try{window.Worker&&(E=new window.Worker(URL.createObjectURL(new Blob(["("+m.default.toString()+")()"],{type:"text/javascript"}))),E.onmessage=function(e){var t=e.data,n=t.id,r=t.command;y[n]&&(y[n](),"triggerTimeout"===r&&delete y[n])},E.onerror=function(e){p.default.notify("Error in TimerWorker",e.message)})}catch(e){}e.exports=C},function(e,t,n){"use strict";function r(){function e(e){return function(){self.postMessage({id:e,command:"triggerTimeout"}),delete n[e]}}function t(e,r){return function(){self.postMessage({id:e,command:"triggerInterval"}),n[e]=setTimeout(t(e,r),r)}}var n={};self.onmessage=function(r){var i=r.data,a=i.command,o=i.id,s=i.time;switch(a){case"setTimeout":n[o]=setTimeout(e(o),s);break;case"setInterval":n[o]=setTimeout(t(o,s),s);break;case"clear":clearTimeout(n[o]),delete n[o]}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(){String.prototype.endsWith=function(e){var t=this.toString();return t.lastIndexOf(e)===t.length-1}}function i(e){return e.endsWith("/")?e:e+"/"}Object.defineProperty(t,"__esModule",{value:!0}),t.polyfillEndsWith=r,t.formatUrl=i,String.prototype.endsWith||r()},function(e,t,n){e.exports={default:n(256),__esModule:!0}},function(e,t,n){e.exports={default:n(259),__esModule:!0}},function(e,t,n){e.exports={default:n(263),__esModule:!0}},function(e,t,n){e.exports={default:n(264),__esModule:!0}},function(e,t,n){e.exports={default:n(265),__esModule:!0}},function(e,t,n){e.exports={default:n(267),__esModule:!0}},function(e,t,n){e.exports={default:n(270),__esModule:!0}},function(e,t,n){e.exports={default:n(271),__esModule:!0}},function(e,t,n){e.exports={default:n(274),__esModule:!0}},function(e,t,n){e.exports={default:n(275),__esModule:!0}},function(e,t,n){e.exports={default:n(277),__esModule:!0}},function(e,t,n){e.exports={default:n(278),__esModule:!0}},function(e,t,n){e.exports={default:n(279),__esModule:!0}},function(e,t,n){"use strict";t.__esModule=!0;var r=n(18),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=i.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=n(7),a=r(i),o=n(244),s=r(o);t.default=function e(t,n,r){null===t&&(t=Function.prototype);var i=(0,s.default)(t,n);if(void 0===i){var o=(0,a.default)(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var u=i.get;return void 0!==u?u.call(r):void 0}},function(e,t,n){n(30),n(302),e.exports=n(3).Array.from},function(e,t,n){n(34),n(30),e.exports=n(300)},function(e,t,n){n(34),n(30),e.exports=n(301)},function(e,t,n){var r=n(3),i=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return i.stringify.apply(i,arguments)}},function(e,t,n){n(60),n(30),n(34),n(304),n(324),e.exports=n(3).Map},function(e,t,n){n(305),e.exports=n(3).Number.isInteger},function(e,t,n){n(306),e.exports=9007199254740991},function(e,t,n){n(307),e.exports=-9007199254740991},function(e,t,n){n(308),e.exports=n(3).Object.assign},function(e,t,n){n(309);var r=n(3).Object;e.exports=function(e,t){return r.create(e,t)}},function(e,t,n){n(310);var r=n(3).Object;e.exports=function(e,t){return r.defineProperties(e,t)}},function(e,t,n){n(311);var r=n(3).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},function(e,t,n){n(312),e.exports=n(3).Object.freeze},function(e,t,n){n(313);var r=n(3).Object;e.exports=function(e,t){return r.getOwnPropertyDescriptor(e,t)}},function(e,t,n){n(314);var r=n(3).Object;e.exports=function(e){return r.getOwnPropertyNames(e)}},function(e,t,n){n(315),e.exports=n(3).Object.getPrototypeOf},function(e,t,n){n(316),e.exports=n(3).Object.isFrozen},function(e,t,n){n(317),e.exports=n(3).Object.is},function(e,t,n){n(318),e.exports=n(3).Object.keys},function(e,t,n){n(319),e.exports=n(3).Object.seal},function(e,t,n){n(320),e.exports=n(3).Object.setPrototypeOf},function(e,t,n){n(325),e.exports=n(3).Object.values},function(e,t,n){n(60),n(30),n(34),n(321),e.exports=n(3).Promise},function(e,t,n){n(60),n(30),n(34),n(322),n(326),e.exports=n(3).Set},function(e,t,n){n(323),n(60),n(327),n(328),e.exports=n(3).Symbol},function(e,t,n){n(30),n(34),e.exports=n(82).f("iterator")},function(e,t){e.exports=function(){}},function(e,t,n){var r=n(55);e.exports=function(e,t){var n=[];return r(e,!1,n.push,n,t),n}},function(e,t,n){var r=n(20),i=n(58),a=n(299);e.exports=function(e){return function(t,n,o){var s,u=r(t),l=i(u.length),d=a(o,l);if(e&&n!=n){for(;l>d;)if((s=u[d++])!=s)return!0}else for(;l>d;d++)if((e||d in u)&&u[d]===n)return e||d||0;return!e&&-1}}},function(e,t,n){var r=n(22),i=n(72),a=n(33),o=n(58),s=n(285);e.exports=function(e,t){var n=1==e,u=2==e,l=3==e,d=4==e,c=6==e,f=5==e||c,_=t||s;return function(t,s,h){for(var p,g,v=a(t),m=i(v),E=r(s,h,3),y=o(m.length),T=0,S=n?_(t,y):u?_(t,0):void 0;y>T;T++)if((f||T in m)&&(p=m[T],g=E(p,T,v),e))if(n)S[T]=g;else if(g)switch(e){case 3:return!0;case 5:return p;case 6:return T;case 2:S.push(p)}else if(d)return!1;return c?-1:l||d?d:S}}},function(e,t,n){var r=n(13),i=n(111),a=n(11)("species");e.exports=function(e){var t;return i(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[a])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){var r=n(284);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){"use strict";var r=n(15),i=n(44);e.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}},function(e,t,n){var r=n(28),i=n(75),a=n(43);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var o,s=n(e),u=a.f,l=0;s.length>l;)u.call(e,o=s[l++])&&t.push(o);return t}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(13),i=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},function(e,t,n){"use strict";var r=n(57),i=n(44),a=n(45),o={};n(23)(o,n(11)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(o,{next:i(1,n)}),a(e,t+" Iterator")}},function(e,t,n){var r=n(28),i=n(20);e.exports=function(e,t){for(var n,a=i(e),o=r(a),s=o.length,u=0;s>u;)if(a[n=o[u++]]===t)return n}},function(e,t,n){var r=n(12),i=n(122).set,a=r.MutationObserver||r.WebKitMutationObserver,o=r.process,s=r.Promise,u="process"==n(41)(o);e.exports=function(){var e,t,n,l=function(){var r,i;for(u&&(r=o.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(u)n=function(){o.nextTick(l)};else if(a){var d=!0,c=document.createTextNode("");new a(l).observe(c,{characterData:!0}),n=function(){c.data=d=!d}}else if(s&&s.resolve){var f=s.resolve();n=function(){f.then(l)}}else n=function(){i.call(r,l)};return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}},function(e,t,n){"use strict";var r=n(28),i=n(75),a=n(43),o=n(33),s=n(72),u=Object.assign;e.exports=!u||n(26)(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=u({},e)[n]||Object.keys(u({},t)).join("")!=r})?function(e,t){for(var n=o(e),u=arguments.length,l=1,d=i.f,c=a.f;u>l;)for(var f,_=s(arguments[l++]),h=d?r(_).concat(d(_)):r(_),p=h.length,g=0;p>g;)c.call(_,f=h[g++])&&(n[f]=_[f]);return n}:u},function(e,t,n){var r=n(28),i=n(20),a=n(43).f;e.exports=function(e){return function(t){for(var n,o=i(t),s=r(o),u=s.length,l=0,d=[];u>l;)a.call(o,n=s[l++])&&d.push(e?[n,o[n]]:o[n]);return d}}},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){var r=n(13),i=n(19),a=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{r=n(22)(Function.call,n(74).f(Object.prototype,"__proto__").set,2),r(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return a(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:a}},function(e,t,n){var r=n(19),i=n(68),a=n(11)("species");e.exports=function(e,t){var n,o=r(e).constructor;return void 0===o||void 0==(n=r(o)[a])?t:i(n)}},function(e,t,n){var r=n(79),i=n(54);e.exports=function(e){return function(t,n){var a,o,s=String(i(t)),u=r(n),l=s.length;return u<0||u>=l?e?"":void 0:(a=s.charCodeAt(u),a<55296||a>56319||u+1===l||(o=s.charCodeAt(u+1))<56320||o>57343?e?s.charAt(u):a:e?s.slice(u,u+2):o-56320+(a-55296<<10)+65536)}}},function(e,t,n){var r=n(79),i=Math.max,a=Math.min;e.exports=function(e,t){return e=r(e),e<0?i(e+t,0):a(e,t)}},function(e,t,n){var r=n(19),i=n(83);e.exports=n(3).getIterator=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return r(t.call(e))}},function(e,t,n){var r=n(53),i=n(11)("iterator"),a=n(32);e.exports=n(3).isIterable=function(e){var t=Object(e);return void 0!==t[i]||"@@iterator"in t||a.hasOwnProperty(r(t))}},function(e,t,n){"use strict";var r=n(22),i=n(6),a=n(33),o=n(112),s=n(110),u=n(58),l=n(286),d=n(83);i(i.S+i.F*!n(113)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,i,c,f=a(e),_="function"==typeof this?this:Array,h=arguments.length,p=h>1?arguments[1]:void 0,g=void 0!==p,v=0,m=d(f);if(g&&(p=r(p,h>2?arguments[2]:void 0,2)),void 0==m||_==Array&&s(m))for(t=u(f.length),n=new _(t);t>v;v++)l(n,v,g?p(f[v],v):f[v]);else for(c=m.call(f),
n=new _;!(i=c.next()).done;v++)l(n,v,g?o(c,p,[i.value,v],!0):i.value);return n.length=v,n}})},function(e,t,n){"use strict";var r=n(280),i=n(114),a=n(32),o=n(20);e.exports=n(73)(Array,"Array",function(e,t){this._t=o(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):"keys"==t?i(0,n):"values"==t?i(0,e[n]):i(0,[n,e[n]])},"values"),a.Arguments=a.Array,r("keys"),r("values"),r("entries")},function(e,t,n){"use strict";var r=n(105);e.exports=n(107)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=r.getEntry(this,e);return t&&t.v},set:function(e,t){return r.def(this,0===e?0:e,t)}},r,!0)},function(e,t,n){var r=n(6);r(r.S,"Number",{isInteger:n(289)})},function(e,t,n){var r=n(6);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){var r=n(6);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,n){var r=n(6);r(r.S+r.F,"Object",{assign:n(293)})},function(e,t,n){var r=n(6);r(r.S,"Object",{create:n(57)})},function(e,t,n){var r=n(6);r(r.S+r.F*!n(14),"Object",{defineProperties:n(115)})},function(e,t,n){var r=n(6);r(r.S+r.F*!n(14),"Object",{defineProperty:n(15).f})},function(e,t,n){var r=n(13),i=n(42).onFreeze;n(29)("freeze",function(e){return function(t){return e&&r(t)?e(i(t)):t}})},function(e,t,n){var r=n(20),i=n(74).f;n(29)("getOwnPropertyDescriptor",function(){return function(e,t){return i(r(e),t)}})},function(e,t,n){n(29)("getOwnPropertyNames",function(){return n(116).f})},function(e,t,n){var r=n(33),i=n(118);n(29)("getPrototypeOf",function(){return function(e){return i(r(e))}})},function(e,t,n){var r=n(13);n(29)("isFrozen",function(e){return function(t){return!r(t)||!!e&&e(t)}})},function(e,t,n){var r=n(6);r(r.S,"Object",{is:n(295)})},function(e,t,n){var r=n(33),i=n(28);n(29)("keys",function(){return function(e){return i(r(e))}})},function(e,t,n){var r=n(13),i=n(42).onFreeze;n(29)("seal",function(e){return function(t){return e&&r(t)?e(i(t)):t}})},function(e,t,n){var r=n(6);r(r.S,"Object",{setPrototypeOf:n(296).set})},function(e,t,n){"use strict";var r,i,a,o=n(56),s=n(12),u=n(22),l=n(53),d=n(6),c=n(13),f=n(68),_=n(69),h=n(55),p=n(297),g=n(122).set,v=n(292)(),m=s.TypeError,E=s.process,y=s.Promise,E=s.process,T="process"==l(E),S=function(){},C=!!function(){try{var e=y.resolve(1),t=(e.constructor={})[n(11)("species")]=function(e){e(S,S)};return(T||"function"==typeof PromiseRejectionEvent)&&e.then(S)instanceof t}catch(e){}}(),A=function(e,t){return e===t||e===y&&t===a},D=function(e){var t;return!(!c(e)||"function"!=typeof(t=e.then))&&t},I=function(e){return A(y,e)?new R(e):new i(e)},R=i=function(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw m("Bad Promise constructor");t=e,n=r}),this.resolve=f(t),this.reject=f(n)},O=function(e){try{e()}catch(e){return{error:e}}},P=function(e,t){if(!e._n){e._n=!0;var n=e._c;v(function(){for(var r=e._v,i=1==e._s,a=0;n.length>a;)!function(t){var n,a,o=i?t.ok:t.fail,s=t.resolve,u=t.reject,l=t.domain;try{o?(i||(2==e._h&&M(e),e._h=1),!0===o?n=r:(l&&l.enter(),n=o(r),l&&l.exit()),n===t.promise?u(m("Promise-chain cycle")):(a=D(n))?a.call(n,s,u):s(n)):u(r)}catch(e){u(e)}}(n[a++]);e._c=[],e._n=!1,t&&!e._h&&b(e)})}},b=function(e){g.call(s,function(){var t,n,r,i=e._v;if(w(e)&&(t=O(function(){T?E.emit("unhandledRejection",i,e):(n=s.onunhandledrejection)?n({promise:e,reason:i}):(r=s.console)&&r.error&&r.error("Unhandled promise rejection",i)}),e._h=T||w(e)?2:1),e._a=void 0,t)throw t.error})},w=function(e){if(1==e._h)return!1;for(var t,n=e._a||e._c,r=0;n.length>r;)if(t=n[r++],t.fail||!w(t.promise))return!1;return!0},M=function(e){g.call(s,function(){var t;T?E.emit("rejectionHandled",e):(t=s.onrejectionhandled)&&t({promise:e,reason:e._v})})},L=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),P(t,!0))},N=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw m("Promise can't be resolved itself");(t=D(e))?v(function(){var r={_w:n,_d:!1};try{t.call(e,u(N,r,1),u(L,r,1))}catch(e){L.call(r,e)}}):(n._v=e,n._s=1,P(n,!1))}catch(e){L.call({_w:n,_d:!1},e)}}};C||(y=function(e){_(this,y,"Promise","_h"),f(e),r.call(this);try{e(u(N,this,1),u(L,this,1))}catch(e){L.call(this,e)}},r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},r.prototype=n(76)(y.prototype,{then:function(e,t){var n=I(p(this,y));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=T?E.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&P(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),R=function(){var e=new r;this.promise=e,this.resolve=u(N,e,1),this.reject=u(L,e,1)}),d(d.G+d.W+d.F*!C,{Promise:y}),n(45)(y,"Promise"),n(121)("Promise"),a=n(3).Promise,d(d.S+d.F*!C,"Promise",{reject:function(e){var t=I(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(o||!C),"Promise",{resolve:function(e){if(e instanceof y&&A(e.constructor,this))return e;var t=I(this);return(0,t.resolve)(e),t.promise}}),d(d.S+d.F*!(C&&n(113)(function(e){y.all(e).catch(S)})),"Promise",{all:function(e){var t=this,n=I(t),r=n.resolve,i=n.reject,a=O(function(){var n=[],a=0,o=1;h(e,!1,function(e){var s=a++,u=!1;n.push(void 0),o++,t.resolve(e).then(function(e){u||(u=!0,n[s]=e,--o||r(n))},i)}),--o||r(n)});return a&&i(a.error),n.promise},race:function(e){var t=this,n=I(t),r=n.reject,i=O(function(){h(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return i&&r(i.error),n.promise}})},function(e,t,n){"use strict";var r=n(105);e.exports=n(107)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return r.def(this,e=0===e?0:e,e)}},r)},function(e,t,n){"use strict";var r=n(12),i=n(27),a=n(14),o=n(6),s=n(120),u=n(42).KEY,l=n(26),d=n(78),c=n(45),f=n(59),_=n(11),h=n(82),p=n(81),g=n(291),v=n(287),m=n(111),E=n(19),y=n(20),T=n(80),S=n(44),C=n(57),A=n(116),D=n(74),I=n(15),R=n(28),O=D.f,P=I.f,b=A.f,w=r.Symbol,M=r.JSON,L=M&&M.stringify,N=_("_hidden"),k=_("toPrimitive"),x={}.propertyIsEnumerable,U=d("symbol-registry"),F=d("symbols"),B=d("op-symbols"),H=Object.prototype,j="function"==typeof w,G=r.QObject,K=!G||!G.prototype||!G.prototype.findChild,V=a&&l(function(){return 7!=C(P({},"a",{get:function(){return P(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=O(H,t);r&&delete H[t],P(e,t,n),r&&e!==H&&P(H,t,r)}:P,W=function(e){var t=F[e]=C(w.prototype);return t._k=e,t},q=j&&"symbol"==typeof w.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof w},Y=function(e,t,n){return e===H&&Y(B,t,n),E(e),t=T(t,!0),E(n),i(F,t)?(n.enumerable?(i(e,N)&&e[N][t]&&(e[N][t]=!1),n=C(n,{enumerable:S(0,!1)})):(i(e,N)||P(e,N,S(1,{})),e[N][t]=!0),V(e,t,n)):P(e,t,n)},z=function(e,t){E(e);for(var n,r=v(t=y(t)),i=0,a=r.length;a>i;)Y(e,n=r[i++],t[n]);return e},Q=function(e,t){return void 0===t?C(e):z(C(e),t)},X=function(e){var t=x.call(this,e=T(e,!0));return!(this===H&&i(F,e)&&!i(B,e))&&(!(t||!i(this,e)||!i(F,e)||i(this,N)&&this[N][e])||t)},Z=function(e,t){if(e=y(e),t=T(t,!0),e!==H||!i(F,t)||i(B,t)){var n=O(e,t);return!n||!i(F,t)||i(e,N)&&e[N][t]||(n.enumerable=!0),n}},J=function(e){for(var t,n=b(y(e)),r=[],a=0;n.length>a;)i(F,t=n[a++])||t==N||t==u||r.push(t);return r},$=function(e){for(var t,n=e===H,r=b(n?B:y(e)),a=[],o=0;r.length>o;)!i(F,t=r[o++])||n&&!i(H,t)||a.push(F[t]);return a};j||(w=function(){if(this instanceof w)throw TypeError("Symbol is not a constructor!");var e=f(arguments.length>0?arguments[0]:void 0),t=function(n){this===H&&t.call(B,n),i(this,N)&&i(this[N],e)&&(this[N][e]=!1),V(this,e,S(1,n))};return a&&K&&V(H,e,{configurable:!0,set:t}),W(e)},s(w.prototype,"toString",function(){return this._k}),D.f=Z,I.f=Y,n(117).f=A.f=J,n(43).f=X,n(75).f=$,a&&!n(56)&&s(H,"propertyIsEnumerable",X,!0),h.f=function(e){return W(_(e))}),o(o.G+o.W+o.F*!j,{Symbol:w});for(var ee="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),te=0;ee.length>te;)_(ee[te++]);for(var ee=R(_.store),te=0;ee.length>te;)p(ee[te++]);o(o.S+o.F*!j,"Symbol",{for:function(e){return i(U,e+="")?U[e]:U[e]=w(e)},keyFor:function(e){if(q(e))return g(U,e);throw TypeError(e+" is not a symbol!")},useSetter:function(){K=!0},useSimple:function(){K=!1}}),o(o.S+o.F*!j,"Object",{create:Q,defineProperty:Y,defineProperties:z,getOwnPropertyDescriptor:Z,getOwnPropertyNames:J,getOwnPropertySymbols:$}),M&&o(o.S+o.F*(!j||l(function(){var e=w();return"[null]"!=L([e])||"{}"!=L({a:e})||"{}"!=L(Object(e))})),"JSON",{stringify:function(e){if(void 0!==e&&!q(e)){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);return t=r[1],"function"==typeof t&&(n=t),!n&&m(t)||(t=function(e,t){if(n&&(t=n.call(this,e,t)),!q(t))return t}),r[1]=t,L.apply(M,r)}}}),w.prototype[k]||n(23)(w.prototype,k,w.prototype.valueOf),c(w,"Symbol"),c(Math,"Math",!0),c(r.JSON,"JSON",!0)},function(e,t,n){var r=n(6);r(r.P+r.R,"Map",{toJSON:n(106)("Map")})},function(e,t,n){var r=n(6),i=n(294)(!1);r(r.S,"Object",{values:function(e){return i(e)}})},function(e,t,n){var r=n(6);r(r.P+r.R,"Set",{toJSON:n(106)("Set")})},function(e,t,n){n(81)("asyncIterator")},function(e,t,n){n(81)("observable")},function(e,t,n){(function(e,r){var i;!function(a){function o(e){throw new RangeError(w[e])}function s(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function u(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(b,"."),r+s(e.split("."),t).join(".")}function l(e){for(var t,n,r=[],i=0,a=e.length;i<a;)t=e.charCodeAt(i++),t>=55296&&t<=56319&&i<a?(n=e.charCodeAt(i++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--)):r.push(t);return r}function d(e){return s(e,function(e){var t="";return e>65535&&(e-=65536,t+=N(e>>>10&1023|55296),e=56320|1023&e),t+=N(e)}).join("")}function c(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:y}function f(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function _(e,t,n){var r=0;for(e=n?L(e/A):e>>1,e+=L(e/t);e>M*S>>1;r+=y)e=L(e/M);return L(r+(M+1)*e/(e+C))}function h(e){var t,n,r,i,a,s,u,l,f,h,p=[],g=e.length,v=0,m=I,C=D;for(n=e.lastIndexOf(R),n<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&o("not-basic"),p.push(e.charCodeAt(r));for(i=n>0?n+1:0;i<g;){for(a=v,s=1,u=y;i>=g&&o("invalid-input"),l=c(e.charCodeAt(i++)),(l>=y||l>L((E-v)/s))&&o("overflow"),v+=l*s,f=u<=C?T:u>=C+S?S:u-C,!(l<f);u+=y)h=y-f,s>L(E/h)&&o("overflow"),s*=h;t=p.length+1,C=_(v-a,t,0==a),L(v/t)>E-m&&o("overflow"),m+=L(v/t),v%=t,p.splice(v++,0,m)}return d(p)}function p(e){var t,n,r,i,a,s,u,d,c,h,p,g,v,m,C,A=[];for(e=l(e),g=e.length,t=I,n=0,a=D,s=0;s<g;++s)(p=e[s])<128&&A.push(N(p));for(r=i=A.length,i&&A.push(R);r<g;){for(u=E,s=0;s<g;++s)(p=e[s])>=t&&p<u&&(u=p);for(v=r+1,u-t>L((E-n)/v)&&o("overflow"),n+=(u-t)*v,t=u,s=0;s<g;++s)if(p=e[s],p<t&&++n>E&&o("overflow"),p==t){for(d=n,c=y;h=c<=a?T:c>=a+S?S:c-a,!(d<h);c+=y)C=d-h,m=y-h,A.push(N(f(h+C%m,0))),d=L(C/m);A.push(N(f(d,0))),a=_(n,v,r==i),n=0,++r}++n,++t}return A.join("")}function g(e){return u(e,function(e){return O.test(e)?h(e.slice(4).toLowerCase()):e})}function v(e){return u(e,function(e){return P.test(e)?"xn--"+p(e):e})}var m,E=("object"==typeof t&&t&&t.nodeType,"object"==typeof e&&e&&e.nodeType,"object"==typeof r&&r,2147483647),y=36,T=1,S=26,C=38,A=700,D=72,I=128,R="-",O=/^xn--/,P=/[^\x20-\x7E]/,b=/[\x2E\u3002\uFF0E\uFF61]/g,w={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},M=y-T,L=Math.floor,N=String.fromCharCode;m={version:"1.4.1",ucs2:{decode:l,encode:d},decode:h,encode:p,toASCII:v,toUnicode:g},void 0!==(i=function(){return m}.call(t,n,t,e))&&(e.exports=i)}()}).call(t,n(339)(e),n(84))},function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,a){t=t||"&",n=n||"=";var o={};if("string"!=typeof e||0===e.length)return o;var s=/\+/g;e=e.split(t);var u=1e3;a&&"number"==typeof a.maxKeys&&(u=a.maxKeys);var l=e.length;u>0&&l>u&&(l=u);for(var d=0;d<l;++d){var c,f,_,h,p=e[d].replace(s,"%20"),g=p.indexOf(n);g>=0?(c=p.substr(0,g),f=p.substr(g+1)):(c=p,f=""),_=decodeURIComponent(c),h=decodeURIComponent(f),r(o,_)?i(o[_])?o[_].push(h):o[_]=[o[_],h]:o[_]=h}return o};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";function r(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,s){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?r(o(e),function(o){var s=encodeURIComponent(i(o))+n;return a(e[o])?r(e[o],function(e){return s+encodeURIComponent(i(e))}).join(t):s+encodeURIComponent(i(e[o]))}).join(t):s?encodeURIComponent(i(s))+n+encodeURIComponent(i(e)):""};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){"use strict";t.decode=t.parse=n(330),t.encode=t.stringify=n(331)},function(e,t,n){var r;!function(i,a){"use strict";var o="model",s="name",u="type",l="vendor",d="version",c="mobile",f="tablet",_={extend:function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},h={rgx:function(e,t){for(var n,r,i,a,o,s,u=0;u<t.length&&!o;){var l=t[u],d=t[u+1];for(n=r=0;n<l.length&&!o;)if(o=l[n++].exec(e))for(i=0;i<d.length;i++)s=o[++r],a=d[i],"object"==typeof a&&a.length>0?2==a.length?"function"==typeof a[1]?this[a[0]]=a[1].call(this,s):this[a[0]]=a[1]:3==a.length?"function"!=typeof a[1]||a[1].exec&&a[1].test?this[a[0]]=s?s.replace(a[1],a[2]):void 0:this[a[0]]=s?a[1].call(this,s,a[2]):void 0:4==a.length&&(this[a[0]]=s?a[3].call(this,s.replace(a[1],a[2])):void 0):this[a]=s||void 0;u+=2}},str:function(e,t){for(var n in t)if("object"==typeof t[n]&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(_.has(t[n][r],e))return"?"===n?void 0:n}else if(_.has(t[n],e))return"?"===n?void 0:n;return e}},p={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},g={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[s,d],[/(opios)[\/\s]+([\w\.]+)/i],[[s,"Opera Mini"],d],[/\s(opr)\/([\w\.]+)/i],[[s,"Opera"],d],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser)\/([\w\.-]+)/i],[s,d],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[s,"IE"],d],[/(edge)\/((\d+)?[\w\.]+)/i],[s,d],[/(yabrowser)\/([\w\.]+)/i],[[s,"Yandex"],d],[/(puffin)\/([\w\.]+)/i],[[s,"Puffin"],d],[/(uc\s?browser)[\/\s]?([\w\.]+)/i,/ucweb.+(ucbrowser)[\/\s]?([\w\.]+)/i,/juc.+(ucweb)[\/\s]?([\w\.]+)/i,/(ucbrowser)\/([\w\.]+)/i],[[s,"UCBrowser"],d],[/(comodo_dragon)\/([\w\.]+)/i],[[s,/_/g," "],d],[/(micromessenger)\/([\w\.]+)/i],[[s,"WeChat"],d],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[s,d],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[d,[s,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[d,[s,"Facebook"]],[/(headlesschrome) ([\w\.]+)/i],[d,[s,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[s,/(.+)/,"$1 WebView"],d],[/android.+samsungbrowser\/([\w\.]+)/i,/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[d,[s,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[s,d],[/(dolfin)\/([\w\.]+)/i],[[s,"Dolphin"],d],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[s,"Chrome"],d],[/(coast)\/([\w\.]+)/i],[[s,"Opera Coast"],d],[/fxios\/([\w\.-]+)/i],[d,[s,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[d,[s,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[d,s],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[s,[d,h.str,p.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[s,d],[/(navigator|netscape)\/([\w\.-]+)/i],[[s,"Netscape"],d],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[s,d]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",_.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",_.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",_.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[o,l,[u,f]],[/applecoremedia\/[\w\.]+ \((ipad)/],[o,[l,"Apple"],[u,f]],[/(apple\s{0,1}tv)/i],[[o,"Apple TV"],[l,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[l,o,[u,f]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[o,[l,"Amazon"],[u,f]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[o,h.str,p.device.amazon.model],[l,"Amazon"],[u,c]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[o,l,[u,c]],[/\((ip[honed|\s\w*]+);/i],[o,[l,"Apple"],[u,c]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[l,o,[u,c]],[/\(bb10;\s(\w+)/i],[o,[l,"BlackBerry"],[u,c]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[o,[l,"Asus"],[u,f]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[l,"Sony"],[o,"Xperia Tablet"],[u,f]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[l,"Sony"],[o,"Xperia Phone"],[u,c]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[l,o,[u,"console"]],[/android.+;\s(shield)\sbuild/i],[o,[l,"Nvidia"],[u,"console"]],[/(playstation\s[34portablevi]+)/i],[o,[l,"Sony"],[u,"console"]],[/(sprint\s(\w+))/i],[[l,h.str,p.device.sprint.vendor],[o,h.str,p.device.sprint.model],[u,c]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[l,o,[u,f]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[l,[o,/_/g," "],[u,c]],[/(nexus\s9)/i],[o,[l,"HTC"],[u,f]],[/(nexus\s6p)/i],[o,[l,"Huawei"],[u,c]],[/(microsoft);\s(lumia[\s\w]+)/i],[l,o,[u,c]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[o,[l,"Microsoft"],[u,"console"]],[/(kin\.[onetw]{3})/i],[[o,/\./g," "],[l,"Microsoft"],[u,c]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[o,[l,"Motorola"],[u,c]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[o,[l,"Motorola"],[u,f]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[l,_.trim],[o,_.trim],[u,"smarttv"]],[/hbbtv.+maple;(\d+)/i],[[o,/^/,"SmartTV"],[l,"Samsung"],[u,"smarttv"]],[/\(dtv[\);].+(aquos)/i],[o,[l,"Sharp"],[u,"smarttv"]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[l,"Samsung"],o,[u,f]],[/smart-tv.+(samsung)/i],[l,[u,"smarttv"],o],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[l,"Samsung"],o,[u,c]],[/sie-(\w+)*/i],[o,[l,"Siemens"],[u,c]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[l,"Nokia"],o,[u,c]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[o,[l,"Acer"],[u,f]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[l,"LG"],o,[u,f]],[/(lg) netcast\.tv/i],[l,o,[u,"smarttv"]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[o,[l,"LG"],[u,c]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[o,[l,"Lenovo"],[u,f]],[/linux;.+((jolla));/i],[l,o,[u,c]],[/((pebble))app\/[\d\.]+\s/i],[l,o,[u,"wearable"]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[l,o,[u,c]],[/crkey/i],[[o,"Chromecast"],[l,"Google"]],[/android.+;\s(glass)\s\d/i],[o,[l,"Google"],[u,"wearable"]],[/android.+;\s(pixel c)\s/i],[o,[l,"Google"],[u,f]],[/android.+;\s(pixel xl|pixel)\s/i],[o,[l,"Google"],[u,c]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i],[[o,/_/g," "],[l,"Xiaomi"],[u,c]],[/android.+a000(1)\s+build/i],[o,[l,"OnePlus"],[u,c]],[/\s(tablet)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[u,_.lowerize],l,o]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[d,[s,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[s,d],[/rv\:([\w\.]+).*(gecko)/i],[d,s]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[s,d],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s]+\w)*/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[s,[d,h.str,p.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[s,"Windows"],[d,h.str,p.os.windows.version]],[/\((bb)(10);/i],[[s,"BlackBerry"],d],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[s,d],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[s,"Symbian"],d],[/\((series40);/i],[s],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[s,"Firefox OS"],d],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[s,d],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[s,"Chromium OS"],d],[/(sunos)\s?([\w\.]+\d)*/i],[[s,"Solaris"],d],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[s,d],[/(haiku)\s(\w+)/i],[s,d],[/(ip[honead]+)(?:.*os\s([\w]+)*\slike\smac|;\sopera)/i],[[s,"iOS"],[d,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[s,"Mac OS"],[d,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[s,d]]},v=function(e,t){this[s]=e,this[d]=t},m=function(e){this.architecture=e},E=function(e,t,n){this[l]=e,this[o]=t,this[u]=n},y=v,T=v,S=function(e,t){if(!(this instanceof S))return new S(e,t).getResult();var n=e||(i&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:""),r=t?_.extend(g,t):g,a=new v,o=new m,s=new E,u=new y,l=new T;return this.getBrowser=function(){return h.rgx.call(a,n,r.browser),a.major=_.major(a.version),a},this.getCPU=function(){return h.rgx.call(o,n,r.cpu),o},this.getDevice=function(){return h.rgx.call(s,n,r.device),s},this.getEngine=function(){return h.rgx.call(u,n,r.engine),u},this.getOS=function(){return h.rgx.call(l,n,r.os),l},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=e,a=new v,o=new m,s=new E,u=new y,l=new T,this},this};S.VERSION="0.7.13",S.BROWSER={NAME:s,MAJOR:"major",VERSION:d},S.CPU={ARCHITECTURE:"architecture"},S.DEVICE={MODEL:o,VENDOR:l,TYPE:u,CONSOLE:"console",MOBILE:c,SMARTTV:"smarttv",TABLET:f,WEARABLE:"wearable",EMBEDDED:"embedded"},S.ENGINE={NAME:s,VERSION:d},S.OS={NAME:s,VERSION:d},void 0!==t?(void 0!==e&&e.exports&&(t=e.exports=S),t.UAParser=S):n(338)?void 0!==(r=function(){return S}.call(t,n,t,e))&&(e.exports=r):i.UAParser=S;var C=i.jQuery||i.Zepto;if(void 0!==C){var A=new S;C.ua=A.getResult(),C.ua.get=function(){return A.getUA()},C.ua.set=function(e){A.setUA(e);var t=A.getResult();for(var n in t)C.ua[n]=t[n]}}}("object"==typeof window?window:this)},function(e,t,n){"use strict";function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(e,t,n){if(e&&l.isObject(e)&&e instanceof r)return e;var i=new r;return i.parse(e,t,n),i}function a(e){return l.isString(e)&&(e=i(e)),e instanceof r?e.format():r.prototype.format.call(e)}function o(e,t){return i(e,!1,!0).resolve(t)}function s(e,t){return e?i(e,!1,!0).resolveObject(t):t}var u=n(329),l=n(335);t.parse=i,t.resolve=o,t.resolveObject=s,t.format=a,t.Url=r;var d=/^([a-z0-9.+-]+:)/i,c=/:[0-9]*$/,f=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,_=["<",">",'"',"`"," ","\r","\n","\t"],h=["{","}","|","\\","^","`"].concat(_),p=["'"].concat(h),g=["%","/","?",";","#"].concat(p),v=["/","?","#"],m=/^[+a-z0-9A-Z_-]{0,63}$/,E=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,y={javascript:!0,"javascript:":!0},T={javascript:!0,"javascript:":!0},S={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},C=n(332);r.prototype.parse=function(e,t,n){if(!l.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),i=-1!==r&&r<e.indexOf("#")?"?":"#",a=e.split(i),o=/\\/g;a[0]=a[0].replace(o,"/"),e=a.join(i);var s=e;if(s=s.trim(),!n&&1===e.split("#").length){var c=f.exec(s);if(c)return this.path=s,this.href=s,this.pathname=c[1],c[2]?(this.search=c[2],this.query=t?C.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var _=d.exec(s);if(_){_=_[0];var h=_.toLowerCase();this.protocol=h,s=s.substr(_.length)}if(n||_||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var A="//"===s.substr(0,2);!A||_&&T[_]||(s=s.substr(2),this.slashes=!0)}if(!T[_]&&(A||_&&!S[_])){for(var D=-1,I=0;I<v.length;I++){var R=s.indexOf(v[I]);-1!==R&&(-1===D||R<D)&&(D=R)}var O,P;P=-1===D?s.lastIndexOf("@"):s.lastIndexOf("@",D),-1!==P&&(O=s.slice(0,P),s=s.slice(P+1),this.auth=decodeURIComponent(O)),D=-1;for(var I=0;I<g.length;I++){var R=s.indexOf(g[I]);-1!==R&&(-1===D||R<D)&&(D=R)}-1===D&&(D=s.length),this.host=s.slice(0,D),s=s.slice(D),this.parseHost(),this.hostname=this.hostname||"";var b="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!b)for(var w=this.hostname.split(/\./),I=0,M=w.length;I<M;I++){var L=w[I];if(L&&!L.match(m)){for(var N="",k=0,x=L.length;k<x;k++)N+=L.charCodeAt(k)>127?"x":L[k];if(!N.match(m)){var U=w.slice(0,I),F=w.slice(I+1),B=L.match(E);B&&(U.push(B[1]),F.unshift(B[2])),F.length&&(s="/"+F.join(".")+s),this.hostname=U.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),b||(this.hostname=u.toASCII(this.hostname));var H=this.port?":"+this.port:"",j=this.hostname||"";this.host=j+H,this.href+=this.host,b&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!y[h])for(var I=0,M=p.length;I<M;I++){var G=p[I];if(-1!==s.indexOf(G)){var K=encodeURIComponent(G);K===G&&(K=escape(G)),s=s.split(G).join(K)}}var V=s.indexOf("#");-1!==V&&(this.hash=s.substr(V),s=s.slice(0,V));var W=s.indexOf("?");if(-1!==W?(this.search=s.substr(W),this.query=s.substr(W+1),t&&(this.query=C.parse(this.query)),s=s.slice(0,W)):t&&(this.search="",this.query={}),s&&(this.pathname=s),S[h]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var H=this.pathname||"",q=this.search||"";this.path=H+q}return this.href=this.format(),this},r.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,a="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&l.isObject(this.query)&&Object.keys(this.query).length&&(a=C.stringify(this.query));var o=this.search||a&&"?"+a||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||S[t])&&!1!==i?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),o&&"?"!==o.charAt(0)&&(o="?"+o),n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),o=o.replace("#","%23"),t+i+n+o+r},r.prototype.resolve=function(e){return this.resolveObject(i(e,!1,!0)).format()},r.prototype.resolveObject=function(e){if(l.isString(e)){var t=new r;t.parse(e,!1,!0),e=t}for(var n=new r,i=Object.keys(this),a=0;a<i.length;a++){var o=i[a];n[o]=this[o]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),u=0;u<s.length;u++){var d=s[u];"protocol"!==d&&(n[d]=e[d])}return S[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!S[e.protocol]){for(var c=Object.keys(e),f=0;f<c.length;f++){var _=c[f];n[_]=e[_]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||T[e.protocol])n.pathname=e.pathname;else{for(var h=(e.pathname||"").split("/");h.length&&!(e.host=h.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==h[0]&&h.unshift(""),h.length<2&&h.unshift(""),n.pathname=h.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var p=n.pathname||"",g=n.search||"";n.path=p+g}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var v=n.pathname&&"/"===n.pathname.charAt(0),m=e.host||e.pathname&&"/"===e.pathname.charAt(0),E=m||v||n.host&&e.pathname,y=E,C=n.pathname&&n.pathname.split("/")||[],h=e.pathname&&e.pathname.split("/")||[],A=n.protocol&&!S[n.protocol];if(A&&(n.hostname="",n.port=null,n.host&&(""===C[0]?C[0]=n.host:C.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===h[0]?h[0]=e.host:h.unshift(e.host)),e.host=null),E=E&&(""===h[0]||""===C[0])),m)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,C=h;else if(h.length)C||(C=[]),C.pop(),C=C.concat(h),n.search=e.search,n.query=e.query;else if(!l.isNullOrUndefined(e.search)){if(A){n.hostname=n.host=C.shift();var D=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");D&&(n.auth=D.shift(),n.host=n.hostname=D.shift())}return n.search=e.search,n.query=e.query,l.isNull(n.pathname)&&l.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!C.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var I=C.slice(-1)[0],R=(n.host||e.host||C.length>1)&&("."===I||".."===I)||""===I,O=0,P=C.length;P>=0;P--)I=C[P],"."===I?C.splice(P,1):".."===I?(C.splice(P,1),O++):O&&(C.splice(P,1),O--);if(!E&&!y)for(;O--;O)C.unshift("..");!E||""===C[0]||C[0]&&"/"===C[0].charAt(0)||C.unshift(""),R&&"/"!==C.join("/").substr(-1)&&C.push("");var b=""===C[0]||C[0]&&"/"===C[0].charAt(0);if(A){n.hostname=n.host=b?"":C.length?C.shift():"";
var D=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");D&&(n.auth=D.shift(),n.host=n.hostname=D.shift())}return E=E||n.host&&C.length,E&&!b&&C.unshift(""),C.length?n.pathname=C.join("/"):(n.pathname=null,n.path=null),l.isNull(n.pathname)&&l.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var e=this.host,t=c.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){function r(e,t,n){var r=t&&n||0,i=t||[];e=e||{};var o=void 0!==e.clockseq?e.clockseq:u,c=void 0!==e.msecs?e.msecs:(new Date).getTime(),f=void 0!==e.nsecs?e.nsecs:d+1,_=c-l+(f-d)/1e4;if(_<0&&void 0===e.clockseq&&(o=o+1&16383),(_<0||c>l)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");l=c,d=f,u=o,c+=122192928e5;var h=(1e4*(268435455&c)+f)%4294967296;i[r++]=h>>>24&255,i[r++]=h>>>16&255,i[r++]=h>>>8&255,i[r++]=255&h;var p=c/4294967296*1e4&268435455;i[r++]=p>>>8&255,i[r++]=255&p,i[r++]=p>>>24&15|16,i[r++]=p>>>16&255,i[r++]=o>>>8|128,i[r++]=255&o;for(var g=e.node||s,v=0;v<6;++v)i[r+v]=g[v];return t||a(i)}var i=n(126),a=n(125),o=i(),s=[1|o[0],o[1],o[2],o[3],o[4],o[5]],u=16383&(o[6]<<8|o[7]),l=0,d=0;e.exports=r},function(e,t,n){function r(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null),e=e||{};var o=e.random||(e.rng||i)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var s=0;s<16;++s)t[r+s]=o[s];return t||a(o)}var i=n(126),a=n(125);e.exports=r},function(e,t){(function(t){e.exports=t}).call(t,{})},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}}])})}])});

/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _window = __webpack_require__(0);

var _window2 = _interopRequireDefault(_window);

var _streamrootDashjsP2pBundle = __webpack_require__(1);

var _streamrootDashjsP2pBundle2 = _interopRequireDefault(_streamrootDashjsP2pBundle);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var isArray = function isArray(a) {
    return Object.prototype.toString.call(a) === '[object Array]';
};

/**
 * videojs-contrib-dash
 *
 * Use Dash.js to playback DASH content inside of Video.js via a SourceHandler
 */

var Html5DashJS = function () {
    function Html5DashJS(source, tech, options) {
        var _this = this;

        _classCallCheck(this, Html5DashJS);

        // Get options from tech if not provided for backwards compatibility
        options = options || tech.options_; // eslint-disable-line no-param-reassign

        var player = videojs(options.playerId);

        this.tech_ = tech;
        this.el_ = tech.el();
        this.elParent_ = this.el_.parentNode;

        // Do nothing if the src is falsey
        if (!source.src) {
            return;
        }

        // While the manifest is loading and Dash.js has not finished initializing
        // we must defer events and functions calls with isReady_ and then `triggerReady`
        // again later once everything is setup
        tech.isReady_ = false;

        if (Html5DashJS.updateSourceData) {
            source = Html5DashJS.updateSourceData(source); // eslint-disable-line no-param-reassign
        }

        var manifestSource = source.src;
        var keySystemOptions = Html5DashJS.buildDashJSProtData(source.keySystemOptions);

        var onVideoPlay = function onVideoPlay(event) {
            event.currentTarget.removeEventListener(event.type, onVideoPlay);

            // this fixes an exception in Chrome -- VideoModel.js:88 Uncaught (in promise)
            // DOMException: The play() request was interrupted by a new load request.
            event.currentTarget.pause();
            event.currentTarget.load();

            // Attach the source with any protection data
            _this.mediaPlayer_.setProtectionData(keySystemOptions);
            _this.mediaPlayer_.attachSource(manifestSource);
        };
        this.el_.addEventListener('play', onVideoPlay);

        // Save the context after the first initialization for subsequent instances
        Html5DashJS.context_ = Html5DashJS.context_ || {};

        // reuse MediaPlayer if it already exists
        if (!this.mediaPlayer_) {
            if (!options || !options.streamroot || !options.streamroot.p2pConfig) {
                throw new Error('p2pConfig is not defined!');
            }

            // initializing streamroot-p2p-bundle
            this.mediaPlayer_ = _streamrootDashjsP2pBundle2.default.MediaPlayer(Html5DashJS.context_).create(options.streamroot.p2pConfig); // eslint-disable-line new-cap
        }

        this.mediaPlayer_.on('manifestloaded', function (_ref) {
            var data = _ref.data;

            _this._duration = data.type === 'static' ? data.mediaPresentationDuration : Infinity;
        });

        // Log MedaPlayer messages through video.js
        if (Html5DashJS.useVideoJSDebug) {
            videojs.log.warn('useVideoJSDebug has been deprecated.' + ' Please switch to using beforeInitialize.');
            Html5DashJS.useVideoJSDebug(this.mediaPlayer_);
        }

        if (Html5DashJS.beforeInitialize) {
            Html5DashJS.beforeInitialize(player, this.mediaPlayer_);
        }

        // Must run controller before these two lines or else there is no
        // element to bind to.
        this.mediaPlayer_.initialize();

        // Apply any options that are set
        if (options.dash && options.dash.limitBitrateByPortal) {
            this.mediaPlayer_.setLimitBitrateByPortal(true);
        } else {
            this.mediaPlayer_.setLimitBitrateByPortal(false);
        }

        this.mediaPlayer_.attachView(this.el_);

        this.tech_.triggerReady();
    }

    _createClass(Html5DashJS, [{
        key: 'duration',
        value: function duration() {
            return this._duration || this.el_.duration || 0;
        }

        /*
         * Iterate over the `keySystemOptions` array and convert each object into
         * the type of object Dash.js expects in the `protData` argument.
         *
         * Also rename 'licenseUrl' property in the options to an 'serverURL' property
         */

    }, {
        key: 'dispose',
        value: function dispose() {
            if (this.mediaPlayer_) {
                this.mediaPlayer_.reset();
            }
        }
    }], [{
        key: 'buildDashJSProtData',
        value: function buildDashJSProtData(keySystemOptions) {
            var output = {};

            if (!keySystemOptions || !isArray(keySystemOptions)) {
                return output;
            }

            for (var i = 0; i < keySystemOptions.length; i++) {
                var keySystem = keySystemOptions[i];
                var options = videojs.mergeOptions({}, keySystem.options);

                if (options.licenseUrl) {
                    options.serverURL = options.licenseUrl;
                    delete options.licenseUrl;
                }

                output[keySystem.name] = options;
            }

            return output;
        }
    }]);

    return Html5DashJS;
}();

videojs.DashSourceHandler = function () {
    return {
        canHandleSource: function canHandleSource(source) {
            var dashExtRE = /\.mpd/i;

            if (videojs.DashSourceHandler.canPlayType(source.type)) {
                return 'probably';
            } else if (dashExtRE.test(source.src)) {
                return 'maybe';
            } else {
                return '';
            }
        },

        handleSource: function handleSource(source, tech, options) {
            return new Html5DashJS(source, tech, options);
        },

        canPlayType: function canPlayType(type) {
            return videojs.DashSourceHandler.canPlayType(type);
        }
    };
};

videojs.DashSourceHandler.canPlayType = function (type) {
    var dashTypeRE = /^application\/dash\+xml/i;
    if (dashTypeRE.test(type)) {
        return 'probably';
    }

    return '';
};

// Only add the SourceHandler if the browser supports MediaSourceExtensions
if (!!_window2.default.MediaSource) {
    videojs.getComponent('Html5').registerSourceHandler(videojs.DashSourceHandler(), 0); // eslint-disable-line new-cap
}

videojs.Html5DashJS = Html5DashJS;
exports.default = Html5DashJS;
module.exports = exports['default'];

/***/ }),
/* 3 */
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || Function("return this")() || (1,eval)("this");
} catch(e) {
	// This works if the window reference is available
	if(typeof window === "object")
		g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ })
/******/ ]);
});